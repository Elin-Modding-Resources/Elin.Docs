---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 29 files modified. 3 new files created.
version: EA 23.257 Nightly Patch 2
changes: ACT/AI_Goto/AI_Idle/AM_Adv/AM_MoveInstalled/ActEffect/ActPlan/ActRush/ActorEx/AttackProcess/BaseCondition/BaseTileMap/Biography/Card/Chara/CharaRenderer/+ConAmbush/+ConPeaky/ConTransmute/+ConTransmuteMimic/FEAT/GameUpdater/HotItemHeld/HotItemNoItem/Player/Religion/RendererReplacer/SLOT/SPELL/Thing/Trait/Zone
---

# EA 23.257 Nightly Patch 2

January 10, 2026

29 files modified. 3 new files created.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [BaseCondition (1)](#basecondition)
```cs:no-line-numbers
public bool TryNullify(Condition c) // [!code --]
public virtual bool TryNullify(Condition c) // [!code ++]
```
### [Religion (1)](#religion)
```cs:no-line-numbers
public bool IsValidArtifact(string id) // [!code --]
public static Religion GetArtifactDeity(string id) // [!code ++]
```
### [RendererReplacer (1)](#rendererreplacer)
```cs:no-line-numbers
public static RendererReplacer CreateFrom(string id, int shift = 0) // [!code --]
public static RendererReplacer CreateFrom(string id, int shift = 0, int mat = -1) // [!code ++]
```
## ACT

[`public virtual bool ShowMouseHint(Card c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ACT.cs#L200-L206)
```cs:line-numbers=200

	public virtual bool IsValidTC(Card c)
	{
		if (!c.isChara) // [!code --]
		if (!c.isChara || c.Chara.mimicry != null) // [!code ++]
		{
			return c.trait.CanBeAttacked;
		}
```

[`public bool CanPerform(Chara _cc, Card _tc = null, Point _tp = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ACT.cs#L345-L351)
```cs:line-numbers=345
			}
		}
	}
	if (!(this is ActMelee) && tt.Range == TargetRange.Chara && (TC == null || !CC.CanSee(TC))) // [!code --]
	if (!(this is ActMelee) && tt.Range == TargetRange.Chara && (TC == null || !CC.CanSee(TC) || TC.Chara?.mimicry != null)) // [!code ++]
	{
		return false;
	}
```

## AI_Goto

[`public Status TryGoTo()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/AI_Goto.cs#L129-L135)
```cs:line-numbers=129
		{
			return Status.Running;
		}
		if (moveResult == Card.MoveResult.Fail || moveResult == Card.MoveResult.Door) // [!code --]
		if (moveResult == Card.MoveResult.Fail || (uint)(moveResult - 2) <= 1u) // [!code ++]
		{
			if (owner.IsPC && ActionMode.IsAdv)
			{
```

## AI_Idle

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/AI_Idle.cs#L368-L373)
```cs:line-numbers=368
				}
			}
		}
		if (!EClass._zone.IsRegion && owner.id == "mimic" && EClass.rnd(5) == 0 && owner.mimicry == null) // [!code ++]
		{ // [!code ++]
			owner.UseAbility(8794, owner); // [!code ++]
		} // [!code ++]
		Party party = owner.party;
		if (party == null || party.leader == owner || !party.leader.IsAliveInCurrentZone || owner.host != null || !EClass._zone.PetFollow)
		{
```

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/AI_Idle.cs#L975-L981)
```cs:line-numbers=975
	string aiIdle = owner.source.aiIdle;
	if (!(aiIdle == "stand") && !(aiIdle == "root"))
	{
		if (EClass.rnd(15) == 0) // [!code --]
		if (EClass.rnd(15) == 0 && owner.mimicry == null) // [!code ++]
		{
			owner.MoveRandom();
		}
```

## AM_Adv

[`public override void OnRenderTile(Point point, HitResult result, int dir)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/AM_Adv.cs#L297-L303)
```cs:line-numbers=297
	}
	foreach (Chara chara in EClass._map.charas)
	{
		if (chara.isSynced && chara.IsHostile(EClass.pc) && !chara.IsMultisize && EClass.pc.CanSee(chara)) // [!code --]
		if (chara.isSynced && chara.IsHostile(EClass.pc) && !chara.IsMultisize && EClass.pc.CanSee(chara) && chara.mimicry == null) // [!code ++]
		{
			Vector3 vector = chara.pos.Position();
			EClass.screen.guide.passGuideFloor.Add(vector.x, vector.y, vector.z - 0.01f, 23f, 0.3f);
```

## AM_MoveInstalled

[`public Card GetTarget(Point point)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/AM_MoveInstalled.cs#L178-L188)
```cs:line-numbers=178

	public bool CanPutAway()
	{
		if (target == null) // [!code ++]
		{ // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
		if (target.HasTag(CTAG.godArtifact)) // [!code ++]
		{ // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
		if (EClass.debug.ignoreBuildRule)
		{
			return true;
		}
		if (target == null || target.isChara || target.trait.CanOnlyCarry) // [!code --]
		if (target.isChara || target.trait.CanOnlyCarry) // [!code ++]
		{
			return false;
		}
```

## ActEffect

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActEffect.cs#L1110-L1127)
```cs:line-numbers=1110
			return;
		}
		List<Chara> list3 = new List<Chara>();
		bool flag5 = false; // [!code --]
		bool flag6 = false; // [!code ++]
		foreach (Chara chara2 in EClass._map.charas)
		{
			if (!chara2.IsPCFactionOrMinion && chara2.id == "littleOne")
			{
				if (flag5) // [!code --]
				if (flag6) // [!code ++]
				{
					flag5 = false; // [!code --]
					flag6 = false; // [!code ++]
					continue;
				}
				list3.Add(chara2);
				flag5 = true; // [!code --]
				flag6 = true; // [!code ++]
			}
		}
		if (list3.Count == 0)
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActEffect.cs#L1193-L1201)
```cs:line-numbers=1193
		TC.PlaySound("curse3");
		TC.PlayEffect("curse");
		TC.Say("forgetItems", TC);
		int num5 = power / 50 + 1 + EClass.rnd(3); // [!code --]
		int num4 = power / 50 + 1 + EClass.rnd(3); // [!code ++]
		List<Thing> source = TC.things.List((Thing t) => t.c_IDTState == 0);
		for (int j = 0; j < num5; j++) // [!code --]
		for (int j = 0; j < num4; j++) // [!code ++]
		{
			source.RandomItem().c_IDTState = 5;
		}
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActEffect.cs#L1207-L1216)
```cs:line-numbers=1207
	case EffectId.EnchantArmorGreat:
	{
		bool armor = id == EffectId.EnchantArmor || id == EffectId.EnchantArmorGreat;
		bool flag4 = id == EffectId.EnchantWeaponGreat || id == EffectId.EnchantArmorGreat; // [!code --]
		bool flag5 = id == EffectId.EnchantWeaponGreat || id == EffectId.EnchantArmorGreat; // [!code ++]
		if (!tc.isThing)
		{
			LayerDragGrid.CreateEnchant(CC, armor, flag4, state); // [!code --]
			LayerDragGrid.CreateEnchant(CC, armor, flag5, state); // [!code ++]
			return;
		}
		cc.PlaySound("identify");
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActEffect.cs#L1221-L1228)
```cs:line-numbers=1221
			tc.ModEncLv(-1);
			break;
		}
		int num4 = (flag4 ? 4 : 2) + (blessed ? 1 : 0); // [!code --]
		if (tc.encLV >= num4) // [!code --]
		int num5 = (flag5 ? 4 : 2) + (blessed ? 1 : 0); // [!code ++]
		if (tc.encLV >= num5) // [!code ++]
		{
			cc.Say("enc_resist", tc);
			break;
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActEffect.cs#L1234-L1254)
```cs:line-numbers=1234
	case EffectId.Identify:
	case EffectId.GreaterIdentify:
	{
		bool flag6 = id == EffectId.GreaterIdentify; // [!code --]
		bool flag3 = id == EffectId.GreaterIdentify; // [!code ++]
		if (flag)
		{
			Redirect(EffectId.ForgetItems, flag6 ? BlessedState.Cursed : BlessedState.Normal, default(ActRef)); // [!code --]
			Redirect(EffectId.ForgetItems, flag3 ? BlessedState.Cursed : BlessedState.Normal, default(ActRef)); // [!code ++]
			break;
		}
		if (!tc.isThing)
		{
			int count = ((!blessed) ? 1 : (flag6 ? (2 + EClass.rnd(2)) : (3 + EClass.rnd(3)))); // [!code --]
			LayerDragGrid.CreateIdentify(CC, flag6, state, 0, count); // [!code --]
			int count = ((!blessed) ? 1 : (flag3 ? (2 + EClass.rnd(2)) : (3 + EClass.rnd(3)))); // [!code ++]
			LayerDragGrid.CreateIdentify(CC, flag3, state, 0, count); // [!code ++]
			return;
		}
		cc.PlaySound("identify");
		cc.PlayEffect("identify");
		tc.Thing.Identify(cc.IsPCParty, (!flag6) ? IDTSource.Identify : IDTSource.SuperiorIdentify); // [!code --]
		tc.Thing.Identify(cc.IsPCParty, (!flag3) ? IDTSource.Identify : IDTSource.SuperiorIdentify); // [!code ++]
		break;
	}
	case EffectId.Uncurse:
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActEffect.cs#L1290-L1305)
```cs:line-numbers=1290
		Element orCreateElement2 = tc.elements.GetOrCreateElement(65);
		Element orCreateElement3 = tc.elements.GetOrCreateElement(67);
		Element orCreateElement4 = tc.elements.GetOrCreateElement(66);
		bool flag3 = tc.IsEquipmentOrRangedOrAmmo || tc.IsThrownWeapon; // [!code --]
		bool flag4 = tc.IsEquipmentOrRangedOrAmmo || tc.IsThrownWeapon; // [!code ++]
		if (flag)
		{
			num3 = (int)(0.01f * (float)num3 * (float)power * 0.75f + 500f);
			if (num3 < 0 || num3 > 10000000)
			{
				num3 = 10000000;
				flag3 = false; // [!code --]
				flag4 = false; // [!code ++]
			}
			if (flag3) // [!code --]
			if (flag4) // [!code ++]
			{
				if (tc.IsWeapon || tc.IsThrownWeapon || tc.IsAmmo)
				{
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActEffect.cs#L1321-L1327)
```cs:line-numbers=1321
			{
				power /= 4;
			}
			if (flag3) // [!code --]
			if (flag4) // [!code ++]
			{
				if (tc.IsWeapon || tc.IsThrownWeapon || tc.IsAmmo)
				{
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActEffect.cs#L1349-L1355)
```cs:line-numbers=1349
	{
		if (!tc.isThing)
		{
			LayerDragGrid.CreateReconstruction(CC, state, power); // [!code --]
			LayerDragGrid.CreateReconstruction(CC, state, power / ((!(blessed || flag)) ? 1 : 2)); // [!code ++]
			return;
		}
		if (tc.Num > 1)
```

## ActPlan

[`public void _Update(PointTarget target)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActPlan.cs#L528-L604)
```cs:line-numbers=528
				int num = c2.Dist(EClass.pc);
				if (num <= 1 || !EClass.pc.isBlind)
				{
					if (!EClass.pc.isBlind && !c2.IsHostile() && (input == ActInput.AllAction || !(c2.IsPCParty || c2.IsMinion || isKey)) && (input == ActInput.AllAction || !c2.IsNeutral() || c2.quest != null || EClass.game.quests.IsDeliverTarget(c2)) && c2.isSynced && num <= 2) // [!code --]
					if (c2.mimicry != null) // [!code ++]
					{
						bool flag5 = !c2.HasCondition<ConSuspend>() && (!c2.isRestrained || !c2.IsPCFaction); // [!code --]
						if (EClass._zone.instance is ZoneInstanceMusic && !c2.IsPCFactionOrMinion) // [!code --]
						if (num <= 1) // [!code ++]
						{
							flag5 = false; // [!code --]
						} // [!code --]
						if (flag5 || altAction) // [!code --]
						{ // [!code --]
							if (EClass.pc.HasElement(1216) && c2.HasCondition<ConSleep>()) // [!code --]
							{ // [!code --]
								TrySetAct(new AI_Fuck // [!code --]
								{ // [!code --]
									target = c2, // [!code --]
									variation = AI_Fuck.Variation.Succubus // [!code --]
								}, c2); // [!code --]
							} // [!code --]
							TrySetAct(ACT.Chat, c2); // [!code --]
							c2.mimicry.TrySetAct(this); // [!code ++]
						}
					}
					if (!c2.IsPC && num <= 2 && ((c2.IsPCFaction && !c2.IsDisabled) || EClass.debug.enable) && input == ActInput.AllAction) // [!code --]
					else // [!code ++]
					{
						TrySetAct("actTrade", delegate // [!code --]
						if (!EClass.pc.isBlind && !c2.IsHostile() && (input == ActInput.AllAction || !(c2.IsPCParty || c2.IsMinion || isKey)) && (input == ActInput.AllAction || !c2.IsNeutral() || c2.quest != null || EClass.game.quests.IsDeliverTarget(c2)) && c2.isSynced && num <= 2) // [!code ++]
						{
							LayerInventory.CreateContainer(c2); // [!code --]
							return false; // [!code --]
						}, c2, null, 2); // [!code --]
					} // [!code --]
					if (c2.host != EClass.pc) // [!code --]
					{ // [!code --]
						TraitShackle traitShackle = c2.pos.FindThing<TraitShackle>(); // [!code --]
						if (c2.IsRestrainedResident) // [!code --]
						{ // [!code --]
							if (traitShackle != null && traitShackle.AllowTraining) // [!code --]
							bool flag5 = !c2.HasCondition<ConSuspend>() && (!c2.isRestrained || !c2.IsPCFaction); // [!code ++]
							if (EClass._zone.instance is ZoneInstanceMusic && !c2.IsPCFactionOrMinion) // [!code ++]
							{ // [!code ++]
								flag5 = false; // [!code ++]
							} // [!code ++]
							if (flag5 || altAction) // [!code ++]
							{
								TrySetAct(new AI_PracticeDummy // [!code --]
								if (EClass.pc.HasElement(1216) && c2.HasCondition<ConSleep>()) // [!code ++]
								{
									target = c2 // [!code --]
								}); // [!code --]
									TrySetAct(new AI_Fuck // [!code ++]
									{ // [!code ++]
										target = c2, // [!code ++]
										variation = AI_Fuck.Variation.Succubus // [!code ++]
									}, c2); // [!code ++]
								} // [!code ++]
								TrySetAct(ACT.Chat, c2); // [!code ++]
							}
						}
						else if ((c2.IsHostile() || altAction || c2.isRestrained) && c2.IsAliveInCurrentZone) // [!code --]
						if (!c2.IsPC && num <= 2 && ((c2.IsPCFaction && !c2.IsDisabled) || EClass.debug.enable) && input == ActInput.AllAction) // [!code ++]
						{
							TrySetAct(ACT.Melee, c2); // [!code --]
							TrySetAct("actTrade", delegate // [!code ++]
							{ // [!code ++]
								LayerInventory.CreateContainer(c2); // [!code ++]
								return false; // [!code ++]
							}, c2, null, 2); // [!code ++]
						}
					} // [!code --]
					if (c2.IsPCPartyMinion && !c2.Chara.IsEscorted() && altAction) // [!code --]
					{ // [!code --]
						TrySetAct("ActBanishSummon", delegate // [!code --]
						{ // [!code --]
							c2.Banish(EClass.pc); // [!code --]
							return true; // [!code --]
						}, c2, null, 99); // [!code --]
						List<Chara> list2 = new List<Chara>(); // [!code --]
						foreach (Chara chara in EClass._map.charas) // [!code --]
						if (c2.host != EClass.pc) // [!code ++]
						{
							if (chara.IsPCFactionMinion && !chara.IsEscorted()) // [!code --]
							TraitShackle traitShackle = c2.pos.FindThing<TraitShackle>(); // [!code ++]
							if (c2.IsRestrainedResident) // [!code ++]
							{
								list2.Add(chara); // [!code --]
								if (traitShackle != null && traitShackle.AllowTraining) // [!code ++]
								{ // [!code ++]
									TrySetAct(new AI_PracticeDummy // [!code ++]
									{ // [!code ++]
										target = c2 // [!code ++]
									}); // [!code ++]
								} // [!code ++]
							} // [!code ++]
							else if ((c2.IsHostile() || altAction || c2.isRestrained) && c2.IsAliveInCurrentZone) // [!code ++]
							{ // [!code ++]
								TrySetAct(ACT.Melee, c2); // [!code ++]
							}
						}
						if (list2.Count > 1) // [!code --]
						if (c2.IsPCPartyMinion && !c2.Chara.IsEscorted() && altAction) // [!code ++]
						{
							TrySetAct("ActBanishSummonAll", delegate // [!code --]
							TrySetAct("ActBanishSummon", delegate // [!code ++]
							{
								foreach (Chara item in list2) // [!code --]
								{ // [!code --]
									item.Banish(EClass.pc); // [!code --]
								} // [!code --]
								c2.Banish(EClass.pc); // [!code ++]
								return true;
							}, c2, null, 99);
							List<Chara> list2 = new List<Chara>(); // [!code ++]
							foreach (Chara chara in EClass._map.charas) // [!code ++]
							{ // [!code ++]
								if (chara.IsPCFactionMinion && !chara.IsEscorted()) // [!code ++]
								{ // [!code ++]
									list2.Add(chara); // [!code ++]
								} // [!code ++]
							} // [!code ++]
							if (list2.Count > 1) // [!code ++]
							{ // [!code ++]
								TrySetAct("ActBanishSummonAll", delegate // [!code ++]
								{ // [!code ++]
									foreach (Chara item in list2) // [!code ++]
									{ // [!code ++]
										item.Banish(EClass.pc); // [!code ++]
									} // [!code ++]
									return true; // [!code ++]
								}, c2, null, 99); // [!code ++]
							} // [!code ++]
						}
					}
				}
```

[`public void _Update(PointTarget target)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActPlan.cs#L613-L619)
```cs:line-numbers=613
			items.ForeachReverse(delegate(Card _c)
			{
				Chara c = _c.Chara;
				if (c != null) // [!code --]
				if (c != null && c.mimicry == null) // [!code ++]
				{
					bool flag3 = EClass.pc.CanSee(c);
					if (flag3)
```

[`void func()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActPlan.cs#L947-L953)
```cs:line-numbers=947
		{
			hotItem.TrySetAct(this);
		}
		bool flag = EClass.game.config.autoCombat.enable && EClass.scene.mouseTarget.TargetChara != null; // [!code --]
		bool flag = EClass.game.config.autoCombat.enable && EClass.scene.mouseTarget.TargetChara != null && EClass.scene.mouseTarget.TargetChara.mimicry == null; // [!code ++]
		if (hotItem.Thing != null && hotItem.Thing.trait.DisableAutoCombat)
		{
			flag = false;
```

## ActRush

[`public override bool CanPerform()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActRush.cs#L37-L42)
```cs:line-numbers=37
	{
		return false;
	}
	if (Act.TC.Chara?.mimicry != null) // [!code ++]
	{ // [!code ++]
		return false; // [!code ++]
	} // [!code ++]
	Act.TP.Set(flag ? EClass.scene.mouseTarget.pos : Act.TC.pos);
	if (Act.CC.isRestrained || Act.CC.HasCondition<ConEntangle>())
	{
```

## ActorEx

[`public void SetOwner(Card c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActorEx.cs#L37-L43)
```cs:line-numbers=37
	{
		data = EMono.core.refs.dictBGM.TryGetValue(owner.refVal);
	}
	if ((bool)audioSource) // [!code --]
	if ((bool)audioSource && (bool)data) // [!code ++]
	{
		audioSource.clip = data.clip;
		audioSource.pitch = data.pitch * (1f + ((data.randomPitch == 0f) ? 0f : Rand.Range(0f - data.randomPitch, data.randomPitch)));
```

[`public float GetVolume()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ActorEx.cs#L90-L95)
```cs:line-numbers=90

	public void Refresh()
	{
		if (!data) // [!code ++]
		{ // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		if (owner.parent != EMono.pc.currentZone)
		{
			Debug.LogWarning(owner);
```

## AttackProcess

[`private bool EvadePlus()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/AttackProcess.cs#L998-L1007)
```cs:line-numbers=998

	public bool CalcHit()
	{
		if (CC.HasCondition<ConAmbush>()) // [!code ++]
		{ // [!code ++]
			return Crit(); // [!code ++]
		} // [!code ++]
		if (critFury)
		{
			crit = true; // [!code --]
			return true; // [!code --]
			return Crit(); // [!code ++]
		}
		if (CC.HasCondition<ConSevenSense>() && (CC.HasElement(1244) || CC.HasElement(1246) || CC.HasElement(1247)))
		{
```

[`public bool CalcHit()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/AttackProcess.cs#L1034-L1042)
```cs:line-numbers=1034
				return EvadePlus();
			}
		}
		if (TC.Evalue(57) > EClass.rnd(100)) // [!code --]
		int num3 = TC.Evalue(57); // [!code ++]
		if (num3 > 0) // [!code ++]
		{ // [!code ++]
			if (num3 > EClass.rnd(100)) // [!code ++]
			{ // [!code ++]
				return EvadePlus(); // [!code ++]
			} // [!code ++]
		} // [!code ++]
		else if (num3 < 0 && num3 * -1 > EClass.rnd(100)) // [!code ++]
		{
			return EvadePlus(); // [!code --]
			return true; // [!code ++]
		}
	}
	if (EClass.rnd(20) == 0)
```

[`public bool CalcHit()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/AttackProcess.cs#L1069-L1076)
```cs:line-numbers=1069
	}
	if (CC.Evalue(1420) > 0)
	{
		int num3 = Mathf.Min(100, 100 - CC.hp * 100 / CC.MaxHP) * (50 + CC.Evalue(1420) * 50) / 100; // [!code --]
		if (num3 >= 50 && num3 * num3 * num3 * num3 / 3 > EClass.rnd(100000000)) // [!code --]
		int num4 = Mathf.Min(100, 100 - CC.hp * 100 / CC.MaxHP) * (50 + CC.Evalue(1420) * 50) / 100; // [!code ++]
		if (num4 >= 50 && num4 * num4 * num4 * num4 / 3 > EClass.rnd(100000000)) // [!code ++]
		{
			return Crit();
		}
```

## BaseCondition

[`public virtual string RefString1`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/BaseCondition.cs#L130-L135)
```cs:line-numbers=130
		}
	}

	public virtual bool ShouldTryNullify => base.source.nullify.Length != 0; // [!code ++]
 // [!code ++]
	public virtual bool CanManualRemove => false;

	public virtual bool CanStack(Condition c)
```

[`public void Start()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/BaseCondition.cs#L249-L255)
```cs:line-numbers=249
	OnStart();
	OnStartOrStack();
	PlayEffect();
	if (base.source.nullify.Length == 0) // [!code --]
	if (!ShouldTryNullify) // [!code ++]
	{
		return;
	}
```

[`public void Start()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/BaseCondition.cs#L262-L268)
```cs:line-numbers=262
		}
	}

	public bool TryNullify(Condition c) // [!code --]
	public virtual bool TryNullify(Condition c) // [!code ++]
	{
		if (base.source.nullify.Length == 0)
		{
```

## BaseTileMap

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/BaseTileMap.cs#L1659-L1668)
```cs:line-numbers=1659
	for (int k = 0; k < detail.charas.Count; k++)
	{
		Chara chara = detail.charas[k];
		if (chara.host != null || (chara != EMono.pc && chara != LayerDrama.alwaysVisible && (flag3 || fogged || (!showAllCards && !EMono.player.CanSee(chara))))) // [!code --]
		if (chara.host != null) // [!code ++]
		{
			continue;
		}
		if (chara != EMono.pc && chara != LayerDrama.alwaysVisible) // [!code ++]
		{ // [!code ++]
			if (chara.mimicry != null) // [!code ++]
			{ // [!code ++]
				if (flag3 || fogged || !this.cell.isSeen) // [!code ++]
				{ // [!code ++]
					continue; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			else if (flag3 || fogged || (!showAllCards && !EMono.player.CanSee(chara))) // [!code ++]
			{ // [!code ++]
				continue; // [!code ++]
			} // [!code ++]
		} // [!code ++]
		_actorPos.x = orgX;
		_actorPos.y = orgY;
		_actorPos.z = orgZ;
```

## Biography

[`public void SetPortrait(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Biography.cs#L489-L494)
```cs:line-numbers=489
	case "sister":
	case "sister_shark":
	case "sister_penguin":
	case "imotoroid": // [!code ++]
	case "imotoroid_origin": // [!code ++]
		c.c_idPortrait = Portrait.GetRandomPortrait("special_f-littlesister");
		break;
	case "citizen_exile":
```

## Card

[`public enum MoveResult`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Card.cs#L13-L19)
```cs:line-numbers=13
	{
		Fail,
		Success,
		Door // [!code --]
		Door, // [!code ++]
		Event // [!code ++]
	}

	public enum MoveType
```

[`private void _OnDeserialized(StreamingContext context)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Card.cs#L2718-L2735)
```cs:line-numbers=2718
		{
			isDestroyed = true;
		}
		if (version < 4) // [!code --]
		if (version >= 5) // [!code ++]
		{
			if (version < 3 && isChara && HasElement(1210)) // [!code --]
			return; // [!code ++]
		} // [!code ++]
		if (version < 3 && isChara && HasElement(1210)) // [!code ++]
		{ // [!code ++]
			elements.ModBase(960, -5 * Evalue(1210)); // [!code ++]
		} // [!code ++]
		if (version < 4 && isChara && HasElement(1210)) // [!code ++]
		{ // [!code ++]
			elements.ModBase(423, Evalue(1210)); // [!code ++]
		} // [!code ++]
		if (version < 5) // [!code ++]
		{ // [!code ++]
			if (isChara && Chara.race.id == "horse" && Chara.body.GetSlot(30, onlyEmpty: false) == null) // [!code ++]
			{
				elements.ModBase(960, -5 * Evalue(1210)); // [!code --]
				Chara.body.AddBodyPart(30); // [!code ++]
				Chara.body.RefreshBodyParts(); // [!code ++]
			}
			if (version < 4 && isChara && HasElement(1210)) // [!code --]
			if (isChara && Chara.race.id == "bike" && id != "bike_cub") // [!code ++]
			{
				elements.ModBase(423, Evalue(1210)); // [!code --]
				Rand.SetSeed(uid); // [!code ++]
				Chara.body.AddBodyPart(30); // [!code ++]
				Chara.SetFeat(1423, 1 + EClass.rnd(10)); // [!code ++]
				Rand.SetSeed(); // [!code ++]
			}
			version = 4; // [!code --]
		}
		version = 5; // [!code ++]
	}

	protected virtual void OnDeserialized()
```

[`public void Create(string _id, int _idMat = -1, int genLv = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Card.cs#L2758-L2764)
```cs:line-numbers=2758
	EClass.game.cards.AssignUID(this);
	this.genLv = genLv;
	isNew = true;
	version = 3; // [!code --]
	version = 5; // [!code ++]
	SetSource();
	OnBeforeCreate();
	if (sourceCard.quality != 0)
```

[`public void PurgeDuplicateArtifact(Thing af)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Card.cs#L3243-L3262)
```cs:line-numbers=3243
	{
		foreach (Chara item in list)
		{
			if (item.IsPCFactionOrMinion) // [!code --]
			if (!item.IsPCFactionOrMinion) // [!code ++]
			{ // [!code ++]
				continue; // [!code ++]
			} // [!code ++]
			List<Thing> list2 = item.things.List((Thing t) => t.HasTag(CTAG.godArtifact) && t != af && !t.isReplica && t.c_idDeity == EClass.pc.faith.id); // [!code ++]
			if (list2.Count == 0) // [!code ++]
			{
				List<Thing> list2 = item.things.List((Thing t) => t.HasTag(CTAG.godArtifact) && t != af && !t.isReplica && t.c_idDeity == EClass.pc.faith.id); // [!code --]
				if (list2.Count != 0) // [!code --]
				continue; // [!code ++]
			} // [!code ++]
			foreach (Thing item2 in list2) // [!code ++]
			{ // [!code ++]
				Religion artifactDeity = Religion.GetArtifactDeity(item2.id); // [!code ++]
				if (item2.isEquipped) // [!code ++]
				{
					foreach (Thing item2 in list2) // [!code --]
					{ // [!code --]
						Msg.Say("destroyed_inv_", item2, item); // [!code --]
						item2.Destroy(); // [!code --]
					} // [!code --]
					item.body.Unequip(item2); // [!code ++]
				}
				item2.c_idDeity = artifactDeity?.id ?? null; // [!code ++]
				Msg.Say("waterCurse", item2); // [!code ++]
			}
		}
		return; // [!code --]
	}
	foreach (Chara item3 in list)
	{
```

[`public void DamageHP(long dmg, int ele, int eleP = 100, AttackSource attackSourc`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Card.cs#L4659-L4664)
```cs:line-numbers=4659
	onEvade?.Invoke();
	if (isChara)
	{
		if (Chara.mimicry != null) // [!code ++]
		{ // [!code ++]
			Chara.RemoveCondition<ConTransmuteMimic>(); // [!code ++]
		} // [!code ++]
		foreach (Condition condition3 in Chara.conditions) // [!code ++]
		{ // [!code ++]
			(condition3 as ConPeaky)?.OnHit(); // [!code ++]
		} // [!code ++]
		if (flag2)
		{
			if (!Chara.HasCondition<ConFaint>())
```

## Chara

[`public class Chara : Card, IPathfindWalker`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L103-L108)
```cs:line-numbers=103

	public ConSuspend conSuspend;

	public ConTransmuteMimic mimicry; // [!code ++]
 // [!code ++]
	public Emo2 emoIcon;

	public int happiness;
```

[`protected override void OnDeserialized()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L1356-L1361)
```cs:line-numbers=1356

	public override string GetName(NameStyle style, int num = -1)
	{
		if (mimicry != null) // [!code ++]
		{ // [!code ++]
			return mimicry.thing.GetName(style, num); // [!code ++]
		} // [!code ++]
		if (base.isBackerContent && EClass.core.config.backer.Show(base.c_idBacker))
		{
			if (id == "follower" && !IsGlobal)
```

[`public void Refresh(bool calledRecursive = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L1747-L1753)
```cs:line-numbers=1747
	{
		base.isHidden = false;
	}
	visibleWithTelepathy = !IsUndead && !IsMachine && !IsHorror && !IsMultisize; // [!code --]
	visibleWithTelepathy = mimicry == null && !IsUndead && !IsMachine && !IsHorror && !IsMultisize; // [!code ++]
	SetDirtySpeed();
	if (host != null && !calledRecursive && host.source != null)
	{
```

[`public void RefreshSpeed(Element.BonusInfo info = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L1878-L1884)
```cs:line-numbers=1878
		if (host.ride == this)
		{
			_Speed = Evalue(79);
			_Speed = _Speed * 100 / Mathf.Clamp(100 + (int)_Speed * ((!race.tag.Contains("noRide")) ? 1 : 5) - base.STR - host.EvalueRiding() * 2 - (race.tag.Contains("ride") ? 50 : 0), 100, 1000); // [!code --]
			int a = Evalue(1423); // [!code ++]
			int value = 100 + (int)_Speed * ((!race.tag.Contains("noRide")) ? 1 : 5) * Mathf.Max(a, 1) - base.STR - host.EvalueRiding() * 2 - (race.tag.Contains("ride") ? 50 : 0); // [!code ++]
			_Speed = _Speed * 100 / Mathf.Clamp(value, 100, 1000); // [!code ++]
		}
		else
		{
```

[`public void ApplyRace(bool remove = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L2262-L2267)
```cs:line-numbers=2262
		}
		body.RefreshBodyParts();
		elements.ApplyElementMap(base.uid, SourceValueType.Chara, race.elementMap, base.DefaultLV, remove, applyFeat: true);
		if (!remove && race.id == "bike" && id != "bike_cub") // [!code ++]
		{ // [!code ++]
			SetFeat(1423, (id == "chara" || id == "player") ? 10 : (1 + EClass.rnd(10))); // [!code ++]
		} // [!code ++]
	}

	public void ChangeRace(string idNew)
```

[`public bool IsEnemyOnPath(Point p, bool cancelAI = true)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L2506-L2512)
```cs:line-numbers=2506
		{
			foreach (Chara chara in p.detail.charas)
			{
				if (chara.IsHostile(this) || chara.IsHostile() || !chara.trait.CanBePushed) // [!code --]
				if (chara.mimicry == null && (chara.IsHostile(this) || chara.IsHostile() || !chara.trait.CanBePushed)) // [!code ++]
				{
					if (cancelAI && EClass.pc.ai is GoalManualMove)
					{
```

[`public override MoveResult _Move(Point newPoint, MoveType type = MoveType.Walk)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L2894-L2906)
```cs:line-numbers=2894
	}
	if (IsPC)
	{
		EClass.player.renderExtraTime = 0f; // [!code ++]
		if (EClass._zone.IsRegion)
		{
			actTime *= EClass.setting.render.anime.regionSpeed;
		}
		else if ((newPoint.x > pos.x && newPoint.z > pos.z) || (newPoint.x < pos.x && newPoint.z < pos.z))
		{
			actTime += actTime * EClass.setting.render.anime.diagonalSpeed; // [!code --]
			EClass.player.renderExtraTime = actTime * EClass.setting.render.anime.diagonalSpeed; // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (newPoint.HasChara) // [!code ++]
	{ // [!code ++]
		foreach (Chara item in newPoint.ListCharas()) // [!code ++]
		{ // [!code ++]
			if (item.mimicry != null && item.IsHostile(this)) // [!code ++]
			{ // [!code ++]
				item.mimicry.RevealMimicry(this, surprise: true); // [!code ++]
				return MoveResult.Event; // [!code ++]
			} // [!code ++]
		}
	}
	if (newPoint.cell.hasDoor)
```

[`public override MoveResult _Move(Point newPoint, MoveType type = MoveType.Walk)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L3046-L3075)
```cs:line-numbers=3046
		PlaySound("Footstep/Extra/pcfootstep");
		if (pos.HasThing)
		{
			foreach (Card item in pos.ListCards()) // [!code --]
			foreach (Card item2 in pos.ListCards()) // [!code ++]
			{
				if (!item.isThing || item.placeState != 0 || item.ignoreAutoPick) // [!code --]
				if (!item2.isThing || item2.placeState != 0 || item2.ignoreAutoPick) // [!code ++]
				{
					continue;
				}
				if (EClass.core.config.game.advancedMenu)
				{
					Window.SaveData dataPick = EClass.player.dataPick;
					ContainerFlag containerFlag = item.category.GetRoot().id.ToEnum<ContainerFlag>(); // [!code --]
					ContainerFlag containerFlag = item2.category.GetRoot().id.ToEnum<ContainerFlag>(); // [!code ++]
					if (containerFlag == ContainerFlag.none)
					{
						containerFlag = ContainerFlag.other;
					}
					if ((dataPick.noRotten && item.IsDecayed) || (dataPick.onlyRottable && item.trait.Decay == 0)) // [!code --]
					if ((dataPick.noRotten && item2.IsDecayed) || (dataPick.onlyRottable && item2.trait.Decay == 0)) // [!code ++]
					{
						continue;
					}
					if (dataPick.userFilter)
					{
						switch (dataPick.IsFilterPass(item.GetName(NameStyle.Full, 1))) // [!code --]
						switch (dataPick.IsFilterPass(item2.GetName(NameStyle.Full, 1))) // [!code ++]
						{
						case Window.SaveData.FilterResult.PassWithoutFurtherTest:
							Pick(item.Thing); // [!code --]
							Pick(item2.Thing); // [!code ++]
							continue;
						case Window.SaveData.FilterResult.Block:
							continue;
```

[`public override MoveResult _Move(Point newPoint, MoveType type = MoveType.Walk)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L3079-L3098)
```cs:line-numbers=3079
					{
						foreach (int cat in dataPick.cats)
						{
							if (item.category.uid == cat) // [!code --]
							if (item2.category.uid == cat) // [!code ++]
							{
								Pick(item.Thing); // [!code --]
								Pick(item2.Thing); // [!code ++]
							}
						}
					}
					else if (!dataPick.flag.HasFlag(containerFlag))
					{
						Pick(item.Thing); // [!code --]
						Pick(item2.Thing); // [!code ++]
					}
				}
				else
				{
					Pick(item.Thing); // [!code --]
					Pick(item2.Thing); // [!code ++]
				}
			}
		}
```

[`public void TickConditions()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L3747-L3773)
```cs:line-numbers=3747
		}
		break;
	case 10:
		if (!HasElement(1250)) // [!code --]
		{ // [!code --]
			break; // [!code --]
		} // [!code --]
		if (!HasCondition<ConVampire>()) // [!code --]
		{ // [!code --]
			AddCondition<ConVampire>(); // [!code --]
		} // [!code --]
		if (!IsPC && !HasCooldown(8793)) // [!code --]
		if (HasElement(1250)) // [!code ++]
		{
			bool flag = false; // [!code --]
			flag = ((!HasCondition<ConTransmuteBat>()) ? (!HasElement(431) && pos.IsSunLit) : (body.HasElement(431) || (EClass.world.date.IsNight && !pos.IsSunLit))); // [!code --]
			if (flag && base.IsPCFactionOrMinion && !EClass._zone.IsPCFactionOrTent && EClass._zone.HasLaw && pos.ListWitnesses(this).Count > 0 && !HasCondition<ConBurning>()) // [!code --]
			if (!HasCondition<ConVampire>()) // [!code ++]
			{
				flag = false; // [!code --]
				AddCondition<ConVampire>(); // [!code ++]
			}
			if (flag) // [!code --]
			if (!IsPC && !HasCooldown(8793)) // [!code ++]
			{
				UseAbility("SpTransmuteBat", this); // [!code --]
				bool flag = false; // [!code ++]
				flag = ((!HasCondition<ConTransmuteBat>()) ? (!HasElement(431) && pos.IsSunLit) : (body.HasElement(431) || (EClass.world.date.IsNight && !pos.IsSunLit))); // [!code ++]
				if (flag && base.IsPCFactionOrMinion && !EClass._zone.IsPCFactionOrTent && EClass._zone.HasLaw && pos.ListWitnesses(this).Count > 0 && !HasCondition<ConBurning>()) // [!code ++]
				{ // [!code ++]
					flag = false; // [!code ++]
				} // [!code ++]
				if (flag) // [!code ++]
				{ // [!code ++]
					UseAbility("SpTransmuteBat", this); // [!code ++]
				} // [!code ++]
			}
		}
		if (HasElement(1423) && !HasCondition<ConPeaky>()) // [!code ++]
		{ // [!code ++]
			AddCondition<ConPeaky>(); // [!code ++]
		} // [!code ++]
		break;
	}
	if (turn % 200 == 0)
```

[`public void Kick(Chara t, bool ignoreSelf = false, bool karmaLoss = true, bool s`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L5841-L5846)
```cs:line-numbers=5841
			EClass.player.ModKarma(-1);
		}
		t.PlayEffect("kick");
		t.mimicry?.RevealMimicry(this, surprise: false); // [!code ++]
	}

	public bool UseAbility(int idAct, Card tc = null, Point pos = null, bool pt = false)
```

[`public bool UseAbility(Act a, Card tc = null, Point pos = null, bool pt = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L6023-L6029)
```cs:line-numbers=6023
		{
			num6 /= 2;
		}
		PlayEffect("cast"); // [!code --]
		if (isSynced) // [!code ++]
		{ // [!code ++]
			PlayEffect("cast"); // [!code ++]
		} // [!code ++]
		mana.Mod(-num6);
		if (isDead)
		{
```

[`public bool FindNewEnemy()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L6475-L6480)
```cs:line-numbers=6475
	{
		return false;
	}
	if (mimicry != null) // [!code ++]
	{ // [!code ++]
		return false; // [!code ++]
	} // [!code ++]
	bool flag = enemy != null || ai is GoalCombat;
	int num = (base.PER + Evalue(210) * 2) * ((!flag) ? 1 : 2);
	bool flag2 = IsPCParty && !IsPC && EClass.game.config.tactics.dontWander;
```

[`public bool FindNewEnemy()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L6484-L6490)
```cs:line-numbers=6484
	for (int i = 0; i < EClass._map.charas.Count; i++)
	{
		Chara chara2 = EClass._map.charas[i];
		if (chara2 == this || !IsHostile(chara2) || !CanSee(chara2)) // [!code --]
		if (chara2 == this || !IsHostile(chara2) || !CanSee(chara2) || chara2.mimicry != null) // [!code ++]
		{
			continue;
		}
```

[`public bool FindNearestNewEnemy()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L6531-L6537)
```cs:line-numbers=6531
	for (int i = 0; i < EClass._map.charas.Count; i++)
	{
		Chara chara = EClass._map.charas[i];
		if (chara != this && chara != enemy && IsHostile(chara) && Dist(chara) <= 1 && CanInteractTo(chara.pos)) // [!code --]
		if (chara != this && chara != enemy && chara.mimicry == null && IsHostile(chara) && Dist(chara) <= 1 && CanInteractTo(chara.pos)) // [!code ++]
		{
			DoHostileAction(chara);
			enemy = chara;
```

[`public bool IsHostile(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L6581-L6587)
```cs:line-numbers=6581
			return true;
		}
	}
	if (id == "unicorn" && c.HasElement(1216)) // [!code --]
	if (id == "unicorn" && (Evalue(418) < 0 || (c.HasElement(1216) && c.Evalue(418) < 1))) // [!code ++]
	{
		return true;
	}
```

[`public override void SetRenderParam(RenderParam p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L6758-L6763)
```cs:line-numbers=6758
	if (renderer.replacer != null)
	{
		p.tile = renderer.replacer.tile * ((!flipX) ? 1 : (-1));
		if (renderer.replacer.mat != -1) // [!code ++]
		{ // [!code ++]
			p.mat = EClass.sources.materials.rows.TryGet(renderer.replacer.mat, 0); // [!code ++]
			p.matColor = BaseTileMap.GetColorInt(ref p.mat.matColor, 100); // [!code ++]
			p.color -= 1048576f; // [!code ++]
		} // [!code ++]
	}
	else if (source._tiles_snow.Length != 0 && EClass._zone.IsSnowCovered)
	{
```

[`public override void SetRenderParam(RenderParam p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L6785-L6790)
```cs:line-numbers=6785

	public override string GetHoverText()
	{
		if (mimicry != null) // [!code ++]
		{ // [!code ++]
			return mimicry.thing.GetHoverText(); // [!code ++]
		} // [!code ++]
		string text = base.Name;
		if (IsFriendOrAbove())
		{
```

[`public override string GetHoverText()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Chara.cs#L6857-L6862)
```cs:line-numbers=6857

	public override string GetHoverText2()
	{
		if (mimicry != null) // [!code ++]
		{ // [!code ++]
			return mimicry.thing.GetHoverText2(); // [!code ++]
		} // [!code ++]
		string text = "";
		if (knowFav)
		{
```

## CharaRenderer

[`public override void UpdatePosition(ref Vector3 destPos, RenderParam p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/CharaRenderer.cs#L158-L163)
```cs:line-numbers=158
		movePoint.Set(owner.pos);
		orgPos = position;
		actTime = owner.actTime;
		if (isPC && EClass.player.renderExtraTime > 0f) // [!code ++]
		{ // [!code ++]
			actTime += EClass.player.renderExtraTime; // [!code ++]
		} // [!code ++]
		RefreshSprite();
		step = 1;
		if (!isMoving)
```

## +ConAmbush

::: details File Created
```cs
public class ConAmbush : Condition
{
	public override int GetPhase()
	{
		return 0;
	}
}
```

:::
## +ConPeaky

::: details File Created
```cs
using Newtonsoft.Json;
using UnityEngine;

public class ConPeaky : Condition
{
	[JsonProperty]
	private ElementContainer ec = new ElementContainer();

	public override int GetPhase()
	{
		return 0;
	}

	public override ElementContainer GetElementContainer()
	{
		return ec;
	}

	public override void Tick()
	{
		if (EClass.rnd(2) == 0)
		{
			return;
		}
		int num = ec.Value(79);
		int num2 = owner.Evalue(1423) * 10;
		if (num < num2)
		{
			ec.ModBase(79, Mathf.Clamp(num2 / 10, 1, num2 - num));
			if (ec.Value(79) == num2)
			{
				owner.PlaySound("bike_kick");
			}
		}
	}

	public void OnHit()
	{
		ec.SetBase(79, ec.Value(79) / 2);
	}

	public override void SetOwner(Chara _owner, bool onDeserialize = false)
	{
		base.SetOwner(_owner);
		ec.SetParent(owner);
	}

	public override void OnRemoved()
	{
		ec.SetParent();
	}
}
```

:::
## ConTransmute

[`public class ConTransmute : BaseBuff`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ConTransmute.cs#L4-L9)
```cs:line-numbers=4

	public override bool ShouldRefresh => true;

	public override bool ShouldTryNullify => true; // [!code ++]
 // [!code ++]
	public override void Tick()
	{
		if (owner.host == null && owner.conSleep == null && (EClass.pc.conSleep == null || EClass.pc.conSleep.pcSleep == 0))
```

[`public override void OnRemoved()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/ConTransmute.cs#L29-L32)
```cs:line-numbers=29
			WidgetRoster.SetDirty();
		}
	}
 // [!code ++]
	public override bool TryNullify(Condition c) // [!code ++]
	{ // [!code ++]
		if (c != this && c is ConTransmute) // [!code ++]
		{ // [!code ++]
			owner.Say("nullify", owner, Name.ToLower(), c.Name.ToLower()); // [!code ++]
			return true; // [!code ++]
		} // [!code ++]
		return false; // [!code ++]
	} // [!code ++]
}
```

## +ConTransmuteMimic

::: details File Created
```cs
using System.Collections.Generic;
using Newtonsoft.Json;

public class ConTransmuteMimic : ConTransmute
{
	[JsonProperty]
	public Thing thing;

	public override bool HasDuration => false;

	public override RendererReplacer GetRendererReplacer()
	{
		if (thing.trait is TraitFigure traitFigure)
		{
			return RendererReplacer.CreateFrom(traitFigure.source.id);
		}
		return RendererReplacer.CreateFrom(thing.id, 0, thing.material.id);
	}

	public override void Tick()
	{
	}

	public override void OnBeforeStart()
	{
		List<Thing> list = owner.things.List((Thing t) => !t.IsMultisize && !t.isEquipped, onlyAccessible: true);
		if (list.Count > 0)
		{
			thing = list.RandomItem().Duplicate(1);
		}
		else if (EClass.rnd(3) == 0)
		{
			thing = ThingGen.Create("chest3", -1, EClass._zone.ContentLv);
			thing.ChangeMaterial(EClass._zone.biome.style.matDoor);
		}
		else
		{
			thing = ThingGen.CreateFromFilter("dungeon", EClass._zone.ContentLv).SetNum(1);
		}
		base.OnBeforeStart();
	}

	public override void SetOwner(Chara _owner, bool onDeserialize = false)
	{
		base.SetOwner(_owner);
		owner.mimicry = this;
	}

	public override void OnRemoved()
	{
		owner.mimicry = null;
		base.OnRemoved();
	}

	public virtual void TrySetAct(ActPlan p)
	{
		if (thing.IsContainer)
		{
			p.TrySetAct("actContainer", delegate
			{
				RevealMimicry(EClass.pc, surprise: true);
				return true;
			}, owner, CursorSystem.Container);
		}
	}

	public virtual void RevealMimicry(Chara c, bool surprise)
	{
		if (owner.IsHostile(c))
		{
			owner.DoHostileAction(c, immediate: true);
		}
		if (surprise)
		{
			owner.AddCondition<ConAmbush>();
		}
		Kill();
	}
}
```

:::
## FEAT

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/FEAT.cs#L33-L75)
```cs:line-numbers=33

	public const int featNegotiate = 1634;

	public const int featMagicManner = 1651; // [!code --]
 // [!code --]
	public const int featSpotting = 1633;

	public const int featEvade = 1632; // [!code ++]
 // [!code ++]
	public const int featDefense = 1631;

	public const int featHardy = 1630; // [!code --]
	public const int featLife = 1610; // [!code ++]

	public const int featSPD = 1629; // [!code --]
	public const int featMana = 1611; // [!code ++]

	public const int featLuck = 1628; // [!code --]
	public const int featStamina = 1612; // [!code ++]

	public const int featCHA = 1627; // [!code --]
	public const int featSTR = 1620; // [!code ++]

	public const int featWIL = 1626; // [!code --]
	public const int featDEX = 1621; // [!code ++]

	public const int featMAG = 1625; // [!code --]
	public const int featEND = 1622; // [!code ++]

	public const int featLER = 1624; // [!code --]
	public const int featMagicManner = 1651; // [!code ++]

	public const int featPER = 1623;

	public const int featEND = 1622; // [!code --]
	public const int featMAG = 1625; // [!code ++]

	public const int featDEX = 1621; // [!code --]
	public const int featWIL = 1626; // [!code ++]

	public const int featSTR = 1620; // [!code --]
	public const int featCHA = 1627; // [!code ++]

	public const int featStamina = 1612; // [!code --]
	public const int featLuck = 1628; // [!code ++]

	public const int featMana = 1611; // [!code --]
	public const int featSPD = 1629; // [!code ++]

	public const int featEvade = 1632; // [!code --]
	public const int featHardy = 1630; // [!code ++]

	public const int featRapidArrow = 1652; // [!code --]
	public const int featLER = 1624; // [!code ++]

	public const int featDreamWaker = 1653; // [!code --]
	public const int featPeaky = 1423; // [!code ++]
 // [!code ++]
	public const int featRapidArrow = 1652; // [!code ++]

	public const int featHeavyCasting = 1654;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/FEAT.cs#L119-L125)
```cs:line-numbers=119

	public const int featLooter = 1660;

	public const int featLife = 1610; // [!code --]
	public const int featDreamWaker = 1653; // [!code ++]

	public const int featDismantler = 1661;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/FEAT.cs#L277-L298)
```cs:line-numbers=277

	public const int featEarthStrength = 1411;

	public static readonly int[] IDS = new int[137] // [!code --]
	public static readonly int[] IDS = new int[138] // [!code ++]
	{
		1223, 1650, 1649, 1648, 1647, 1646, 1645, 1644, 1643, 1642,
		1641, 1640, 1636, 1635, 1634, 1651, 1633, 1631, 1630, 1629, // [!code --]
		1628, 1627, 1626, 1625, 1624, 1623, 1622, 1621, 1620, 1612, // [!code --]
		1611, 1632, 1652, 1653, 1654, 1222, 1200, 1201, 1202, 1203, // [!code --]
		1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211, 1212, 1213, // [!code --]
		1214, 1215, 1655, 1656, 1657, 1658, 1659, 1660, 1610, 1661, // [!code --]
		1221, 1220, 1219, 1218, 1217, 1216, 1662, 1422, 1750, 1420, // [!code --]
		1251, 1252, 1270, 1271, 1272, 1273, 1290, 1300, 1305, 1310, // [!code --]
		1315, 1320, 1330, 1335, 1340, 1345, 1350, 1355, 1400, 1401, // [!code --]
		1402, 1403, 1404, 1250, 1249, 1248, 1247, 1232, 1231, 1421, // [!code --]
		1230, 1229, 1228, 1227, 1226, 1225, 1224, 1233, 1405, 1234, // [!code --]
		1236, 1237, 1238, 1239, 1240, 1241, 1242, 1243, 1244, 1245, // [!code --]
		1246, 1235, 1406, 1325, 1408, 1419, 1418, 1417, 1416, 1415, // [!code --]
		1407, 1413, 1409, 1410, 1414, 1412, 1411 // [!code --]
		1641, 1640, 1636, 1635, 1634, 1633, 1632, 1631, 1610, 1611, // [!code ++]
		1612, 1620, 1621, 1622, 1651, 1623, 1625, 1626, 1627, 1628, // [!code ++]
		1629, 1630, 1624, 1423, 1652, 1654, 1222, 1200, 1201, 1202, // [!code ++]
		1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211, 1212, // [!code ++]
		1213, 1214, 1215, 1655, 1656, 1657, 1658, 1659, 1660, 1653, // [!code ++]
		1661, 1221, 1220, 1219, 1218, 1217, 1216, 1662, 1422, 1750, // [!code ++]
		1420, 1251, 1252, 1270, 1271, 1272, 1273, 1290, 1300, 1305, // [!code ++]
		1310, 1315, 1320, 1330, 1335, 1340, 1345, 1350, 1355, 1400, // [!code ++]
		1401, 1402, 1403, 1404, 1250, 1249, 1248, 1247, 1232, 1231, // [!code ++]
		1421, 1230, 1229, 1228, 1227, 1226, 1225, 1224, 1233, 1405, // [!code ++]
		1234, 1236, 1237, 1238, 1239, 1240, 1241, 1242, 1243, 1244, // [!code ++]
		1245, 1246, 1235, 1406, 1325, 1408, 1419, 1418, 1417, 1416, // [!code ++]
		1415, 1407, 1413, 1409, 1410, 1414, 1412, 1411 // [!code ++]
	};
}
public class Feat : Element
```

## GameUpdater

[`public override void FixedUpdate()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/GameUpdater.cs#L250-L257)
```cs:line-numbers=250
			return;
		}
		List<Chara> charas = EClass._map.charas;
		SetUpdatesPerFrame(charas.Count, 0.05f); // [!code --]
		float gameDelta = Core.gameDelta;
		EClass.player.renderExtraTime -= delta * EClass.scene.actionMode.gameSpeed; // [!code ++]
		if (EClass.player.renderExtraTime > 0f) // [!code ++]
		{ // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		SetUpdatesPerFrame(charas.Count, 0.05f); // [!code ++]
		for (int i = 0; i < charas.Count; i++)
		{
			Chara chara = charas[i];
```

## HotItemHeld

[`public bool TrySetToolAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/HotItemHeld.cs#L330-L336)
```cs:line-numbers=330
		Card tc = null;
		foreach (Chara item in pos.ListVisibleCharas())
		{
			if (item.isSynced && item.IsAliveInCurrentZone) // [!code --]
			if (item.isSynced && item.IsAliveInCurrentZone && item.mimicry == null) // [!code ++]
			{
				tc = item;
				break;
```

## HotItemNoItem

[`public static bool _TrySetAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/HotItemNoItem.cs#L16-L21)
```cs:line-numbers=16
	Card tg = null;
	p.pos.ListVisibleCards().ForeachReverse(delegate(Card a)
	{
		if (a.isChara && a.Chara.mimicry != null) // [!code ++]
		{ // [!code ++]
			tg = a; // [!code ++]
			return true; // [!code ++]
		} // [!code ++]
		if (a.TileType.CanBeHeld && a.trait.CanBeHeld && a.isThing && !a.isNPCProperty && a.isThing && a.TileType.CanBeHeld)
		{
			tg = a;
```

[`public static bool _TrySetAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/HotItemNoItem.cs#L29-L34)
```cs:line-numbers=29
		{
			if (tg.ExistsOnMap)
			{
				if (tg.isChara && tg.Chara.mimicry != null) // [!code ++]
				{ // [!code ++]
					tg.Chara.mimicry.RevealMimicry(EClass.pc, surprise: true); // [!code ++]
					return true; // [!code ++]
				} // [!code ++]
				if (!EClass.pc.CanLift(tg))
				{
					EClass.pc.Say("tooHeavy", tg);
```

## Player

[`public void OnLeaveZone()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Player.cs#L1200-L1205)
```cs:line-numbers=1200

	public float pickupDelay = 2f;

	public float renderExtraTime; // [!code ++]
 // [!code ++]
	public Chara chara;

	public Chara focusedchara;
```

## Religion

[`public bool TryGetGift()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Religion.cs#L252-L277)
```cs:line-numbers=252
		return false;
	}

	public bool IsValidArtifact(string id) // [!code --]
	public static Religion GetArtifactDeity(string id) // [!code ++]
	{
		return id switch
		{
			"gun_mani" => this == EClass.game.religions.Machine,  // [!code --]
			"cloak_mani" => this == EClass.game.religions.Machine,  // [!code --]
			"scythe_kumi" => this == EClass.game.religions.Harvest,  // [!code --]
			"blunt_earth" => this == EClass.game.religions.Earth,  // [!code --]
			"luckydagger" => this == EClass.game.religions.Luck,  // [!code --]
			"staff_element" => this == EClass.game.religions.Element,  // [!code --]
			"windbow" => this == EClass.game.religions.Wind,  // [!code --]
			"shirt_wind" => this == EClass.game.religions.Wind,  // [!code --]
			"pole_holy" => this == EClass.game.religions.Healing,  // [!code --]
			"sword_muramasa2" => this == EClass.game.religions.MoonShadow,  // [!code --]
			"kogitsunemaru" => this == EClass.game.religions.Trickery,  // [!code --]
			"warmonger" => this == EClass.game.religions.Strife,  // [!code --]
			_ => false,  // [!code --]
			"gun_mani" => EClass.game.religions.Machine,  // [!code ++]
			"cloak_mani" => EClass.game.religions.Machine,  // [!code ++]
			"scythe_kumi" => EClass.game.religions.Harvest,  // [!code ++]
			"blunt_earth" => EClass.game.religions.Earth,  // [!code ++]
			"luckydagger" => EClass.game.religions.Luck,  // [!code ++]
			"staff_element" => EClass.game.religions.Element,  // [!code ++]
			"windbow" => EClass.game.religions.Wind,  // [!code ++]
			"shirt_wind" => EClass.game.religions.Wind,  // [!code ++]
			"pole_holy" => EClass.game.religions.Healing,  // [!code ++]
			"sword_muramasa2" => EClass.game.religions.MoonShadow,  // [!code ++]
			"kogitsunemaru" => EClass.game.religions.Trickery,  // [!code ++]
			"warmonger" => EClass.game.religions.Strife,  // [!code ++]
			_ => null,  // [!code ++]
		};
	}

	public bool IsValidArtifact(string id) // [!code ++]
	{ // [!code ++]
		return this == GetArtifactDeity(id); // [!code ++]
	} // [!code ++]
 // [!code ++]
	public static Thing Reforge(string id, Point pos = null, bool first = true)
	{
		if (pos == null)
```

## RendererReplacer

[`public class RendererReplacer : EClass`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/RendererReplacer.cs#L2-L19)
```cs:line-numbers=2
{
	public int tile = 1820;

	public int mat = -1; // [!code ++]
 // [!code ++]
	public RenderData data;

	public SourcePref pref;

	public static RendererReplacer CreateFrom(string id, int shift = 0) // [!code --]
	public static RendererReplacer CreateFrom(string id, int shift = 0, int mat = -1) // [!code ++]
	{
		CardRow cardRow = EClass.sources.cards.map[id];
		return new RendererReplacer
		{
			tile = cardRow._tiles[0] + shift,
			data = cardRow.renderData,
			pref = cardRow.pref // [!code --]
			pref = cardRow.pref, // [!code ++]
			mat = mat // [!code ++]
		};
	}
}
```

## SLOT

[`public class SLOT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SLOT.cs#L24-L40)
```cs:line-numbers=24

	public const int neck = 31;

	public const int head = 30; // [!code ++]
 // [!code ++]
	public const int finger = 36;

	public const int token = 43;

	public const int range = 41;

	public const int head = 30; // [!code --]
 // [!code --]
	public static readonly int[] IDS = new int[16]
	{
		44, 32, 45, 39, 38, 42, 34, 37, 35, 40,
		33, 31, 36, 43, 41, 30 // [!code --]
		33, 31, 30, 36, 43, 41 // [!code ++]
	};
}
```

## SPELL

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L1-L42)
```cs:line-numbers=1
public class SPELL
{
	public const int puddle_Nerve = 50908; // [!code --]
	public const int ball_Nerve = 50108; // [!code ++]

	public const int weapon_Nerve = 50808; // [!code --]
	public const int puddle_Mind = 50904; // [!code ++]

	public const int miasma_Nerve = 50708; // [!code --]
	public const int bolt_Nerve = 50308; // [!code ++]

	public const int funnel_Nerve = 50608; // [!code --]
	public const int weapon_Mind = 50804; // [!code ++]

	public const int sword_Nerve = 51008; // [!code --]
	public const int hand_Nerve = 50408; // [!code ++]

	public const int miasma_Poison = 50705; // [!code --]
	public const int bit_Nerve = 51108; // [!code ++]

	public const int puddle_Mind = 50904; // [!code --]
	public const int bit_Sound = 51107; // [!code ++]

	public const int hand_Nerve = 50408; // [!code --]
	public const int funnel_Nerve = 50608; // [!code ++]

	public const int bolt_Nerve = 50308; // [!code --]
	public const int miasma_Nerve = 50708; // [!code ++]

	public const int sword_Mind = 51004; // [!code --]
	public const int weapon_Nerve = 50808; // [!code ++]

	public const int ball_Nerve = 50108; // [!code --]
	public const int puddle_Nerve = 50908; // [!code ++]
 // [!code ++]
	public const int sword_Nerve = 51008; // [!code ++]

	public const int flare_Sound = 51207;

	public const int arrow_Nerve = 50508;

	public const int bit_Nerve = 51108; // [!code --]
 // [!code --]
	public const int flare_Nerve = 51208;

	public const int ball_Holy = 50109;

	public const int weapon_Mind = 50804; // [!code --]
	public const int miasma_Mind = 50704; // [!code ++]

	public const int bolt_Holy = 50309; // [!code --]
	public const int funnel_Mind = 50604; // [!code ++]

	public const int miasma_Mind = 50704; // [!code --]
	public const int bolt_Holy = 50309; // [!code ++]

	public const int hand_Holy = 50409;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L44-L52)
```cs:line-numbers=44

	public const int funnel_Holy = 50609;

	public const int miasma_Holy = 50709; // [!code --]
	public const int arrow_Mind = 50504; // [!code ++]

	public const int funnel_Mind = 50604; // [!code --]
	public const int miasma_Holy = 50709; // [!code ++]

	public const int weapon_Holy = 50809;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L58-L70)
```cs:line-numbers=58

	public const int flare_Holy = 51209;

	public const int bit_Sound = 51107; // [!code --]
 // [!code --]
	public const int sword_Sound = 51007;

	public const int puddle_Sound = 50907; // [!code ++]
 // [!code ++]
	public const int weapon_Sound = 50807;

	public const int funnel_Poison = 50605; // [!code --]
	public const int miasma_Sound = 50707; // [!code ++]
 // [!code ++]
	public const int miasma_Poison = 50705; // [!code ++]

	public const int weapon_Poison = 50805;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L72-L88)
```cs:line-numbers=72

	public const int sword_Poison = 51005;

	public const int bit_Poison = 51105; // [!code --]
	public const int hand_Poison = 50405; // [!code ++]

	public const int arrow_Poison = 50505; // [!code --]
	public const int bit_Poison = 51105; // [!code ++]

	public const int flare_Poison = 51205;

	public const int ball_Nether = 50106;

	public const int bolt_Nether = 50306; // [!code --]
	public const int bolt_Poison = 50305; // [!code ++]

	public const int hand_Poison = 50405; // [!code --]
	public const int bolt_Nether = 50306; // [!code ++]

	public const int hand_Nether = 50406;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L92-L112)
```cs:line-numbers=92

	public const int miasma_Nether = 50706;

	public const int puddle_Sound = 50907; // [!code --]
 // [!code --]
	public const int weapon_Nether = 50806;

	public const int bolt_Poison = 50305; // [!code --]
	public const int puddle_Nether = 50906; // [!code ++]

	public const int sword_Nether = 51006;

	public const int ball_Poison = 50105; // [!code ++]
 // [!code ++]
	public const int bit_Nether = 51106;

	public const int flare_Nether = 51206;

	public const int ball_Chaos = 50110; // [!code ++]
 // [!code ++]
	public const int ball_Sound = 50107;

	public const int ball_Chaos = 50110; // [!code --]
	public const int flare_Mind = 51204; // [!code ++]

	public const int bolt_Sound = 50307;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L114-L130)
```cs:line-numbers=114

	public const int arrow_Sound = 50507;

	public const int funnel_Sound = 50607; // [!code --]
 // [!code --]
	public const int flare_Mind = 51204; // [!code --]
 // [!code --]
	public const int bit_Mind = 51104;

	public const int miasma_Sound = 50707; // [!code --]
	public const int sword_Mind = 51004; // [!code ++]

	public const int puddle_Nether = 50906; // [!code --]
	public const int funnel_Sound = 50607; // [!code ++]

	public const int ball_Poison = 50105; // [!code --]
	public const int arrow_Poison = 50505; // [!code ++]
 // [!code ++]
	public const int funnel_Poison = 50605; // [!code ++]

	public const int ball_Acid = 50113;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L274-L284)
```cs:line-numbers=274

	public const int bit_Magic = 51111;

	public const int arrow_Mind = 50504; // [!code --]
	public const int hand_Mind = 50404; // [!code ++]

	public const int arrow_Cold = 50501;

	public const int bolt_Mind = 50304; // [!code --]
	public const int ball_Mind = 50104; // [!code ++]

	public const int SpHero = 8504;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L426-L439)
```cs:line-numbers=426

	public const int SpIdentifyG = 8232;

	public const int SpTransmuteMimic = 8794; // [!code ++]
 // [!code ++]
	public const int SpDarkness = 8800;

	public const int SpWeb = 8801;

	public const int SpSummon = 9000; // [!code --]
 // [!code --]
	public const int arrow_Lightning = 50502; // [!code --]
 // [!code --]
	public const int hand_Lightning = 50402;

	public const int bolt_Lightning = 50302;
```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L462-L476)
```cs:line-numbers=462

	public const int flare_Fire = 51200;

	public const int funnel_Lightning = 50602; // [!code --]
 // [!code --]
	public const int bit_Fire = 51100;

	public const int miasma_Lightning = 50702; // [!code --]
	public const int arrow_Lightning = 50502; // [!code ++]

	public const int puddle_Lightning = 50902; // [!code --]
	public const int sword_Fire = 51000; // [!code ++]

	public const int ball_Mind = 50104; // [!code --]
	public const int funnel_Lightning = 50602; // [!code ++]
 // [!code ++]
	public const int weapon_Lightning = 50802; // [!code ++]

	public const int flare_Darkness = 51203;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L500-L514)
```cs:line-numbers=500

	public const int sword_Lightning = 51002;

	public const int weapon_Lightning = 50802; // [!code --]
	public const int puddle_Lightning = 50902; // [!code ++]

	public const int sword_Fire = 51000; // [!code --]
	public const int miasma_Lightning = 50702; // [!code ++]

	public const int puddle_Fire = 50900;

	public const int weapon_Fire = 50800;

	public const int SpSummonDragon = 9054; // [!code --]
	public const int miasma_Fire = 50700; // [!code ++]

	public const int SpSummonMachine = 9053;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L538-L553)
```cs:line-numbers=538

	public const int SpSummonUndeadSister = 9001;

	public const int SpSummon = 9000; // [!code ++]
 // [!code ++]
	public const int SpSummonDragon = 9054; // [!code ++]
 // [!code ++]
	public const int SpSummonUndead = 9055;

	public const int SpMeteor = 9150;

	public const int SpEarthquake = 9151;

	public const int SpMoonSpear = 9155; // [!code --]
 // [!code --]
	public const int miasma_Fire = 50700; // [!code --]
 // [!code --]
	public const int funnel_Fire = 50600;

	public const int arrow_Fire = 50500;
```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L560-L570)
```cs:line-numbers=560

	public const int ball_Fire = 50100;

	public const int hand_Mind = 50404; // [!code --]
 // [!code --]
	public const int FieldSpider = 10000;

	public const int SpDrawMetal = 9502; // [!code --]
	public const int bolt_Mind = 50304; // [!code ++]
 // [!code ++]
	public const int SpDrawBacker = 9503; // [!code ++]

	public const int SpDrawMonster = 9501;

```

[`public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/SPELL.cs#L578-L619)
```cs:line-numbers=578

	public const int SpMoonArrow = 9156;

	public const int SpDrawBacker = 9503; // [!code --]
	public const int SpMoonSpear = 9155; // [!code ++]
 // [!code ++]
	public const int SpDrawMetal = 9502; // [!code ++]

	public const int flare_Void = 51216;

	public static readonly int[] IDS = new int[291] // [!code --]
	public static readonly int[] IDS = new int[292] // [!code ++]
	{
		50908, 50808, 50708, 50608, 51008, 50705, 50904, 50408, 50308, 51004, // [!code --]
		50108, 51207, 50508, 51108, 51208, 50109, 50804, 50309, 50704, 50409, // [!code --]
		50509, 50609, 50709, 50604, 50809, 50909, 51009, 51109, 51209, 51107, // [!code --]
		51007, 50807, 50605, 50805, 50905, 51005, 51105, 50505, 51205, 50106, // [!code --]
		50306, 50405, 50406, 50506, 50606, 50706, 50907, 50806, 50305, 51006, // [!code --]
		51106, 51206, 50107, 50110, 50307, 50407, 50507, 50607, 51204, 51104, // [!code --]
		50707, 50906, 50105, 50113, 50410, 50115, 51214, 51114, 51014, 50914, // [!code --]
		50814, 50315, 50714, 50514, 50414, 50314, 50114, 51213, 51113, 50614, // [!code --]
		50415, 50515, 50615, 51016, 50916, 50816, 50716, 50616, 50516, 50416, // [!code --]
		50316, 50116, 51215, 51115, 51015, 50915, 50815, 50715, 51013, 50913, // [!code --]
		50813, 50713, 50811, 50711, 50611, 50511, 50411, 50311, 50111, 51210, // [!code --]
		51110, 51010, 50910, 50810, 50710, 50610, 50510, 50911, 50310, 51011, // [!code --]
		51211, 50613, 50513, 50413, 50313, 51212, 51112, 51012, 50912, 50812, // [!code --]
		50712, 50612, 50512, 50412, 50312, 50112, 51111, 50504, 50501, 50304, // [!code --]
		8504, 8503, 8502, 8501, 8500, 8491, 8490, 8480, 8471, 8470, // [!code --]
		8450, 8430, 8406, 8405, 8404, 8506, 8403, 8507, 8550, 8791, // [!code --]
		8790, 8780, 8776, 8775, 8770, 8710, 8708, 8707, 8706, 8705, // [!code --]
		8704, 8702, 8700, 8555, 8510, 8792, 8402, 8400, 8220, 8202, // [!code --]
		8201, 8200, 7800, 7010, 7009, 7008, 7007, 7006, 7005, 7004, // [!code --]
		7003, 7002, 7001, 8221, 8401, 8230, 8240, 8390, 8380, 8300, // [!code --]
		8288, 8286, 8285, 8284, 8281, 8280, 8260, 8256, 8255, 8251, // [!code --]
		8250, 8241, 8232, 8800, 8801, 9000, 50502, 50402, 50302, 50102, // [!code --]
		50108, 50904, 50308, 50804, 50408, 51108, 51107, 50608, 50708, 50808, // [!code ++]
		50908, 51008, 51207, 50508, 51208, 50109, 50704, 50604, 50309, 50409, // [!code ++]
		50509, 50609, 50504, 50709, 50809, 50909, 51009, 51109, 51209, 51007, // [!code ++]
		50907, 50807, 50707, 50705, 50805, 50905, 51005, 50405, 51105, 51205, // [!code ++]
		50106, 50305, 50306, 50406, 50506, 50606, 50706, 50806, 50906, 51006, // [!code ++]
		50105, 51106, 51206, 50110, 50107, 51204, 50307, 50407, 50507, 51104, // [!code ++]
		51004, 50607, 50505, 50605, 50113, 50410, 50115, 51214, 51114, 51014, // [!code ++]
		50914, 50814, 50315, 50714, 50514, 50414, 50314, 50114, 51213, 51113, // [!code ++]
		50614, 50415, 50515, 50615, 51016, 50916, 50816, 50716, 50616, 50516, // [!code ++]
		50416, 50316, 50116, 51215, 51115, 51015, 50915, 50815, 50715, 51013, // [!code ++]
		50913, 50813, 50713, 50811, 50711, 50611, 50511, 50411, 50311, 50111, // [!code ++]
		51210, 51110, 51010, 50910, 50810, 50710, 50610, 50510, 50911, 50310, // [!code ++]
		51011, 51211, 50613, 50513, 50413, 50313, 51212, 51112, 51012, 50912, // [!code ++]
		50812, 50712, 50612, 50512, 50412, 50312, 50112, 51111, 50404, 50501, // [!code ++]
		50104, 8504, 8503, 8502, 8501, 8500, 8491, 8490, 8480, 8471, // [!code ++]
		8470, 8450, 8430, 8406, 8405, 8404, 8506, 8403, 8507, 8550, // [!code ++]
		8791, 8790, 8780, 8776, 8775, 8770, 8710, 8708, 8707, 8706, // [!code ++]
		8705, 8704, 8702, 8700, 8555, 8510, 8792, 8402, 8400, 8220, // [!code ++]
		8202, 8201, 8200, 7800, 7010, 7009, 7008, 7007, 7006, 7005, // [!code ++]
		7004, 7003, 7002, 7001, 8221, 8401, 8230, 8240, 8390, 8380, // [!code ++]
		8300, 8288, 8286, 8285, 8284, 8281, 8280, 8260, 8256, 8255, // [!code ++]
		8251, 8250, 8241, 8232, 8794, 8800, 8801, 50402, 50302, 50102, // [!code ++]
		51201, 51101, 51001, 50901, 50801, 50701, 50601, 50401, 50301, 50101,
		51200, 50602, 51100, 50702, 50902, 50104, 51203, 51103, 51003, 50903, // [!code --]
		51200, 51100, 50502, 51000, 50602, 50802, 51203, 51103, 51003, 50903, // [!code ++]
		50803, 50703, 50603, 50503, 50403, 50303, 50103, 51202, 51102, 51002,
		50802, 51000, 50900, 50800, 9054, 9053, 9052, 9051, 9050, 9010, // [!code --]
		9009, 9008, 9007, 9006, 9005, 9004, 9003, 9002, 9001, 9055, // [!code --]
		9150, 9151, 9155, 50700, 50600, 50500, 50400, 50300, 51116, 50100, // [!code --]
		50404, 10000, 9502, 9501, 9500, 9210, 9200, 9160, 9156, 9503, // [!code --]
		51216 // [!code --]
		50902, 50702, 50900, 50800, 50700, 9053, 9052, 9051, 9050, 9010, // [!code ++]
		9009, 9008, 9007, 9006, 9005, 9004, 9003, 9002, 9001, 9000, // [!code ++]
		9054, 9055, 9150, 9151, 50600, 50500, 50400, 50300, 51116, 50100, // [!code ++]
		10000, 50304, 9503, 9501, 9500, 9210, 9200, 9160, 9156, 9155, // [!code ++]
		9502, 51216 // [!code ++]
	};
}
public class Spell : Ability
```

## Thing

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Thing.cs#L925-L931)
```cs:line-numbers=925
			SetImage(uIItem.image2);
			uIItem.image2.Rect().pivot = new Vector2(0.5f, 0.5f);
			string text5 = base.Num.ToFormat() ?? "";
			string text6 = (Mathf.Ceil(0.01f * (float)base.ChildrenAndSelfWeight) * 0.1f).ToString("F1") + "s"; // [!code --]
			string text6 = (0.01f * (float)base.ChildrenAndSelfWeight * 0.1f).ToString((base.ChildrenAndSelfWeight == 0) ? "F0" : ((base.ChildrenAndSelfWeight >= 1000) ? "F1" : "F2")) + "s"; // [!code ++]
			if (things.Count > 0)
			{
				text5 = text5 + " (" + things.Count + ")";
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Thing.cs#L935-L940)
```cs:line-numbers=935
				text6 = text6 + " (" + (Mathf.Ceil(0.01f * (float)SelfWeight) * 0.1f).ToString("F1") + "s)";
			}
			text3 = "_quantity".lang(text5 ?? "", text6);
			if (EClass.debug.showExtra) // [!code ++]
			{ // [!code ++]
				text3 = text3 + "(" + base.ChildrenAndSelfWeight + ")"; // [!code ++]
			} // [!code ++]
			if (flag && recipe != null && (bool)LayerCraft.Instance)
			{
				text3 = text3 + "  " + "_recipe_lv".lang(recipe.RecipeLv.ToString() ?? "");
```

## Trait

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Trait.cs#L1961-L1966)
```cs:line-numbers=1961
				{
					t.AddThing(ThingGen.Create("letter_trial"));
				}
				AddThing(ThingGen.CreateScroll(8220, 4 + EClass.rnd(6))); // [!code ++]
				AddThing(ThingGen.CreateScroll(8221, 4 + EClass.rnd(6))); // [!code ++]
				AddThing(ThingGen.CreateScroll(8200, 4 + EClass.rnd(6))); // [!code ++]
				AddThing(ThingGen.CreateScroll(8201, 4 + EClass.rnd(6))); // [!code ++]
				break;
			case ShopType.Festival:
				if (EClass._zone.IsFestival)
```

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Trait.cs#L2033-L2038)
```cs:line-numbers=2033
				AddThing(ThingGen.CreateSpellbook(8790));
				AddThing(ThingGen.CreatePotion(8791).SetNum(3 + EClass.rnd(3)));
				AddThing(ThingGen.CreatePotion(8792).SetNum(3 + EClass.rnd(3)));
				AddThing(ThingGen.CreatePotion(8794).SetNum(3 + EClass.rnd(3))); // [!code ++]
				break;
			case "girl_blue":
				Add("779", 1 + EClass.rnd(3), 0);
```

## Zone

[`public Chara SpawnMob(Point pos = null, SpawnSetting setting = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/3d1e3facb31cf62b4bdd66af5ddf926f2e1379f0/Elin/Zone.cs#L2851-L2857)
```cs:line-numbers=2851
		switch (chara.id)
		{
		case "unicorn":
			if (EClass.pc.HasElement(1216)) // [!code --]
			if (EClass.pc.HasElement(1216) && EClass.pc.Evalue(418) < 1) // [!code ++]
			{
				chara.SetHostility(Hostility.Enemy);
			}
```

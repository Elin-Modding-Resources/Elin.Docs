---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 9 files modified.
version: EA 23.205 Nightly
changes: AI_Idle/ActMelee/ActRush/Biography/Card/Player/Thing/Trait/Zone
---

# EA 23.205 Nightly

September 25, 2025

9 files modified.

## Important Changes

**None.**
## AI_Idle

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/AI_Idle.cs#L169-L175)
```cs:line-numbers=169
					{
						continue;
					}
					for (int i = 0; i < 5; i++) // [!code --]
					for (int j = 0; j < 5; j++) // [!code ++]
					{
						if (thing8.encLV >= 0)
						{
```

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/AI_Idle.cs#L378-L401)
```cs:line-numbers=378
	{
		owner.TryAssignBed();
	}
	if (owner.id == "geist" && EClass.rnd(20) == 0) // [!code --]
	string text; // [!code ++]
	if (!EClass._zone.IsRegion) // [!code ++]
	{
		Point nearestPoint = EClass.pc.pos.GetNearestPoint(allowBlock: false, allowChara: false); // [!code --]
		if (nearestPoint != null) // [!code --]
		text = owner.id; // [!code ++]
		if (!(text == "geist")) // [!code ++]
		{
			foreach (Chara item3 in nearestPoint.ListCharasInRadius(owner, 6, (Chara _c) => _c != owner && !_c.IsPCFactionOrMinion)) // [!code --]
			if (text == "mech_scarab" && EClass.rnd(20) == 0) // [!code ++]
			{
				item3.Teleport(nearestPoint.GetNearestPoint(allowBlock: false, allowChara: false) ?? nearestPoint); // [!code --]
				int i = 0; // [!code ++]
				owner.pos.ForeachNeighbor(delegate(Point p) // [!code ++]
				{ // [!code ++]
					if (p.HasChara && p.FirstChara.id == "mech_scarab") // [!code ++]
					{ // [!code ++]
						i++; // [!code ++]
					} // [!code ++]
				}); // [!code ++]
				if (i <= 2) // [!code ++]
				{ // [!code ++]
					EClass._zone.AddCard(owner.Duplicate(), owner.pos.GetNearestPoint(allowBlock: false, allowChara: false)); // [!code ++]
				} // [!code ++]
			}
			if (owner != null) // [!code --]
		} // [!code ++]
		else if (EClass.rnd(20) == 0) // [!code ++]
		{ // [!code ++]
			Point nearestPoint = EClass.pc.pos.GetNearestPoint(allowBlock: false, allowChara: false); // [!code ++]
			if (nearestPoint != null) // [!code ++]
			{
				if (!owner.IsPCFactionOrMinion) // [!code --]
				foreach (Chara item3 in nearestPoint.ListCharasInRadius(owner, 6, (Chara _c) => _c != owner && !_c.IsPCFactionOrMinion)) // [!code ++]
				{ // [!code ++]
					item3.Teleport(nearestPoint.GetNearestPoint(allowBlock: false, allowChara: false) ?? nearestPoint); // [!code ++]
				} // [!code ++]
				if (owner != null) // [!code ++]
				{
					EClass.pc.ai.Cancel(); // [!code --]
					if (!owner.IsPCFactionOrMinion) // [!code ++]
					{ // [!code ++]
						EClass.pc.ai.Cancel(); // [!code ++]
					} // [!code ++]
					owner.Teleport(nearestPoint); // [!code ++]
				}
				owner.Teleport(nearestPoint); // [!code --]
				yield return Success(); // [!code ++]
			}
			yield return Success(); // [!code --]
		}
	}
	if (EClass._zone.IsPCFaction)
```

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/AI_Idle.cs#L438-L447)
```cs:line-numbers=438
			else if (EClass.rnd(15) == 0 && EClass._zone.IsTown && owner.hostility >= Hostility.Neutral && !owner.IsPCFaction && !EClass.pc.HasCondition<ConIncognito>())
			{
				bool flag4 = EClass._zone is Zone_Derphy;
				string text = ((EClass.player.karma > 10) ? ((EClass.player.karma < 90) ? "" : (flag4 ? "rumor_bad" : "rumor_good")) : (flag4 ? "rumor_good" : "rumor_bad")); // [!code --]
				if (!text.IsEmpty()) // [!code --]
				string text2 = ((EClass.player.karma > 10) ? ((EClass.player.karma < 90) ? "" : (flag4 ? "rumor_bad" : "rumor_good")) : (flag4 ? "rumor_good" : "rumor_bad")); // [!code ++]
				if (!text2.IsEmpty()) // [!code ++]
				{
					owner.Talk(text); // [!code --]
					owner.Talk(text2); // [!code ++]
				}
				if ((flag4 ? (EClass.player.karma >= 90) : (EClass.player.karma <= 10)) && EClass.rnd(10) == 0)
				{
```

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/AI_Idle.cs#L837-L843)
```cs:line-numbers=837
	}
	if (EClass.rnd(10) == 0 && !EClass._zone.IsUnderwater && (owner.race.tag.Contains("water") || owner.source.tag.Contains("water")) && !owner.pos.IsDeepWater)
	{
		for (int j = 0; j < 100; j++) // [!code --]
		for (int k = 0; k < 100; k++) // [!code ++]
		{
			Point randomPoint = EClass._map.GetRandomPoint();
			if (randomPoint.IsDeepWater && !randomPoint.IsBlocked)
```

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/AI_Idle.cs#L847-L854)
```cs:line-numbers=847
			}
		}
	}
	string aiIdle = owner.source.aiIdle; // [!code --]
	if (!(aiIdle == "stand") && !(aiIdle == "root")) // [!code --]
	text = owner.source.aiIdle; // [!code ++]
	if (!(text == "stand") && !(text == "root")) // [!code ++]
	{
		if (EClass.rnd(15) == 0)
		{
```

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/AI_Idle.cs#L870-L878)
```cs:line-numbers=870
	yield return Restart();
	Point FindMovePoint(BaseArea.AccessType type)
	{
		for (int k = 0; k < 20; k++) // [!code --]
		for (int l = 0; l < 20; l++) // [!code ++]
		{
			Point randomPoint2 = owner.pos.GetRandomPoint(5 + k, requireLos: false); // [!code --]
			Point randomPoint2 = owner.pos.GetRandomPoint(5 + l, requireLos: false); // [!code ++]
			if (randomPoint2 != null && randomPoint2.IsInBounds && (randomPoint2.cell.room == null || randomPoint2.cell.room.data.accessType == type))
			{
				return randomPoint2;
```

## ActMelee

[`public bool Attack(float dmgMulti = 1f)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/ActMelee.cs#L161-L167)
```cs:line-numbers=161
	{
		Act.CC.RemoveCondition<ConInvisibility>();
	}
	if (orgTC.isChara && orgTC.ExistsOnMap && orgTC != cC && !orgTC.IsRestrainedResident && !orgTC.IsDisabled && ACT.Melee.CanPerform(orgTC.Chara, cC)) // [!code --]
	if (orgTC.isChara && orgTC.ExistsOnMap && orgTC != cC && !orgTC.IsRestrainedResident && !orgTC.IsDisabled && ACT.Melee.CanPerform(orgTC.Chara, cC) && (!orgTC.IsPCFactionOrMinion || !EClass._zone.isPeace)) // [!code ++]
	{
		if (parried)
		{
```

## ActRush

[`public override bool CanPerform()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/ActRush.cs#L38-L44)
```cs:line-numbers=38
		return false;
	}
	Act.TP.Set(flag ? EClass.scene.mouseTarget.pos : Act.TC.pos);
	if (Act.CC.isRestrained) // [!code --]
	if (Act.CC.isRestrained || Act.CC.HasCondition<ConEntangle>()) // [!code ++]
	{
		return false;
	}
```

## Biography

[`public int GetAge(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Biography.cs#L287-L295)
```cs:line-numbers=287
			return int.Parse(array[1]);
		}
	}
	if (!c.IsPC && EClass.game.principal.noAging) // [!code --]
	if (!c.IsPC && EClass.game.principal.noAging && EClass.world.date.year - birthYear >= 13) // [!code ++]
	{
		return EClass.game.Prologue.year - birthYear; // [!code --]
		return (int)MathF.Max(EClass.game.Prologue.year - birthYear, 13f); // [!code ++]
	}
	return EClass.world.date.year - birthYear;
}
```

## Card

[`public virtual int GetPrice(CurrencyType currency = CurrencyType.Money, bool sel`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Card.cs#L7075-L7082)
```cs:line-numbers=7075
		switch (currency)
		{
		case CurrencyType.Influence:
			if (id == "lunch_love") // [!code --]
			switch (id) // [!code ++]
			{
			case "ticket_fortune": // [!code ++]
				return 5; // [!code ++]
			case "medal": // [!code ++]
				return 5; // [!code ++]
			case "lunch_love": // [!code ++]
				return 10;
			}
			break;
```

## Player

[`public void OnEnterZone()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Player.cs#L825-L835)
```cs:line-numbers=825
				PlayStory(availableStories[0]);
				availableStories.RemoveAt(0);
			}
			if (!LayerDrama.Instance && !EClass.game.isLoading && EClass.debug.enable && EClass._zone.IsPCFaction && EClass.game.quests.GetPhase<QuestIntoDarkness>() == 0 && EClass.game.quests.GetPhase<QuestNegotiationDarkness>() == 5) // [!code --]
			if (!LayerDrama.Instance && !EClass.game.isLoading && EClass._zone.IsPCFaction) // [!code ++]
			{
				EClass.game.cards.globalCharas.Find("kettle"); // [!code --]
				EClass.game.quests.Get<QuestNegotiationDarkness>().Complete(); // [!code --]
				EClass.game.quests.Get<QuestIntoDarkness>().UpdateOnTalk(); // [!code --]
				if (EClass.game.quests.GetPhase<QuestIntoDarkness>() == 0 && EClass.game.quests.GetPhase<QuestNegotiationDarkness>() == 5) // [!code ++]
				{ // [!code ++]
					EClass.game.quests.Get<QuestNegotiationDarkness>().Complete(); // [!code ++]
					EClass.game.quests.Get<QuestIntoDarkness>().UpdateOnTalk(); // [!code ++]
				} // [!code ++]
				else if (EClass.game.quests.GetPhase<QuestIntoDarkness>() == 1) // [!code ++]
				{ // [!code ++]
					EClass.game.quests.Get<QuestIntoDarkness>().UpdateOnTalk(); // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					EClass.game.quests.GetPhase<QuestIntoDarkness>(); // [!code ++]
					_ = 2; // [!code ++]
				} // [!code ++]
			}
		}

```

## Thing

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Thing.cs#L1281-L1287)
```cs:line-numbers=1281
					return s;
				}
				int num4 = e.Value;
				if (e.source.IsWeaponEnc && !e.source.tag.Contains("modRanged") && isEquipped && root.isChara) // [!code --]
				if (e.source.IsWeaponEnc && (!e.source.tag.Contains("modRanged") || e.id == 609) && isEquipped && root.isChara) // [!code ++]
				{
					num4 = num4 * (100 + AttackProcess.GetTwoHandEncBonus(root.Chara)) / 100;
				}
```

## Trait

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1531-L1537)
```cs:line-numbers=1531
		{
			break;
		}
		int num4 = 0; // [!code --]
		int num5 = 0; // [!code ++]
		foreach (Thing thing10 in c_copyContainer.things)
		{
			if (!owner.trait.CanCopy(thing10))
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1546-L1563)
```cs:line-numbers=1546
			{
				thing5.elements.Remove(item.id);
			}
			int num5 = 1; // [!code --]
			int num6 = 1; // [!code ++]
			switch (owner.trait.CopyShop)
			{
			case CopyShopType.Item:
			{
				num5 = (1000 + owner.c_invest * 100) / (thing5.GetPrice(CurrencyType.Money, sell: false, PriceType.CopyShop) + 50); // [!code --]
				num6 = (1000 + owner.c_invest * 100) / (thing5.GetPrice(CurrencyType.Money, sell: false, PriceType.CopyShop) + 50); // [!code ++]
				int[] array = new int[4] { 701, 704, 703, 702 };
				foreach (int ele in array)
				{
					if (thing5.HasElement(ele))
					{
						num5 = 1; // [!code --]
						num6 = 1; // [!code ++]
					}
				}
				break;
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1566-L1578)
```cs:line-numbers=1566
				thing5.c_charges = thing10.c_charges;
				break;
			}
			if (num5 > 1 && thing5.trait.CanStack) // [!code --]
			if (num6 > 1 && thing5.trait.CanStack) // [!code ++]
			{
				thing5.SetNum(num5); // [!code --]
				thing5.SetNum(num6); // [!code ++]
			}
			AddThing(thing5);
			num4++; // [!code --]
			if (num4 > owner.trait.NumCopyItem) // [!code --]
			num5++; // [!code ++]
			if (num5 > owner.trait.NumCopyItem) // [!code ++]
			{
				break;
			}
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1608-L1614)
```cs:line-numbers=1608
		break;
	case ShopType.RedBook:
	{
		for (int num3 = 0; num3 < 30; num3++) // [!code --]
		for (int num4 = 0; num4 < 30; num4++) // [!code ++]
		{
			AddThing(ThingGen.CreateFromCategory((EClass.rnd(2) == 0) ? "_book" : "book"));
		}
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1621-L1631)
```cs:line-numbers=1621
		AddThing(TraitSeed.MakeSeed("carrot")).SetNum(4 + EClass.rnd(4));
		AddThing(TraitSeed.MakeSeed("potato")).SetNum(4 + EClass.rnd(4));
		AddThing(TraitSeed.MakeSeed("corn")).SetNum(4 + EClass.rnd(4));
		for (int num7 = 0; num7 < EClass.rnd(3) + 1; num7++) // [!code --]
		for (int num8 = 0; num8 < EClass.rnd(3) + 1; num8++) // [!code ++]
		{
			Add("462", 1, 0);
		}
		for (int num8 = 0; num8 < EClass.rnd(3) + 1; num8++) // [!code --]
		for (int num9 = 0; num9 < EClass.rnd(3) + 1; num9++) // [!code ++]
		{
			Add("1167", 1, 0);
		}
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1699-L1707)
```cs:line-numbers=1699
				break;
			case ShopType.Influence:
			{
				bool num2 = owner.id == "big_sister"; // [!code --]
				TraitTicketFurniture.SetZone(num2 ? EClass.game.spatials.Find("little_garden") : EClass._zone, Add("ticket_furniture", 1, 0).SetNum(99)); // [!code --]
				if (num2) // [!code --]
				bool num3 = owner.id == "big_sister"; // [!code ++]
				TraitTicketFurniture.SetZone(num3 ? EClass.game.spatials.Find("little_garden") : EClass._zone, Add("ticket_furniture", 1, 0).SetNum(99)); // [!code ++]
				if (num3) // [!code ++]
				{
					Add("littleball", 10, 0);
					if (owner.Chara.affinity.CanGiveCard())
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1774-L1795)
```cs:line-numbers=1774
				break;
			}
			case ShopType.Medal:
				NoRestock(ThingGen.Create("sword_dragon")); // [!code --]
				NoRestockId("sword_dragon"); // [!code ++]
				Add("sword_dragon", 1, 0).SetReplica(on: true);
				NoRestock(ThingGen.Create("blunt_bonehammer")); // [!code --]
				NoRestockId("blunt_bonehammer"); // [!code ++]
				Add("blunt_bonehammer", 1, 0).SetReplica(on: true);
				NoRestock(ThingGen.Create("pole_gunlance")); // [!code --]
				NoRestockId("pole_gunlance"); // [!code ++]
				Add("pole_gunlance", 1, 0).SetReplica(on: true);
				NoRestock(ThingGen.Create("sword_muramasa")); // [!code --]
				NoRestockId("sword_muramasa"); // [!code ++]
				Add("sword_muramasa", 1, 0).SetReplica(on: true);
				NoRestock(ThingGen.Create("sword_forgetmenot")); // [!code --]
				NoRestockId("sword_forgetmenot"); // [!code ++]
				Add("sword_forgetmenot", 1, 0).SetReplica(on: true);
				NoRestock(ThingGen.Create("dagger_fish")); // [!code --]
				NoRestockId("dagger_fish"); // [!code ++]
				Add("dagger_fish", 1, 0).SetReplica(on: true);
				NoRestock(ThingGen.Create("sword_zephir")); // [!code --]
				NoRestockId("sword_zephir"); // [!code ++]
				Add("sword_zephir", 1, 0).SetReplica(on: true);
				Add("ribbon", 1, 0); // [!code --]
				Add("helm_sage", 1, 0); // [!code --]
				NoRestockId("ribbon"); // [!code ++]
				NoRestockId("helm_sage"); // [!code ++]
				Add("diary_sister", 1, 0);
				Add("diary_catsister", 1, 0);
				Add("diary_lady", 1, 0);
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1817-L1824)
```cs:line-numbers=1817
			default:
			{
				float num = (float)(3 + Mathf.Min(ShopLv / 5, 10)) + Mathf.Sqrt(ShopLv);
				int num2 = 300; // [!code ++]
				if (ShopType == ShopType.Ecopo) // [!code ++]
				{ // [!code ++]
					num2 = 30; // [!code ++]
				} // [!code ++]
				num = num * (float)(100 + EClass.pc.Evalue(1406) * 5) / 100f;
				num = Mathf.Min(num, 300f); // [!code --]
				num = Mathf.Min(num, num2); // [!code ++]
				for (int j = 0; (float)j < num; j++)
				{
					Thing thing = CreateStock();
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1837-L1845)
```cs:line-numbers=1837
					continue;
				}
				string[] recipeKey = item3.row.recipeKey;
				for (int num6 = 0; num6 < recipeKey.Length; num6++) // [!code --]
				for (int num7 = 0; num7 < recipeKey.Length; num7++) // [!code ++]
				{
					if (recipeKey[num6] == ShopType.ToString()) // [!code --]
					if (recipeKey[num7] == ShopType.ToString()) // [!code ++]
					{
						NoRestock(ThingGen.CreateRecipe(item3.id));
						break;
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1850-L1874)
```cs:line-numbers=1850
			{
			case ShopType.Moyer:
			{
				for (int num11 = 1; num11 <= 12; num11++) // [!code --]
				for (int num12 = 1; num12 <= 12; num12++) // [!code ++]
				{
					AddAdvWeek(num11); // [!code --]
					AddAdvWeek(num12); // [!code ++]
				}
				break;
			}
			case ShopType.StrangeGirl:
			{
				int num12 = (EClass.debug.enable ? 20 : (EClass._zone.development / 10)); // [!code --]
				if (num12 > 0) // [!code --]
				int num13 = (EClass.debug.enable ? 20 : (EClass._zone.development / 10)); // [!code ++]
				if (num13 > 0) // [!code ++]
				{
					Add("syringe_gene", num12, 0); // [!code --]
					Add("syringe_gene", num13, 0); // [!code ++]
					Add("diary_little", 1, 0);
				}
				if (num12 > 10) // [!code --]
				if (num13 > 10) // [!code ++]
				{
					Add("syringe_heaven", num12 / 5, 0); // [!code --]
					Add("syringe_heaven", num13 / 5, 0); // [!code ++]
					Add("1276", 1, 0);
				}
				Add("medal", 10, 0); // [!code ++]
				Add("ticket_fortune", 10, 0); // [!code ++]
				break;
			}
			case ShopType.GeneralExotic:
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1922-L1933)
```cs:line-numbers=1922
					Add("ticket_armpillow", 1, 0);
					Add("ticket_champagne", 1, 0);
				}
				for (int num9 = 0; num9 < 3; num9++) // [!code --]
				for (int num10 = 0; num10 < 3; num10++) // [!code ++]
				{
					if (EClass.rnd(5) == 0)
					{
						TreasureType treasureType = ((EClass.rnd(10) == 0) ? TreasureType.BossNefia : ((EClass.rnd(10) == 0) ? TreasureType.Map : TreasureType.RandomChest));
						int num10 = EClass.rnd(EClass.rnd(ShopLv + (EClass.debug.enable ? 200 : 50)) + 1) + 1; // [!code --]
						int num11 = EClass.rnd(EClass.rnd(ShopLv + (EClass.debug.enable ? 200 : 50)) + 1) + 1; // [!code ++]
						Thing thing6 = ThingGen.Create(treasureType switch
						{
							TreasureType.Map => "chest_treasure", 
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1935-L1944)
```cs:line-numbers=1935
							_ => "chest3", 
						});
						thing6.c_lockedHard = true;
						thing6.c_lockLv = num10; // [!code --]
						thing6.c_priceAdd = 2000 + num10 * 250 * ((treasureType == TreasureType.RandomChest) ? 1 : 5); // [!code --]
						thing6.c_lockLv = num11; // [!code ++]
						thing6.c_priceAdd = 2000 + num11 * 250 * ((treasureType == TreasureType.RandomChest) ? 1 : 5); // [!code ++]
						thing6.c_revealLock = true;
						ThingGen.CreateTreasureContent(thing6, num10, treasureType, clearContent: true); // [!code --]
						ThingGen.CreateTreasureContent(thing6, num11, treasureType, clearContent: true); // [!code ++]
						AddThing(thing6);
					}
				}
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L1948-L1954)
```cs:line-numbers=1948
			ShopType shopType = ShopType;
			if (shopType == ShopType.General || shopType == ShopType.Food)
			{
				for (int num13 = 0; num13 < (EClass.debug.enable ? 3 : 3); num13++) // [!code --]
				for (int num14 = 0; num14 < (EClass.debug.enable ? 3 : 3); num14++) // [!code ++]
				{
					if (EClass.rnd(3) == 0)
					{
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L2039-L2049)
```cs:line-numbers=2039
			{
				return;
			}
			int num14 = t.things.width * 10; // [!code --]
			if (t.things.Count > num14) // [!code --]
			int num15 = t.things.width * 10; // [!code ++]
			if (t.things.Count > num15) // [!code ++]
			{
				int num15 = t.things.Count - num14; // [!code --]
				for (int num16 = 0; num16 < num15; num16++) // [!code --]
				int num16 = t.things.Count - num15; // [!code ++]
				for (int num17 = 0; num17 < num16; num17++) // [!code ++]
				{
					t.things.LastItem().Destroy();
				}
```

[`void NoRestock(Thing _t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Trait.cs#L2081-L2086)
```cs:line-numbers=2081
						AddThing(_t);
					}
				}
				void NoRestockId(string _id) // [!code ++]
				{ // [!code ++]
					NoRestock(ThingGen.Create(_id)); // [!code ++]
				} // [!code ++]
			}

			public Thing CreateStock()
```

## Zone

[`public bool CanDestroy()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/d102ca7722d4c0e8e37c0d10dc20f750b94bba00/Elin/Zone.cs#L1776-L1792)
```cs:line-numbers=1776
		return true;
	}
	bool flag = false;
	string text = id; // [!code --]
	if (!(text == "cave_yeek")) // [!code --]
	switch (id) // [!code ++]
	{
		if (text == "cave_mino" && !(this is Zone_DungeonMino)) // [!code --]
	case "cave_dragon": // [!code ++]
		if (!(this is Zone_DungeonDragon)) // [!code ++]
		{
			flag = true;
		}
	} // [!code --]
	else if (!(this is Zone_DungeonYeek)) // [!code --]
	{ // [!code --]
		flag = true; // [!code --]
		break; // [!code ++]
	case "cave_yeek": // [!code ++]
		if (!(this is Zone_DungeonYeek)) // [!code ++]
		{ // [!code ++]
			flag = true; // [!code ++]
		} // [!code ++]
		break; // [!code ++]
	case "cave_mino": // [!code ++]
		if (!(this is Zone_DungeonMino)) // [!code ++]
		{ // [!code ++]
			flag = true; // [!code ++]
		} // [!code ++]
		break; // [!code ++]
	}
	Zone topZone = GetTopZone();
	if (!flag)
```

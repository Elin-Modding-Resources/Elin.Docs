---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 9 files modified.
version: EA 23.206 Nightly
changes: AI_Idle/ActEffect/AttackProcess/Card/Chara/DNA/Trait/TraitMiral/Zone
---

# EA 23.206 Nightly

September 26, 2025

9 files modified.

## Important Changes

**None.**
## AI_Idle

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/AI_Idle.cs#L384-L390)
```cs:line-numbers=384
		text = owner.id;
		if (!(text == "geist"))
		{
			if (text == "mech_scarab" && EClass.rnd(20) == 0) // [!code --]
			if (text == "mech_scarab" && EClass.rnd(20) == 0 && owner.CanDuplicate()) // [!code ++]
			{
				int i = 0;
				owner.pos.ForeachNeighbor(delegate(Point p)
```

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/AI_Idle.cs#L394-L402)
```cs:line-numbers=394
						i++;
					}
				});
				if (i <= 2) // [!code --]
				if (i < 2) // [!code ++]
				{
					EClass._zone.AddCard(owner.Duplicate(), owner.pos.GetNearestPoint(allowBlock: false, allowChara: false)); // [!code --]
					Point randomPoint = owner.pos.GetRandomPoint(1, requireLos: false, allowChara: false, allowBlocked: false, 200); // [!code ++]
					if (randomPoint != null) // [!code ++]
					{ // [!code ++]
						Card c2 = EClass._zone.AddCard(owner.Duplicate(), randomPoint); // [!code ++]
						if (randomPoint.Distance(EClass.pc.pos) < EClass.pc.GetHearingRadius()) // [!code ++]
						{ // [!code ++]
							Msg.Say("self_dupe", owner, c2); // [!code ++]
						} // [!code ++]
					} // [!code ++]
				}
			}
		}
```

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/AI_Idle.cs#L862-L871)
```cs:line-numbers=862
	{
		for (int k = 0; k < 100; k++)
		{
			Point randomPoint = EClass._map.GetRandomPoint(); // [!code --]
			if (randomPoint.IsDeepWater && !randomPoint.IsBlocked) // [!code --]
			Point randomPoint2 = EClass._map.GetRandomPoint(); // [!code ++]
			if (randomPoint2.IsDeepWater && !randomPoint2.IsBlocked) // [!code ++]
			{
				yield return DoGoto(randomPoint); // [!code --]
				yield return DoGoto(randomPoint2); // [!code ++]
				break;
			}
		}
```

[`Point FindMovePoint(BaseArea.AccessType type)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/AI_Idle.cs#L895-L904)
```cs:line-numbers=895
	{
		for (int l = 0; l < 20; l++)
		{
			Point randomPoint2 = owner.pos.GetRandomPoint(5 + l, requireLos: false); // [!code --]
			if (randomPoint2 != null && randomPoint2.IsInBounds && (randomPoint2.cell.room == null || randomPoint2.cell.room.data.accessType == type)) // [!code --]
			Point randomPoint3 = owner.pos.GetRandomPoint(5 + l, requireLos: false); // [!code ++]
			if (randomPoint3 != null && randomPoint3.IsInBounds && (randomPoint3.cell.room == null || randomPoint3.cell.room.data.accessType == type)) // [!code ++]
			{
				return randomPoint2; // [!code --]
				return randomPoint3; // [!code ++]
			}
		}
		return null;
```

## ActEffect

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L932-L938)
```cs:line-numbers=932
	case EffectId.Duplicate:
	{
		Point randomPoint = CC.pos.GetRandomPoint(2, requireLos: false, allowChara: false, allowBlocked: false, 200);
		if (randomPoint == null || randomPoint.Equals(CC.pos) || !randomPoint.IsValid || EClass._zone.IsRegion || CC.HasCondition<ConPoison>() || CC.HasCondition<ConConfuse>() || CC.HasCondition<ConDim>() || CC.HasCondition<ConParalyze>() || CC.HasCondition<ConSleep>() || CC.HasCondition<ConBurning>() || CC.HasCondition<ConFreeze>() || CC.HasCondition<ConMiasma>() || CC.corruption >= 100) // [!code --]
		if (randomPoint == null || randomPoint.Equals(CC.pos) || !randomPoint.IsValid || !CC.CanDuplicate()) // [!code ++]
		{
			CC.Say("split_fail", CC);
			return;
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1110-L1117)
```cs:line-numbers=1110
			tc.ModEncLv(-1);
			break;
		}
		int num4 = (flag3 ? 4 : 2) + (blessed ? 1 : 0); // [!code --]
		if (tc.encLV >= num4) // [!code --]
		int num5 = (flag3 ? 4 : 2) + (blessed ? 1 : 0); // [!code ++]
		if (tc.encLV >= num5) // [!code ++]
		{
			cc.Say("enc_resist", tc);
			break;
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1173-L1179)
```cs:line-numbers=1173
		}
		cc.PlaySound("offering");
		cc.PlayEffect("buff");
		int num5 = (tc.isWeightChanged ? tc.c_weight : tc.Thing.source.weight); // [!code --]
		int num6 = (tc.isWeightChanged ? tc.c_weight : tc.Thing.source.weight); // [!code ++]
		tc.isWeightChanged = true;
		Element orCreateElement = tc.elements.GetOrCreateElement(64);
		Element orCreateElement2 = tc.elements.GetOrCreateElement(65);
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1182-L1191)
```cs:line-numbers=1182
		bool flag5 = tc.IsEquipmentOrRangedOrAmmo || tc.IsThrownWeapon;
		if (flag)
		{
			num5 = (int)(0.01f * (float)num5 * (float)power * 0.75f + 500f); // [!code --]
			if (num5 < 0 || num5 > 10000000) // [!code --]
			num6 = (int)(0.01f * (float)num6 * (float)power * 0.75f + 500f); // [!code ++]
			if (num6 < 0 || num6 > 10000000) // [!code ++]
			{
				num5 = 10000000; // [!code --]
				num6 = 10000000; // [!code ++]
				flag5 = false;
			}
			if (flag5)
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1205-L1211)
```cs:line-numbers=1205
		}
		else
		{
			num5 = num5 * (100 - power / 10) / 100; // [!code --]
			num6 = num6 * (100 - power / 10) / 100; // [!code ++]
			if (blessed)
			{
				power /= 4;
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1225-L1231)
```cs:line-numbers=1225
			}
			cc.Say("lighten", cc, tc);
		}
		tc.c_weight = num5; // [!code --]
		tc.c_weight = num6; // [!code ++]
		tc.SetDirtyWeight();
		if (tc.parent == null)
		{
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1249-L1256)
```cs:line-numbers=1249
		cc.PlayEffect("identify");
		cc.Say("reconstruct", cc, tc);
		EClass.game.cards.uidNext += EClass.rnd(30);
		Thing thing = ThingGen.Create(tc.id, -1, tc.LV * power / 100); // [!code --]
		int num4 = Mathf.Max(tc.genLv, tc.LV, EClass.player.stats.deepest); // [!code ++]
		Thing thing = ThingGen.Create(tc.id, -1, num4 * power / 100); // [!code ++]
		thing.SetBlessedState(state);
		thing.genLv = num4; // [!code ++]
		tc.Destroy();
		CC.Pick(thing, msg: false);
		if (!CC.IsPC)
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1466-L1473)
```cs:line-numbers=1466
			{
				if (!item4.IsFriendOrAbove(CC))
				{
					int num9 = Dice.Create("SpShutterHex", power, CC, (actRef.refThing != null) ? null : actRef.act).Roll(); // [!code --]
					item4.DamageHP(num9 * hex2, 919, power, AttackSource.None, CC); // [!code --]
					int num10 = Dice.Create("SpShutterHex", power, CC, (actRef.refThing != null) ? null : actRef.act).Roll(); // [!code ++]
					item4.DamageHP(num10 * hex2, 919, power, AttackSource.None, CC); // [!code ++]
				}
			}
		});
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1631-L1656)
```cs:line-numbers=1631
		List<Thing> list = new List<Thing>();
		TC.things.Foreach(delegate(Thing t)
		{
			int num10 = 0; // [!code --]
			int num11 = 0; // [!code ++]
			if ((t.isEquipped || t.IsRangedWeapon || blessed) && t.blessedState < BlessedState.Normal)
			{
				if (t.blessedState == BlessedState.Cursed)
				{
					num10 = EClass.rnd(200); // [!code --]
					num11 = EClass.rnd(200); // [!code ++]
				}
				if (t.blessedState == BlessedState.Doomed)
				{
					num10 = EClass.rnd(1000); // [!code --]
					num11 = EClass.rnd(1000); // [!code ++]
				}
				if (blessed)
				{
					num10 /= 2; // [!code --]
					num11 /= 2; // [!code ++]
				}
				if (id == EffectId.UncurseEQGreater)
				{
					num10 /= 10; // [!code --]
					num11 /= 10; // [!code ++]
				}
				if (power >= num10) // [!code --]
				if (power >= num11) // [!code ++]
				{
					TC.Say("uncurseEQ_success", t);
					t.SetBlessedState(BlessedState.Normal);
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1746-L1758)
```cs:line-numbers=1746
			power = power * 2 / 3;
		}
		int a2 = power;
		int num7 = TC.WIL * (isPowerful ? 20 : 5); // [!code --]
		int num8 = TC.WIL * (isPowerful ? 20 : 5); // [!code ++]
		ConHolyVeil condition = TC.GetCondition<ConHolyVeil>();
		if (condition != null)
		{
			num7 += condition.power * 5; // [!code --]
			num8 += condition.power * 5; // [!code ++]
		}
		if (id != EffectId.DebuffKizuami && EClass.rnd(a2) < num7 / EClass.sources.stats.alias[n].hexPower && EClass.rnd(10) != 0) // [!code --]
		if (id != EffectId.DebuffKizuami && EClass.rnd(a2) < num8 / EClass.sources.stats.alias[n].hexPower && EClass.rnd(10) != 0) // [!code ++]
		{
			TC.Say("debuff_resist", TC);
			CC.DoHostileAction(TC);
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1973-L1984)
```cs:line-numbers=1973
	{
		bool flag9 = id == EffectId.DamageBody || id == EffectId.DamageBodyGreat;
		bool mind = id == EffectId.DamageMind || id == EffectId.DamageMindGreat;
		int num8 = ((id == EffectId.DamageBody || id == EffectId.DamageMind) ? 1 : (4 + EClass.rnd(4))); // [!code --]
		int num9 = ((id == EffectId.DamageBody || id == EffectId.DamageMind) ? 1 : (4 + EClass.rnd(4))); // [!code ++]
		if (id == EffectId.Weaken)
		{
			flag9 = EClass.rnd(2) == 0;
			mind = !flag9;
			num8 = 1; // [!code --]
			num9 = 1; // [!code ++]
		}
		else
		{
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L1986-L1992)
```cs:line-numbers=1986
			TC.PlaySound("debuff");
		}
		TC.Say(flag9 ? "damageBody" : "damageMind", TC);
		for (int k = 0; k < num8; k++) // [!code --]
		for (int k = 0; k < num9; k++) // [!code ++]
		{
			TC.DamageTempElements(power, flag9, mind, id != EffectId.Weaken);
		}
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/ActEffect.cs#L2048-L2064)
```cs:line-numbers=2048
		{
			Debug.Log(actRef.act.id);
		}
		int num6 = Dice.Create((actRef.act != null && EClass.sources.calc.map.ContainsKey(actRef.act.ID)) ? actRef.act.ID : "SpHealLight", power, CC, (actRef.refThing != null) ? null : actRef.act).Roll(); // [!code --]
		int num7 = Dice.Create((actRef.act != null && EClass.sources.calc.map.ContainsKey(actRef.act.ID)) ? actRef.act.ID : "SpHealLight", power, CC, (actRef.refThing != null) ? null : actRef.act).Roll(); // [!code ++]
		if (actRef.refThing != null)
		{
			num6 = num6 * (100 + actRef.refThing.Evalue(7500)) / 100; // [!code --]
			num7 = num7 * (100 + actRef.refThing.Evalue(7500)) / 100; // [!code ++]
		}
		if (flag)
		{
			TC.DamageHP(num6 / 2, 919, power); // [!code --]
			TC.DamageHP(num7 / 2, 919, power); // [!code ++]
			break;
		}
		TC.HealHPHost(num6, (actRef.refThing == null && id != EffectId.JureHeal) ? HealSource.Magic : HealSource.Item); // [!code --]
		TC.HealHPHost(num7, (actRef.refThing == null && id != EffectId.JureHeal) ? HealSource.Magic : HealSource.Item); // [!code ++]
		TC.CureHost(CureType.Heal, power, state);
		TC.Say((power >= 300) ? "heal_heavy" : "heal_light", TC);
		break;
```

## AttackProcess

[`public void PlayRangedAnime(int numFire)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/AttackProcess.cs#L410-L426)
```cs:line-numbers=410
		{
			if (EClass.core.IsGameStarted && _CC.IsAliveInCurrentZone && _zone == _CC.currentZone)
			{
				if (_weapon.id == "gun_rail") // [!code --]
				string id = _weapon.id; // [!code ++]
				if (!(id == "gun_rail")) // [!code ++]
				{
					_CC.PlayEffect("laser").GetComponent<SpriteBasedLaser>().Play(_TP.PositionCenter()); // [!code --]
					if (id == "gun_laser") // [!code ++]
					{ // [!code ++]
						_CC.PlayEffect("laser").GetComponent<SpriteBasedLaser>().Play(_TP.PositionCenter()); // [!code ++]
					} // [!code ++]
					else // [!code ++]
					{ // [!code ++]
						Effect effect = Effect.Get("ranged_arrow")._Play(_CC.pos, _CC.isSynced ? _CC.renderer.position : _CC.pos.Position(), 0f, _TP, data.sprite); // [!code ++]
						if (isCane) // [!code ++]
						{ // [!code ++]
							effect.sr.color = effColor; // [!code ++]
						} // [!code ++]
					} // [!code ++]
				}
				else
				{
					Effect effect = Effect.Get("ranged_arrow")._Play(_CC.pos, _CC.isSynced ? _CC.renderer.position : _CC.pos.Position(), 0f, _TP, data.sprite); // [!code --]
					if (isCane) // [!code --]
					{ // [!code --]
						effect.sr.color = effColor; // [!code --]
					} // [!code --]
					_CC.PlayEffect("laser_rail").GetComponent<SpriteBasedLaser>().Play(_TP.PositionCenter()); // [!code ++]
				}
				if (data.eject)
				{
```

## Card

[`public int _z`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/Card.cs#L188-L193)
```cs:line-numbers=188
		}
	}

	public int genLv // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			return _ints[10]; // [!code ++]
		} // [!code ++]
		set // [!code ++]
		{ // [!code ++]
			_ints[10] = value; // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public int refVal
	{
		get
```

[`public void Create(string _id, int _idMat = -1, int genLv = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/Card.cs#L2709-L2714)
```cs:line-numbers=2709
	Num = 1;
	autoRefuel = true;
	EClass.game.cards.AssignUID(this);
	this.genLv = genLv; // [!code ++]
	isNew = true;
	SetSource();
	OnBeforeCreate();
```

[`public float GetLightPower()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/Card.cs#L6206-L6211)
```cs:line-numbers=6206
		return num;
	}

	public int GetHearingRadius() // [!code ++]
	{ // [!code ++]
		return 8; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public int GetSightRadius()
	{
		if (IsPC)
```

## Chara

[`public void Refresh(bool calledRecursive = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/Chara.cs#L1737-L1742)
```cs:line-numbers=1737
		}
	}

	public bool CanDuplicate() // [!code ++]
	{ // [!code ++]
		if (EClass._zone.IsRegion || HasCondition<ConPoison>() || HasCondition<ConConfuse>() || HasCondition<ConDim>() || HasCondition<ConParalyze>() || HasCondition<ConSleep>() || HasCondition<ConBurning>() || HasCondition<ConFreeze>() || HasCondition<ConMiasma>() || corruption >= 100) // [!code ++]
		{ // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
		if (id == "mech_scarab" && (isSynced || pos.cell.light > 0 || (!EClass._map.IsIndoor && !pos.cell.HasRoof && !EClass.world.date.IsNight))) // [!code ++]
		{ // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
		return true; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public Chara Duplicate()
	{
		Chara chara = CharaGen.Create(id);
```

[`public void RestockEquip(bool onCreate)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/Chara.cs#L4733-L4753)
```cs:line-numbers=4733
		}
		break;
	}
	switch (equip) // [!code --]
	if (onCreate || !TryEquipRanged()) // [!code ++]
	{
	case "archer": // [!code --]
		if (onCreate || !TryEquipRanged()) // [!code --]
		if (id == "mech_scarab") // [!code ++]
		{
			EQ_CAT((EClass.rnd(4) == 0) ? "crossbow" : "bow"); // [!code --]
			AddThing("gun_laser"); // [!code ++]
		}
		break; // [!code --]
	case "inquisitor": // [!code --]
	case "gunner": // [!code --]
		if (onCreate || !TryEquipRanged()) // [!code --]
		else // [!code ++]
		{
			EQ_CAT("gun"); // [!code --]
			switch (equip) // [!code ++]
			{ // [!code ++]
			case "archer": // [!code ++]
				EQ_CAT((EClass.rnd(4) == 0) ? "crossbow" : "bow"); // [!code ++]
				break; // [!code ++]
			case "inquisitor": // [!code ++]
			case "gunner": // [!code ++]
				EQ_CAT("gun"); // [!code ++]
				break; // [!code ++]
			} // [!code ++]
		}
		break; // [!code --]
	}
	int num = ((base.rarity >= Rarity.Mythical) ? (base.LV * 3) : ((base.rarity >= Rarity.Legendary) ? (base.LV * 2) : base.LV));
	if (trait is TraitAdventurer)
```

[`public void TryDropBossLoot()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/Chara.cs#L5550-L5555)
```cs:line-numbers=5550
	}
	if (num != 0)
	{
		if (EClass._zone.DangerLv > EClass.player.stats.deepest) // [!code ++]
		{ // [!code ++]
			EClass.player.stats.deepest = EClass._zone.DangerLv; // [!code ++]
		} // [!code ++]
		EClass.player.willAutoSave = true;
		Thing thing = ThingGen.CreateTreasure("chest_boss", base.LV, type);
		point.SetBlock();
```

## DNA

[`public void WriteNote(UINote n)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/DNA.cs#L601-L610)
```cs:line-numbers=601
		if (num3 >= 0)
		{
			text2 = text2 + "[" + "*".Repeat(Mathf.Clamp(num3, 1, 5)) + ((num3 > 5) ? "+" : "") + "]";
			if (EClass.debug.showExtra) // [!code --]
			{ // [!code --]
				text2 = text2 + " (" + element.Value + ")"; // [!code --]
			} // [!code --]
		} // [!code ++]
		if ((bool)EClass.ui.GetLayer<LayerInfo>()) // [!code ++]
		{ // [!code ++]
			text2 = text2 + " (" + element.Value + ")"; // [!code ++]
		}
		n.AddText("gene_info".lang(element.Name.ToTitleCase(wholeText: true), text2), color2);
	}
```

## Trait

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/Trait.cs#L1788-L1795)
```cs:line-numbers=1788
				Add("dagger_fish", 1, 0).SetReplica(on: true);
				NoRestockId("sword_zephir");
				Add("sword_zephir", 1, 0).SetReplica(on: true);
				NoRestockId("ribbon"); // [!code --]
				NoRestockId("helm_sage"); // [!code --]
				Add("ribbon", 1, 0); // [!code ++]
				Add("helm_sage", 1, 0); // [!code ++]
				Add("diary_sister", 1, 0);
				Add("diary_catsister", 1, 0);
				Add("diary_lady", 1, 0);
```

## TraitMiral

[`public class TraitMiral : TraitUniqueMerchant`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/TraitMiral.cs#L9-L12)
```cs:line-numbers=9
	public override string LangBarter => "daBuyMedal";

	public override string IdAmbience => "blacksmith";
 // [!code ++]
	public override int ShopLv => 1; // [!code ++]
}
```

## Zone

[`public void RefreshHat()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/c058885a6a676c0f2e92192fa5238dd77ced8705/Elin/Zone.cs#L1053-L1062)
```cs:line-numbers=1053

	public void OnVisit()
	{
		if (CountDeepestLevel && DangerLv > EClass.player.stats.deepest) // [!code --]
		{ // [!code --]
			EClass.player.stats.deepest = DangerLv; // [!code --]
		} // [!code --]
		if (EClass.world.date.IsExpired(base.dateRevive))
		{
			ResetHostility();
```

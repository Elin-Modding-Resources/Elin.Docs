---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 5 files modified.
version: EA 23.228 Nightly
changes: Chara/CoreDebug/FortuneRollData/SurvivalManager/Trait
---

# EA 23.228 Nightly

October 30, 2025

5 files modified.

## Important Changes

**None.**
## Chara

[`public override bool isSynced`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/Chara.cs#L705-L711)
```cs:line-numbers=705

	public override int MaxHP => (int)Mathf.Clamp(((long)(base.END * 2 + base.STR + base.WIL / 2) * (long)Mathf.Min(base.LV, 25) / 25 + base.END + 10) * Evalue(60) / 100 * ((base.IsPCFactionOrMinion ? 100 : (100 + (int)base.rarity * 300)) + (IsPC ? (EClass.player.lastEmptyAlly * Evalue(1646)) : 0)) / 100, 1f, 1E+09f);

	public override int WeightLimit => Mathf.Max((base.STR * 500 + base.END * 250 + Evalue(207) * 2000) * ((!HasElement(1411)) ? 1 : 5) + 45000, 1000); // [!code --]
	public override int WeightLimit => (int)Mathf.Clamp(((long)base.STR * 500L + base.END * 250 + Evalue(207) * 2000) * ((!HasElement(1411)) ? 1 : 5) + 45000, 1000f, 1.0737418E+09f); // [!code ++]

	public override int SelfWeight => bio.weight * 1000;

```

[`public override void OnCreate(int genLv)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/Chara.cs#L1596-L1602)
```cs:line-numbers=1596
	_idTimeTable = ((EClass.rnd(5) == 0) ? 1 : 0);
	ApplyRace();
	ApplyJob();
	Debug.Log(source.defMat); // [!code --]
	ChangeMaterial(source.defMat.IsEmpty(race.material), ignoreFixedMaterial: true);
	if (num != source.LV)
	{
```

## CoreDebug

[`public void QuickStart()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/CoreDebug.cs#L439-L452)
```cs:line-numbers=439
		for (int j = 0; j < 30; j++)
		{
			CardBlueprint.Set(CardBlueprint.DebugEQ);
			Thing thing2 = ThingGen.CreateFromCategory("weapon", int.MaxValue); // [!code --]
			Thing thing2 = ThingGen.CreateFromCategory("weapon", 214748364); // [!code ++]
			thing2.elements.SetBase(653, 1);
			if (!(thing2.trait is TraitAmmo))
			{
				thing.AddCard(thing2);
			}
			CardBlueprint.Set(CardBlueprint.DebugEQ);
			thing2 = ThingGen.CreateFromCategory("armor", int.MaxValue); // [!code --]
			thing2 = ThingGen.CreateFromCategory("armor", 214748364); // [!code ++]
			thing2.elements.SetBase(653, 1);
			thing.AddCard(thing2);
		}
```

## FortuneRollData

[`public List<List<string>> GetPrizeList()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/FortuneRollData.cs#L184-L190)
```cs:line-numbers=184
		{
			"computer", "834", "1090", "goods_figure", "goods_canvas", "mb_1", "mb_2", "mb_3", "mb_4", "mb_5",
			"1174", "1085", "toilet", "714", "nobility", "plat", "1165", "mathammer", "medal", "bbq",
			"panty", "beehive", "ticket_resident", "lovepotion", "crystal_sun" // [!code --]
			"panty", "beehive", "ticket_resident", "lovepotion", "crystal_sun", "goods_crim" // [!code ++]
		},
		new List<string>
		{
```

## SurvivalManager

[`public void OnExpandFloor(Point pos)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/SurvivalManager.cs#L228-L248)
```cs:line-numbers=228
	});
	Check(20, delegate
	{
		EClass.pc.homeBranch.AddMemeber(EClass._zone.AddCard(CharaGen.Create("fiama"), pos.x, pos.z).Chara); // [!code --]
		AddMemeber("fiama"); // [!code ++]
	});
	Check(40, delegate
	{
		EClass.pc.homeBranch.AddMemeber(EClass._zone.AddCard(CharaGen.Create("nino"), pos.x, pos.z).Chara); // [!code --]
		AddMemeber("nino"); // [!code ++]
	});
	Check(60, delegate
	{
		EClass.pc.homeBranch.AddMemeber(EClass._zone.AddCard(CharaGen.Create("loytel"), pos.x, pos.z).Chara); // [!code --]
		AddMemeber("loytel"); // [!code ++]
		CheckLoytelDebt();
	});
	Check(80, delegate
	{ // [!code ++]
		AddMemeber("farris"); // [!code ++]
	}); // [!code ++]
	Check(100, delegate // [!code ++]
	{
		EClass._zone.AddCard(ThingGen.Create("core_defense"), pos).Install();
	});
	void AddMemeber(string id) // [!code ++]
	{ // [!code ++]
		if (EClass.game.cards.globalCharas.Find(id) == null) // [!code ++]
		{ // [!code ++]
			EClass.pc.homeBranch.AddMemeber(EClass._zone.AddCard(CharaGen.Create(id), pos.x, pos.z).Chara); // [!code ++]
		} // [!code ++]
	} // [!code ++]
	void Check(int a, Action action)
	{
		if (!done && flags.floors < a && i >= a)
```

[`public bool OnMineWreck(Point point)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/SurvivalManager.cs#L291-L297)
```cs:line-numbers=291
		break;
	case "wreck_junk":
		chanceChange = 100;
		return Pop(ThingGen.CreateFromFilter("shop_junk", num)); // [!code --]
		return Pop(ThingGen.CreateFromFilter("wreck_junk", num)); // [!code ++]
	case "wreck_stone":
		chanceChange = 30;
		array = new string[4] { "rock", "rock", "stone", "bone" };
```

## Trait

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/Trait.cs#L1533-L1580)
```cs:line-numbers=1533
		{
			break;
		}
		int num7 = 0; // [!code --]
		int num3 = 0; // [!code ++]
		foreach (Thing thing10 in c_copyContainer.things)
		{
			if (!owner.trait.CanCopy(thing10))
			{
				continue;
			}
			Thing thing5 = thing10.Duplicate(1); // [!code --]
			thing5.isStolen = false; // [!code --]
			thing5.isCopy = true; // [!code --]
			thing5.c_priceFix = 0; // [!code --]
			foreach (Element item in thing5.elements.dict.Values.Where((Element e) => e.HasTag("noInherit")).ToList()) // [!code --]
			Thing thing3 = thing10.Duplicate(1); // [!code ++]
			thing3.isStolen = false; // [!code ++]
			thing3.isCopy = true; // [!code ++]
			thing3.c_priceFix = 0; // [!code ++]
			foreach (Element item in thing3.elements.dict.Values.Where((Element e) => e.HasTag("noInherit")).ToList()) // [!code ++]
			{
				thing5.elements.Remove(item.id); // [!code --]
				thing3.elements.Remove(item.id); // [!code ++]
			}
			int num8 = 1; // [!code --]
			int num4 = 1; // [!code ++]
			switch (owner.trait.CopyShop)
			{
			case CopyShopType.Item:
			{
				num8 = (1000 + owner.c_invest * 100) / (thing5.GetPrice(CurrencyType.Money, sell: false, PriceType.CopyShop) + 50); // [!code --]
				num4 = (1000 + owner.c_invest * 100) / (thing3.GetPrice(CurrencyType.Money, sell: false, PriceType.CopyShop) + 50); // [!code ++]
				int[] array = new int[3] { 704, 703, 702 };
				foreach (int ele in array)
				{
					if (thing5.HasElement(ele)) // [!code --]
					if (thing3.HasElement(ele)) // [!code ++]
					{
						num8 = 1; // [!code --]
						num4 = 1; // [!code ++]
					}
				}
				break;
			}
			case CopyShopType.Spellbook:
				thing5.c_charges = thing10.c_charges; // [!code --]
				thing3.c_charges = thing10.c_charges; // [!code ++]
				break;
			}
			if (num8 > 1 && thing5.trait.CanStack) // [!code --]
			if (num4 > 1 && thing3.trait.CanStack) // [!code ++]
			{
				thing5.SetNum(num8); // [!code --]
				thing3.SetNum(num4); // [!code ++]
			}
			AddThing(thing5); // [!code --]
			num7++; // [!code --]
			if (num7 > owner.trait.NumCopyItem) // [!code --]
			AddThing(thing3); // [!code ++]
			num3++; // [!code ++]
			if (num3 > owner.trait.NumCopyItem) // [!code ++]
			{
				break;
			}
```

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/Trait.cs#L1611-L1617)
```cs:line-numbers=1611
		break;
	case ShopType.RedBook:
	{
		for (int num6 = 0; num6 < 30; num6++) // [!code --]
		for (int num7 = 0; num7 < 30; num7++) // [!code ++]
		{
			AddThing(ThingGen.CreateFromCategory((EClass.rnd(2) == 0) ? "_book" : "book"));
		}
```

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/Trait.cs#L1624-L1634)
```cs:line-numbers=1624
		AddThing(TraitSeed.MakeSeed("carrot")).SetNum(4 + EClass.rnd(4));
		AddThing(TraitSeed.MakeSeed("potato")).SetNum(4 + EClass.rnd(4));
		AddThing(TraitSeed.MakeSeed("corn")).SetNum(4 + EClass.rnd(4));
		for (int l = 0; l < EClass.rnd(3) + 1; l++) // [!code --]
		for (int num8 = 0; num8 < EClass.rnd(3) + 1; num8++) // [!code ++]
		{
			Add("462", 1, 0);
		}
		for (int m = 0; m < EClass.rnd(3) + 1; m++) // [!code --]
		for (int num9 = 0; num9 < EClass.rnd(3) + 1; num9++) // [!code ++]
		{
			Add("1167", 1, 0);
		}
```

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/Trait.cs#L1693-L1698)
```cs:line-numbers=1693
				Add("stethoscope", 1, 0);
				Add("whip_love", 1, 0);
				Add("whip_interest", 1, 0);
				if (EClass.game.IsSurvival) // [!code ++]
				{ // [!code ++]
					Add("chest_tax", 1, 0); // [!code ++]
				} // [!code ++]
				break;
			case ShopType.Guild:
				if (this is TraitClerk_Merchant)
```

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/Trait.cs#L1702-L1710)
```cs:line-numbers=1702
				break;
			case ShopType.Influence:
			{
				bool num3 = owner.id == "big_sister"; // [!code --]
				TraitTicketFurniture.SetZone(num3 ? EClass.game.spatials.Find("little_garden") : EClass._zone, Add("ticket_furniture", 1, 0).SetNum(99)); // [!code --]
				if (num3) // [!code --]
				bool num5 = owner.id == "big_sister"; // [!code ++]
				TraitTicketFurniture.SetZone(num5 ? EClass.game.spatials.Find("little_garden") : EClass._zone, Add("ticket_furniture", 1, 0).SetNum(99)); // [!code ++]
				if (num5) // [!code ++]
				{
					Add("littleball", 10, 0);
					if (!owner.Chara.affinity.CanGiveCard())
```

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/Trait.cs#L1717-L1741)
```cs:line-numbers=1717
					}
					if (!reroll)
					{
						for (int n = 0; n < 20; n++) // [!code --]
						for (int m = 0; m < 20; m++) // [!code ++]
						{
							owner.Chara.ModExp(287, 1000);
						}
					}
					Thing thing3 = CraftUtil.MakeLoveLunch(owner.Chara); // [!code --]
					thing3.elements.SetBase(1229, 1); // [!code --]
					AddThing(thing3); // [!code --]
					Thing thing4 = CraftUtil.MakeLoveLunch(owner.Chara); // [!code ++]
					thing4.elements.SetBase(1229, 1); // [!code ++]
					AddThing(thing4); // [!code ++]
					break;
				}
				for (int num4 = 0; num4 < 10; num4++) // [!code --]
				for (int n = 0; n < 10; n++) // [!code ++]
				{
					Thing thing4 = ThingGen.Create(EClass._zone.IsFestival ? "1123" : ((EClass.rnd(3) == 0) ? "1169" : "1160")); // [!code --]
					thing4.DyeRandom(); // [!code --]
					AddThing(thing4); // [!code --]
					Thing thing5 = ThingGen.Create(EClass._zone.IsFestival ? "1123" : ((EClass.rnd(3) == 0) ? "1169" : "1160")); // [!code ++]
					thing5.DyeRandom(); // [!code ++]
					AddThing(thing5); // [!code ++]
				}
				if (EClass._zone is Zone_Exile)
				{
					for (int num5 = 0; num5 < 30; num5++) // [!code --]
					for (int num6 = 0; num6 < 30; num6++) // [!code ++]
					{
						Add("1235", 1, -1);
						Add("1236", 1, -1);
```

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6ee4916f1e1d77735674a1c3d942ba71c68f645d/Elin/Trait.cs#L1863-L1871)
```cs:line-numbers=1863
					continue;
				}
				string[] recipeKey = item3.row.recipeKey;
				for (int num9 = 0; num9 < recipeKey.Length; num9++) // [!code --]
				for (int l = 0; l < recipeKey.Length; l++) // [!code ++]
				{
					if (recipeKey[num9] == ShopType.ToString()) // [!code --]
					if (recipeKey[l] == ShopType.ToString()) // [!code ++]
					{
						NoRestock(ThingGen.CreateRecipe(item3.id));
						break;
```

---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 33 files modified. 4 new files created.
version: EA 23.84 Nightly
changes: ABILITY/ActEffect/BaseTileMap/ButtonGrid/Card/Chara/Core/DOMAIN/ELEMENT/ENC/EditorTag/ElementContainer/FACTION/FEAT/FOOD/GameDate/GrowSystemTreeCoralwood/HealSource/InvOwnerMod/MUTATION/POLICY/Recipe/RecipeCard/SKILL/SLOT/SPELL/Scene/Thing/TraitBaseSpellbook/TraitCrafter/TraitDrink/TraitKettle/+TraitRuneMold/+TraitRuneMoldEarth/+TraitRuneMoldMana/+TraitRuneMoldSun/TraitStairsDown
---

# EA 23.84 Nightly

February 3, 2025

33 files modified. 4 new files created.

## Important Changes

**None.**
## ABILITY

[`@@ -4,8 +4,6 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ABILITY.cs#L4-L11)
```cs:line-numbers=4
{
	public const int ActChat = 5044;

	public const int TaskMoveInstalled = 5036; // [!code --]
 // [!code --]
	public const int ActNoItem = 5037;

	public const int ActThrow = 5038;
```

[`@@ -32,11 +30,11 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ABILITY.cs#L32-L42)
```cs:line-numbers=32

	public const int AI_Sleep = 5050;

	public const int TaskBuild = 5035; // [!code --]
 // [!code --]
	public const int ActZap = 5051;

	public const int TaskHarvest = 5053; // [!code --]
	public const int TaskMoveInstalled = 5036; // [!code ++]
 // [!code ++]
	public const int ActBash = 5052; // [!code ++]

	public const int AI_Bladder = 5054;

```

[`@@ -64,15 +62,15 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ABILITY.cs#L64-L78)
```cs:line-numbers=64

	public const int ActEscape = 6400;

	public const int ActBash = 5052; // [!code --]
 // [!code --]
	public const int ActSuicide = 6410;

	public const int GoalIdle = 5034; // [!code --]
	public const int TaskHarvest = 5053; // [!code ++]

	public const int AI_Equip = 5032; // [!code --]
	public const int ActDuplicate = 6420; // [!code ++]

	public const int Melee = 5002; // [!code --]
	public const int TaskBuild = 5035; // [!code ++]
 // [!code ++]
	public const int ActCancelTask = 5033; // [!code ++]

	public const int Ranged = 5003;

```

[`@@ -100,11 +98,11 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ABILITY.cs#L100-L110)
```cs:line-numbers=100

	public const int TaskAttack = 5015;

	public const int ActCancelTask = 5033; // [!code --]
 // [!code --]
	public const int TaskTame = 5016;

	public const int TaskPick = 5018; // [!code --]
	public const int GoalIdle = 5034; // [!code ++]
 // [!code ++]
	public const int TaskTalk = 5017; // [!code ++]

	public const int TaskReadBoard = 5019;

```

[`@@ -132,17 +130,15 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ABILITY.cs#L132-L148)
```cs:line-numbers=132

	public const int AI_Deconstruct = 5031;

	public const int TaskTalk = 5017; // [!code --]
 // [!code --]
	public const int ActDuplicate = 6420; // [!code --]
	public const int AI_Equip = 5032; // [!code ++]

	public const int ActRush = 6450; // [!code --]
	public const int TaskPick = 5018; // [!code ++]

	public const int breathe_Darkness = 50203; // [!code --]
	public const int ActCrabBreathe = 6500; // [!code ++]

	public const int ActLulwyTrick = 6902; // [!code --]
	public const int ActRush = 6450; // [!code ++]

	public const int ActKizuamiTrick = 6903; // [!code --]
	public const int ActEntangle = 6601; // [!code ++]

	public const int ActHeadpat = 6904;

```

[`@@ -154,19 +150,19 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ABILITY.cs#L154-L172)
```cs:line-numbers=154

	public const int breathe_Lightning = 50202;

	public const int ActCrabBreathe = 6500; // [!code --]
	public const int breathe_Darkness = 50203; // [!code ++]

	public const int breathe_Mind = 50204;

	public const int ActWait = 5000; // [!code --]
	public const int ActCurse = 6600; // [!code ++]

	public const int breathe_Poison = 50205; // [!code --]
	public const int breathe_Nether = 50206; // [!code ++]

	public const int breathe_Sound = 50207;

	public const int breathe_Nerve = 50208; // [!code --]
	public const int ActKizuamiTrick = 6903; // [!code ++]

	public const int breathe_Holy = 50209; // [!code --]
	public const int breathe_Nerve = 50208; // [!code ++]

	public const int breathe_Chaos = 50210;

```

[`@@ -180,44 +176,42 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ABILITY.cs#L180-L223)
```cs:line-numbers=180

	public const int breathe_Impact = 50215;

	public const int breathe_Nether = 50206; // [!code --]
 // [!code --]
	public const int ActManaAbsorb = 6900; // [!code --]
	public const int breathe_Void = 50216; // [!code ++]

	public const int ActJureHeal = 6901; // [!code --]
	public const int ActWait = 5000; // [!code ++]

	public const int StTaunt = 6700; // [!code --]
	public const int ActMelee = 5001; // [!code ++]

	public const int ActCurse = 6600; // [!code --]
	public const int Melee = 5002; // [!code ++]

	public const int ActEntangle = 6601; // [!code --]
	public const int breathe_Holy = 50209; // [!code ++]

	public const int ActDraw = 6602; // [!code --]
	public const int ActLulwyTrick = 6902; // [!code ++]

	public const int ActNTR = 6603; // [!code --]
	public const int breathe_Poison = 50205; // [!code ++]

	public const int ActMelee = 5001; // [!code --]
	public const int ActGazeMana = 6623; // [!code ++]

	public const int ActWeaken = 6610;

	public const int ActDraw = 6602; // [!code ++]
 // [!code ++]
	public const int ActFear = 6611;

	public const int ActTouchSleep = 6612;

	public const int StManaCost = 6720; // [!code --]
	public const int ActGazeDim = 6620; // [!code ++]

	public const int ActGazeInsane = 6621;

	public const int ActGazeMutation = 6622;

	public const int ActGazeDim = 6620; // [!code --]
	public const int ActNTR = 6603; // [!code ++]

	public const int ActDrainBlood = 6626;

	public const int ActInsult = 6630;

	public const int ActScream = 6631; // [!code --]
 // [!code --]
	public const int ActSteal = 6640;

	public const int ActStealFood = 6641;
```

[`@@ -230,22 +224,30 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ABILITY.cs#L230-L251)
```cs:line-numbers=230

	public const int ActThrowPotion = 6661;

	public const int ActGazeMana = 6623; // [!code --]
	public const int StTaunt = 6700; // [!code ++]
 // [!code ++]
	public const int StManaCost = 6720; // [!code ++]
 // [!code ++]
	public const int ActManaAbsorb = 6900; // [!code ++]
 // [!code ++]
	public const int ActScream = 6631; // [!code ++]
 // [!code ++]
	public const int ActJureHeal = 6901; // [!code ++]

	public static readonly int[] IDS = new int[115] // [!code --]
	public static readonly int[] IDS = new int[116] // [!code ++]
	{
		5044, 5036, 5037, 5038, 5039, 5040, 5041, 5042, 5043, 5045, // [!code --]
		5046, 5047, 5048, 5049, 5050, 5035, 5051, 5053, 5054, 5055, // [!code --]
		6001, 6003, 6011, 6012, 6013, 6015, 6018, 6019, 6020, 6050, // [!code --]
		6400, 5052, 6410, 5034, 5032, 5002, 5003, 5004, 5005, 5006, // [!code --]
		5007, 5008, 5009, 5010, 5011, 5012, 5013, 5014, 5015, 5033, // [!code --]
		5016, 5018, 5019, 5020, 5021, 5022, 5023, 5024, 5025, 5026, // [!code --]
		5027, 5028, 5029, 5030, 5031, 5017, 6420, 6450, 50203, 6902, // [!code --]
		6903, 6904, 7000, 50200, 50201, 50202, 6500, 50204, 5000, 50205, // [!code --]
		50207, 50208, 50209, 50210, 50211, 50212, 50213, 50214, 50215, 50206, // [!code --]
		6900, 6901, 6700, 6600, 6601, 6602, 6603, 5001, 6610, 6611, // [!code --]
		6612, 6720, 6621, 6622, 6620, 6626, 6630, 6631, 6640, 6641, // [!code --]
		6642, 6650, 6660, 6661, 6623 // [!code --]
		5044, 5037, 5038, 5039, 5040, 5041, 5042, 5043, 5045, 5046, // [!code ++]
		5047, 5048, 5049, 5050, 5051, 5036, 5052, 5054, 5055, 6001, // [!code ++]
		6003, 6011, 6012, 6013, 6015, 6018, 6019, 6020, 6050, 6400, // [!code ++]
		6410, 5053, 6420, 5035, 5033, 5003, 5004, 5005, 5006, 5007, // [!code ++]
		5008, 5009, 5010, 5011, 5012, 5013, 5014, 5015, 5016, 5034, // [!code ++]
		5017, 5019, 5020, 5021, 5022, 5023, 5024, 5025, 5026, 5027, // [!code ++]
		5028, 5029, 5030, 5031, 5032, 5018, 6500, 6450, 6601, 6904, // [!code ++]
		7000, 50200, 50201, 50202, 50203, 50204, 6600, 50206, 50207, 6903, // [!code ++]
		50208, 50210, 50211, 50212, 50213, 50214, 50215, 50216, 5000, 5001, // [!code ++]
		5002, 50209, 6902, 50205, 6623, 6610, 6602, 6611, 6612, 6620, // [!code ++]
		6621, 6622, 6603, 6626, 6630, 6640, 6641, 6642, 6650, 6660, // [!code ++]
		6661, 6700, 6720, 6900, 6631, 6901 // [!code ++]
	};
}
public class Ability : Act
```

## ActEffect

[`@@ -1322,26 +1322,26 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1322-L1347)
```cs:line-numbers=1322
			TC.Say((actRef.n1 == "money") ? "abStealNegateMoney" : "abStealNegate", TC);
			break;
		}
		Thing thing6 = null; // [!code --]
		bool flag8 = actRef.n1 == "food"; // [!code --]
		Thing thing4 = null; // [!code ++]
		bool flag6 = actRef.n1 == "food"; // [!code ++]
		if (actRef.n1 == "money")
		{
			int currency = TC.GetCurrency();
			if (currency > 0)
			{
				currency = Mathf.Clamp(EClass.rnd(currency / 10), 1, 100 + EClass.rndHalf(CC.LV * 200));
				thing6 = ThingGen.Create("money").SetNum(currency); // [!code --]
				thing4 = ThingGen.Create("money").SetNum(currency); // [!code ++]
				TC.ModCurrency(-currency);
			}
		}
		else
		{
			Func<Thing, bool> func = (Thing t) => true;
			if (flag8) // [!code --]
			if (flag6) // [!code ++]
			{
				func = (Thing t) => t.IsFood;
			}
			List<Thing> list7 = TC.things.List(delegate(Thing t) // [!code --]
			List<Thing> list3 = TC.things.List(delegate(Thing t) // [!code ++]
			{
				if (t.parentCard?.trait is TraitChestMerchant || t.trait is TraitTool || t.IsThrownWeapon)
				{
```

[`@@ -1349,30 +1349,30 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1349-L1378)
```cs:line-numbers=1349
				}
				return t.trait.CanBeDestroyed && t.things.Count == 0 && t.invY != 1 && t.trait.CanBeStolen && !t.trait.CanOnlyCarry && !t.IsUnique && !t.isEquipped && t.blessedState == BlessedState.Normal && func(t);
			}, onlyAccessible: true);
			if (list7.Count > 0) // [!code --]
			if (list3.Count > 0) // [!code ++]
			{
				thing6 = list7.RandomItem(); // [!code --]
				if (thing6.Num > 1) // [!code --]
				thing4 = list3.RandomItem(); // [!code ++]
				if (thing4.Num > 1) // [!code ++]
				{
					thing6 = thing6.Split(1); // [!code --]
					thing4 = thing4.Split(1); // [!code ++]
				}
			}
			CC.AddCooldown(6640, 200);
		}
		if (thing6 == null) // [!code --]
		if (thing4 == null) // [!code ++]
		{
			CC.Say("abStealNothing", CC, TC);
			break;
		}
		thing6.SetInt(116, 1); // [!code --]
		TC.PlaySound(thing6.material.GetSoundDrop(thing6.sourceCard)); // [!code --]
		CC.Pick(thing6, msg: false); // [!code --]
		CC.Say("abSteal", CC, TC, thing6.Name); // [!code --]
		thing4.SetInt(116, 1); // [!code ++]
		TC.PlaySound(thing4.material.GetSoundDrop(thing4.sourceCard)); // [!code ++]
		CC.Pick(thing4, msg: false); // [!code ++]
		CC.Say("abSteal", CC, TC, thing4.Name); // [!code ++]
		if (actRef.n1 == "food")
		{
			if (CC.hunger.value != 0)
			{
				CC.InstantEat(thing6); // [!code --]
				CC.InstantEat(thing4); // [!code ++]
			}
		}
		else
```

[`@@ -1397,7 +1397,7 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1397-L1403)
```cs:line-numbers=1397
		{
			break;
		}
		List<Thing> list6 = TC.things.List(delegate(Thing t) // [!code --]
		List<Thing> list7 = TC.things.List(delegate(Thing t) // [!code ++]
		{
			if (!t.isEquipped || t.blessedState == BlessedState.Doomed || t.IsToolbelt)
			{
```

[`@@ -1405,15 +1405,15 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1405-L1419)
```cs:line-numbers=1405
			}
			return (t.blessedState < BlessedState.Blessed || EClass.rnd(10) == 0) ? true : false;
		});
		if (list6.Count == 0) // [!code --]
		if (list7.Count == 0) // [!code ++]
		{
			CC.SayNothingHappans();
			break;
		}
		Thing thing5 = list6.RandomItem(); // [!code --]
		TC.Say("curse_hit", TC, thing5); // [!code --]
		thing5.SetBlessedState((thing5.blessedState == BlessedState.Cursed) ? BlessedState.Doomed : BlessedState.Cursed); // [!code --]
		LayerInventory.SetDirty(thing5); // [!code --]
		Thing thing6 = list7.RandomItem(); // [!code ++]
		TC.Say("curse_hit", TC, thing6); // [!code ++]
		thing6.SetBlessedState((thing6.blessedState == BlessedState.Cursed) ? BlessedState.Doomed : BlessedState.Cursed); // [!code ++]
		LayerInventory.SetDirty(thing6); // [!code ++]
		break;
	}
	case EffectId.UncurseEQ:
```

[`@@ -1495,18 +1495,18 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1495-L1512)
```cs:line-numbers=1495
				text3 = text4;
			}
		}
		Condition condition2 = Condition.Create(text3, power, delegate(Condition con) // [!code --]
		Condition condition = Condition.Create(text3, power, delegate(Condition con) // [!code ++]
		{
			if (!actRef.aliasEle.IsEmpty())
			{
				con.SetElement(EClass.sources.elements.alias[actRef.aliasEle].id);
			}
		});
		condition2.isPerfume = TC.IsPC && actRef.isPerfume; // [!code --]
		Condition condition3 = TC.AddCondition(condition2); // [!code --]
		if (condition3 != null && condition3.isPerfume) // [!code --]
		condition.isPerfume = TC.IsPC && actRef.isPerfume; // [!code ++]
		Condition condition2 = TC.AddCondition(condition); // [!code ++]
		if (condition2 != null && condition2.isPerfume) // [!code ++]
		{
			condition3.value = 3; // [!code --]
			condition2.value = 3; // [!code ++]
			Msg.Say("perfume", TC);
		}
		if (!text4.IsEmpty())
```

[`@@ -1519,12 +1519,12 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1519-L1530)
```cs:line-numbers=1519
	{
		EClass.game.religions.Trickery.Talk("ability");
		bool hex2 = CC.IsHostile(TC);
		List<SourceStat.Row> list3 = EClass.sources.stats.rows.Where((SourceStat.Row con) => con.tag.Contains("random") && con.group == (hex2 ? "Debuff" : "Buff")).ToList(); // [!code --]
		List<SourceStat.Row> list6 = EClass.sources.stats.rows.Where((SourceStat.Row con) => con.tag.Contains("random") && con.group == (hex2 ? "Debuff" : "Buff")).ToList(); // [!code ++]
		int power2 = power;
		for (int k = 0; k < 4 + EClass.rnd(2); k++) // [!code --]
		for (int m = 0; m < 4 + EClass.rnd(2); m++) // [!code ++]
		{
			SourceStat.Row row2 = list3.RandomItem(); // [!code --]
			list3.Remove(row2); // [!code --]
			SourceStat.Row row2 = list6.RandomItem(); // [!code ++]
			list6.Remove(row2); // [!code ++]
			Proc(hex2 ? EffectId.Debuff : EffectId.Buff, CC, TC, power2, new ActRef
			{
				n1 = row2.alias
```

[`@@ -1542,13 +1542,13 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1542-L1554)
```cs:line-numbers=1542
		bool isPowerful = TC.IsPowerful;
		string n = actRef.n1;
		int a2 = power;
		int num7 = TC.WIL * (isPowerful ? 20 : 5); // [!code --]
		ConHolyVeil condition = TC.GetCondition<ConHolyVeil>(); // [!code --]
		if (condition != null) // [!code --]
		int num6 = TC.WIL * (isPowerful ? 20 : 5); // [!code ++]
		ConHolyVeil condition3 = TC.GetCondition<ConHolyVeil>(); // [!code ++]
		if (condition3 != null) // [!code ++]
		{
			num7 += condition.power * 5; // [!code --]
			num6 += condition3.power * 5; // [!code ++]
		}
		if (EClass.rnd(a2) < num7 / EClass.sources.stats.alias[n].hexPower && EClass.rnd(10) != 0) // [!code --]
		if (EClass.rnd(a2) < num6 / EClass.sources.stats.alias[n].hexPower && EClass.rnd(10) != 0) // [!code ++]
		{
			TC.Say("debuff_resist", TC);
			CC.DoHostileAction(TC);
```

[`@@ -1696,16 +1696,16 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1696-L1711)
```cs:line-numbers=1696
		break;
	case EffectId.Revive:
	{
		List<KeyValuePair<int, Chara>> list4 = EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon && a.Value.c_wasInPcParty).ToList(); // [!code --]
		List<KeyValuePair<int, Chara>> list5 = EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon && a.Value.c_wasInPcParty).ToList(); // [!code ++]
		if (TC.IsPCFaction || TC.IsPCFactionMinion)
		{
			if (TC.IsPC && list4.Count == 0) // [!code --]
			if (TC.IsPC && list5.Count == 0) // [!code ++]
			{
				list4 = EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.CanRevive() && a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon).ToList(); // [!code --]
				list5 = EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.CanRevive() && a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon).ToList(); // [!code ++]
			}
			if (list4.Count > 0) // [!code --]
			if (list5.Count > 0) // [!code ++]
			{
				list4.RandomItem().Value.Chara.GetRevived(); // [!code --]
				list5.RandomItem().Value.Chara.GetRevived(); // [!code ++]
				break;
			}
		}
```

[`@@ -1718,24 +1718,24 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1718-L1741)
```cs:line-numbers=1718
	case EffectId.DamageMindGreat:
	case EffectId.Weaken:
	{
		bool flag9 = id == EffectId.DamageBody || id == EffectId.DamageBodyGreat; // [!code --]
		bool mind2 = id == EffectId.DamageMind || id == EffectId.DamageMindGreat; // [!code --]
		int num9 = ((id == EffectId.DamageBody || id == EffectId.DamageMind) ? 1 : (4 + EClass.rnd(4))); // [!code --]
		bool flag7 = id == EffectId.DamageBody || id == EffectId.DamageBodyGreat; // [!code ++]
		bool mind = id == EffectId.DamageMind || id == EffectId.DamageMindGreat; // [!code ++]
		int num7 = ((id == EffectId.DamageBody || id == EffectId.DamageMind) ? 1 : (4 + EClass.rnd(4))); // [!code ++]
		if (id == EffectId.Weaken)
		{
			flag9 = EClass.rnd(2) == 0; // [!code --]
			mind2 = !flag9; // [!code --]
			num9 = 1; // [!code --]
			flag7 = EClass.rnd(2) == 0; // [!code ++]
			mind = !flag7; // [!code ++]
			num7 = 1; // [!code ++]
		}
		else
		{
			TC.PlayEffect("debuff");
			TC.PlaySound("debuff");
		}
		TC.Say(flag9 ? "damageBody" : "damageMind", TC); // [!code --]
		for (int m = 0; m < num9; m++) // [!code --]
		TC.Say(flag7 ? "damageBody" : "damageMind", TC); // [!code ++]
		for (int k = 0; k < num7; k++) // [!code ++]
		{
			TC.DamageTempElements(power, flag9, mind2); // [!code --]
			TC.DamageTempElements(power, flag7, mind); // [!code ++]
		}
		if (TC.IsPC)
		{
```

[`@@ -1748,40 +1748,40 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1748-L1787)
```cs:line-numbers=1748
	case EffectId.EnhanceBodyGreat:
	case EffectId.EnhanceMindGreat:
	{
		bool flag6 = id == EffectId.EnhanceBody || id == EffectId.EnhanceBodyGreat; // [!code --]
		bool mind = id == EffectId.EnhanceMind || id == EffectId.EnhanceMindGreat; // [!code --]
		int num6 = ((id == EffectId.EnhanceBody || id == EffectId.EnhanceMind) ? 1 : (4 + EClass.rnd(4))); // [!code --]
		TC.Say(flag6 ? "enhanceBody" : "enhanceMind", TC); // [!code --]
		bool flag8 = id == EffectId.EnhanceBody || id == EffectId.EnhanceBodyGreat; // [!code ++]
		bool mind2 = id == EffectId.EnhanceMind || id == EffectId.EnhanceMindGreat; // [!code ++]
		int num8 = ((id == EffectId.EnhanceBody || id == EffectId.EnhanceMind) ? 1 : (4 + EClass.rnd(4))); // [!code ++]
		TC.Say(flag8 ? "enhanceBody" : "enhanceMind", TC); // [!code ++]
		TC.PlayEffect("buff");
		TC.PlaySound("buff");
		for (int l = 0; l < num6; l++) // [!code --]
		for (int l = 0; l < num8; l++) // [!code ++]
		{
			TC.EnhanceTempElements(power, flag6, mind); // [!code --]
			TC.EnhanceTempElements(power, flag8, mind2); // [!code ++]
		}
		break;
	}
	case EffectId.RestoreBody:
	case EffectId.RestoreMind:
	{
		bool flag7 = id == EffectId.RestoreBody; // [!code --]
		bool flag9 = id == EffectId.RestoreBody; // [!code ++]
		if (flag)
		{
			Redirect(flag7 ? EffectId.DamageBodyGreat : EffectId.DamageMindGreat, BlessedState.Normal, default(ActRef)); // [!code --]
			Redirect(flag9 ? EffectId.DamageBodyGreat : EffectId.DamageMindGreat, BlessedState.Normal, default(ActRef)); // [!code ++]
			break;
		}
		TC.Say(flag7 ? "restoreBody" : "restoreMind", TC); // [!code --]
		TC.Say(flag9 ? "restoreBody" : "restoreMind", TC); // [!code ++]
		TC.PlaySound("heal");
		TC.PlayEffect("heal");
		TC.CureHost(flag7 ? CureType.CureBody : CureType.CureMind, power, state); // [!code --]
		TC.CureHost(flag9 ? CureType.CureBody : CureType.CureMind, power, state); // [!code ++]
		if (blessed)
		{
			Redirect(flag7 ? EffectId.EnhanceBodyGreat : EffectId.EnhanceMindGreat, BlessedState.Normal, default(ActRef)); // [!code --]
			Redirect(flag9 ? EffectId.EnhanceBodyGreat : EffectId.EnhanceMindGreat, BlessedState.Normal, default(ActRef)); // [!code ++]
		}
		break;
	}
	case EffectId.HealComplete:
		Dice.Create("SpHealLight", power, CC, actRef.act);
		TC.HealHPHost(9999, HealSource.Magic); // [!code --]
		TC.HealHPHost(9999, (actRef.refThing == null) ? HealSource.Magic : HealSource.Item); // [!code ++]
		TC.CureHost(CureType.HealComplete, power, state);
		TC.Say("heal_heavy", TC);
		break;
```

[`@@ -1792,13 +1792,13 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L1792-L1804)
```cs:line-numbers=1792
		{
			EClass.game.religions.Healing.Talk("ability");
		}
		int num8 = Dice.Create((actRef.act != null && EClass.sources.calc.map.ContainsKey(actRef.act.ID)) ? actRef.act.ID : "SpHealLight", power, CC, actRef.act).Roll(); // [!code --]
		int num9 = Dice.Create((actRef.act != null && EClass.sources.calc.map.ContainsKey(actRef.act.ID)) ? actRef.act.ID : "SpHealLight", power, CC, actRef.act).Roll(); // [!code ++]
		if (flag)
		{
			TC.DamageHP(num8 / 2, 919, power); // [!code --]
			TC.DamageHP(num9 / 2, 919, power); // [!code ++]
			break;
		}
		TC.HealHPHost(num8, HealSource.Magic); // [!code --]
		TC.HealHPHost(num9, (actRef.refThing == null) ? HealSource.Magic : HealSource.Item); // [!code ++]
		TC.CureHost(CureType.Heal, power, state);
		TC.Say((power >= 300) ? "heal_heavy" : "heal_light", TC);
		break;
```

[`@@ -2069,20 +2069,20 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ActEffect.cs#L2069-L2088)
```cs:line-numbers=2069
		{
			power /= 4;
		}
		List<Thing> list5 = TC.things.List((Thing t) => (t.Num <= 1 && t.IsEquipmentOrRanged && !t.IsToolbelt && !t.IsLightsource && t.isEquipped) ? true : false); // [!code --]
		if (list5.Count != 0) // [!code --]
		List<Thing> list4 = TC.things.List((Thing t) => (t.Num <= 1 && t.IsEquipmentOrRanged && !t.IsToolbelt && !t.IsLightsource && t.isEquipped) ? true : false); // [!code ++]
		if (list4.Count != 0) // [!code ++]
		{
			Thing thing4 = list5.RandomItem(); // [!code --]
			Thing thing5 = list4.RandomItem(); // [!code ++]
			TC.Say("acid_hit", TC);
			if (thing4.isAcidproof) // [!code --]
			if (thing5.isAcidproof) // [!code ++]
			{
				TC.Say("acid_nullify", thing4); // [!code --]
				TC.Say("acid_nullify", thing5); // [!code ++]
			}
			else if (thing4.encLV > -5) // [!code --]
			else if (thing5.encLV > -5) // [!code ++]
			{
				TC.Say("acid_rust", TC, thing4); // [!code --]
				thing4.ModEncLv(-1); // [!code --]
				LayerInventory.SetDirty(thing4); // [!code --]
				TC.Say("acid_rust", TC, thing5); // [!code ++]
				thing5.ModEncLv(-1); // [!code ++]
				LayerInventory.SetDirty(thing5); // [!code ++]
			}
			if (TC.IsPCParty)
			{
```

## BaseTileMap

[`@@ -1254,7 +1254,448 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1254-L1260)
```cs:line-numbers=1254
			fogged = true;
		}
	}
	goto IL_7aaf; // [!code --]
	goto IL_7b3a; // [!code ++]
	IL_7b3a: // [!code ++]
	if (detail.things.Count == 0 && detail.charas.Count == 0) // [!code ++]
	{ // [!code ++]
		return; // [!code ++]
	} // [!code ++]
	int num3 = 0; // [!code ++]
	thingPos.x = 0f; // [!code ++]
	thingPos.y = 0f; // [!code ++]
	thingPos.z = 0f; // [!code ++]
	freePos.x = (freePos.y = (freePos.z = 0f)); // [!code ++]
	if (this.cell.HasRamp) // [!code ++]
	{ // [!code ++]
		Vector3 rampFix = sourceBlock.tileType.GetRampFix(this.cell.blockDir); // [!code ++]
		param.x += rampFix.x; // [!code ++]
		param.y += rampFix.y; // [!code ++]
		param.z += rampFix.z; // [!code ++]
		freePos.x += rampFix.x; // [!code ++]
		freePos.y += rampFix.y; // [!code ++]
		freePos.z += rampFix.z; // [!code ++]
	} // [!code ++]
	param.y += (flag ? 0f : ((this.cell._bridge != 0) ? this.cell.sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight)); // [!code ++]
	orgPos.x = (orgX = param.x); // [!code ++]
	orgPos.y = (orgY = param.y); // [!code ++]
	orgPos.z = (orgZ = param.z); // [!code ++]
	if (flag && liquidLv > 0) // [!code ++]
	{ // [!code ++]
		if (liquidLv > 10) // [!code ++]
		{ // [!code ++]
			liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code ++]
		} // [!code ++]
		liquidLv -= (int)(floatY * 0.5f); // [!code ++]
		param.liquidLv = liquidLv; // [!code ++]
		param.y -= TileType.FloorWaterShallow.FloorHeight; // [!code ++]
	} // [!code ++]
	Thing thing = null; // [!code ++]
	bool shadow = liquidLv == 0; // [!code ++]
	float num4 = 0f; // [!code ++]
	float num5 = 0f; // [!code ++]
	bool flag6 = false; // [!code ++]
	float num6 = 0f; // [!code ++]
	bool flag7 = false; // [!code ++]
	float num7 = 0f; // [!code ++]
	if (detail.things.Count > 0 && isSeen) // [!code ++]
	{ // [!code ++]
		_ = zSetting.max1; // [!code ++]
		float num8 = 0f; // [!code ++]
		for (int j = 0; j < detail.things.Count; j++) // [!code ++]
		{ // [!code ++]
			Thing t = detail.things[j]; // [!code ++]
			if ((fogged && !t.isRoofItem) || ((t.isHidden || t.trait.HideInAdv || t.isMasked) && !EMono.scene.actionMode.ShowMaskedThings) || (t.isRoofItem && ((this.room == null && !sourceBlock.tileType.IsFullBlock && !EMono._zone.IsPCFaction) || (lowBlock && !showFullWall && this.room != null) || (noRoofMode && currentRoom == null))) || (flag3 && !t.isRoofItem)) // [!code ++]
			{ // [!code ++]
				continue; // [!code ++]
			} // [!code ++]
			TileType tileType = t.trait.tileType; // [!code ++]
			bool isInstalled = t.IsInstalled; // [!code ++]
			SourcePref pref = t.Pref; // [!code ++]
			if (!isInstalled && t.category.tileDummy != 0) // [!code ++]
			{ // [!code ++]
				pref = rendererObjDummy.shadowPref; // [!code ++]
			} // [!code ++]
			float num9 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code ++]
			if (t.ignoreStackHeight) // [!code ++]
			{ // [!code ++]
				thingPos.y -= num4; // [!code ++]
			} // [!code ++]
			shadow = thingPos.y < 0.16f && num7 < 0.16f; // [!code ++]
			_ = pref.bypassShadow; // [!code ++]
			param.shadowFix = 0f - thingPos.y; // [!code ++]
			param.liquidLv = ((thingPos.y + (float)t.altitude < 0.1f) ? liquidLv : 0); // [!code ++]
			if (t.isRoofItem) // [!code ++]
			{ // [!code ++]
				param.snow = isSnowCovered && !this.cell.isClearSnow; // [!code ++]
				SetRoofHeight(param, this.cell, cx, cz); // [!code ++]
				_actorPos.x = param.x; // [!code ++]
				_actorPos.y = param.y; // [!code ++]
				_actorPos.z = param.z + num8; // [!code ++]
				if (this.room != null) // [!code ++]
				{ // [!code ++]
					param.color = GetRoofLight(this.room.lot); // [!code ++]
				} // [!code ++]
				shadow = false; // [!code ++]
				param.liquidLv = 0; // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				param.snow = snowed; // [!code ++]
				_actorPos.x = orgX + num5; // [!code ++]
				_actorPos.y = orgY; // [!code ++]
				_actorPos.z = orgZ + num8 + thingPos.z; // [!code ++]
				if (tileType.CanStack || !isInstalled) // [!code ++]
				{ // [!code ++]
					if (thing?.id != t.id) // [!code ++]
					{ // [!code ++]
						_actorPos.x += thingPos.x; // [!code ++]
					} // [!code ++]
					_actorPos.y += thingPos.y; // [!code ++]
					if (t.trait.IgnoreLastStackHeight && (thing == null || !thing.trait.IgnoreLastStackHeight)) // [!code ++]
					{ // [!code ++]
						thingPos.y -= num4; // [!code ++]
						if (thing != null) // [!code ++]
						{ // [!code ++]
							_actorPos.z -= 0.2f; // [!code ++]
							thingPos.z -= 0.2f; // [!code ++]
						} // [!code ++]
						_actorPos.y -= num4; // [!code ++]
					} // [!code ++]
					_actorPos.z += renderSetting.thingZ + (float)j * -0.01f + zSetting.mod1 * thingPos.y; // [!code ++]
				} // [!code ++]
				if (isInstalled) // [!code ++]
				{ // [!code ++]
					if (t.TileType.IsRamp) // [!code ++]
					{ // [!code ++]
						Vector3 rampFix2 = t.TileType.GetRampFix(t.dir); // [!code ++]
						orgX += rampFix2.x; // [!code ++]
						orgY += rampFix2.y; // [!code ++]
						orgZ += rampFix2.z; // [!code ++]
						freePos.x += rampFix2.x; // [!code ++]
						freePos.y += rampFix2.y; // [!code ++]
						freePos.z += rampFix2.z; // [!code ++]
						if (!this.cell.IsTopWater || t.altitude > 0) // [!code ++]
						{ // [!code ++]
							num7 += rampFix2.y; // [!code ++]
						} // [!code ++]
						liquidLv -= (int)(rampFix2.y * 150f); // [!code ++]
						if (liquidLv < 0) // [!code ++]
						{ // [!code ++]
							liquidLv = 0; // [!code ++]
						} // [!code ++]
					} // [!code ++]
					else if (!flag7 && t.trait.IsChangeFloorHeight && !t.ignoreStackHeight) // [!code ++]
					{ // [!code ++]
						orgY += num9 + (float)t.altitude * altitudeFix.y; // [!code ++]
						orgZ += (float)t.altitude * altitudeFix.z; // [!code ++]
						freePos.y += num9 + (float)t.altitude * altitudeFix.y; // [!code ++]
						if (!this.cell.IsTopWater || t.altitude > 0) // [!code ++]
						{ // [!code ++]
							num7 += num9 + (float)t.altitude * altitudeFix.y; // [!code ++]
						} // [!code ++]
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
						_actorPos.z += pref.z; // [!code ++]
						thingPos.z += pref.z; // [!code ++]
						liquidLv -= (int)(num9 * 150f); // [!code ++]
						if (liquidLv < 0) // [!code ++]
						{ // [!code ++]
							liquidLv = 0; // [!code ++]
						} // [!code ++]
					} // [!code ++]
					else // [!code ++]
					{ // [!code ++]
						thingPos.y += num9; // [!code ++]
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
						_actorPos.z += pref.z; // [!code ++]
						if (pref.height >= 0f) // [!code ++]
						{ // [!code ++]
							thingPos.z += pref.z; // [!code ++]
						} // [!code ++]
					} // [!code ++]
					if (!tileType.UseMountHeight && j > 10) // [!code ++]
					{ // [!code ++]
						flag7 = true; // [!code ++]
					} // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					thingPos.y += num9; // [!code ++]
					_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
					_actorPos.z += pref.z; // [!code ++]
					thingPos.z += pref.z; // [!code ++]
				} // [!code ++]
				if (t.isFloating && isWater && !hasBridge && !flag) // [!code ++]
				{ // [!code ++]
					flag = true; // [!code ++]
					float num10 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code ++]
					orgY += 0.01f * floatY - num10; // [!code ++]
					num6 = num9; // [!code ++]
					_actorPos.y += 0.01f * floatY - num10; // [!code ++]
					if (liquidLv > 10) // [!code ++]
					{ // [!code ++]
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code ++]
					} // [!code ++]
					liquidLv -= (int)(floatY * 0.5f); // [!code ++]
					if (liquidLv < 0) // [!code ++]
					{ // [!code ++]
						liquidLv = 0; // [!code ++]
					} // [!code ++]
					param.liquidLv = liquidLv; // [!code ++]
				} // [!code ++]
				num4 = num9; // [!code ++]
				if (t.sourceCard.multisize && !t.trait.IsGround) // [!code ++]
				{ // [!code ++]
					num8 += zSetting.multiZ; // [!code ++]
				} // [!code ++]
				orgZ += t.renderer.data.stackZ; // [!code ++]
				if (param.liquidLv > 0) // [!code ++]
				{ // [!code ++]
					param.liquidLv += pref.liquidMod; // [!code ++]
					if (param.liquidLv < 1) // [!code ++]
					{ // [!code ++]
						param.liquidLv = 1; // [!code ++]
					} // [!code ++]
					else if (param.liquidLv > 99 + pref.liquidModMax) // [!code ++]
					{ // [!code ++]
						param.liquidLv = 99 + pref.liquidModMax; // [!code ++]
					} // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (isInstalled && tileType.UseMountHeight) // [!code ++]
			{ // [!code ++]
				if (tileType != TileType.Illumination || !this.cell.HasObj) // [!code ++]
				{ // [!code ++]
					if (noRoofMode && currentRoom == null && t.altitude >= lowWallObjAltitude) // [!code ++]
					{ // [!code ++]
						continue; // [!code ++]
					} // [!code ++]
					if (hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code ++]
					{ // [!code ++]
						Room room = ((t.dir == 0) ? this.cell.Back.room : this.cell.Left.room); // [!code ++]
						if (t.trait.AlwaysHideOnLowWall) // [!code ++]
						{ // [!code ++]
							if (room == null || !room.data.showWallItem) // [!code ++]
							{ // [!code ++]
								continue; // [!code ++]
							} // [!code ++]
						} // [!code ++]
						else if (t.altitude >= lowWallObjAltitude) // [!code ++]
						{ // [!code ++]
							continue; // [!code ++]
						} // [!code ++]
					} // [!code ++]
				} // [!code ++]
				if (tileType.UseHangZFix) // [!code ++]
				{ // [!code ++]
					flag6 = true; // [!code ++]
				} // [!code ++]
				tileType.GetMountHeight(ref _actorPos, Point.shared.Set(index), t.dir, t); // [!code ++]
				shadow = false; // [!code ++]
				param.liquidLv = 0; // [!code ++]
				if (t.freePos) // [!code ++]
				{ // [!code ++]
					_actorPos.x += t.fx; // [!code ++]
					_actorPos.y += t.fy; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				if (t.altitude != 0) // [!code ++]
				{ // [!code ++]
					_actorPos += altitudeFix * t.altitude; // [!code ++]
					if (t.altitude > 2 && ((this.cell.Back.room != null && this.cell.Back.IsRoomEdge) || (this.cell.Left.room != null && this.cell.Left.IsRoomEdge)) && hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code ++]
					{ // [!code ++]
						continue; // [!code ++]
					} // [!code ++]
				} // [!code ++]
				if (t.freePos) // [!code ++]
				{ // [!code ++]
					_actorPos.x = orgX + t.fx - freePos.x; // [!code ++]
					_actorPos.y = orgY + t.fy - freePos.y; // [!code ++]
				} // [!code ++]
				if (t.trait is TraitDoor && (t.trait as TraitDoor).IsOpen()) // [!code ++]
				{ // [!code ++]
					_actorPos.z += -0.5f; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (!t.sourceCard.multisize || (t.pos.x == cx && t.pos.z == cz)) // [!code ++]
			{ // [!code ++]
				if (iconMode != 0) // [!code ++]
				{ // [!code ++]
					int num11 = 0; // [!code ++]
					switch (iconMode) // [!code ++]
					{ // [!code ++]
					case CardIconMode.Visibility: // [!code ++]
						if (t.isMasked) // [!code ++]
						{ // [!code ++]
							num11 = 17; // [!code ++]
						} // [!code ++]
						break; // [!code ++]
					case CardIconMode.State: // [!code ++]
						if (t.placeState == PlaceState.installed) // [!code ++]
						{ // [!code ++]
							num11 = 18; // [!code ++]
						} // [!code ++]
						break; // [!code ++]
					case CardIconMode.Deconstruct: // [!code ++]
						if (t.isDeconstructing) // [!code ++]
						{ // [!code ++]
							num11 = 14; // [!code ++]
						} // [!code ++]
						break; // [!code ++]
					} // [!code ++]
					if (t.isNPCProperty && !EMono.debug.godBuild) // [!code ++]
					{ // [!code ++]
						num11 = 13; // [!code ++]
					} // [!code ++]
					if (num11 != 0) // [!code ++]
					{ // [!code ++]
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num11); // [!code ++]
					} // [!code ++]
				} // [!code ++]
				t.SetRenderParam(param); // [!code ++]
				if (_lowblock && t.trait.UseLowblock && !this.cell.HasFullBlock) // [!code ++]
				{ // [!code ++]
					param.tile += ((param.tile < 0f) ? (-64) : 64); // [!code ++]
				} // [!code ++]
				if (t.trait is TraitTrolley && EMono.pc.ai is AI_Trolley aI_Trolley && aI_Trolley.trolley.owner == t) // [!code ++]
				{ // [!code ++]
					RenderParam _param = new RenderParam(param); // [!code ++]
					EMono.core.actionsLateUpdate.Add(delegate // [!code ++]
					{ // [!code ++]
						t.SetRenderParam(_param); // [!code ++]
						_actorPos.x = EMono.pc.renderer.position.x; // [!code ++]
						_actorPos.y = EMono.pc.renderer.position.y - pref.height; // [!code ++]
						_actorPos.z = EMono.pc.renderer.position.z + 0.02f; // [!code ++]
						t.renderer.Draw(_param, ref _actorPos, !t.noShadow && (shadow || tileType.AlwaysShowShadow)); // [!code ++]
					}); // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					t.renderer.Draw(param, ref _actorPos, !t.noShadow && (shadow || tileType.AlwaysShowShadow)); // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (isInstalled) // [!code ++]
			{ // [!code ++]
				num5 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
			} // [!code ++]
			param.x = orgX; // [!code ++]
			param.y = orgY; // [!code ++]
			param.z = orgZ; // [!code ++]
			param.color = floorLight; // [!code ++]
			thing = t; // [!code ++]
			if (pref.Float) // [!code ++]
			{ // [!code ++]
				liquidLv = 0; // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
	orgY += num6; // [!code ++]
	if (detail.charas.Count <= 0) // [!code ++]
	{ // [!code ++]
		return; // [!code ++]
	} // [!code ++]
	param.shadowFix = 0f - num7; // [!code ++]
	param.color += 1310720f; // [!code ++]
	float max = zSetting.max2; // [!code ++]
	for (int k = 0; k < detail.charas.Count; k++) // [!code ++]
	{ // [!code ++]
		Chara chara = detail.charas[k]; // [!code ++]
		if (chara.host != null || (chara != EMono.pc && chara != LayerDrama.alwaysVisible && (flag3 || fogged || (!showAllCards && !EMono.player.CanSee(chara))))) // [!code ++]
		{ // [!code ++]
			continue; // [!code ++]
		} // [!code ++]
		_actorPos.x = orgX; // [!code ++]
		_actorPos.y = orgY; // [!code ++]
		_actorPos.z = orgZ; // [!code ++]
		chara.SetRenderParam(param); // [!code ++]
		_ = chara.IsAliveInCurrentZone; // [!code ++]
		if (chara.isRestrained) // [!code ++]
		{ // [!code ++]
			TraitShackle restrainer = chara.GetRestrainer(); // [!code ++]
			if (restrainer != null) // [!code ++]
			{ // [!code ++]
				Vector3 getRestrainPos = restrainer.GetRestrainPos; // [!code ++]
				if (getRestrainPos != default(Vector3)) // [!code ++]
				{ // [!code ++]
					Vector3 position = restrainer.owner.renderer.position; // [!code ++]
					float defCharaHeight = EMono.setting.render.defCharaHeight; // [!code ++]
					float num12 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code ++]
					_actorPos.x = position.x + getRestrainPos.x * (float)((restrainer.owner.dir % 2 == 0) ? 1 : (-1)); // [!code ++]
					_actorPos.y = position.y + num12; // [!code ++]
					_actorPos.z = position.z + getRestrainPos.z; // [!code ++]
					param.liquidLv = 0; // [!code ++]
					param.shadowFix = orgY - _actorPos.y; // [!code ++]
					chara.renderer.SetFirst(first: true); // [!code ++]
					chara.renderer.Draw(param, ref _actorPos, drawShadow: true); // [!code ++]
					param.shadowFix = 0f; // [!code ++]
					continue; // [!code ++]
				} // [!code ++]
			} // [!code ++]
		} // [!code ++]
		if (!chara.sourceCard.multisize || (chara.pos.x == cx && chara.pos.z == cz)) // [!code ++]
		{ // [!code ++]
			if (chara.IsDeadOrSleeping && chara.IsPCC) // [!code ++]
			{ // [!code ++]
				float num13 = chara.renderer.data.size.y * 0.3f; // [!code ++]
				if (thingPos.y > max) // [!code ++]
				{ // [!code ++]
					thingPos.y = max; // [!code ++]
				} // [!code ++]
				float num14 = thingPos.y + num13; // [!code ++]
				float num15 = (float)k * -0.01f; // [!code ++]
				if (num14 > zSetting.thresh1) // [!code ++]
				{ // [!code ++]
					num15 = zSetting.mod1; // [!code ++]
				} // [!code ++]
				_actorPos.x += thingPos.x; // [!code ++]
				_actorPos.y += thingPos.y; // [!code ++]
				_actorPos.z += renderSetting.laydownZ + num15; // [!code ++]
				param.liquidLv = ((thingPos.y == 0f && liquidLv > 0) ? 90 : 0); // [!code ++]
				thingPos.y += num13 * 0.8f; // [!code ++]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				param.liquidLv = liquidLv; // [!code ++]
				if (param.liquidLv > 0) // [!code ++]
				{ // [!code ++]
					param.liquidLv += chara.Pref.liquidMod; // [!code ++]
					if (param.liquidLv < 1) // [!code ++]
					{ // [!code ++]
						param.liquidLv = 1; // [!code ++]
					} // [!code ++]
					else if (param.liquidLv > 99 + chara.Pref.liquidModMax) // [!code ++]
					{ // [!code ++]
						param.liquidLv = 99 + chara.Pref.liquidModMax; // [!code ++]
					} // [!code ++]
				} // [!code ++]
				if (!chara.IsPC && !chara.renderer.IsMoving && detail.charas.Count > 1 && (detail.charas.Count != 2 || !detail.charas[0].IsDeadOrSleeping || !detail.charas[0].IsPCC)) // [!code ++]
				{ // [!code ++]
					_actorPos += renderSetting.charaPos[1 + ((num3 < 4) ? num3 : 3)]; // [!code ++]
				} // [!code ++]
				_actorPos.z += 0.01f * (float)k + renderSetting.charaZ; // [!code ++]
				num3++; // [!code ++]
				if (flag6) // [!code ++]
				{ // [!code ++]
					_actorPos.z += chara.renderer.data.hangedFixZ; // [!code ++]
				} // [!code ++]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0); // [!code ++]
			} // [!code ++]
		} // [!code ++]
		param.x = orgX; // [!code ++]
		param.y = orgY; // [!code ++]
		param.z = orgZ; // [!code ++]
	} // [!code ++]
	return; // [!code ++]
	IL_6f1f: // [!code ++]
	int num16; // [!code ++]
	if (!showRoof || !roof || this.cell.room == null || this.cell.Front.room == null || this.cell.Right.room == null) // [!code ++]
	{ // [!code ++]
		param.tile = num16; // [!code ++]
		rendererFov.Draw(param); // [!code ++]
	} // [!code ++]
	goto IL_6f7f; // [!code ++]
	IL_6f7f:
	if (isSnowCovered && (sourceBlock.id != 0 || this.cell.hasDoor) && !snowed && !this.cell.isClearSnow && ((!this.cell.Front.HasRoof && !this.cell.Front.HasBlock) || (!this.cell.Right.HasRoof && !this.cell.Right.HasBlock)))
	{
```

[`@@ -1280,16 +1721,16 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1280-L1295)
```cs:line-numbers=1280
			{
				if (sourceEffect2.anime.Length > 2)
				{
					float num3 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code --]
					if (!(num3 >= (float)sourceEffect2.anime[0])) // [!code --]
					float num17 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code ++]
					if (!(num17 >= (float)sourceEffect2.anime[0])) // [!code ++]
					{
						param.tile += num3; // [!code --]
						param.tile += num17; // [!code ++]
					}
				}
				else
				{
					float num4 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code --]
					param.tile += num4; // [!code --]
					float num18 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code ++]
					param.tile += num18; // [!code ++]
				}
			}
			if (this.cell.effect.IsFire)
```

[`@@ -1389,6 +1830,11 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1389-L1394)
```cs:line-numbers=1389
			if (sourceObj.HasGrowth)
			{
				this.cell.growth.OnRenderTileMap(param);
				if (this.cell.obj == 118 && Core.fixedFrame % 10f == 0f && sourceObj.growth.IsMature) // [!code ++]
				{ // [!code ++]
					EMono.scene.psFey.transform.position = new Vector3(param.x, param.y, param.z - 2f); // [!code ++]
					EMono.scene.psFey.Emit(1); // [!code ++]
				} // [!code ++]
			}
			else
			{
```

[`@@ -1473,19 +1919,11 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1473-L1491)
```cs:line-numbers=1473
		param.matColor = 104025f;
		renderFootmark.Draw(param);
	}
	goto IL_7aaf; // [!code --]
	IL_6f1f: // [!code --]
	int num5; // [!code --]
	if (!showRoof || !roof || this.cell.room == null || this.cell.Front.room == null || this.cell.Right.room == null) // [!code --]
	{ // [!code --]
		param.tile = num5; // [!code --]
		rendererFov.Draw(param); // [!code --]
	} // [!code --]
	goto IL_6f7f; // [!code --]
	goto IL_7b3a; // [!code ++]
	IL_1668:
	if (this.cell.isSlopeEdge)
	{
		float num6 = (float)height * _heightMod.y; // [!code --]
		float num19 = (float)height * _heightMod.y; // [!code ++]
		orgY = param.y;
		orgZ = param.z;
		param.dir = this.cell.blockDir;
```

[`@@ -1515,17 +1953,17 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1515-L1531)
```cs:line-numbers=1515
				param.matColor = 104025f;
			}
		}
		for (int j = 0; (float)j < num6 / heightBlockSize; j++) // [!code --]
		for (int l = 0; (float)l < num19 / heightBlockSize; l++) // [!code ++]
		{
			param.y += ugFix.y;
			param.z += ugFix.z + slopeFixZ * (float)j; // [!code --]
			param.z += ugFix.z + slopeFixZ * (float)l; // [!code ++]
			defBlock.renderData.Draw(param);
			if (this.cell.pcSync && EMono.player.lightPower > 0f)
			{
				float num7 = param.tile; // [!code --]
				float num20 = param.tile; // [!code ++]
				param.tile = 0f;
				rendererFov.Draw(param);
				param.tile = num7; // [!code --]
				param.tile = num20; // [!code ++]
			}
		}
		param.y = orgY;
```

[`@@ -1536,29 +1974,29 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1536-L1564)
```cs:line-numbers=1536
	{
		orgY = param.y;
		orgZ = param.z;
		int num8 = 0; // [!code --]
		int num21 = 0; // [!code ++]
		if (sourceBlock.tileType.IsFullBlock)
		{
			SourceBlock.Row row3 = sourceBlock;
			num8 = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length]; // [!code --]
			num21 = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length]; // [!code ++]
		}
		else
		{
			SourceBlock.Row row3 = sourceFloor._defBlock;
			num8 = row3._tiles[this.cell.blockDir % row3._tiles.Length]; // [!code --]
			num21 = row3._tiles[this.cell.blockDir % row3._tiles.Length]; // [!code ++]
		}
		if (((this.cell.Front.shore / 12) & 1) == 0 && this.cell.Front.sourceFloor.tileType.IsWater && this.cell.Front.height <= height && this.cell.Front.sourceBlock.tileType.RenderWaterBlock)
		{
			param.y = (float)(cz - cx) * screen.tileAlign.y - (this.cell.Front.sourceFloor.tileType.IsDeepWater ? 0.6f : 0.4f) + (float)(int)this.cell.Front.height * _heightMod.y;
			param.z = 1000f + param.x * screen.tileWeight.x + param.y * screen.tileWeight.z;
			param.tile = num8 + ((!this.cell.Front.sourceFloor.tileType.IsDeepWater) ? 3000000 : 0); // [!code --]
			param.tile = num21 + ((!this.cell.Front.sourceFloor.tileType.IsDeepWater) ? 3000000 : 0); // [!code ++]
			rendererWaterBlock.Draw(param);
		}
		if (((this.cell.Right.shore / 12) & 8) == 0 && this.cell.Right.sourceFloor.tileType.IsWater && this.cell.Right.height <= height && this.cell.Right.sourceBlock.tileType.RenderWaterBlock)
		{
			param.y = (float)(cz - cx) * screen.tileAlign.y - (this.cell.Right.sourceFloor.tileType.IsDeepWater ? 0.6f : 0.4f) + (float)(int)this.cell.Right.height * _heightMod.y;
			param.z = 1000f + param.x * screen.tileWeight.x + param.y * screen.tileWeight.z;
			param.tile = num8 + ((!this.cell.Right.sourceFloor.tileType.IsDeepWater) ? 3000000 : 0); // [!code --]
			param.tile = num21 + ((!this.cell.Right.sourceFloor.tileType.IsDeepWater) ? 3000000 : 0); // [!code ++]
			rendererWaterBlock.Draw(param);
		}
		param.y = orgY;
```

[`@@ -1599,10 +2037,10 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1599-L1608)
```cs:line-numbers=1599
		{
			param.matColor = 104025f;
		}
		for (int k = 0; k < ((!this.cell.isSkyFloor) ? 1 : EMono._map.config.skyBlockHeight); k++) // [!code --]
		for (int m = 0; m < ((!this.cell.isSkyFloor) ? 1 : EMono._map.config.skyBlockHeight); m++) // [!code ++]
		{
			param.y += ugFix.y;
			param.z += ugFix.z + slopeFixZ * (float)k; // [!code --]
			param.z += ugFix.z + slopeFixZ * (float)m; // [!code ++]
			defBlock2.renderData.Draw(param);
		}
		param.y = orgY;
```

[`@@ -1656,20 +2094,20 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1656-L1675)
```cs:line-numbers=1656
				}
				sourceFloor.renderData.Draw(param);
			}
			int num9 = 0; // [!code --]
			int num22 = 0; // [!code ++]
			if (isSnowCovered && sourceFloor == FLOOR.sourceSnow && !this.cell.hasDoor)
			{
				if (!this.cell.Right.IsSnowTile && this.cell.Right.topHeight == this.cell.topHeight)
				{
					num9++; // [!code --]
					num22++; // [!code ++]
				}
				if (!this.cell.Front.IsSnowTile && this.cell.Front.topHeight == this.cell.topHeight)
				{
					num9 += 2; // [!code --]
					num22 += 2; // [!code ++]
				}
				if (num9 != 0) // [!code --]
				if (num22 != 0) // [!code ++]
				{
					param.tile = 448 + num9 + 12; // [!code --]
					param.tile = 448 + num22 + 12; // [!code ++]
					param.z -= 0.1f;
					sourceFloor.renderData.Draw(param);
					param.z += 0.1f;
```

[`@@ -1740,7 +2178,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1740-L1746)
```cs:line-numbers=1740
					}
				}
			}
			if (this.cell.autotile != 0 && sourceFloor.autotile != 0 && (!hasBridge || this.cell.bridgeHeight - this.cell.height > 3) && !this.cell.skipRender && num9 == 0) // [!code --]
			if (this.cell.autotile != 0 && sourceFloor.autotile != 0 && (!hasBridge || this.cell.bridgeHeight - this.cell.height > 3) && !this.cell.skipRender && num22 == 0) // [!code ++]
			{
				pass = (isWater ? passAutoTileWater : passAutoTile);
				batch = pass.batches[pass.batchIdx];
```

[`@@ -1759,16 +2197,16 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1759-L1774)
```cs:line-numbers=1759
		}
		if (isWater)
		{
			int num10 = 12; // [!code --]
			int num11 = this.cell.shore / num10; // [!code --]
			int num12 = this.cell.shore % num10; // [!code --]
			int num23 = 12; // [!code ++]
			int num24 = this.cell.shore / num23; // [!code ++]
			int num25 = this.cell.shore % num23; // [!code ++]
			bool isShoreSand = this.cell.isShoreSand;
			if (this.cell.shore != 0)
			{
				Cell cell = ((((uint)num11 & (true ? 1u : 0u)) != 0) ? this.cell.Back : ((((uint)num11 & 2u) != 0) ? this.cell.Right : ((((uint)num11 & 4u) != 0) ? this.cell.Front : this.cell.Left))); // [!code --]
				Cell cell = ((((uint)num24 & (true ? 1u : 0u)) != 0) ? this.cell.Back : ((((uint)num24 & 2u) != 0) ? this.cell.Right : ((((uint)num24 & 4u) != 0) ? this.cell.Front : this.cell.Left))); // [!code ++]
				if (isShoreSand && !cell.sourceFloor.isBeach)
				{
					cell = ((((uint)num11 & 8u) != 0) ? this.cell.Left : ((((uint)num11 & 4u) != 0) ? this.cell.Front : ((((uint)num11 & 2u) != 0) ? this.cell.Right : this.cell.Back))); // [!code --]
					cell = ((((uint)num24 & 8u) != 0) ? this.cell.Left : ((((uint)num24 & 4u) != 0) ? this.cell.Front : ((((uint)num24 & 2u) != 0) ? this.cell.Right : this.cell.Back))); // [!code ++]
				}
				if (!cell.IsSnowTile)
				{
```

[`@@ -1780,7 +2218,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1780-L1786)
```cs:line-numbers=1780
						batch.matrices[pass.idx].m03 = param.x;
						batch.matrices[pass.idx].m13 = param.y;
						batch.matrices[pass.idx].m23 = param.z;
						batch.tiles[pass.idx] = 768 + this.cell.shore / num10; // [!code --]
						batch.tiles[pass.idx] = 768 + this.cell.shore / num23; // [!code ++]
						batch.colors[pass.idx] = param.color;
						batch.matColors[pass.idx] = param.matColor;
						pass.idx++;
```

[`@@ -1788,38 +2226,38 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1788-L1825)
```cs:line-numbers=1788
						{
							pass.NextBatch();
						}
						num12 = 2; // [!code --]
						num25 = 2; // [!code ++]
					}
					else
					{
						num12 = cell.sourceFloor.edge; // [!code --]
						num25 = cell.sourceFloor.edge; // [!code ++]
					}
					param.tile = (24 + num12 / 2) * 32 + num12 % 2 * 16 + num11; // [!code --]
					param.tile = (24 + num25 / 2) * 32 + num25 % 2 * 16 + num24; // [!code ++]
					rendererShore.Draw(param);
				}
			}
			if (this.cell.Back.isShoreSand && ((uint)(this.cell.Back.shore / num10) & 8u) != 0 && this.cell.Left.isShoreSand && ((uint)(this.cell.Left.shore / num10) & (true ? 1u : 0u)) != 0) // [!code --]
			if (this.cell.Back.isShoreSand && ((uint)(this.cell.Back.shore / num23) & 8u) != 0 && this.cell.Left.isShoreSand && ((uint)(this.cell.Left.shore / num23) & (true ? 1u : 0u)) != 0) // [!code ++]
			{
				param.tile = 785f;
				param.matColor = GetColorInt(ref this.cell.BackLeft.matFloor.matColor, this.cell.BackLeft.sourceFloor.colorMod);
				passShore.Add(param);
				Draw(60);
			}
			if (this.cell.Back.isShoreSand && ((uint)(this.cell.Back.shore / num10) & 2u) != 0 && this.cell.Right.isShoreSand && ((uint)(this.cell.Right.shore / num10) & (true ? 1u : 0u)) != 0) // [!code --]
			if (this.cell.Back.isShoreSand && ((uint)(this.cell.Back.shore / num23) & 2u) != 0 && this.cell.Right.isShoreSand && ((uint)(this.cell.Right.shore / num23) & (true ? 1u : 0u)) != 0) // [!code ++]
			{
				param.tile = 786f;
				param.matColor = GetColorInt(ref this.cell.BackRight.matFloor.matColor, this.cell.BackRight.sourceFloor.colorMod);
				passShore.Add(param);
				Draw(56);
			}
			if (this.cell.Front.isShoreSand && ((uint)(this.cell.Front.shore / num10) & 2u) != 0 && this.cell.Right.isShoreSand && ((uint)(this.cell.Right.shore / num10) & 4u) != 0) // [!code --]
			if (this.cell.Front.isShoreSand && ((uint)(this.cell.Front.shore / num23) & 2u) != 0 && this.cell.Right.isShoreSand && ((uint)(this.cell.Right.shore / num23) & 4u) != 0) // [!code ++]
			{
				param.tile = 787f;
				param.matColor = GetColorInt(ref this.cell.FrontRight.matFloor.matColor, this.cell.FrontRight.sourceFloor.colorMod);
				passShore.Add(param);
				Draw(48);
			}
			if (this.cell.Front.isShoreSand && ((uint)(this.cell.Front.shore / num10) & 8u) != 0 && this.cell.Left.isShoreSand && ((uint)(this.cell.Left.shore / num10) & 4u) != 0) // [!code --]
			if (this.cell.Front.isShoreSand && ((uint)(this.cell.Front.shore / num23) & 8u) != 0 && this.cell.Left.isShoreSand && ((uint)(this.cell.Left.shore / num23) & 4u) != 0) // [!code ++]
			{
				param.tile = 788f;
				param.matColor = GetColorInt(ref this.cell.FrontLeft.matFloor.matColor, this.cell.FrontLeft.sourceFloor.colorMod);
```

[`@@ -1842,36 +2280,36 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1842-L1877)
```cs:line-numbers=1842
					pass.NextBatch();
				}
			}
			bool flag6 = false; // [!code --]
			bool flag8 = false; // [!code ++]
			if (isShoreSand)
			{
				if (((uint)num11 & (true ? 1u : 0u)) != 0) // [!code --]
				if (((uint)num24 & (true ? 1u : 0u)) != 0) // [!code ++]
				{
					if (((uint)num11 & 8u) != 0) // [!code --]
					if (((uint)num24 & 8u) != 0) // [!code ++]
					{
						Draw(16);
						flag6 = true; // [!code --]
						flag8 = true; // [!code ++]
					}
					if (((uint)num11 & 2u) != 0) // [!code --]
					if (((uint)num24 & 2u) != 0) // [!code ++]
					{
						Draw(20);
						flag6 = true; // [!code --]
						flag8 = true; // [!code ++]
					}
				}
				if (((uint)num11 & 4u) != 0) // [!code --]
				if (((uint)num24 & 4u) != 0) // [!code ++]
				{
					if (((uint)num11 & 8u) != 0) // [!code --]
					if (((uint)num24 & 8u) != 0) // [!code ++]
					{
						Draw(24);
						flag6 = true; // [!code --]
						flag8 = true; // [!code ++]
					}
					if (((uint)num11 & 2u) != 0) // [!code --]
					if (((uint)num24 & 2u) != 0) // [!code ++]
					{
						Draw(28);
						flag6 = true; // [!code --]
						flag8 = true; // [!code ++]
					}
				}
				if (!flag6) // [!code --]
				if (!flag8) // [!code ++]
				{
					if (!this.cell.Front.sourceFloor.tileType.IsWater && !this.cell.Front.isDeck)
					{
```

[`@@ -1883,7 +2321,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1883-L1889)
```cs:line-numbers=1883
					}
				}
			}
			if (!flag6) // [!code --]
			if (!flag8) // [!code ++]
			{
				if (!this.cell.Back.sourceFloor.tileType.IsWater && !this.cell.Back.isDeck)
				{
```

[`@@ -1891,7 +2329,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1891-L1897)
```cs:line-numbers=1891
					batch = pass.batches[pass.batchIdx];
					batch.tiles[pass.idx] = 608 + waterAnimeIndex % 4;
					batch.matColors[pass.idx] = 104025f;
					if (((uint)(this.cell.shore / num10) & (true ? 1u : 0u)) != 0) // [!code --]
					if (((uint)(this.cell.shore / num23) & (true ? 1u : 0u)) != 0) // [!code ++]
					{
						if (isShoreSand)
						{
```

[`@@ -1929,7 +2367,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L1929-L1935)
```cs:line-numbers=1929
					batch = pass.batches[pass.batchIdx];
					batch.tiles[pass.idx] = 612 + waterAnimeIndex % 4;
					batch.matColors[pass.idx] = 104025f;
					if (((uint)(this.cell.shore / num10) & 8u) != 0) // [!code --]
					if (((uint)(this.cell.shore / num23) & 8u) != 0) // [!code ++]
					{
						if (isShoreSand)
						{
```

[`@@ -2045,16 +2483,16 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2045-L2060)
```cs:line-numbers=2045
			param.z += bridgeFix.z;
			param.dir = 0;
			SourceBlock.Row row4 = sourceBridge._bridgeBlock;
			float num13 = (float)(this.cell.bridgeHeight - this.cell.height) * _heightMod.y; // [!code --]
			float num26 = (float)(this.cell.bridgeHeight - this.cell.height) * _heightMod.y; // [!code ++]
			if (this.cell.sourceFloor.tileType == TileType.Sky)
			{
				num13 += (float)EMono._map.config.skyBlockHeight; // [!code --]
				num26 += (float)EMono._map.config.skyBlockHeight; // [!code ++]
			}
			int num14 = (int)(num13 / heightBlockSize) + 2; // [!code --]
			int num27 = (int)(num26 / heightBlockSize) + 2; // [!code ++]
			if (this.cell.bridgePillar != 0)
			{
				row4 = EMono.sources.blocks.rows[this.cell.bridgePillar];
				param.tile = row4._tiles[0] + ((num14 == 2) ? 32 : 0); // [!code --]
				param.tile = row4._tiles[0] + ((num27 == 2) ? 32 : 0); // [!code ++]
				param.mat = ((sourceBridge.DefaultMaterial == row4.DefaultMaterial) ? sourceBridge.DefaultMaterial : row4.DefaultMaterial);
				param.matColor = ((row4.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, row4.colorMod));
			}
```

[`@@ -2066,9 +2504,9 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2066-L2074)
```cs:line-numbers=2066
			}
			param.y += ugFixBridgeTop.y;
			param.z += ugFixBridgeTop.z;
			for (int l = 0; l < num14; l++) // [!code --]
			for (int n = 0; n < num27; n++) // [!code ++]
			{
				if (l == num14 - 1) // [!code --]
				if (n == num27 - 1) // [!code ++]
				{
					param.y = (float)(cz - cx) * screen.tileAlign.y + (float)height * _heightMod.y + ugFixBridgeBottom.y;
					param.z = 1000f + param.x * screen.tileWeight.x + param.y * screen.tileWeight.z + (float)height * _heightMod.z + ugFixBridgeBottom.z;
```

[`@@ -2100,13 +2538,13 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2100-L2112)
```cs:line-numbers=2100
	{
		snowed = false;
	}
	num5 = 0; // [!code --]
	num16 = 0; // [!code ++]
	if (sourceBlock.id != 0)
	{
		this.tileType = sourceBlock.tileType;
		roomHeight = 0f;
		int blockDir = this.cell.blockDir;
		bool flag7 = false; // [!code --]
		bool flag9 = false; // [!code ++]
		switch (wallClipMode)
		{
		case WallClipMode.ByRoom:
```

[`@@ -2150,8 +2588,8 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2150-L2157)
```cs:line-numbers=2150
					}
				}
			}
			flag7 = (this.room != null && this.room.data.atrium) || (this.cell.room != null && this.cell.room.data.atrium); // [!code --]
			if (flag7) // [!code --]
			flag9 = (this.room != null && this.room.data.atrium) || (this.cell.room != null && this.cell.room.data.atrium); // [!code ++]
			if (flag9) // [!code ++]
			{
				_lowblock = false;
			}
```

[`@@ -2173,8 +2611,8 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2173-L2180)
```cs:line-numbers=2173
					roomHeight = 0f;
					break;
				}
				int num15 = ((this.room.data.maxHeight == 0) ? 2 : this.room.data.maxHeight); // [!code --]
				roomHeight = EMono.setting.render.roomHeightMod * (float)((this.room.lot.height < num15) ? this.room.lot.height : num15) + 0.01f * (float)this.room.lot.heightFix; // [!code --]
				int num28 = ((this.room.data.maxHeight == 0) ? 2 : this.room.data.maxHeight); // [!code ++]
				roomHeight = EMono.setting.render.roomHeightMod * (float)((this.room.lot.height < num28) ? this.room.lot.height : num28) + 0.01f * (float)this.room.lot.heightFix; // [!code ++]
			}
			break;
		case WallClipMode.ByLot:
```

[`@@ -2220,11 +2658,11 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2220-L2230)
```cs:line-numbers=2220
		}
		if (!_lowblock && (double)roomHeight > 1.2 && this.tileType.RepeatBlock)
		{
			num5 = 1; // [!code --]
			num16 = 1; // [!code ++]
		}
		else if (lowBlock)
		{
			num5 = 2; // [!code --]
			num16 = 2; // [!code ++]
		}
		param.mat = matBlock;
		param.dir = this.cell.blockDir;
```

[`@@ -2271,11 +2709,11 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2271-L2281)
```cs:line-numbers=2271
				}
				if (!_lowblock)
				{
					int num16 = ((currentRoom.data.maxHeight == 0) ? 2 : currentRoom.data.maxHeight); // [!code --]
					roomHeight = EMono.setting.render.roomHeightMod * (float)((currentRoom.lot.height < num16) ? currentRoom.lot.height : num16) + 0.01f * (float)currentRoom.lot.heightFix; // [!code --]
					int num29 = ((currentRoom.data.maxHeight == 0) ? 2 : currentRoom.data.maxHeight); // [!code ++]
					roomHeight = EMono.setting.render.roomHeightMod * (float)((currentRoom.lot.height < num29) ? currentRoom.lot.height : num29) + 0.01f * (float)currentRoom.lot.heightFix; // [!code ++]
				}
			}
			if (flag7) // [!code --]
			if (flag9) // [!code ++]
			{
				_lowblock = (!this.cell.Front.HasFullBlock || !this.cell.Right.HasFullBlock) && (!this.cell.Front.HasFullBlock || !this.cell.Left.HasFullBlock) && (!this.cell.Back.HasFullBlock || !this.cell.Right.HasFullBlock) && (!this.cell.Back.HasFullBlock || !this.cell.Left.HasFullBlock);
				if (_lowblock)
```

[`@@ -2305,62 +2743,62 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2305-L2366)
```cs:line-numbers=2305
			{
				sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFixBlock, this.cell.hasDoor, this.cell.effect?.FireAmount ?? 0, isBlock: true);
			}
			Room room = this.cell.Front.room ?? this.cell.room; // [!code --]
			if (room == null && this.cell.Right.room != null) // [!code --]
			Room room2 = this.cell.Front.room ?? this.cell.room; // [!code ++]
			if (room2 == null && this.cell.Right.room != null) // [!code ++]
			{
				room = this.cell.Right.room; // [!code --]
				room2 = this.cell.Right.room; // [!code ++]
			}
			if (!invisible && room != null) // [!code --]
			if (!invisible && room2 != null) // [!code ++]
			{
				if (room.lot.idDeco != 0 && !this.cell.hasDoor) // [!code --]
				if (room2.lot.idDeco != 0 && !this.cell.hasDoor) // [!code ++]
				{
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room.lot.idDeco); // [!code --]
					param.matColor = room.lot.colDeco; // [!code --]
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco); // [!code ++]
					param.matColor = room2.lot.colDeco; // [!code ++]
					float y = param.y;
					param.y += (float)room.lot.decoFix * 0.01f; // [!code --]
					param.y += (float)room2.lot.decoFix * 0.01f; // [!code ++]
					rendererWallDeco.Draw(param);
					param.y = y;
				}
				if (room.lot.idDeco2 != 0 && roomHeight != 0f && (float)room.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code --]
				if (room2.lot.idDeco2 != 0 && roomHeight != 0f && (float)room2.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code ++]
				{
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room.lot.idDeco2); // [!code --]
					param.matColor = room.lot.colDeco2; // [!code --]
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco2); // [!code ++]
					param.matColor = room2.lot.colDeco2; // [!code ++]
					float y2 = param.y;
					float num17 = param.z; // [!code --]
					param.y += (float)room.lot.decoFix2 * 0.01f; // [!code --]
					param.z += (float)room.lot.decoFix2 * 0.01f * heightModDeco; // [!code --]
					float num30 = param.z; // [!code ++]
					param.y += (float)room2.lot.decoFix2 * 0.01f; // [!code ++]
					param.z += (float)room2.lot.decoFix2 * 0.01f * heightModDeco; // [!code ++]
					rendererWallDeco.Draw(param);
					param.y = y2;
					param.z = num17; // [!code --]
					param.z = num30; // [!code ++]
				}
			}
			room = this.cell.Right.room ?? this.cell.room; // [!code --]
			if (room == null && this.cell.Front.room != null) // [!code --]
			room2 = this.cell.Right.room ?? this.cell.room; // [!code ++]
			if (room2 == null && this.cell.Front.room != null) // [!code ++]
			{
				room = this.cell.Front.room; // [!code --]
				room2 = this.cell.Front.room; // [!code ++]
			}
			if (!invisible && room != null) // [!code --]
			if (!invisible && room2 != null) // [!code ++]
			{
				if (room.lot.idDeco != 0 && !this.cell.hasDoor) // [!code --]
				if (room2.lot.idDeco != 0 && !this.cell.hasDoor) // [!code ++]
				{
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room.lot.idDeco) * -1; // [!code --]
					param.matColor = room.lot.colDeco; // [!code --]
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco) * -1; // [!code ++]
					param.matColor = room2.lot.colDeco; // [!code ++]
					float y3 = param.y;
					param.y += (float)room.lot.decoFix * 0.01f; // [!code --]
					param.y += (float)room2.lot.decoFix * 0.01f; // [!code ++]
					rendererWallDeco.Draw(param);
					param.y = y3;
				}
				if (room.lot.idDeco2 != 0 && roomHeight != 0f && (float)room.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code --]
				if (room2.lot.idDeco2 != 0 && roomHeight != 0f && (float)room2.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code ++]
				{
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room.lot.idDeco2) * -1; // [!code --]
					param.matColor = room.lot.colDeco2; // [!code --]
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco2) * -1; // [!code ++]
					param.matColor = room2.lot.colDeco2; // [!code ++]
					float y4 = param.y;
					float num18 = param.z; // [!code --]
					param.y += (float)room.lot.decoFix2 * 0.01f; // [!code --]
					param.z += (float)room.lot.decoFix2 * 0.01f * heightModDeco; // [!code --]
					float num31 = param.z; // [!code ++]
					param.y += (float)room2.lot.decoFix2 * 0.01f; // [!code ++]
					param.z += (float)room2.lot.decoFix2 * 0.01f * heightModDeco; // [!code ++]
					rendererWallDeco.Draw(param);
					param.y = y4;
					param.z = num18; // [!code --]
					param.z = num31; // [!code ++]
				}
			}
			break;
```

[`@@ -2375,198 +2813,69 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2375-L2572)
```cs:line-numbers=2375
			orgY = param.y;
			orgZ = param.z;
			param.color = (this.tileType.IsFence ? (floorLight - (float)((int)(_shadowStrength * 0.8f * 50f) * 262144)) : blockLight);
			bool flag8 = blockDir == 1 || _lowblock || flag7; // [!code --]
			bool flag9 = blockDir == 0 || _lowblock || flag7; // [!code --]
			bool flag10 = blockDir == 1 || _lowblock || flag9; // [!code ++]
			bool flag11 = blockDir == 0 || _lowblock || flag9; // [!code ++]
			if (!showFullWall && currentRoom != null)
			{
				if (!flag8) // [!code --]
				if (!flag10) // [!code ++]
				{
					if (currentRoom == this.cell.room || (this.cell.lotWall && this.cell.room?.lot == currentLot && this.cell.Front.room != currentRoom))
					{
						if (!this.cell.IsRoomEdge || (this.cell.Front.room != this.cell.room && this.cell.FrontRight.room != this.cell.room))
						{
							flag8 = true; // [!code --]
							flag10 = true; // [!code ++]
						}
					}
					else if ((!this.cell.Front.lotWall || this.cell.Front.room?.lot != currentLot) && this.cell.Front.room != currentRoom)
					{
						flag8 = true; // [!code --]
						flag10 = true; // [!code ++]
					}
				}
				if (!flag9) // [!code --]
				if (!flag11) // [!code ++]
				{
					if (currentRoom == this.cell.room || (this.cell.lotWall && this.cell.room?.lot == currentLot && this.cell.Right.room != currentRoom))
					{
						if (!this.cell.IsRoomEdge || (this.cell.Right.room != this.cell.room && this.cell.FrontRight.room != this.cell.room))
						{
							flag9 = true; // [!code --]
							flag11 = true; // [!code ++]
						}
					}
					else if ((!this.cell.Right.lotWall || this.cell.Right.room?.lot != currentLot) && this.cell.Right.room != currentRoom)
					{
						flag9 = true; // [!code --]
						flag11 = true; // [!code ++]
					}
				}
			}
			if (blockDir == 0 || blockDir == 2)
			{
				param.dir = 0;
				Room room2 = this.cell.Front.room ?? this.cell.room; // [!code --]
				if (room2 != null && this.tileType.IsWall) // [!code --]
				{ // [!code --]
					if (room2.lot.idDeco != 0 && !this.cell.hasDoor) // [!code --]
					{ // [!code --]
						param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco); // [!code --]
						param.matColor = room2.lot.colDeco; // [!code --]
						param.y += (float)room2.lot.decoFix * 0.01f; // [!code --]
						rendererWallDeco.Draw(param); // [!code --]
						param.y = orgY; // [!code --]
					} // [!code --]
					if (room2.lot.idDeco2 != 0 && roomHeight != 0f && !flag8 && (float)room2.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code --]
					{ // [!code --]
						param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco2); // [!code --]
						param.matColor = room2.lot.colDeco2; // [!code --]
						param.y += (float)room2.lot.decoFix2 * 0.01f; // [!code --]
						param.z += (float)room2.lot.decoFix2 * 0.01f * heightModDeco; // [!code --]
						rendererWallDeco.Draw(param); // [!code --]
						param.y = orgY; // [!code --]
						param.z = orgZ; // [!code --]
					} // [!code --]
				} // [!code --]
				Cell left = this.cell.Left; // [!code --]
				if (blockDir == 2 && left.sourceBlock.tileType.IsWallOrFence && !this.cell.crossWall) // [!code --]
				{ // [!code --]
					_sourceBlock = left.sourceBlock; // [!code --]
					param.mat = left.matBlock; // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					_sourceBlock = sourceBlock; // [!code --]
					param.mat = matBlock; // [!code --]
				} // [!code --]
				this.tileType = _sourceBlock.tileType; // [!code --]
				param.tile = (tile = _sourceBlock._tiles[0] + ((flag8 && !this.tileType.IsFence) ? 32 : 0)); // [!code --]
				if (_sourceBlock.useAltColor) // [!code --]
				{ // [!code --]
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, _sourceBlock.colorMod)); // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, _sourceBlock.colorMod)); // [!code --]
				} // [!code --]
				if (roomHeight == 0f || flag8 || !this.tileType.RepeatBlock) // [!code --]
				{ // [!code --]
					if (!this.cell.hasDoor) // [!code --]
					{ // [!code --]
						_sourceBlock.renderData.Draw(param); // [!code --]
					} // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix, this.cell.hasDoor, this.cell.effect?.FireAmount ?? 0); // [!code --]
				} // [!code --]
				param.z += cornerWallFix2.z; // [!code --]
				if ((blockDir == 2 || (this.cell.Front.HasWallOrFence && this.cell.Front.blockDir != 0)) != this.cell.isToggleWallPillar) // [!code --]
				{ // [!code --]
					if (this.cell.Back.IsSnowTile && this.cell.Right.IsSnowTile) // [!code --]
					{ // [!code --]
						param.snow = true; // [!code --]
					} // [!code --]
					param.tile = _sourceBlock._tiles[0] + ((flag8 && flag9 && !this.tileType.IsFence && !flag7) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code --]
					if (roomHeight == 0f || !this.tileType.RepeatBlock || (flag8 && flag9 && !flag7)) // [!code --]
					{ // [!code --]
						_sourceBlock.renderData.Draw(param); // [!code --]
					} // [!code --]
					else // [!code --]
					{ // [!code --]
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix); // [!code --]
					} // [!code --]
				} // [!code --]
				if (!flag8 && !showRoof && this.cell.Left.HasWallOrFence && this.cell.Left.blockDir != 0 && !this.cell.isToggleWallPillar) // [!code --]
				{ // [!code --]
					orgX = param.x; // [!code --]
					param.tile = _sourceBlock._tiles[0] + ((flag8 && !this.tileType.IsFence && !flag7) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code --]
					param.x += cornerWallFix3.x; // [!code --]
					param.y += cornerWallFix3.y; // [!code --]
					param.z += cornerWallFix3.z; // [!code --]
					if (!flag7 && (roomHeight == 0f || flag8)) // [!code --]
					{ // [!code --]
						_sourceBlock.renderData.Draw(param); // [!code --]
					} // [!code --]
					else // [!code --]
					{ // [!code --]
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight + cornerWallFix.y, ref renderSetting.peakFix); // [!code --]
					} // [!code --]
					param.x = orgX; // [!code --]
				} // [!code --]
				else if (this.cell.FrontLeft.HasWallOrFence && this.cell.FrontLeft.blockDir != 0 && (!flag8 || !this.cell.Left.HasWall) && !this.cell.isToggleWallPillar) // [!code --]
				{ // [!code --]
					orgX = param.x; // [!code --]
					param.tile = _sourceBlock._tiles[0] + ((flag8 && !this.tileType.IsFence && !flag7) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code --]
					param.x += cornerWallFix.x; // [!code --]
					param.y += cornerWallFix.y; // [!code --]
					param.z += cornerWallFix.z; // [!code --]
					if (!flag7 && (roomHeight == 0f || flag8)) // [!code --]
					{ // [!code --]
						_sourceBlock.renderData.Draw(param); // [!code --]
					} // [!code --]
					else // [!code --]
					{ // [!code --]
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight + cornerWallFix.y, ref renderSetting.peakFix); // [!code --]
					} // [!code --]
					param.x = orgX; // [!code --]
				} // [!code --]
			} // [!code --]
			if (blockDir == 1 || blockDir == 2) // [!code --]
			{ // [!code --]
				param.y = orgY; // [!code --]
				param.z = orgZ; // [!code --]
				param.dir = 1; // [!code --]
				Room room3 = this.cell.Right.room ?? this.cell.room; // [!code --]
				Room room3 = this.cell.Front.room ?? this.cell.room; // [!code ++]
				if (room3 != null && this.tileType.IsWall)
				{
					if (room3.lot.idDeco != 0 && !this.cell.hasDoor)
					{
						param.tile = -EMono.sources.blocks.rows[0].ConvertTile(1000 + room3.lot.idDeco); // [!code --]
						param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room3.lot.idDeco); // [!code ++]
						param.matColor = room3.lot.colDeco;
						param.y += (float)room3.lot.decoFix * 0.01f; // [!code --]
						rendererWallDeco.Draw(param); // [!code --]
						param.y = orgY; // [!code --]
					} // [!code --]
					if (room3.lot.idDeco2 != 0 && roomHeight != 0f && !flag9 && (float)room3.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code --]
					{ // [!code --]
						param.tile = -EMono.sources.blocks.rows[0].ConvertTile(1000 + room3.lot.idDeco2); // [!code --]
						param.matColor = room3.lot.colDeco2; // [!code --]
						param.y += (float)room3.lot.decoFix2 * 0.01f; // [!code --]
						param.z += (float)room3.lot.decoFix2 * 0.01f * heightModDeco; // [!code --]
						rendererWallDeco.Draw(param); // [!code --]
						param.y = orgY; // [!code --]
						param.z = orgZ; // [!code --]
					} // [!code --]
				} // [!code --]
				if (blockDir == 2 && this.cell.room == null && this.cell.Right.room != null) // [!code --]
				{ // [!code --]
					Room room4 = this.cell.Right.room; // [!code --]
					maxHeight = (float)(cz - cx) * screen.tileAlign.y + (float)room4.lot.mh * _heightMod.y; // [!code --]
					if (showRoof) // [!code --]
					{ // [!code --]
						roomHeight = room4.lot.realHeight; // [!code --]
					} // [!code --]
					else if ((noRoofMode && currentRoom == null) || (_lowblock && !this.tileType.ForceRpeatBlock)) // [!code --]
					{ // [!code --]
						roomHeight = 0f; // [!code --]
						param.y += (float)room3.lot.decoFix * 0.01f; // [!code ++]
						rendererWallDeco.Draw(param); // [!code ++]
						param.y = orgY; // [!code ++]
					}
					else // [!code --]
					if (room3.lot.idDeco2 != 0 && roomHeight != 0f && !flag10 && (float)room3.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code ++]
					{
						int num19 = ((room4.data.maxHeight == 0) ? 2 : room4.data.maxHeight); // [!code --]
						roomHeight = EMono.setting.render.roomHeightMod * (float)((room4.lot.height < num19) ? room4.lot.height : num19) + 0.01f * (float)room4.lot.heightFix; // [!code --]
						param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room3.lot.idDeco2); // [!code ++]
						param.matColor = room3.lot.colDeco2; // [!code ++]
						param.y += (float)room3.lot.decoFix2 * 0.01f; // [!code ++]
						param.z += (float)room3.lot.decoFix2 * 0.01f * heightModDeco; // [!code ++]
						rendererWallDeco.Draw(param); // [!code ++]
						param.y = orgY; // [!code ++]
						param.z = orgZ; // [!code ++]
					}
				}
				Cell back2 = this.cell.Back; // [!code --]
				if (blockDir == 2 && back2.sourceBlock.tileType.IsWallOrFence && !this.cell.crossWall) // [!code --]
				Cell left = this.cell.Left; // [!code ++]
				if (blockDir == 2 && left.sourceBlock.tileType.IsWallOrFence && !this.cell.crossWall) // [!code ++]
				{
					_sourceBlock = back2.sourceBlock; // [!code --]
					param.mat = back2.matBlock; // [!code --]
					_sourceBlock = left.sourceBlock; // [!code ++]
					param.mat = left.matBlock; // [!code ++]
				}
				else
				{
```

[`@@ -2574,7 +2883,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2574-L2580)
```cs:line-numbers=2574
					param.mat = matBlock;
				}
				this.tileType = _sourceBlock.tileType;
				param.tile = (tile = -_sourceBlock._tiles[0] + ((flag9 && !this.tileType.IsFence) ? (-32) : 0)); // [!code --]
				param.tile = (tile = _sourceBlock._tiles[0] + ((flag10 && !this.tileType.IsFence) ? 32 : 0)); // [!code ++]
				if (_sourceBlock.useAltColor)
				{
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, _sourceBlock.colorMod));
```

[`@@ -2583,8 +2892,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2583-L2590)
```cs:line-numbers=2583
				{
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, _sourceBlock.colorMod));
				}
				param.color += _rightWallShade; // [!code --]
				if (roomHeight == 0f || flag9 || !this.tileType.RepeatBlock) // [!code --]
				if (roomHeight == 0f || flag10 || !this.tileType.RepeatBlock) // [!code ++]
				{
					if (!this.cell.hasDoor)
					{
```

[`@@ -2595,15 +2903,15 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2595-L2609)
```cs:line-numbers=2595
				{
					_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix, this.cell.hasDoor, this.cell.effect?.FireAmount ?? 0);
				}
				if ((this.cell.Right.HasWallOrFence && this.cell.Right.blockDir != 1) != this.cell.isToggleWallPillar && (blockDir != 2 || !this.cell.isToggleWallPillar)) // [!code --]
				param.z += cornerWallFix2.z; // [!code ++]
				if ((blockDir == 2 || (this.cell.Front.HasWallOrFence && this.cell.Front.blockDir != 0)) != this.cell.isToggleWallPillar) // [!code ++]
				{
					if (this.cell.Left.IsSnowTile && this.cell.Front.IsSnowTile) // [!code --]
					if (this.cell.Back.IsSnowTile && this.cell.Right.IsSnowTile) // [!code ++]
					{
						param.snow = true;
					}
					orgX = param.x; // [!code --]
					param.tile = _sourceBlock._tiles[0] + ((flag9 && !this.tileType.IsFence && !flag7) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code --]
					if (!flag7 && (roomHeight == 0f || !this.tileType.RepeatBlock || flag9)) // [!code --]
					param.tile = _sourceBlock._tiles[0] + ((flag10 && flag11 && !this.tileType.IsFence && !flag9) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code ++]
					if (roomHeight == 0f || !this.tileType.RepeatBlock || (flag10 && flag11 && !flag9)) // [!code ++]
					{
						_sourceBlock.renderData.Draw(param);
					}
```

[`@@ -2611,505 +2919,203 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/BaseTileMap.cs#L2611-L3115)
```cs:line-numbers=2611
					{
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix);
					}
					param.x = orgX; // [!code --]
				} // [!code --]
			} // [!code --]
			param.y = orgY; // [!code --]
			param.z = orgZ; // [!code --]
			break; // [!code --]
		} // [!code --]
		case BlockRenderMode.HalfBlock: // [!code --]
			param.color = floorLight; // [!code --]
			_sourceBlock = ((sourceBlock.id == 5) ? EMono.sources.blocks.rows[matBlock.defBlock] : sourceBlock); // [!code --]
			param.tile = _sourceBlock._tiles[0]; // [!code --]
			param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, _sourceBlock.colorMod)); // [!code --]
			param.tile2 = _sourceBlock.sourceAutoFloor._tiles[0]; // [!code --]
			param.halfBlockColor = ((_sourceBlock.sourceAutoFloor.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, _sourceBlock.sourceAutoFloor.colorMod)); // [!code --]
			sourceBlock.renderData.Draw(param); // [!code --]
			break; // [!code --]
		case BlockRenderMode.Pillar: // [!code --]
		{ // [!code --]
			RenderData renderData2 = sourceBlock.renderData; // [!code --]
			param.tile = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length]; // [!code --]
			param.matColor = ((sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, sourceBlock.colorMod)); // [!code --]
			int num20 = this.cell.objDir + ((this.cell.objDir >= 7) ? this.cell.objDir : 0) + 1; // [!code --]
			if (num20 == 0) // [!code --]
			{ // [!code --]
				renderData2.Draw(param); // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				renderData2.DrawRepeat(param, num20, sourceBlock.tileType.RepeatSize); // [!code --]
			} // [!code --]
			param.tile = renderData2.idShadow; // [!code --]
			SourcePref shadowPref2 = renderData2.shadowPref; // [!code --]
			int shadow4 = shadowPref2.shadow; // [!code --]
			passShadow.AddShadow(param.x + renderData2.offsetShadow.x, param.y + renderData2.offsetShadow.y, param.z + renderData2.offsetShadow.z, ShadowData.Instance.items[shadow4], shadowPref2, 0, param.snow); // [!code --]
			break; // [!code --]
		} // [!code --]
		default: // [!code --]
			param.color = floorLight; // [!code --]
			param.tile = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length] + ((_lowblock && this.tileType.UseLowWallTiles) ? 3000000 : 0); // [!code --]
			param.matColor = ((sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, sourceBlock.colorMod)); // [!code --]
			if (roomHeight == 0f) // [!code --]
			{ // [!code --]
				sourceBlock.renderData.Draw(param); // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFixBlock); // [!code --]
			} // [!code --]
			break; // [!code --]
		} // [!code --]
	} // [!code --]
	if (this.cell.pcSync && EMono.player.lightPower > 0f && !cinemaMode) // [!code --]
	{ // [!code --]
		if (this.cell.room != null || !this.cell.IsRoomEdge || !showRoof) // [!code --]
		{ // [!code --]
			goto IL_6f1f; // [!code --]
		} // [!code --]
		if (this.cell._block == 0 || !this.cell.sourceBlock.tileType.RepeatBlock) // [!code --]
		{ // [!code --]
			Room obj = this.cell.FrontRight.room; // [!code --]
			if (obj == null || !obj.HasRoof) // [!code --]
			{ // [!code --]
				goto IL_6f1f; // [!code --]
			} // [!code --]
		} // [!code --]
	} // [!code --]
	goto IL_6f7f; // [!code --]
	IL_7aaf: // [!code --]
	if (detail.things.Count == 0 && detail.charas.Count == 0) // [!code --]
	{ // [!code --]
		return; // [!code --]
	} // [!code --]
	int num21 = 0; // [!code --]
	thingPos.x = 0f; // [!code --]
	thingPos.y = 0f; // [!code --]
	thingPos.z = 0f; // [!code --]
	freePos.x = (freePos.y = (freePos.z = 0f)); // [!code --]
	if (this.cell.HasRamp) // [!code --]
	{ // [!code --]
		Vector3 rampFix = sourceBlock.tileType.GetRampFix(this.cell.blockDir); // [!code --]
		param.x += rampFix.x; // [!code --]
		param.y += rampFix.y; // [!code --]
		param.z += rampFix.z; // [!code --]
		freePos.x += rampFix.x; // [!code --]
		freePos.y += rampFix.y; // [!code --]
		freePos.z += rampFix.z; // [!code --]
	} // [!code --]
	param.y += (flag ? 0f : ((this.cell._bridge != 0) ? this.cell.sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight)); // [!code --]
	orgPos.x = (orgX = param.x); // [!code --]
	orgPos.y = (orgY = param.y); // [!code --]
	orgPos.z = (orgZ = param.z); // [!code --]
	if (flag && liquidLv > 0) // [!code --]
	{ // [!code --]
		if (liquidLv > 10) // [!code --]
		{ // [!code --]
			liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code --]
		} // [!code --]
		liquidLv -= (int)(floatY * 0.5f); // [!code --]
		param.liquidLv = liquidLv; // [!code --]
		param.y -= TileType.FloorWaterShallow.FloorHeight; // [!code --]
	} // [!code --]
	Thing thing = null; // [!code --]
	bool shadow = liquidLv == 0; // [!code --]
	float num22 = 0f; // [!code --]
	float num23 = 0f; // [!code --]
	bool flag10 = false; // [!code --]
	float num24 = 0f; // [!code --]
	bool flag11 = false; // [!code --]
	float num25 = 0f; // [!code --]
	if (detail.things.Count > 0 && isSeen) // [!code --]
	{ // [!code --]
		_ = zSetting.max1; // [!code --]
		float num26 = 0f; // [!code --]
		for (int m = 0; m < detail.things.Count; m++) // [!code --]
		{ // [!code --]
			Thing t = detail.things[m]; // [!code --]
			if ((fogged && !t.isRoofItem) || ((t.isHidden || t.trait.HideInAdv || t.isMasked) && !EMono.scene.actionMode.ShowMaskedThings) || (t.isRoofItem && ((this.room == null && !sourceBlock.tileType.IsFullBlock && !EMono._zone.IsPCFaction) || (lowBlock && !showFullWall && this.room != null) || (noRoofMode && currentRoom == null))) || (flag3 && !t.isRoofItem)) // [!code --]
			{ // [!code --]
				continue; // [!code --]
			} // [!code --]
			TileType tileType = t.trait.tileType; // [!code --]
			bool isInstalled = t.IsInstalled; // [!code --]
			SourcePref pref = t.Pref; // [!code --]
			if (!isInstalled && t.category.tileDummy != 0) // [!code --]
			{ // [!code --]
				pref = rendererObjDummy.shadowPref; // [!code --]
			} // [!code --]
			float num27 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code --]
			if (t.ignoreStackHeight) // [!code --]
			{ // [!code --]
				thingPos.y -= num22; // [!code --]
			} // [!code --]
			shadow = thingPos.y < 0.16f && num25 < 0.16f; // [!code --]
			_ = pref.bypassShadow; // [!code --]
			param.shadowFix = 0f - thingPos.y; // [!code --]
			param.liquidLv = ((thingPos.y + (float)t.altitude < 0.1f) ? liquidLv : 0); // [!code --]
			if (t.isRoofItem) // [!code --]
			{ // [!code --]
				param.snow = isSnowCovered && !this.cell.isClearSnow; // [!code --]
				SetRoofHeight(param, this.cell, cx, cz); // [!code --]
				_actorPos.x = param.x; // [!code --]
				_actorPos.y = param.y; // [!code --]
				_actorPos.z = param.z + num26; // [!code --]
				if (this.room != null) // [!code --]
				{ // [!code --]
					param.color = GetRoofLight(this.room.lot); // [!code --]
				} // [!code --]
				shadow = false; // [!code --]
				param.liquidLv = 0; // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				param.snow = snowed; // [!code --]
				_actorPos.x = orgX + num23; // [!code --]
				_actorPos.y = orgY; // [!code --]
				_actorPos.z = orgZ + num26 + thingPos.z; // [!code --]
				if (tileType.CanStack || !isInstalled) // [!code --]
				{ // [!code --]
					if (thing?.id != t.id) // [!code --]
					{ // [!code --]
						_actorPos.x += thingPos.x; // [!code --]
					} // [!code --]
					_actorPos.y += thingPos.y; // [!code --]
					if (t.trait.IgnoreLastStackHeight && (thing == null || !thing.trait.IgnoreLastStackHeight)) // [!code --]
					{ // [!code --]
						thingPos.y -= num22; // [!code --]
						if (thing != null) // [!code --]
						{ // [!code --]
							_actorPos.z -= 0.2f; // [!code --]
							thingPos.z -= 0.2f; // [!code --]
						} // [!code --]
						_actorPos.y -= num22; // [!code --]
					} // [!code --]
					_actorPos.z += renderSetting.thingZ + (float)m * -0.01f + zSetting.mod1 * thingPos.y; // [!code --]
				}
				if (isInstalled) // [!code --]
				if (!flag10 && !showRoof && this.cell.Left.HasWallOrFence && this.cell.Left.blockDir != 0 && !this.cell.isToggleWallPillar) // [!code ++]
				{
					if (t.TileType.IsRamp) // [!code --]
					{ // [!code --]
						Vector3 rampFix2 = t.TileType.GetRampFix(t.dir); // [!code --]
						orgX += rampFix2.x; // [!code --]
						orgY += rampFix2.y; // [!code --]
						orgZ += rampFix2.z; // [!code --]
						freePos.x += rampFix2.x; // [!code --]
						freePos.y += rampFix2.y; // [!code --]
						freePos.z += rampFix2.z; // [!code --]
						if (!this.cell.IsTopWater || t.altitude > 0) // [!code --]
						{ // [!code --]
							num25 += rampFix2.y; // [!code --]
						} // [!code --]
						liquidLv -= (int)(rampFix2.y * 150f); // [!code --]
						if (liquidLv < 0) // [!code --]
						{ // [!code --]
							liquidLv = 0; // [!code --]
						} // [!code --]
					} // [!code --]
					else if (!flag11 && t.trait.IsChangeFloorHeight && !t.ignoreStackHeight) // [!code --]
					orgX = param.x; // [!code ++]
					param.tile = _sourceBlock._tiles[0] + ((flag10 && !this.tileType.IsFence && !flag9) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code ++]
					param.x += cornerWallFix3.x; // [!code ++]
					param.y += cornerWallFix3.y; // [!code ++]
					param.z += cornerWallFix3.z; // [!code ++]
					if (!flag9 && (roomHeight == 0f || flag10)) // [!code ++]
					{
						orgY += num27 + (float)t.altitude * altitudeFix.y; // [!code --]
						orgZ += (float)t.altitude * altitudeFix.z; // [!code --]
						freePos.y += num27 + (float)t.altitude * altitudeFix.y; // [!code --]
						if (!this.cell.IsTopWater || t.altitude > 0) // [!code --]
						{ // [!code --]
							num25 += num27 + (float)t.altitude * altitudeFix.y; // [!code --]
						} // [!code --]
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
						_actorPos.z += pref.z; // [!code --]
						thingPos.z += pref.z; // [!code --]
						liquidLv -= (int)(num27 * 150f); // [!code --]
						if (liquidLv < 0) // [!code --]
						{ // [!code --]
							liquidLv = 0; // [!code --]
						} // [!code --]
						_sourceBlock.renderData.Draw(param); // [!code ++]
					}
					else
					{
						thingPos.y += num27; // [!code --]
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
						_actorPos.z += pref.z; // [!code --]
						if (pref.height >= 0f) // [!code --]
						{ // [!code --]
							thingPos.z += pref.z; // [!code --]
						} // [!code --]
					} // [!code --]
					if (!tileType.UseMountHeight && m > 10) // [!code --]
					{ // [!code --]
						flag11 = true; // [!code --]
					} // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					thingPos.y += num27; // [!code --]
					_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
					_actorPos.z += pref.z; // [!code --]
					thingPos.z += pref.z; // [!code --]
				} // [!code --]
				if (t.isFloating && isWater && !hasBridge && !flag) // [!code --]
				{ // [!code --]
					flag = true; // [!code --]
					float num28 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code --]
					orgY += 0.01f * floatY - num28; // [!code --]
					num24 = num27; // [!code --]
					_actorPos.y += 0.01f * floatY - num28; // [!code --]
					if (liquidLv > 10) // [!code --]
					{ // [!code --]
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code --]
					} // [!code --]
					liquidLv -= (int)(floatY * 0.5f); // [!code --]
					if (liquidLv < 0) // [!code --]
					{ // [!code --]
						liquidLv = 0; // [!code --]
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight + cornerWallFix.y, ref renderSetting.peakFix); // [!code ++]
					}
					param.liquidLv = liquidLv; // [!code --]
				} // [!code --]
				num22 = num27; // [!code --]
				if (t.sourceCard.multisize && !t.trait.IsGround) // [!code --]
				{ // [!code --]
					num26 += zSetting.multiZ; // [!code --]
					param.x = orgX; // [!code ++]
				}
				orgZ += t.renderer.data.stackZ; // [!code --]
				if (param.liquidLv > 0) // [!code --]
				else if (this.cell.FrontLeft.HasWallOrFence && this.cell.FrontLeft.blockDir != 0 && (!flag10 || !this.cell.Left.HasWall) && !this.cell.isToggleWallPillar) // [!code ++]
				{
					param.liquidLv += pref.liquidMod; // [!code --]
					if (param.liquidLv < 1) // [!code --]
					orgX = param.x; // [!code ++]
					param.tile = _sourceBlock._tiles[0] + ((flag10 && !this.tileType.IsFence && !flag9) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code ++]
					param.x += cornerWallFix.x; // [!code ++]
					param.y += cornerWallFix.y; // [!code ++]
					param.z += cornerWallFix.z; // [!code ++]
					if (!flag9 && (roomHeight == 0f || flag10)) // [!code ++]
					{
						param.liquidLv = 1; // [!code --]
						_sourceBlock.renderData.Draw(param); // [!code ++]
					}
					else if (param.liquidLv > 99 + pref.liquidModMax) // [!code --]
					else // [!code ++]
					{
						param.liquidLv = 99 + pref.liquidModMax; // [!code --]
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight + cornerWallFix.y, ref renderSetting.peakFix); // [!code ++]
					}
					param.x = orgX; // [!code ++]
				}
			}
			if (isInstalled && tileType.UseMountHeight) // [!code --]
			if (blockDir == 1 || blockDir == 2) // [!code ++]
			{
				if (tileType != TileType.Illumination || !this.cell.HasObj) // [!code --]
				param.y = orgY; // [!code ++]
				param.z = orgZ; // [!code ++]
				param.dir = 1; // [!code ++]
				Room room4 = this.cell.Right.room ?? this.cell.room; // [!code ++]
				if (room4 != null && this.tileType.IsWall) // [!code ++]
				{
					if (noRoofMode && currentRoom == null && t.altitude >= lowWallObjAltitude) // [!code --]
					if (room4.lot.idDeco != 0 && !this.cell.hasDoor) // [!code ++]
					{
						continue; // [!code --]
						param.tile = -EMono.sources.blocks.rows[0].ConvertTile(1000 + room4.lot.idDeco); // [!code ++]
						param.matColor = room4.lot.colDeco; // [!code ++]
						param.y += (float)room4.lot.decoFix * 0.01f; // [!code ++]
						rendererWallDeco.Draw(param); // [!code ++]
						param.y = orgY; // [!code ++]
					}
					if (hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code --]
					if (room4.lot.idDeco2 != 0 && roomHeight != 0f && !flag11 && (float)room4.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code ++]
					{
						Room room5 = ((t.dir == 0) ? this.cell.Back.room : this.cell.Left.room); // [!code --]
						if (t.trait.AlwaysHideOnLowWall) // [!code --]
						{ // [!code --]
							if (room5 == null || !room5.data.showWallItem) // [!code --]
							{ // [!code --]
								continue; // [!code --]
							} // [!code --]
						} // [!code --]
						else if (t.altitude >= lowWallObjAltitude) // [!code --]
						{ // [!code --]
							continue; // [!code --]
						} // [!code --]
						param.tile = -EMono.sources.blocks.rows[0].ConvertTile(1000 + room4.lot.idDeco2); // [!code ++]
						param.matColor = room4.lot.colDeco2; // [!code ++]
						param.y += (float)room4.lot.decoFix2 * 0.01f; // [!code ++]
						param.z += (float)room4.lot.decoFix2 * 0.01f * heightModDeco; // [!code ++]
						rendererWallDeco.Draw(param); // [!code ++]
						param.y = orgY; // [!code ++]
						param.z = orgZ; // [!code ++]
					}
				}
				if (tileType.UseHangZFix) // [!code --]
				if (blockDir == 2 && this.cell.room == null && this.cell.Right.room != null) // [!code ++]
				{
					flag10 = true; // [!code --]
					Room room5 = this.cell.Right.room; // [!code ++]
					maxHeight = (float)(cz - cx) * screen.tileAlign.y + (float)room5.lot.mh * _heightMod.y; // [!code ++]
					if (showRoof) // [!code ++]
					{ // [!code ++]
						roomHeight = room5.lot.realHeight; // [!code ++]
					} // [!code ++]
					else if ((noRoofMode && currentRoom == null) || (_lowblock && !this.tileType.ForceRpeatBlock)) // [!code ++]
					{ // [!code ++]
						roomHeight = 0f; // [!code ++]
					} // [!code ++]
					else // [!code ++]
					{ // [!code ++]
						int num32 = ((room5.data.maxHeight == 0) ? 2 : room5.data.maxHeight); // [!code ++]
						roomHeight = EMono.setting.render.roomHeightMod * (float)((room5.lot.height < num32) ? room5.lot.height : num32) + 0.01f * (float)room5.lot.heightFix; // [!code ++]
					} // [!code ++]
				}
				tileType.GetMountHeight(ref _actorPos, Point.shared.Set(index), t.dir, t); // [!code --]
				shadow = false; // [!code --]
				param.liquidLv = 0; // [!code --]
				if (t.freePos) // [!code --]
				Cell back2 = this.cell.Back; // [!code ++]
				if (blockDir == 2 && back2.sourceBlock.tileType.IsWallOrFence && !this.cell.crossWall) // [!code ++]
				{
					_actorPos.x += t.fx; // [!code --]
					_actorPos.y += t.fy; // [!code --]
					_sourceBlock = back2.sourceBlock; // [!code ++]
					param.mat = back2.matBlock; // [!code ++]
				}
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				if (t.altitude != 0) // [!code --]
				else // [!code ++]
				{
					_actorPos += altitudeFix * t.altitude; // [!code --]
					if (t.altitude > 2 && ((this.cell.Back.room != null && this.cell.Back.IsRoomEdge) || (this.cell.Left.room != null && this.cell.Left.IsRoomEdge)) && hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code --]
					{ // [!code --]
						continue; // [!code --]
					} // [!code --]
					_sourceBlock = sourceBlock; // [!code ++]
					param.mat = matBlock; // [!code ++]
				}
				if (t.freePos) // [!code --]
				this.tileType = _sourceBlock.tileType; // [!code ++]
				param.tile = (tile = -_sourceBlock._tiles[0] + ((flag11 && !this.tileType.IsFence) ? (-32) : 0)); // [!code ++]
				if (_sourceBlock.useAltColor) // [!code ++]
				{
					_actorPos.x = orgX + t.fx - freePos.x; // [!code --]
					_actorPos.y = orgY + t.fy - freePos.y; // [!code --]
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, _sourceBlock.colorMod)); // [!code ++]
				}
				if (t.trait is TraitDoor && (t.trait as TraitDoor).IsOpen()) // [!code --]
				else // [!code ++]
				{
					_actorPos.z += -0.5f; // [!code --]
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, _sourceBlock.colorMod)); // [!code ++]
				}
			} // [!code --]
			if (!t.sourceCard.multisize || (t.pos.x == cx && t.pos.z == cz)) // [!code --]
			{ // [!code --]
				if (iconMode != 0) // [!code --]
				param.color += _rightWallShade; // [!code ++]
				if (roomHeight == 0f || flag11 || !this.tileType.RepeatBlock) // [!code ++]
				{
					int num29 = 0; // [!code --]
					switch (iconMode) // [!code --]
					{ // [!code --]
					case CardIconMode.Visibility: // [!code --]
						if (t.isMasked) // [!code --]
						{ // [!code --]
							num29 = 17; // [!code --]
						} // [!code --]
						break; // [!code --]
					case CardIconMode.State: // [!code --]
						if (t.placeState == PlaceState.installed) // [!code --]
						{ // [!code --]
							num29 = 18; // [!code --]
						} // [!code --]
						break; // [!code --]
					case CardIconMode.Deconstruct: // [!code --]
						if (t.isDeconstructing) // [!code --]
						{ // [!code --]
							num29 = 14; // [!code --]
						} // [!code --]
						break; // [!code --]
					} // [!code --]
					if (t.isNPCProperty && !EMono.debug.godBuild) // [!code --]
					{ // [!code --]
						num29 = 13; // [!code --]
					} // [!code --]
					if (num29 != 0) // [!code --]
					if (!this.cell.hasDoor) // [!code ++]
					{
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num29); // [!code --]
						_sourceBlock.renderData.Draw(param); // [!code ++]
					}
				}
				t.SetRenderParam(param); // [!code --]
				if (_lowblock && t.trait.UseLowblock && !this.cell.HasFullBlock) // [!code --]
				else // [!code ++]
				{
					param.tile += ((param.tile < 0f) ? (-64) : 64); // [!code --]
					_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix, this.cell.hasDoor, this.cell.effect?.FireAmount ?? 0); // [!code ++]
				}
				if (t.trait is TraitTrolley && EMono.pc.ai is AI_Trolley aI_Trolley && aI_Trolley.trolley.owner == t) // [!code --]
				if ((this.cell.Right.HasWallOrFence && this.cell.Right.blockDir != 1) != this.cell.isToggleWallPillar && (blockDir != 2 || !this.cell.isToggleWallPillar)) // [!code ++]
				{
					RenderParam _param = new RenderParam(param); // [!code --]
					EMono.core.actionsLateUpdate.Add(delegate // [!code --]
					if (this.cell.Left.IsSnowTile && this.cell.Front.IsSnowTile) // [!code ++]
					{
						t.SetRenderParam(_param); // [!code --]
						_actorPos.x = EMono.pc.renderer.position.x; // [!code --]
						_actorPos.y = EMono.pc.renderer.position.y - pref.height; // [!code --]
						_actorPos.z = EMono.pc.renderer.position.z + 0.02f; // [!code --]
						t.renderer.Draw(_param, ref _actorPos, !t.noShadow && (shadow || tileType.AlwaysShowShadow)); // [!code --]
					}); // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					t.renderer.Draw(param, ref _actorPos, !t.noShadow && (shadow || tileType.AlwaysShowShadow)); // [!code --]
						param.snow = true; // [!code ++]
					} // [!code ++]
					orgX = param.x; // [!code ++]
					param.tile = _sourceBlock._tiles[0] + ((flag11 && !this.tileType.IsFence && !flag9) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code ++]
					if (!flag9 && (roomHeight == 0f || !this.tileType.RepeatBlock || flag11)) // [!code ++]
					{ // [!code ++]
						_sourceBlock.renderData.Draw(param); // [!code ++]
					} // [!code ++]
					else // [!code ++]
					{ // [!code ++]
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix); // [!code ++]
					} // [!code ++]
					param.x = orgX; // [!code ++]
				}
			}
			if (isInstalled) // [!code --]
			{ // [!code --]
				num23 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
			} // [!code --]
			param.x = orgX; // [!code --]
			param.y = orgY;
			param.z = orgZ;
			break; // [!code ++]
		} // [!code ++]
		case BlockRenderMode.HalfBlock: // [!code ++]
			param.color = floorLight;
			thing = t; // [!code --]
			if (pref.Float) // [!code --]
			_sourceBlock = ((sourceBlock.id == 5) ? EMono.sources.blocks.rows[matBlock.defBlock] : sourceBlock); // [!code ++]
			param.tile = _sourceBlock._tiles[0]; // [!code ++]
			param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, _sourceBlock.colorMod)); // [!code ++]
			param.tile2 = _sourceBlock.sourceAutoFloor._tiles[0]; // [!code ++]
			param.halfBlockColor = ((_sourceBlock.sourceAutoFloor.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, _sourceBlock.sourceAutoFloor.colorMod)); // [!code ++]
			sourceBlock.renderData.Draw(param); // [!code ++]
			break; // [!code ++]
		case BlockRenderMode.Pillar: // [!code ++]
		{ // [!code ++]
			RenderData renderData2 = sourceBlock.renderData; // [!code ++]
			param.tile = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length]; // [!code ++]
			param.matColor = ((sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, sourceBlock.colorMod)); // [!code ++]
			int num33 = this.cell.objDir + ((this.cell.objDir >= 7) ? this.cell.objDir : 0) + 1; // [!code ++]
			if (num33 == 0) // [!code ++]
			{
				liquidLv = 0; // [!code --]
				renderData2.Draw(param); // [!code ++]
			}
		} // [!code --]
	} // [!code --]
	orgY += num24; // [!code --]
	if (detail.charas.Count <= 0) // [!code --]
	{ // [!code --]
		return; // [!code --]
	} // [!code --]
	param.shadowFix = 0f - num25; // [!code --]
	param.color += 1310720f; // [!code --]
	float max = zSetting.max2; // [!code --]
	for (int n = 0; n < detail.charas.Count; n++) // [!code --]
	{ // [!code --]
		Chara chara = detail.charas[n]; // [!code --]
		if (chara.host != null || (chara != EMono.pc && chara != LayerDrama.alwaysVisible && (flag3 || fogged || (!showAllCards && !EMono.player.CanSee(chara))))) // [!code --]
		{ // [!code --]
			continue; // [!code --]
		} // [!code --]
		_actorPos.x = orgX; // [!code --]
		_actorPos.y = orgY; // [!code --]
		_actorPos.z = orgZ; // [!code --]
		chara.SetRenderParam(param); // [!code --]
		_ = chara.IsAliveInCurrentZone; // [!code --]
		if (chara.isRestrained) // [!code --]
		{ // [!code --]
			TraitShackle restrainer = chara.GetRestrainer(); // [!code --]
			if (restrainer != null) // [!code --]
			else // [!code ++]
			{
				Vector3 getRestrainPos = restrainer.GetRestrainPos; // [!code --]
				if (getRestrainPos != default(Vector3)) // [!code --]
				{ // [!code --]
					Vector3 position = restrainer.owner.renderer.position; // [!code --]
					float defCharaHeight = EMono.setting.render.defCharaHeight; // [!code --]
					float num30 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code --]
					_actorPos.x = position.x + getRestrainPos.x * (float)((restrainer.owner.dir % 2 == 0) ? 1 : (-1)); // [!code --]
					_actorPos.y = position.y + num30; // [!code --]
					_actorPos.z = position.z + getRestrainPos.z; // [!code --]
					param.liquidLv = 0; // [!code --]
					param.shadowFix = orgY - _actorPos.y; // [!code --]
					chara.renderer.SetFirst(first: true); // [!code --]
					chara.renderer.Draw(param, ref _actorPos, drawShadow: true); // [!code --]
					param.shadowFix = 0f; // [!code --]
					continue; // [!code --]
				} // [!code --]
				renderData2.DrawRepeat(param, num33, sourceBlock.tileType.RepeatSize); // [!code ++]
			}
			param.tile = renderData2.idShadow; // [!code ++]
			SourcePref shadowPref2 = renderData2.shadowPref; // [!code ++]
			int shadow4 = shadowPref2.shadow; // [!code ++]
			passShadow.AddShadow(param.x + renderData2.offsetShadow.x, param.y + renderData2.offsetShadow.y, param.z + renderData2.offsetShadow.z, ShadowData.Instance.items[shadow4], shadowPref2, 0, param.snow); // [!code ++]
			break; // [!code ++]
		}
		if (!chara.sourceCard.multisize || (chara.pos.x == cx && chara.pos.z == cz)) // [!code --]
		{ // [!code --]
			if (chara.IsDeadOrSleeping && chara.IsPCC) // [!code --]
		default: // [!code ++]
			param.color = floorLight; // [!code ++]
			param.tile = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length] + ((_lowblock && this.tileType.UseLowWallTiles) ? 3000000 : 0); // [!code ++]
			param.matColor = ((sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, sourceBlock.colorMod)); // [!code ++]
			if (roomHeight == 0f) // [!code ++]
			{
				float num31 = chara.renderer.data.size.y * 0.3f; // [!code --]
				if (thingPos.y > max) // [!code --]
				{ // [!code --]
					thingPos.y = max; // [!code --]
				} // [!code --]
				float num32 = thingPos.y + num31; // [!code --]
				float num33 = (float)n * -0.01f; // [!code --]
				if (num32 > zSetting.thresh1) // [!code --]
				{ // [!code --]
					num33 = zSetting.mod1; // [!code --]
				} // [!code --]
				_actorPos.x += thingPos.x; // [!code --]
				_actorPos.y += thingPos.y; // [!code --]
				_actorPos.z += renderSetting.laydownZ + num33; // [!code --]
				param.liquidLv = ((thingPos.y == 0f && liquidLv > 0) ? 90 : 0); // [!code --]
				thingPos.y += num31 * 0.8f; // [!code --]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0); // [!code --]
				sourceBlock.renderData.Draw(param); // [!code ++]
			}
			else
			{
				param.liquidLv = liquidLv; // [!code --]
				if (param.liquidLv > 0) // [!code --]
				{ // [!code --]
					param.liquidLv += chara.Pref.liquidMod; // [!code --]
					if (param.liquidLv < 1) // [!code --]
					{ // [!code --]
						param.liquidLv = 1; // [!code --]
					} // [!code --]
					else if (param.liquidLv > 99 + chara.Pref.liquidModMax) // [!code --]
					{ // [!code --]
						param.liquidLv = 99 + chara.Pref.liquidModMax; // [!code --]
					} // [!code --]
				} // [!code --]
				if (!chara.IsPC && !chara.renderer.IsMoving && detail.charas.Count > 1 && (detail.charas.Count != 2 || !detail.charas[0].IsDeadOrSleeping || !detail.charas[0].IsPCC)) // [!code --]
				{ // [!code --]
					_actorPos += renderSetting.charaPos[1 + ((num21 < 4) ? num21 : 3)]; // [!code --]
				} // [!code --]
				_actorPos.z += 0.01f * (float)n + renderSetting.charaZ; // [!code --]
				num21++; // [!code --]
				if (flag10) // [!code --]
				{ // [!code --]
					_actorPos.z += chara.renderer.data.hangedFixZ; // [!code --]
				} // [!code --]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0); // [!code --]
				sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFixBlock); // [!code ++]
			}
			break; // [!code ++]
		}
		param.x = orgX; // [!code --]
		param.y = orgY; // [!code --]
		param.z = orgZ; // [!code --]
	}
	if (this.cell.pcSync && EMono.player.lightPower > 0f && !cinemaMode) // [!code ++]
	{ // [!code ++]
		if (this.cell.room != null || !this.cell.IsRoomEdge || !showRoof) // [!code ++]
		{ // [!code ++]
			goto IL_6f1f; // [!code ++]
		} // [!code ++]
		if (this.cell._block == 0 || !this.cell.sourceBlock.tileType.RepeatBlock) // [!code ++]
		{ // [!code ++]
			Room obj = this.cell.FrontRight.room; // [!code ++]
			if (obj == null || !obj.HasRoof) // [!code ++]
			{ // [!code ++]
				goto IL_6f1f; // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
	goto IL_6f7f; // [!code ++]
	void Draw(int tile)
	{
		pass = passEdge;
```

## ButtonGrid

[`@@ -508,6 +508,7 @@ public void SetIngredient(Recipe r, Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ButtonGrid.cs#L508-L513)
```cs:line-numbers=508
	int num = t.Num;
	mainText.text = num.ToString() ?? "";
	mainText.SetActive(enable: true);
	ing = null; // [!code ++]
	if (t.GetRootCard() != EClass.pc)
	{
		Attach("pcInv", rightAttach: false);
```

## Card

[`@@ -870,6 +870,18 @@ public bool isRestocking`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Card.cs#L870-L875)
```cs:line-numbers=870
		}
	}

	public bool isRuneAdded // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			return _bits2[8]; // [!code ++]
		} // [!code ++]
		set // [!code ++]
		{ // [!code ++]
			_bits2[8] = value; // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public bool isBackerContent => c_idBacker != 0;

	public SourceBacker.Row sourceBacker
```

[`@@ -3528,9 +3540,11 @@ public virtual void HealHP(int a, HealSource origin = HealSource.None)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Card.cs#L3528-L3536)
```cs:line-numbers=3528
	{
		hp = MaxHP;
	}
	Debug.Log(origin); // [!code ++]
	switch (origin)
	{
	case HealSource.Magic:
	case HealSource.Item: // [!code ++]
		PlaySound("heal");
		PlayEffect("heal");
		break;
```

[`@@ -6384,12 +6398,13 @@ public virtual int GetPrice(CurrencyType currency = CurrencyType.Money, bool sel`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Card.cs#L6384-L6395)
```cs:line-numbers=6384
	int num = ((priceType != PriceType.CopyShop) ? 1 : 5);
	float num2 = Mathf.Min(0.01f * (float)Evalue(752), 1f);
	float num3 = Mathf.Min(0.01f * (float)Evalue(751), 1f);
	float num4 = Mathf.Min(0.02f * (float)Evalue(759), 2f); // [!code ++]
	if (num3 > 0f)
	{
		num3 *= (float)num;
	}
	float num4 = Mathf.Clamp(1f + num2 + num3, 0.5f, 5f); // [!code --]
	p *= num4; // [!code --]
	float num5 = Mathf.Clamp(1f + num2 + num3, 0.5f, 5f) + num4; // [!code ++]
	p *= num5; // [!code ++]
	p *= 0.20000000298023224;
	if (sell)
	{
```

[`@@ -6472,11 +6487,11 @@ public virtual int GetPrice(CurrencyType currency = CurrencyType.Money, bool sel`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Card.cs#L6472-L6482)
```cs:line-numbers=6472
		}
		break;
	}
	float num5 = Math.Clamp(Mathf.Sqrt(c.EvalueMax(291) + ((!sell && EClass._zone.IsPCFaction) ? (EClass.Branch.Evalue(2800) * 2) : 0)), 0f, 25f); // [!code --]
	float num6 = Math.Clamp(Mathf.Sqrt(c.EvalueMax(291) + ((!sell && EClass._zone.IsPCFaction) ? (EClass.Branch.Evalue(2800) * 2) : 0)), 0f, 25f); // [!code ++]
	switch (priceType)
	{
	case PriceType.Tourism:
		num5 = 0f; // [!code --]
		num6 = 0f; // [!code ++]
		break;
	case PriceType.Shipping:
		if (sell)
```

[`@@ -6490,52 +6505,52 @@ public virtual int GetPrice(CurrencyType currency = CurrencyType.Money, bool sel`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Card.cs#L6490-L6541)
```cs:line-numbers=6490
		{
			break;
		}
		float num6 = 1.25f; // [!code --]
		float num7 = 1.25f; // [!code ++]
		if (EClass.Branch != null)
		{
			if (EClass.Branch.policies.IsActive(2817))
			{
				num6 += 0.1f + 0.01f * Mathf.Sqrt(EClass.Branch.Evalue(2817)); // [!code --]
				num7 += 0.1f + 0.01f * Mathf.Sqrt(EClass.Branch.Evalue(2817)); // [!code ++]
			}
			if (EClass.Branch.policies.IsActive(2816))
			{
				num6 += 0.2f + 0.02f * Mathf.Sqrt(EClass.Branch.Evalue(2816)); // [!code --]
				num7 += 0.2f + 0.02f * Mathf.Sqrt(EClass.Branch.Evalue(2816)); // [!code ++]
			}
			if (isChara)
			{
				if (EClass.Branch.policies.IsActive(2828))
				{
					num6 += 0.1f + 0.01f * Mathf.Sqrt(EClass.Branch.Evalue(2828)); // [!code --]
					num7 += 0.1f + 0.01f * Mathf.Sqrt(EClass.Branch.Evalue(2828)); // [!code ++]
				}
			}
			else if (category.IsChildOf("food") || category.IsChildOf("drink"))
			{
				if (EClass.Branch.policies.IsActive(2818))
				{
					num6 += 0.05f + 0.005f * Mathf.Sqrt(EClass.Branch.Evalue(2818)); // [!code --]
					num7 += 0.05f + 0.005f * Mathf.Sqrt(EClass.Branch.Evalue(2818)); // [!code ++]
				}
			}
			else if (category.IsChildOf("furniture"))
			{
				if (EClass.Branch.policies.IsActive(2819))
				{
					num6 += 0.05f + 0.005f * Mathf.Sqrt(EClass.Branch.Evalue(2819)); // [!code --]
					num7 += 0.05f + 0.005f * Mathf.Sqrt(EClass.Branch.Evalue(2819)); // [!code ++]
				}
			}
			else if (EClass.Branch.policies.IsActive(2820))
			{
				num6 += 0.05f + 0.005f * Mathf.Sqrt(EClass.Branch.Evalue(2820)); // [!code --]
				num7 += 0.05f + 0.005f * Mathf.Sqrt(EClass.Branch.Evalue(2820)); // [!code ++]
			}
		}
		p *= num6; // [!code --]
		p *= num7; // [!code ++]
		break;
	}
	}
	if ((uint)currency > 1u)
	{
		num5 = 0f; // [!code --]
		num6 = 0f; // [!code ++]
	}
	p *= (sell ? (1f + num5 * 0.02f) : (1f - num5 * 0.02f)); // [!code --]
	p *= (sell ? (1f + num6 * 0.02f) : (1f - num6 * 0.02f)); // [!code ++]
	if (sell)
	{
		p = EClass.curve((int)p, 10000, 10000, 80);
```

## Chara

[`@@ -1783,6 +1783,9 @@ public override void ApplyEditorTags(EditorTag tag)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Chara.cs#L1783-L1788)
```cs:line-numbers=1783
		bio.SetGender(1);
		base.c_idPortrait = Portrait.GetRandomPortrait(1, GetIdPortraitCat());
		break;
	case EditorTag.baby: // [!code ++]
		SetFeat(1232); // [!code ++]
		break; // [!code ++]
	}
	base.ApplyEditorTags(tag);
}
```

[`@@ -7022,6 +7025,15 @@ public bool TryUse(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Chara.cs#L7022-L7027)
```cs:line-numbers=7022
			});
			return true;
		}
		if (base.hp < MaxHP * 90 / 100) // [!code ++]
		{ // [!code ++]
			Action healAction = t.trait.GetHealAction(this); // [!code ++]
			if (healAction != null) // [!code ++]
			{ // [!code ++]
				healAction(); // [!code ++]
				return true; // [!code ++]
			} // [!code ++]
		} // [!code ++]
		return false;
	}

```

## Core

[`@@ -22,6 +22,8 @@ public class Core : BaseCore`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Core.cs#L22-L27)
```cs:line-numbers=22

	public static float gameDeltaNoPause;

	public static float fixedFrame; // [!code ++]
 // [!code ++]
	public static bool spiked;

	private static SourceElement sourceElement;
```

[`@@ -289,6 +291,11 @@ public void StartCase()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Core.cs#L289-L294)
```cs:line-numbers=289
		}
	}

	private void FixedUpdate() // [!code ++]
	{ // [!code ++]
		fixedFrame += 1f; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public void Update()
	{
		frame++;
```

## DOMAIN

[`@@ -2,42 +2,42 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/DOMAIN.cs#L2-L43)
```cs:line-numbers=2

public class DOMAIN
{
	public const int domArcane = 804; // [!code --]
 // [!code --]
	public const int domTest = 800; // [!code --]
 // [!code --]
	public const int domSurvival = 801; // [!code --]
	public const int domEyth = 814; // [!code ++]

	public const int domFaith = 802; // [!code --]
	public const int domHealing = 811; // [!code ++]

	public const int domMiracle = 803; // [!code --]
	public const int domOblivion = 813; // [!code ++]

	public const int domComm = 805; // [!code --]
	public const int domTest = 800; // [!code ++]

	public const int domEyth = 814; // [!code --]
	public const int domEarth = 812; // [!code ++]

	public const int domWind = 807; // [!code --]
	public const int domSurvival = 801; // [!code ++]

	public const int domHarvest = 808;

	public const int domMachine = 809; // [!code --]
	public const int domMiracle = 803; // [!code ++]

	public const int domLuck = 810;

	public const int domHealing = 811; // [!code --]
 // [!code --]
	public const int domOblivion = 813; // [!code --]
	public const int domMachine = 809; // [!code ++]

	public const int domEarth = 812; // [!code --]
	public const int domWind = 807; // [!code ++]

	public const int domElement = 806;

	public const int domComm = 805; // [!code ++]
 // [!code ++]
	public const int domFaith = 802; // [!code ++]
 // [!code ++]
	public const int domHarmony = 815;

	public const int domArcane = 804; // [!code ++]
 // [!code ++]
	public static readonly int[] IDS = new int[16]
	{
		804, 800, 801, 802, 803, 805, 814, 807, 808, 809, // [!code --]
		810, 811, 813, 812, 806, 815 // [!code --]
		814, 811, 813, 800, 812, 801, 808, 803, 810, 809, // [!code ++]
		807, 806, 805, 802, 815, 804 // [!code ++]
	};
}
public class Domain : EClass
```

## ELEMENT

[`@@ -5,27 +5,29 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ELEMENT.cs#L5-L31)
```cs:line-numbers=5

public class ELEMENT
{
	public const int hotspring = 756; // [!code --]
	public const int antidote = 753; // [!code ++]

	public const int blood = 755; // [!code --]
	public const int comfort = 750; // [!code ++]

	public const int nerve = 754;

	public const int antidote = 753; // [!code --]
	public const int blood = 755; // [!code ++]
 // [!code ++]
	public const int hotspring = 756; // [!code ++]
 // [!code ++]
	public const int purity = 759; // [!code ++]

	public const int cute = 752;

	public const int rare = 751;

	public const int comfort = 750; // [!code --]
 // [!code --]
	public const int _void = 0;

	public const int quality = 2; // [!code --]
	public const int d = 3; // [!code ++]

	public const int lv = 1;

	public const int d = 3; // [!code --]
	public const int quality = 2; // [!code ++]

	public const int socket = 5;

```

[`@@ -65,11 +67,12 @@ public class ELEMENT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ELEMENT.cs#L65-L75)
```cs:line-numbers=65

	public const int poison = 20;

	public static readonly int[] IDS = new int[30] // [!code --]
	public static readonly int[] IDS = new int[31] // [!code ++]
	{
		756, 755, 754, 753, 752, 751, 750, 0, 2, 1, // [!code --]
		3, 5, 10, 11, 12, 13, 14, 16, 17, 18, // [!code --]
		15, 21, 22, 23, 24, 25, 26, 29, 85, 20 // [!code --]
		753, 750, 754, 755, 756, 759, 752, 751, 0, 3, // [!code ++]
		1, 2, 5, 10, 11, 12, 13, 14, 16, 17, // [!code ++]
		18, 15, 21, 22, 23, 24, 25, 26, 29, 85, // [!code ++]
		20 // [!code ++]
	};
}
public class Element : EClass
```

## ENC

[`@@ -1,5 +1,7 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ENC.cs#L1-L5)
```cs:line-numbers=1
public class ENC
{
	public const int living = 653; // [!code ++]
 // [!code ++]
	public const int eco = 652;

	public const int r_PV = 651;
```

[`@@ -8,25 +10,21 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ENC.cs#L8-L32)
```cs:line-numbers=8

	public const int r_mana = 641;

	public const int r_life = 640; // [!code --]
	public const int mod_frustration = 624; // [!code ++]

	public const int mod_flurry = 621;

	public const int mod_chaser = 620; // [!code --]
 // [!code --]
	public const int mod_feint = 623; // [!code --]
 // [!code --]
	public const int mod_cleave = 622;

	public const int living = 653; // [!code --]
 // [!code --]
	public const int mod_frustration = 624; // [!code --]
	public const int mod_feint = 623; // [!code ++]

	public const int noDamage = 654;

	public const int convertFire = 850; // [!code --]
	public const int r_life = 640; // [!code ++]

	public const int permaCurse = 656; // [!code --]
	public const int onlyPet = 655; // [!code ++]
 // [!code ++]
	public const int convertCold = 851; // [!code ++]

	public const int absorbHP = 660;

```

[`@@ -42,21 +40,23 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ENC.cs#L42-L62)
```cs:line-numbers=42

	public const int meleeDistance = 666;

	public const int convertCold = 851; // [!code --]
	public const int convertFire = 850; // [!code ++]

	public const int mod_splash = 608; // [!code --]
	public const int mod_chaser = 620; // [!code ++]

	public const int convertImpact = 865;

	public const int convertLightning = 852;

	public const int onlyPet = 655; // [!code --]
	public const int permaCurse = 656; // [!code ++]

	public const int mod_scatter = 607; // [!code --]
	public const int mod_splash = 608; // [!code ++]

	public const int bane_fairy = 462; // [!code --]
	public const int throwReturn = 410; // [!code ++]

	public const int mod_precision = 605; // [!code --]
	public const int mod_drill = 606; // [!code ++]
 // [!code ++]
	public const int sustain_STR = 440; // [!code ++]

	public const int breathing = 429;

```

[`@@ -86,13 +86,11 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ENC.cs#L86-L98)
```cs:line-numbers=86

	public const int encSpell = 411;

	public const int throwReturn = 410; // [!code --]
 // [!code --]
	public const int corruption = 409;

	public const int resWeather = 408;

	public const int travelSpeed = 407; // [!code --]
	public const int mod_scatter = 607; // [!code ++]

	public const int resMutation = 406;

```

[`@@ -108,13 +106,15 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ENC.cs#L108-L120)
```cs:line-numbers=108

	public const int negateTeleport = 400;

	public const int sustain_STR = 440; // [!code --]
 // [!code --]
	public const int sustain_END = 441;

	public const int mod_drill = 606; // [!code --]
	public const int sustain_DEX = 442; // [!code ++]

	public const int optimizeMana = 483; // [!code --]
	public const int travelSpeed = 407; // [!code ++]
 // [!code ++]
	public const int mod_ammo = 600; // [!code ++]
 // [!code ++]
	public const int mod_precision = 605; // [!code ++]

	public const int mod_ammo_recover = 604;

```

[`@@ -124,7 +124,7 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ENC.cs#L124-L130)
```cs:line-numbers=124

	public const int mod_reload = 601;

	public const int mod_ammo = 600; // [!code --]
	public const int optimizeMana = 483; // [!code ++]

	public const int force_weapon = 482;

```

[`@@ -134,15 +134,15 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ENC.cs#L134-L148)
```cs:line-numbers=134

	public const int bane_all = 468;

	public const int bane_fish = 467; // [!code --]
 // [!code --]
	public const int bane_god = 466;

	public const int bane_machine = 465; // [!code ++]
 // [!code ++]
	public const int bane_man = 464;

	public const int bane_animal = 463; // [!code --]
	public const int bane_fish = 467; // [!code ++]

	public const int bane_machine = 465; // [!code --]
	public const int bane_fairy = 462; // [!code ++]

	public const int bane_undead = 461;

```

[`@@ -152,23 +152,23 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ENC.cs#L152-L174)
```cs:line-numbers=152

	public const int sustain_MAG = 446;

	public const int bane_animal = 463; // [!code ++]
 // [!code ++]
	public const int sustain_WIL = 445;

	public const int sustain_LER = 444;

	public const int sustain_PER = 443;

	public const int sustain_DEX = 442; // [!code --]
 // [!code --]
	public static readonly int[] IDS = new int[80]
	{
		652, 651, 650, 641, 640, 621, 620, 623, 622, 653, // [!code --]
		624, 654, 850, 656, 660, 661, 662, 663, 664, 665, // [!code --]
		666, 851, 608, 865, 852, 655, 607, 462, 605, 429, // [!code --]
		653, 652, 651, 650, 641, 624, 621, 622, 623, 654, // [!code ++]
		640, 655, 851, 660, 661, 662, 663, 664, 665, 666, // [!code ++]
		850, 620, 865, 852, 656, 608, 410, 606, 440, 429, // [!code ++]
		428, 427, 426, 425, 424, 423, 422, 421, 420, 416,
		415, 412, 411, 410, 409, 408, 407, 406, 405, 404, // [!code --]
		403, 402, 401, 400, 440, 441, 606, 483, 604, 603, // [!code --]
		602, 601, 600, 482, 481, 480, 468, 467, 466, 464, // [!code --]
		463, 465, 461, 460, 447, 446, 445, 444, 443, 442 // [!code --]
		415, 412, 411, 409, 408, 607, 406, 405, 404, 403, // [!code ++]
		402, 401, 400, 441, 442, 407, 600, 605, 604, 603, // [!code ++]
		602, 601, 483, 482, 481, 480, 468, 466, 465, 464, // [!code ++]
		467, 462, 461, 460, 447, 446, 463, 445, 444, 443 // [!code ++]
	};
}
```

## EditorTag

[`@@ -14,6 +14,7 @@ public enum EditorTag`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/EditorTag.cs#L14-L19)
```cs:line-numbers=14
InvulnerableToMobs = 51,
Male = 60,
Female = 61,
baby = 65, // [!code ++]
NoSnow = 70,
TreasureMelilith = 110,
Boss = 120,
```

## ElementContainer

[`@@ -637,6 +637,11 @@ public List<Element> ListLearnable(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/ElementContainer.cs#L637-L642)
```cs:line-numbers=637
		return list;
	}

	public List<Element> ListRune() // [!code ++]
	{ // [!code ++]
		return ListElements((Element a) => !a.source.encSlot.IsEmpty()); // [!code ++]
	} // [!code ++]
 // [!code ++]
	public void CopyTo(ElementContainer container)
	{
		container.dict.Clear();
```

## FACTION

[`@@ -4,31 +4,31 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FACTION.cs#L4-L34)
```cs:line-numbers=4

public class FACTION
{
	public const int bfCave = 3500; // [!code --]
 // [!code --]
	public const int bfPlain = 3600;

	public const int bfForest = 3601;

	public const int bfRuin = 3702; // [!code --]
 // [!code --]
	public const int bfGeyser = 3701; // [!code --]
 // [!code --]
	public const int bfSnow = 3602;

	public const int bfRuin = 3702; // [!code ++]
 // [!code ++]
	public const int bfHill = 3603;

	public const int bfFertile = 3700; // [!code ++]
 // [!code ++]
	public const int bfSea = 3605;

	public const int bfBeach = 3604;

	public const int fRation = 2207; // [!code --]
	public const int bfCave = 3500; // [!code ++]

	public const int bfFertile = 3700; // [!code --]
	public const int bfGeyser = 3701; // [!code ++]

	public const int fAttraction = 2206; // [!code --]
	public const int fRation = 2207; // [!code ++]

	public const int fTaxEvasion = 2119; // [!code --]
	public const int actBuildCollect = 4004; // [!code ++]
 // [!code ++]
	public const int fSafety = 2205; // [!code ++]

	public const int fFood = 2204;

```

[`@@ -38,41 +38,37 @@ public class FACTION`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FACTION.cs#L38-L78)
```cs:line-numbers=38

	public const int fElec = 2201;

	public const int fLuck = 2118; // [!code --]
 // [!code --]
	public const int fConstruction = 2003; // [!code --]
 // [!code --]
	public const int bfTranquil = 3703;

	public const int fSoil = 2200; // [!code ++]
 // [!code ++]
	public const int fHeirloom = 2120;

	public const int fAdmin = 2115; // [!code --]
	public const int fTaxEvasion = 2119; // [!code ++]

	public const int fEducation = 2116; // [!code --]
	public const int fLuck = 2118; // [!code ++]

	public const int fLoyal = 2117;

	public const int fSafety = 2205; // [!code --]
 // [!code --]
	public const int fSoil = 2200; // [!code --]
	public const int fAttraction = 2206; // [!code ++]

	public const int bfVolcano = 3704;

	public const int bfFish = 3706; // [!code --]
	public const int bfCoal = 3800; // [!code ++]

	public const int actBuildInspect = 4006; // [!code --]
	public const int bfFish = 3706; // [!code ++]

	public const int actBuildRecipe = 4005;

	public const int actBuildCollect = 4004; // [!code --]
 // [!code --]
	public const int actBuildAnywhere = 4003; // [!code --]
	public const int actBuildInspect = 4006; // [!code ++]

	public const int actBuildTerrain = 4002;

	public const int actBuildMine = 4001;

	public const int bfHunt = 3705; // [!code --]
	public const int fEducation = 2116; // [!code ++]
 // [!code ++]
	public const int actBuildCut = 4000; // [!code ++]

	public const int bfStart = 3900;

```

[`@@ -82,40 +78,44 @@ public class FACTION`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FACTION.cs#L82-L121)
```cs:line-numbers=82

	public const int bfGum = 3803;

	public const int actBuildCut = 4000; // [!code --]
 // [!code --]
	public const int bfMushroom = 3801; // [!code --]
	public const int bfHunt = 3705; // [!code ++]

	public const int bfSilica = 3802;

	public const int bfFreshAir = 3708; // [!code --]
	public const int actBuildAnywhere = 4003; // [!code ++]

	public const int bfBasin = 3709; // [!code --]
	public const int bfLandmark5 = 3784; // [!code ++]

	public const int bfBreed = 3710; // [!code --]
	public const int bfLandmark4 = 3783; // [!code ++]
 // [!code ++]
	public const int bfLandmark3 = 3782; // [!code ++]
 // [!code ++]
	public const int bfLandmark2 = 3781; // [!code ++]

	public const int bfLandmark1 = 3780;

	public const int bfMonster = 3707; // [!code --]
	public const int bfBreed = 3710; // [!code ++]

	public const int bfLandmark3 = 3782; // [!code --]
	public const int bfBasin = 3709; // [!code ++]

	public const int bfLandmark4 = 3783; // [!code --]
	public const int bfFreshAir = 3708; // [!code ++]

	public const int bfLandmark5 = 3784; // [!code --]
	public const int bfMonster = 3707; // [!code ++]

	public const int bfCoal = 3800; // [!code --]
	public const int bfMushroom = 3801; // [!code ++]

	public const int bfLandmark2 = 3781; // [!code --]
	public const int fAdmin = 2115; // [!code ++]
 // [!code ++]
	public const int fConstruction = 2003; // [!code ++]

	public static readonly int[] IDS = new int[52]
	{
		3500, 3600, 3601, 3702, 3701, 3602, 3603, 3605, 3604, 2207, // [!code --]
		3700, 2206, 2119, 2204, 2203, 2202, 2201, 2118, 2003, 3703, // [!code --]
		2120, 2115, 2116, 2117, 2205, 2200, 3704, 3706, 4006, 4005, // [!code --]
		4004, 4003, 4002, 4001, 3705, 3900, 3805, 3804, 3803, 4000, // [!code --]
		3801, 3802, 3708, 3709, 3710, 3780, 3707, 3782, 3783, 3784, // [!code --]
		3800, 3781 // [!code --]
		3600, 3601, 3602, 3702, 3603, 3700, 3605, 3604, 3500, 3701, // [!code ++]
		2207, 4004, 2205, 2204, 2203, 2202, 2201, 3703, 2200, 2120, // [!code ++]
		2119, 2118, 2117, 2206, 3704, 3800, 3706, 4005, 4006, 4002, // [!code ++]
		4001, 2116, 4000, 3900, 3805, 3804, 3803, 3705, 3802, 4003, // [!code ++]
		3784, 3783, 3782, 3781, 3780, 3710, 3709, 3708, 3707, 3801, // [!code ++]
		2115, 2003 // [!code ++]
	};
}
public class Faction : EClass
```

## FEAT

[`@@ -3,15 +3,33 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FEAT.cs#L3-L17)
```cs:line-numbers=3

public class FEAT
{
	public const int featUndead = 1210; // [!code ++]
 // [!code ++]
	public const int featMartial = 1635; // [!code ++]
 // [!code ++]
	public const int featNegotiate = 1634; // [!code ++]
 // [!code ++]
	public const int featSpotting = 1633; // [!code ++]
 // [!code ++]
	public const int featEvade = 1632; // [!code ++]
 // [!code ++]
	public const int featDefense = 1631; // [!code ++]
 // [!code ++]
	public const int featHardy = 1630; // [!code ++]
 // [!code ++]
	public const int featSPD = 1629; // [!code ++]
 // [!code ++]
	public const int featLuck = 1628; // [!code ++]
 // [!code ++]
	public const int featCHA = 1627;

	public const int featWIL = 1626;

	public const int featMAG = 1625;

	public const int featLER = 1624; // [!code --]
	public const int featFaith = 1636; // [!code ++]

	public const int featPER = 1623; // [!code --]
	public const int featLER = 1624; // [!code ++]

	public const int featEND = 1622;

```

[`@@ -23,7 +41,7 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FEAT.cs#L23-L29)
```cs:line-numbers=23

	public const int featMana = 1611;

	public const int featEarthStrength = 1411; // [!code --]
	public const int featLife = 1610; // [!code ++]

	public const int featManaMeat = 1421;

```

[`@@ -35,33 +53,39 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FEAT.cs#L35-L67)
```cs:line-numbers=35

	public const int featWitch = 1417;

	public const int featInquisitor = 1416; // [!code --]
	public const int featPER = 1623; // [!code ++]

	public const int featFoxMaid = 1415; // [!code --]
	public const int featAnimalLover = 1640; // [!code ++]

	public const int featWhiteVixen = 1414; // [!code --]
	public const int featResCurse = 1641; // [!code ++]

	public const int featFairysan = 1413; // [!code --]
	public const int featSleeper = 1642; // [!code ++]

	public const int featLuckyCat = 1412; // [!code --]
	public const int featFluffyTail = 1209; // [!code ++]

	public const int featLuck = 1628; // [!code --]
	public const int featSlowFood = 1200; // [!code ++]

	public const int featLife = 1610; // [!code --]
	public const int featManaBond = 1201; // [!code ++]

	public const int featSPD = 1629; // [!code --]
	public const int featFastLearner = 1202; // [!code ++]

	public const int featParty = 1645; // [!code --]
	public const int featGrowParts = 1203; // [!code ++]

	public const int featDefense = 1631; // [!code --]
	public const int featFairyWeak = 1204; // [!code ++]

	public const int featReboot = 1410; // [!code --]
	public const int featCannibalism = 1205; // [!code ++]
 // [!code ++]
	public const int featMelilithCurse = 1206; // [!code ++]
 // [!code ++]
	public const int featFoxBless = 1207; // [!code ++]
 // [!code ++]
	public const int featFoxLearn = 1208; // [!code ++]

	public const int featChef = 1658;

	public const int featManaCost = 1657;

	public const int featScavenger = 1656; // [!code --]
	public const int featModelBeliever = 1655; // [!code ++]

	public const int featHeavyCasting = 1654;

```

[`@@ -81,56 +105,24 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FEAT.cs#L81-L136)
```cs:line-numbers=81

	public const int featLonelySoul = 1646;

	public const int featParty = 1645; // [!code ++]
 // [!code ++]
	public const int featBodyParts = 1644;

	public const int featSorter = 1643;

	public const int featSleeper = 1642; // [!code --]
 // [!code --]
	public const int featResCurse = 1641; // [!code --]
 // [!code --]
	public const int featAnimalLover = 1640; // [!code --]
 // [!code --]
	public const int featFaith = 1636; // [!code --]
 // [!code --]
	public const int featMartial = 1635; // [!code --]
 // [!code --]
	public const int featNegotiate = 1634; // [!code --]
 // [!code --]
	public const int featSpotting = 1633; // [!code --]
 // [!code --]
	public const int featEvade = 1632; // [!code --]
 // [!code --]
	public const int featHardy = 1630; // [!code --]
 // [!code --]
	public const int featBoost = 1409; // [!code --]
 // [!code --]
	public const int featModelBeliever = 1655; // [!code --]
 // [!code --]
	public const int featPaladin = 1407; // [!code --]
 // [!code --]
	public const int featShiva = 1224; // [!code --]
 // [!code --]
	public const int featLoyal = 1225; // [!code --]
 // [!code --]
	public const int featUnderground = 1226; // [!code --]
 // [!code --]
	public const int featServant = 1227; // [!code --]
 // [!code --]
	public const int featDemigod = 1228; // [!code --]
 // [!code --]
	public const int featLittleOne = 1229; // [!code --]
 // [!code --]
	public const int featAdam = 1230; // [!code --]
	public const int featInquisitor = 1416; // [!code ++]

	public const int featBaby = 1232; // [!code --]
	public const int featFoxMaid = 1415; // [!code ++]

	public const int featCosmicHorror = 1233; // [!code --]
	public const int featScavenger = 1656; // [!code ++]

	public const int featAcidBody = 1223; // [!code --]
	public const int featFairysan = 1413; // [!code ++]

	public const int featHeavyEater = 1234;

	public const int featLightEater = 1235; // [!code ++]
 // [!code ++]
	public const int featNorland = 1236;

	public const int featRoran = 1237;
```

[`@@ -139,8 +131,6 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FEAT.cs#L139-L146)
```cs:line-numbers=139

	public const int featGod_element1 = 1300;

	public const int featGod_earth1 = 1305; // [!code --]
 // [!code --]
	public const int featGod_wind1 = 1310;

	public const int featGod_machine1 = 1315;
```

[`@@ -149,39 +139,33 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FEAT.cs#L149-L187)
```cs:line-numbers=149

	public const int featGod_harvest1 = 1325;

	public const int featLightEater = 1235; // [!code --]
 // [!code --]
	public const int featSplit = 1222; // [!code --]
 // [!code --]
	public const int featSpike = 1221; // [!code --]
 // [!code --]
	public const int featFate = 1220; // [!code --]
	public const int featGod_luck1 = 1330; // [!code ++]

	public const int featPaladin2 = 1408; // [!code --]
	public const int featGod_harmony1 = 1335; // [!code ++]

	public const int featSlowFood = 1200; // [!code --]
	public const int featGod_oblivion1 = 1340; // [!code ++]

	public const int featManaBond = 1201; // [!code --]
	public const int featGod_trickery1 = 1345; // [!code ++]

	public const int featFastLearner = 1202; // [!code --]
	public const int featGod_moonshadow1 = 1350; // [!code ++]

	public const int featGrowParts = 1203; // [!code --]
	public const int featGod_strife1 = 1355; // [!code ++]

	public const int featFairyWeak = 1204; // [!code --]
	public const int featWarrior = 1400; // [!code ++]

	public const int featCannibalism = 1205; // [!code --]
	public const int featThief = 1401; // [!code ++]

	public const int featMelilithCurse = 1206; // [!code --]
	public const int featWizard = 1402; // [!code ++]

	public const int featFoxBless = 1207; // [!code --]
	public const int featCosmicHorror = 1233; // [!code ++]

	public const int featFoxLearn = 1208; // [!code --]
	public const int featBaby = 1232; // [!code ++]

	public const int featFluffyTail = 1209; // [!code --]
	public const int featNirvana = 1231; // [!code ++]

	public const int featUndead = 1210; // [!code --]
	public const int featAdam = 1230; // [!code ++]

	public const int featSnail = 1211; // [!code --]
	public const int featWhiteVixen = 1414; // [!code ++]

	public const int featFairyResist = 1212;

```

[`@@ -199,48 +183,64 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FEAT.cs#L199-L246)
```cs:line-numbers=199

	public const int featElderCrab = 1219;

	public const int featGod_luck1 = 1330; // [!code --]
	public const int featFarmer = 1403; // [!code ++]

	public const int featGod_harmony1 = 1335; // [!code --]
	public const int featFate = 1220; // [!code ++]

	public const int featNirvana = 1231; // [!code --]
	public const int featSplit = 1222; // [!code ++]

	public const int featGod_trickery1 = 1345; // [!code --]
	public const int featSnail = 1211; // [!code ++]

	public const int featGod_oblivion1 = 1340; // [!code --]
	public const int featAcidBody = 1223; // [!code ++]

	public const int featGod_moonshadow1 = 1350; // [!code --]
	public const int featShiva = 1224; // [!code ++]

	public const int featGod_strife1 = 1355; // [!code --]
	public const int featLoyal = 1225; // [!code ++]

	public const int featWarrior = 1400; // [!code --]
	public const int featUnderground = 1226; // [!code ++]

	public const int featWizard = 1402; // [!code --]
	public const int featServant = 1227; // [!code ++]

	public const int featFarmer = 1403; // [!code --]
	public const int featDemigod = 1228; // [!code ++]
 // [!code ++]
	public const int featLittleOne = 1229; // [!code ++]
 // [!code ++]
	public const int featSpike = 1221; // [!code ++]

	public const int featArcher = 1404;

	public const int featGod_earth1 = 1305; // [!code ++]
 // [!code ++]
	public const int featTourist = 1406; // [!code ++]
 // [!code ++]
	public const int featPianist = 1405;

	public const int featThief = 1401; // [!code --]
	public const int featPaladin2 = 1408; // [!code ++]

	public const int featTourist = 1406; // [!code --]
	public const int featReboot = 1410; // [!code ++]
 // [!code ++]
	public const int featEarthStrength = 1411; // [!code ++]
 // [!code ++]
	public const int featBoost = 1409; // [!code ++]
 // [!code ++]
	public const int featLuckyCat = 1412; // [!code ++]
 // [!code ++]
	public const int featPaladin = 1407; // [!code ++]

	public static readonly int[] IDS = new int[112]
	{
		1627, 1626, 1625, 1624, 1623, 1622, 1621, 1620, 1612, 1611, // [!code --]
		1411, 1421, 1420, 1419, 1418, 1417, 1416, 1415, 1414, 1413, // [!code --]
		1412, 1628, 1610, 1629, 1645, 1631, 1410, 1658, 1657, 1656, // [!code --]
		1654, 1653, 1652, 1651, 1650, 1649, 1648, 1647, 1646, 1644, // [!code --]
		1643, 1642, 1641, 1640, 1636, 1635, 1634, 1633, 1632, 1630, // [!code --]
		1409, 1655, 1407, 1224, 1225, 1226, 1227, 1228, 1229, 1230, // [!code --]
		1232, 1233, 1223, 1234, 1236, 1237, 1238, 1300, 1305, 1310, // [!code --]
		1315, 1320, 1325, 1235, 1222, 1221, 1220, 1408, 1200, 1201, // [!code --]
		1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211, // [!code --]
		1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1330, 1335, // [!code --]
		1231, 1345, 1340, 1350, 1355, 1400, 1402, 1403, 1404, 1405, // [!code --]
		1401, 1406 // [!code --]
		1210, 1635, 1634, 1633, 1632, 1631, 1630, 1629, 1628, 1627, // [!code ++]
		1626, 1625, 1636, 1624, 1622, 1621, 1620, 1612, 1611, 1610, // [!code ++]
		1421, 1420, 1419, 1418, 1417, 1623, 1640, 1641, 1642, 1209, // [!code ++]
		1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1658, // [!code ++]
		1657, 1655, 1654, 1653, 1652, 1651, 1650, 1649, 1648, 1647, // [!code ++]
		1646, 1645, 1644, 1643, 1416, 1415, 1656, 1413, 1234, 1235, // [!code ++]
		1236, 1237, 1238, 1300, 1310, 1315, 1320, 1325, 1330, 1335, // [!code ++]
		1340, 1345, 1350, 1355, 1400, 1401, 1402, 1233, 1232, 1231, // [!code ++]
		1230, 1414, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, // [!code ++]
		1403, 1220, 1222, 1211, 1223, 1224, 1225, 1226, 1227, 1228, // [!code ++]
		1229, 1221, 1404, 1305, 1406, 1405, 1408, 1410, 1411, 1409, // [!code ++]
		1412, 1407 // [!code ++]
	};
}
public class Feat : Element
```

## FOOD

[`@@ -1,22 +1,22 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/FOOD.cs#L1-L22)
```cs:line-numbers=1
public class FOOD
{
	public const int food_CHA = 700; // [!code --]
 // [!code --]
	public const int food_cat = 701; // [!code --]
	public const int gainWeight = 705; // [!code ++]

	public const int food_god = 758; // [!code --]
	public const int food_bug = 704; // [!code ++]

	public const int justcooked = 757; // [!code --]
	public const int food_love = 703; // [!code ++]

	public const int food_poison = 702;

	public const int gainWeight = 705; // [!code --]
	public const int food_cat = 701; // [!code ++]

	public const int food_bug = 704; // [!code --]
	public const int justcooked = 757; // [!code ++]

	public const int food_love = 703; // [!code --]
	public const int food_god = 758; // [!code ++]

	public const int loseWeight = 706;

	public static readonly int[] IDS = new int[9] { 700, 701, 758, 757, 702, 705, 704, 703, 706 }; // [!code --]
	public const int food_CHA = 700; // [!code ++]
 // [!code ++]
	public static readonly int[] IDS = new int[9] { 705, 704, 703, 702, 701, 757, 758, 706, 700 }; // [!code ++]
}
```

## GameDate

[`@@ -281,7 +281,12 @@ public void ShipGoods()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/GameDate.cs#L281-L287)
```cs:line-numbers=281
	{
		return;
	}
	num2 = (shippingResult.hearthExpGained = num2 / 2 + 1); // [!code --]
	num2 = num2 / 2 + 1; // [!code ++]
	if (zone.branch.policies.IsActive(2515)) // [!code ++]
	{ // [!code ++]
		num2 = 0; // [!code ++]
	} // [!code ++]
	shippingResult.hearthExpGained = num2; // [!code ++]
	EClass.pc.homeBranch.log.Add(Msg.Say("shipped_collect"));
	foreach (string item in list2)
	{
```

## GrowSystemTreeCoralwood

[`@@ -20,6 +20,12 @@ public override bool BlockSight(Cell cell)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/GrowSystemTreeCoralwood.cs#L20-L25)
```cs:line-numbers=20
	public override void OnSetObj()
	{
		GrowSystem.cell.isObjDyed = true;
		GrowSystem.cell.objDir = EClass.rnd(source.tiles.Length); // [!code ++]
		GrowSystem.cell.objMat = (byte)EClass.sources.materials.rows.Where((SourceMaterial.Row r) => r.tag.Contains("coral")).RandomItem().id;
	}
 // [!code ++]
	public override int GetStageTile() // [!code ++]
	{ // [!code ++]
		return source._tiles[GrowSystem.cell.objDir % source._tiles.Length]; // [!code ++]
	} // [!code ++]
}
```

## HealSource

[`@@ -2,5 +2,6 @@ public enum HealSource`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/HealSource.cs#L2-L6)
```cs:line-numbers=2
{
	None,
	Magic,
	HOT // [!code --]
	HOT, // [!code ++]
	Item // [!code ++]
}
```

## InvOwnerMod

[`@@ -6,9 +6,9 @@ public class InvOwnerMod : InvOwnerDraglet`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/InvOwnerMod.cs#L6-L14)
```cs:line-numbers=6

	public static bool IsValidRuneMod(Thing t, SourceElement.Row row, string idMat)
	{
		if (idMat == "adamantite") // [!code --]
		if (t.category.slot != 0 && !t.isRuneAdded && !t.HasElement(row.id)) // [!code ++]
		{
			return t.category.slot == 35; // [!code --]
			return !t.IsUnique; // [!code ++]
		}
		return false;
	}
```

[`@@ -41,8 +41,9 @@ public override bool ShouldShowGuide(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/InvOwnerMod.cs#L41-L48)
```cs:line-numbers=41
		{
			return false;
		}
		return true; // [!code ++]
	}
	else if (!IsValidRangedMod(t, traitMod.source)) // [!code --]
	if (!IsValidRangedMod(t, traitMod.source)) // [!code ++]
	{
		return false;
	}
```

[`@@ -61,9 +62,19 @@ public override bool ShouldShowGuide(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/InvOwnerMod.cs#L61-L69)
```cs:line-numbers=61

	public override void _OnProcess(Thing t)
	{
		SE.Play("reloaded"); // [!code --]
		EClass.pc.PlayEffect("identify"); // [!code --]
		Msg.Say("modded", t, owner);
		t.ApplySocket(owner.Thing); // [!code --]
		if (owner.trait is TraitRune) // [!code ++]
		{ // [!code ++]
			SE.Play("intonation"); // [!code ++]
			EClass.pc.PlayEffect("intonation"); // [!code ++]
			t.elements.ModBase(owner.refVal, owner.encLV); // [!code ++]
			t.isRuneAdded = true; // [!code ++]
		} // [!code ++]
		else // [!code ++]
		{ // [!code ++]
			SE.Play("reloaded"); // [!code ++]
			EClass.pc.PlayEffect("identify"); // [!code ++]
			t.ApplySocket(owner.Thing); // [!code ++]
		} // [!code ++]
	}
}
```

## MUTATION

[`@@ -1,32 +1,40 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/MUTATION.cs#L1-L32)
```cs:line-numbers=1
public class MUTATION
{
	public const int mutationRegen = 1516; // [!code --]
	public const int mutationSpeedN = 1519; // [!code ++]

	public const int etherManaBattery = 1564; // [!code --]
	public const int mutationSpeed = 1518; // [!code ++]

	public const int mutationSkin = 1510; // [!code --]
	public const int mutationRegenN = 1517; // [!code ++]
 // [!code ++]
	public const int mutationRegen = 1516; // [!code ++]

	public const int mutationSkinN = 1511;

	public const int mutationDex = 1514; // [!code ++]
 // [!code ++]
	public const int mutationEye = 1512;

	public const int mutationEyeN = 1513; // [!code --]
	public const int mutationSkin = 1510; // [!code ++]

	public const int mutationDex = 1514; // [!code --]
	public const int mutationStr = 1520; // [!code ++]

	public const int mutationDexN = 1515;

	public const int mutationRegenN = 1517; // [!code --]
	public const int mutationStrN = 1521; // [!code ++]
 // [!code ++]
	public const int mutationEyeN = 1513; // [!code ++]
 // [!code ++]
	public const int mutationChaN = 1523; // [!code ++]

	public const int etherPoisonHand = 1565;

	public const int mutationSpeedN = 1519; // [!code --]
	public const int mutationCha = 1522; // [!code ++]

	public const int etherProvoke = 1563;

	public const int etherArmor = 1562;

	public const int mutationSpeed = 1518; // [!code --]
	public const int etherStupid = 1561; // [!code ++]

	public const int etherWeak = 1560;

```

[`@@ -42,46 +50,38 @@ public class MUTATION`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/MUTATION.cs#L42-L87)
```cs:line-numbers=42

	public const int etherWing = 1554;

	public const int etherEye = 1553; // [!code --]
	public const int etherManaBattery = 1564; // [!code ++]

	public const int etherFeet = 1552;

	public const int etherUgly = 1551;

	public const int etherStupid = 1561; // [!code --]
 // [!code --]
	public const int mutationBodyN = 1531; // [!code --]
 // [!code --]
	public const int etherGravity = 1550;

	public const int mutationStr = 1520; // [!code --]
 // [!code --]
	public const int mutationCha = 1522; // [!code --]
 // [!code --]
	public const int mutationChaN = 1523; // [!code --]
	public const int mutationBodyN = 1531; // [!code ++]

	public const int mutationBrain = 1524; // [!code --]
	public const int mutationBody = 1530; // [!code ++]

	public const int mutationBrainN = 1525; // [!code --]
	public const int mutationLightningN = 1529; // [!code ++]

	public const int mutationStrN = 1521; // [!code --]
	public const int mutationLightning = 1528; // [!code ++]

	public const int mutationColdN = 1527;

	public const int mutationLightning = 1528; // [!code --]
	public const int mutationCold = 1526; // [!code ++]

	public const int mutationLightningN = 1529; // [!code --]
	public const int mutationBrainN = 1525; // [!code ++]

	public const int mutationBody = 1530; // [!code --]
	public const int mutationBrain = 1524; // [!code ++]

	public const int mutationCold = 1526; // [!code --]
	public const int etherEye = 1553; // [!code ++]

	public static readonly int[] IDS = new int[38]
	{
		1516, 1564, 1510, 1511, 1512, 1513, 1514, 1515, 1517, 1565, // [!code --]
		1519, 1563, 1562, 1518, 1560, 1559, 1558, 1557, 1556, 1555, // [!code --]
		1554, 1553, 1552, 1551, 1561, 1531, 1550, 1520, 1522, 1523, // [!code --]
		1524, 1525, 1521, 1527, 1528, 1529, 1530, 1526 // [!code --]
		1519, 1518, 1517, 1516, 1511, 1514, 1512, 1510, 1520, 1515, // [!code ++]
		1521, 1513, 1523, 1565, 1522, 1563, 1562, 1561, 1560, 1559, // [!code ++]
		1558, 1557, 1556, 1555, 1554, 1564, 1552, 1551, 1550, 1531, // [!code ++]
		1530, 1529, 1528, 1527, 1526, 1525, 1524, 1553 // [!code ++]
	};
}
public class Mutation : Feat
```

## POLICY

[`@@ -3,29 +3,29 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/POLICY.cs#L3-L31)
```cs:line-numbers=3

public class POLICY
{
	public const int store_ripoff = 2816; // [!code --]
	public const int forcePanty = 2712; // [!code ++]

	public const int livestock_priv = 2715; // [!code --]
	public const int platinum_ticket = 2815; // [!code ++]

	public const int home_discount = 2800; // [!code --]
	public const int mass_exhibition = 2814; // [!code ++]

	public const int open_business = 2810; // [!code --]
	public const int suite_room = 2813; // [!code ++]

	public const int tourist_safety = 2811; // [!code --]
	public const int livestock_priv = 2715; // [!code ++]

	public const int bed_quality = 2812; // [!code --]
	public const int tourist_safety = 2811; // [!code ++]

	public const int forcePanty = 2712; // [!code --]
	public const int open_business = 2810; // [!code ++]

	public const int suite_room = 2813; // [!code --]
	public const int home_discount = 2800; // [!code ++]

	public const int mass_exhibition = 2814; // [!code --]
	public const int store_ripoff = 2816; // [!code ++]

	public const int platinum_ticket = 2815; // [!code --]
	public const int bed_quality = 2812; // [!code ++]

	public const int store_premium = 2817;

	public const int legendary_exhibition = 2823; // [!code --]
	public const int celeb = 2822; // [!code ++]

	public const int license_furniture = 2819;

```

[`@@ -33,7 +33,7 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/POLICY.cs#L33-L39)
```cs:line-numbers=33

	public const int legendary_heirloom = 2821;

	public const int celeb = 2822; // [!code --]
	public const int legendary_exhibition = 2823; // [!code ++]

	public const int license_stolen = 2824;

```

[`@@ -45,18 +45,16 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/POLICY.cs#L45-L62)
```cs:line-numbers=45

	public const int license_slaver = 2828;

	public const int incomeTransfer = 2711; // [!code --]
 // [!code --]
	public const int license_food = 2818;

	public const int noMother = 2710; // [!code --]
 // [!code --]
	public const int inquisition = 2507; // [!code --]
	public const int incomeTransfer = 2711; // [!code ++]

	public const int noDM = 2708; // [!code --]
	public const int self_sufficient = 2511; // [!code ++]

	public const int noAnimal = 2709;

	public const int noMother = 2710; // [!code ++]
 // [!code ++]
	public const int food_for_people = 2502;

	public const int faith_tax = 2501;
```

[`@@ -69,33 +67,35 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/POLICY.cs#L69-L101)
```cs:line-numbers=69

	public const int legal_drug = 2505;

	public const int inquisition = 2507; // [!code ++]
 // [!code ++]
	public const int nocturnal_life = 2508;

	public const int vaccination = 2509;

	public const int ban_radio = 2510;

	public const int self_sufficient = 2511; // [!code --]
 // [!code --]
	public const int resident_tax = 2512;

	public const int human_right = 2506;

	public const int taxfree = 2514;

	public const int resident_wanted = 2513; // [!code ++]
 // [!code ++]
	public const int auto_farm = 2707;

	public const int resident_wanted = 2513; // [!code --]
	public const int demon_invocation = 2706; // [!code ++]

	public const int taxTransfer = 2705;

	public const int border_watch = 2704; // [!code --]
	public const int noDM = 2708; // [!code ++]

	public const int demon_invocation = 2706; // [!code --]
	public const int weed_no = 2703; // [!code ++]

	public const int trash_no = 2702; // [!code --]
	public const int border_watch = 2704; // [!code ++]

	public const int weed_no = 2703; // [!code --]
	public const int trash_sort = 2701; // [!code ++]

	public const int energy_conservation = 2700;

```

[`@@ -103,16 +103,16 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/POLICY.cs#L103-L118)
```cs:line-numbers=103

	public const int stop_growth = 2515;

	public const int trash_sort = 2701; // [!code --]
	public const int trash_no = 2702; // [!code ++]

	public static readonly int[] IDS = new int[51]
	{
		2816, 2715, 2800, 2810, 2811, 2812, 2712, 2813, 2814, 2815, // [!code --]
		2817, 2823, 2819, 2820, 2821, 2822, 2824, 2825, 2826, 2827, // [!code --]
		2828, 2711, 2818, 2710, 2507, 2708, 2709, 2502, 2501, 2500, // [!code --]
		2503, 2504, 2505, 2508, 2509, 2510, 2511, 2512, 2506, 2514, // [!code --]
		2707, 2513, 2705, 2704, 2706, 2702, 2703, 2700, 2516, 2515, // [!code --]
		2701 // [!code --]
		2712, 2815, 2814, 2813, 2715, 2811, 2810, 2800, 2816, 2812, // [!code ++]
		2817, 2822, 2819, 2820, 2821, 2823, 2824, 2825, 2826, 2827, // [!code ++]
		2828, 2818, 2711, 2511, 2709, 2710, 2502, 2501, 2500, 2503, // [!code ++]
		2504, 2505, 2507, 2508, 2509, 2510, 2512, 2506, 2514, 2513, // [!code ++]
		2707, 2706, 2705, 2708, 2703, 2704, 2701, 2700, 2516, 2515, // [!code ++]
		2702 // [!code ++]
	};
}
public class Policy : EClass
```

## Recipe

[`@@ -673,7 +673,7 @@ public virtual void Build(Chara chara, Card t, Point pos, int mat, int dir, int`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Recipe.cs#L673-L679)
```cs:line-numbers=673
		break;
	case "Obj":
		EClass._map.SetObj(pos.x, pos.z, mat, tileRow.id, 1, dir);
		if (tileType.ChangeBlockDir) // [!code --]
		if (tileType.ChangeBlockDir || pos.growth is GrowSystemTreeSingle) // [!code ++]
		{
			EClass._map.SetBlockDir(pos.x, pos.z, dir);
		}
```

## RecipeCard

[`@@ -449,7 +449,7 @@ void CheckBlock(Point _pos)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/RecipeCard.cs#L449-L455)
```cs:line-numbers=449
	{
		if (_pos.cell.IsBlocked && _pos.HasChara)
		{
			foreach (Chara item in _pos.ListCharas()) // [!code --]
			foreach (Chara item in _pos.ListCharas().Copy()) // [!code ++]
			{
				chara.Kick(item, ignoreSelf: false, karmaLoss: false);
			}
```

## SKILL

[`@@ -1,27 +1,27 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L1-L27)
```cs:line-numbers=1
public class SKILL
{
	public const int twowield = 131; // [!code --]
 // [!code --]
	public const int tactics = 132;

	public const int twowield = 131; // [!code ++]
 // [!code ++]
	public const int twohand = 130;

	public const int shield = 123;

	public const int armorHeavy = 122;

	public const int weaponCrossbow = 109; // [!code --]
	public const int acidproof = 51; // [!code ++]

	public const int weaponBlunt = 111;

	public const int weaponScythe = 110;

	public const int weaponCrossbow = 109; // [!code ++]
 // [!code ++]
	public const int fireproof = 50;

	public const int marksman = 133;

	public const int acidproof = 51; // [!code --]
 // [!code --]
	public const int armorLight = 120;

	public const int eyeofmind = 134;
```

[`@@ -50,7 +50,7 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L50-L56)
```cs:line-numbers=50

	public const int mining = 220;

	public const int spotting = 210; // [!code --]
	public const int fishing = 245; // [!code ++]

	public const int weightlifting = 207;

```

[`@@ -68,7 +68,7 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L68-L74)
```cs:line-numbers=68

	public const int life = 60;

	public const int fishing = 245; // [!code --]
	public const int mana = 61; // [!code ++]

	public const int vigor = 62;

```

[`@@ -118,6 +118,8 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L118-L123)
```cs:line-numbers=118

	public const int weaponStaff = 103;

	public const int weaponBow = 104; // [!code ++]
 // [!code ++]
	public const int weaponGun = 105;

	public const int weaponPolearm = 106;
```

[`@@ -126,13 +128,11 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L126-L138)
```cs:line-numbers=126

	public const int throwing = 108;

	public const int mana = 61; // [!code --]
 // [!code --]
	public const int LUC = 78;

	public const int gathering = 250;

	public const int weaponBow = 104; // [!code --]
	public const int spotting = 210; // [!code ++]

	public const int blacksmith = 256;

```

[`@@ -144,8 +144,6 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L144-L151)
```cs:line-numbers=144

	public const int eleHoly = 919;

	public const int eleChaos = 920; // [!code --]
 // [!code --]
	public const int eleMagic = 921;

	public const int eleEther = 922;
```

[`@@ -164,11 +162,11 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L164-L174)
```cs:line-numbers=164

	public const int resLightning = 952;

	public const int elePoison = 915; // [!code --]
 // [!code --]
	public const int resDarkness = 953;

	public const int resPoison = 955; // [!code --]
	public const int elePoison = 915; // [!code ++]
 // [!code ++]
	public const int resMind = 954; // [!code ++]

	public const int resNether = 956;

```

[`@@ -190,17 +188,19 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L190-L206)
```cs:line-numbers=190

	public const int resImpact = 965;

	public const int resDecay = 970; // [!code ++]
 // [!code ++]
	public const int resDamage = 971;

	public const int resCurse = 972;

	public const int carpentry = 255;

	public const int resMind = 954; // [!code --]
	public const int resPoison = 955; // [!code ++]

	public const int eleMind = 914;

	public const int resDecay = 970; // [!code --]
	public const int eleChaos = 920; // [!code ++]

	public const int eleLightning = 912;

```

[`@@ -222,7 +222,9 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L222-L228)
```cs:line-numbers=222

	public const int farming = 286;

	public const int cooking = 287; // [!code --]
	public const int eleDarkness = 913; // [!code ++]
 // [!code ++]
	public const int building = 288; // [!code ++]

	public const int appraising = 289;

```

[`@@ -232,25 +234,23 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L232-L256)
```cs:line-numbers=232

	public const int investing = 292;

	public const int building = 288; // [!code --]
	public const int cooking = 287; // [!code ++]

	public const int regeneration = 300;

	public const int eleCold = 911;

	public const int eleFire = 910; // [!code --]
	public const int disarmTrap = 293; // [!code ++]

	public const int env = 313;

	public const int disarmTrap = 293; // [!code --]
 // [!code --]
	public const int fun = 312;

	public const int bladder = 311;

	public const int hygine = 310;

	public const int eleDarkness = 913; // [!code --]
	public const int eleFire = 910; // [!code ++]

	public const int faith = 306;

```

[`@@ -268,19 +268,19 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SKILL.cs#L268-L286)
```cs:line-numbers=268

	public static readonly int[] IDS = new int[133]
	{
		131, 132, 130, 123, 122, 109, 111, 110, 50, 133, // [!code --]
		51, 120, 134, 227, 150, 242, 241, 240, 237, 235, // [!code --]
		230, 55, 226, 225, 220, 210, 207, 200, 152, 151, // [!code --]
		135, 56, 101, 60, 245, 62, 64, 65, 66, 67, // [!code --]
		132, 131, 130, 123, 122, 51, 111, 110, 109, 50, // [!code ++]
		133, 120, 134, 227, 150, 242, 241, 240, 237, 235, // [!code ++]
		230, 55, 226, 225, 220, 245, 207, 200, 152, 151, // [!code ++]
		135, 56, 101, 60, 61, 62, 64, 65, 66, 67, // [!code ++]
		68, 70, 71, 72, 73, 74, 75, 76, 57, 77,
		79, 80, 90, 91, 92, 93, 100, 102, 103, 105, // [!code --]
		106, 107, 108, 61, 78, 250, 104, 256, 916, 917, // [!code --]
		918, 919, 920, 921, 922, 923, 924, 925, 926, 950, // [!code --]
		951, 952, 915, 953, 955, 956, 957, 958, 959, 960, // [!code --]
		961, 962, 963, 964, 965, 971, 972, 255, 954, 914, // [!code --]
		970, 912, 257, 258, 259, 260, 261, 280, 281, 285, // [!code --]
		286, 287, 289, 290, 291, 292, 288, 300, 911, 910, // [!code --]
		313, 293, 312, 311, 310, 913, 306, 305, 304, 303, // [!code --]
		79, 80, 90, 91, 92, 93, 100, 102, 103, 104, // [!code ++]
		105, 106, 107, 108, 78, 250, 210, 256, 916, 917, // [!code ++]
		918, 919, 921, 922, 923, 924, 925, 926, 950, 951, // [!code ++]
		952, 953, 915, 954, 956, 957, 958, 959, 960, 961, // [!code ++]
		962, 963, 964, 965, 970, 971, 972, 255, 955, 914, // [!code ++]
		920, 912, 257, 258, 259, 260, 261, 280, 281, 285, // [!code ++]
		286, 913, 288, 289, 290, 291, 292, 287, 300, 911, // [!code ++]
		293, 313, 312, 311, 310, 910, 306, 305, 304, 303, // [!code ++]
		302, 307, 301
	};
}
```

## SLOT

[`@@ -1,40 +1,40 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SLOT.cs#L1-L40)
```cs:line-numbers=1
public class SLOT
{
	public const int toolbelt = 44; // [!code --]
	public const int arm = 34; // [!code ++]

	public const int torso = 32; // [!code --]
	public const int hand = 35; // [!code ++]

	public const int foot = 39; // [!code --]
	public const int finger = 36; // [!code ++]

	public const int lightsource = 45; // [!code --]
	public const int waist = 37; // [!code ++]

	public const int leg = 38;

	public const int arm = 34; // [!code --]
 // [!code --]
	public const int waist = 37; // [!code --]
 // [!code --]
	public const int tool = 40;

	public const int back = 33; // [!code --]
	public const int lightsource = 45; // [!code ++]

	public const int hand = 35; // [!code --]
	public const int toolbelt = 44; // [!code ++]

	public const int neck = 31; // [!code --]
	public const int range = 41; // [!code ++]

	public const int finger = 36; // [!code --]
	public const int token = 43; // [!code ++]

	public const int range = 41; // [!code --]
	public const int back = 33; // [!code ++]

	public const int head = 30; // [!code --]
	public const int foot = 39; // [!code ++]
 // [!code ++]
	public const int torso = 32; // [!code ++]

	public const int ammo = 42;

	public const int token = 43; // [!code --]
	public const int neck = 31; // [!code ++]
 // [!code ++]
	public const int head = 30; // [!code ++]

	public static readonly int[] IDS = new int[16]
	{
		44, 32, 39, 45, 38, 34, 37, 40, 33, 35, // [!code --]
		31, 36, 41, 30, 42, 43 // [!code --]
		34, 35, 36, 37, 38, 40, 45, 44, 41, 43, // [!code ++]
		33, 39, 32, 42, 31, 30 // [!code ++]
	};
}
```

## SPELL

[`@@ -1,13 +1,15 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L1-L13)
```cs:line-numbers=1
public class SPELL
{
	public const int ball_Sound = 50107; // [!code --]
	public const int puddle_Nether = 50906; // [!code ++]

	public const int puddle_Darkness = 50903; // [!code --]
	public const int ball_Sound = 50107; // [!code ++]

	public const int bolt_Sound = 50307;

	public const int hand_Sound = 50407;

	public const int ball_Void = 50116; // [!code ++]
 // [!code ++]
	public const int arrow_Sound = 50507;

	public const int funnel_Sound = 50607;
```

[`@@ -16,11 +18,11 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L16-L26)
```cs:line-numbers=16

	public const int weapon_Sound = 50807;

	public const int ball_Nerve = 50108; // [!code --]
	public const int weapon_Nether = 50806; // [!code ++]

	public const int weapon_Darkness = 50803; // [!code --]
	public const int puddle_Sound = 50907; // [!code ++]

	public const int ball_Holy = 50109; // [!code --]
	public const int puddle_Impact = 50915; // [!code ++]

	public const int bolt_Nerve = 50308;

```

[`@@ -36,35 +38,47 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L36-L70)
```cs:line-numbers=36

	public const int puddle_Nerve = 50908;

	public const int puddle_Sound = 50907; // [!code --]
	public const int ball_Holy = 50109; // [!code ++]

	public const int puddle_Nether = 50906; // [!code --]
	public const int weapon_Impact = 50815; // [!code ++]

	public const int weapon_Nether = 50806; // [!code --]
	public const int ball_Nerve = 50108; // [!code ++]
 // [!code ++]
	public const int bolt_Holy = 50309; // [!code ++]

	public const int miasma_Nether = 50706;

	public const int puddle_Mind = 50904; // [!code --]
	public const int funnel_Nether = 50606; // [!code ++]
 // [!code ++]
	public const int hand_Mind = 50404; // [!code ++]
 // [!code ++]
	public const int arrow_Mind = 50504; // [!code ++]
 // [!code ++]
	public const int funnel_Mind = 50604; // [!code ++]

	public const int miasma_Mind = 50704;

	public const int weapon_Mind = 50804; // [!code ++]
 // [!code ++]
	public const int miasma_Void = 50716; // [!code ++]
 // [!code ++]
	public const int puddle_Mind = 50904; // [!code ++]
 // [!code ++]
	public const int ball_Poison = 50105;

	public const int funnel_Mind = 50604; // [!code --]
	public const int funnel_Void = 50616; // [!code ++]

	public const int bolt_Poison = 50305;

	public const int hand_Poison = 50405; // [!code --]
	public const int bolt_Void = 50316; // [!code ++]

	public const int arrow_Poison = 50505; // [!code --]
	public const int hand_Poison = 50405; // [!code ++]

	public const int funnel_Poison = 50605;

	public const int arrow_Mind = 50504; // [!code --]
 // [!code --]
	public const int miasma_Poison = 50705;

	public const int hand_Mind = 50404; // [!code --]
	public const int arrow_Void = 50516; // [!code ++]

	public const int weapon_Poison = 50805;

```

[`@@ -72,7 +86,7 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L72-L78)
```cs:line-numbers=72

	public const int ball_Nether = 50106;

	public const int bolt_Mind = 50304; // [!code --]
	public const int hand_Void = 50416; // [!code ++]

	public const int bolt_Nether = 50306;

```

[`@@ -80,19 +94,25 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L80-L98)
```cs:line-numbers=80

	public const int arrow_Nether = 50506;

	public const int funnel_Nether = 50606; // [!code --]
	public const int arrow_Poison = 50505; // [!code ++]

	public const int ball_Mind = 50104; // [!code --]
	public const int ball_Impact = 50115; // [!code ++]

	public const int weapon_Mind = 50804; // [!code --]
	public const int hand_Holy = 50409; // [!code ++]

	public const int ball_Acid = 50113; // [!code --]
	public const int funnel_Holy = 50609; // [!code ++]

	public const int hand_Holy = 50409; // [!code --]
	public const int funnel_Ether = 50612; // [!code ++]
 // [!code ++]
	public const int miasma_Ether = 50712; // [!code ++]
 // [!code ++]
	public const int weapon_Ether = 50812; // [!code ++]

	public const int puddle_Ether = 50912;

	public const int miasma_Darkness = 50703; // [!code --]
	public const int ball_Acid = 50113; // [!code ++]
 // [!code ++]
	public const int hand_Impact = 50415; // [!code ++]

	public const int bolt_Acid = 50313;

```

[`@@ -102,14 +122,16 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L102-L115)
```cs:line-numbers=102

	public const int funnel_Acid = 50613;

	public const int miasma_Acid = 50713; // [!code --]
	public const int arrow_Ether = 50512; // [!code ++]

	public const int weapon_Acid = 50813; // [!code --]
	public const int miasma_Acid = 50713; // [!code ++]

	public const int puddle_Acid = 50913;

	public const int ball_Cut = 50114;

	public const int bolt_Impact = 50315; // [!code ++]
 // [!code ++]
	public const int bolt_Cut = 50314;

	public const int hand_Cut = 50414;
```

[`@@ -124,30 +146,14 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L124-L153)
```cs:line-numbers=124

	public const int puddle_Cut = 50914;

	public const int ball_Impact = 50115; // [!code --]
	public const int bolt_Mind = 50304; // [!code ++]

	public const int bolt_Impact = 50315; // [!code --]
	public const int arrow_Holy = 50509; // [!code ++]

	public const int hand_Impact = 50415; // [!code --]
	public const int hand_Ether = 50412; // [!code ++]

	public const int arrow_Impact = 50515;

	public const int funnel_Impact = 50615; // [!code --]
 // [!code --]
	public const int miasma_Impact = 50715; // [!code --]
 // [!code --]
	public const int weapon_Ether = 50812; // [!code --]
 // [!code --]
	public const int miasma_Ether = 50712; // [!code --]
 // [!code --]
	public const int funnel_Ether = 50612; // [!code --]
 // [!code --]
	public const int arrow_Ether = 50512; // [!code --]
 // [!code --]
	public const int arrow_Holy = 50509; // [!code --]
 // [!code --]
	public const int funnel_Holy = 50609; // [!code --]
 // [!code --]
	public const int miasma_Holy = 50709;

	public const int weapon_Holy = 50809;
```

[`@@ -156,6 +162,8 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L156-L161)
```cs:line-numbers=156

	public const int ball_Chaos = 50110;

	public const int miasma_Impact = 50715; // [!code ++]
 // [!code ++]
	public const int bolt_Chaos = 50310;

	public const int hand_Chaos = 50410;
```

[`@@ -166,12 +174,14 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L166-L177)
```cs:line-numbers=166

	public const int miasma_Chaos = 50710;

	public const int bolt_Holy = 50309; // [!code --]
	public const int bolt_Ether = 50312; // [!code ++]

	public const int weapon_Chaos = 50810;

	public const int ball_Magic = 50111;

	public const int funnel_Impact = 50615; // [!code ++]
 // [!code ++]
	public const int bolt_Magic = 50311;

	public const int hand_Magic = 50411;
```

[`@@ -188,21 +198,13 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L188-L208)
```cs:line-numbers=188

	public const int ball_Ether = 50112;

	public const int bolt_Ether = 50312; // [!code --]
 // [!code --]
	public const int hand_Ether = 50412; // [!code --]
 // [!code --]
	public const int puddle_Chaos = 50910;

	public const int funnel_Darkness = 50603; // [!code --]
 // [!code --]
	public const int SpDrawMonster = 9501; // [!code --]
 // [!code --]
	public const int hand_Darkness = 50403; // [!code --]
	public const int weapon_Acid = 50813; // [!code ++]

	public const int SpLevitate = 8300; // [!code --]
	public const int bolt_Fire = 50300; // [!code ++]

	public const int SpMutation = 8380; // [!code --]
	public const int puddle_Darkness = 50903; // [!code ++]

	public const int SpWish = 8390;

```

[`@@ -222,10 +224,10 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L222-L231)
```cs:line-numbers=222

	public const int SpRevive = 8430;

	public const int SpReconstruction = 8288; // [!code --]
 // [!code --]
	public const int SpHOT = 8450;

	public const int SpRestoreBody = 8470; // [!code ++]
 // [!code ++]
	public const int SpRestoreMind = 8471;

	public const int SpCureMutation = 8480;
```

[`@@ -248,15 +250,19 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L248-L262)
```cs:line-numbers=248

	public const int SpSpeedUp = 8510;

	public const int SpRestoreBody = 8470; // [!code --]
 // [!code --]
	public const int SpSilence = 8700;

	public const int SpChangeMaterialG = 8286; // [!code --]
	public const int SpWeakness = 8702; // [!code ++]

	public const int SpChangeMaterialLesser = 8284; // [!code --]
	public const int SpWeakResEle = 8704; // [!code ++]

	public const int weapon_Impact = 50815; // [!code --]
	public const int SpMutation = 8380; // [!code ++]
 // [!code ++]
	public const int SpBane = 8706; // [!code ++]
 // [!code ++]
	public const int SpLevitate = 8300; // [!code ++]
 // [!code ++]
	public const int SpChangeMaterialG = 8286; // [!code ++]

	public const int ball_ = 7001;

```

[`@@ -278,10 +284,10 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L278-L287)
```cs:line-numbers=278

	public const int SpTeleportShort = 8201;

	public const int SpChangeMaterial = 8285; // [!code --]
 // [!code --]
	public const int SpReturn = 8220;

	public const int SpEvac = 8221; // [!code ++]
 // [!code ++]
	public const int SpIdentify = 8230;

	public const int SpIdentifyG = 8232;
```

[`@@ -304,21 +310,17 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L304-L324)
```cs:line-numbers=304

	public const int SpFaith = 8281;

	public const int SpEvac = 8221; // [!code --]
 // [!code --]
	public const int arrow_Darkness = 50503; // [!code --]
 // [!code --]
	public const int SpWeakness = 8702; // [!code --]
	public const int SpChangeMaterialLesser = 8284; // [!code ++]

	public const int SpBane = 8706; // [!code --]
	public const int SpChangeMaterial = 8285; // [!code ++]

	public const int hand_Fire = 50400; // [!code --]
	public const int SpReconstruction = 8288; // [!code ++]

	public const int arrow_Fire = 50500; // [!code --]
	public const int SpGravity = 8708; // [!code ++]

	public const int funnel_Fire = 50600; // [!code --]
	public const int SpSpeedDown = 8710; // [!code ++]

	public const int miasma_Fire = 50700; // [!code --]
	public const int SpTelepathy = 8770; // [!code ++]

	public const int weapon_Fire = 50800;

```

[`@@ -334,10 +336,10 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L334-L343)
```cs:line-numbers=334

	public const int funnel_Cold = 50601;

	public const int bolt_Fire = 50300; // [!code --]
 // [!code --]
	public const int miasma_Cold = 50701;

	public const int weapon_Cold = 50801; // [!code ++]
 // [!code ++]
	public const int puddle_Cold = 50901;

	public const int ball_Lightning = 50102;
```

[`@@ -360,19 +362,23 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L360-L378)
```cs:line-numbers=360

	public const int bolt_Darkness = 50303;

	public const int weapon_Cold = 50801; // [!code --]
	public const int hand_Darkness = 50403; // [!code ++]

	public const int SpWeakResEle = 8704; // [!code --]
	public const int arrow_Darkness = 50503; // [!code ++]

	public const int ball_Fire = 50100; // [!code --]
	public const int funnel_Darkness = 50603; // [!code ++]

	public const int SpDrawMetal = 9502; // [!code --]
	public const int miasma_Darkness = 50703; // [!code ++]

	public const int SpGravity = 8708; // [!code --]
	public const int weapon_Darkness = 50803; // [!code ++]

	public const int SpSpeedDown = 8710; // [!code --]
	public const int miasma_Fire = 50700; // [!code ++]

	public const int SpTelepathy = 8770; // [!code --]
	public const int funnel_Fire = 50600; // [!code ++]
 // [!code ++]
	public const int arrow_Fire = 50500; // [!code ++]
 // [!code ++]
	public const int hand_Fire = 50400; // [!code ++]

	public const int SpInvisibility = 8775;

```

[`@@ -390,17 +396,17 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L390-L406)
```cs:line-numbers=390

	public const int SpSummon = 9000;

	public const int SpDrawBacker = 9503; // [!code --]
 // [!code --]
	public const int SpSummonUndeadSister = 9001;

	public const int SpSummonFire = 9002; // [!code ++]
 // [!code ++]
	public const int SpSummonTentacle = 9003;

	public const int SpSummonMonster = 9004;

	public const int SpSummonPawn = 9005; // [!code --]
	public const int ball_Mind = 50104; // [!code ++]

	public const int SpSummonYeek = 9006; // [!code --]
	public const int SpSummonPawn = 9005; // [!code ++]

	public const int SpSummonOrc = 9007;

```

[`@@ -416,33 +422,44 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/SPELL.cs#L416-L448)
```cs:line-numbers=416

	public const int SpWardMonster = 9500;

	public const int SpSummonFire = 9002; // [!code --]
	public const int SpDrawMonster = 9501; // [!code ++]

	public const int puddle_Impact = 50915; // [!code --]
	public const int SpDrawMetal = 9502; // [!code ++]
 // [!code ++]
	public const int SpDrawBacker = 9503; // [!code ++]
 // [!code ++]
	public const int ball_Fire = 50100; // [!code ++]
 // [!code ++]
	public const int weapon_Void = 50816; // [!code ++]
 // [!code ++]
	public const int SpSummonYeek = 9006; // [!code ++]
 // [!code ++]
	public const int puddle_Void = 50916; // [!code ++]

	public static readonly int[] IDS = new int[210] // [!code --]
	public static readonly int[] IDS = new int[218] // [!code ++]
	{
		50107, 50903, 50307, 50407, 50507, 50607, 50707, 50807, 50108, 50803, // [!code --]
		50109, 50308, 50408, 50508, 50608, 50708, 50808, 50908, 50907, 50906, // [!code --]
		50806, 50706, 50904, 50704, 50105, 50604, 50305, 50405, 50505, 50605, // [!code --]
		50504, 50705, 50404, 50805, 50905, 50106, 50304, 50306, 50406, 50506, // [!code --]
		50606, 50104, 50804, 50113, 50409, 50912, 50703, 50313, 50413, 50513, // [!code --]
		50613, 50713, 50813, 50913, 50114, 50314, 50414, 50514, 50614, 50714, // [!code --]
		50814, 50914, 50115, 50315, 50415, 50515, 50615, 50715, 50812, 50712, // [!code --]
		50612, 50512, 50509, 50609, 50709, 50809, 50909, 50110, 50310, 50410, // [!code --]
		50510, 50610, 50710, 50309, 50810, 50111, 50311, 50411, 50511, 50611, // [!code --]
		50711, 50811, 50911, 50112, 50312, 50412, 50910, 50603, 9501, 50403, // [!code --]
		8300, 8380, 8390, 8400, 8401, 8402, 8403, 8404, 8405, 8406, // [!code --]
		8430, 8288, 8450, 8471, 8480, 8490, 8491, 8500, 8501, 8502, // [!code --]
		8503, 8504, 8506, 8510, 8470, 8700, 8286, 8284, 50815, 7001, // [!code --]
		7002, 7003, 7004, 7005, 7006, 7007, 7800, 8200, 8201, 8285, // [!code --]
		8220, 8230, 8232, 8240, 8241, 8250, 8251, 8255, 8256, 8260, // [!code --]
		8280, 8281, 8221, 50503, 8702, 8706, 50400, 50500, 50600, 50700, // [!code --]
		50800, 50900, 50101, 50301, 50401, 50501, 50601, 50300, 50701, 50901, // [!code --]
		50102, 50302, 50402, 50502, 50602, 50702, 50802, 50902, 50103, 50303, // [!code --]
		50801, 8704, 50100, 9502, 8708, 8710, 8770, 8775, 8776, 8780, // [!code --]
		8790, 8791, 8800, 8801, 9000, 9503, 9001, 9003, 9004, 9005, // [!code --]
		9006, 9007, 9050, 9150, 9151, 9160, 9200, 9500, 9002, 50915 // [!code --]
		50906, 50107, 50307, 50407, 50116, 50507, 50607, 50707, 50807, 50806, // [!code ++]
		50907, 50915, 50308, 50408, 50508, 50608, 50708, 50808, 50908, 50109, // [!code ++]
		50815, 50108, 50309, 50706, 50606, 50404, 50504, 50604, 50704, 50804, // [!code ++]
		50716, 50904, 50105, 50616, 50305, 50316, 50405, 50605, 50705, 50516, // [!code ++]
		50805, 50905, 50106, 50416, 50306, 50406, 50506, 50505, 50115, 50409, // [!code ++]
		50609, 50612, 50712, 50812, 50912, 50113, 50415, 50313, 50413, 50513, // [!code ++]
		50613, 50512, 50713, 50913, 50114, 50315, 50314, 50414, 50514, 50614, // [!code ++]
		50714, 50814, 50914, 50304, 50509, 50412, 50515, 50709, 50809, 50909, // [!code ++]
		50110, 50715, 50310, 50410, 50510, 50610, 50710, 50312, 50810, 50111, // [!code ++]
		50615, 50311, 50411, 50511, 50611, 50711, 50811, 50911, 50112, 50910, // [!code ++]
		50813, 50300, 50903, 8390, 8400, 8401, 8402, 8403, 8404, 8405, // [!code ++]
		8406, 8430, 8450, 8470, 8471, 8480, 8490, 8491, 8500, 8501, // [!code ++]
		8502, 8503, 8504, 8506, 8510, 8700, 8702, 8704, 8380, 8706, // [!code ++]
		8300, 8286, 7001, 7002, 7003, 7004, 7005, 7006, 7007, 7800, // [!code ++]
		8200, 8201, 8220, 8221, 8230, 8232, 8240, 8241, 8250, 8251, // [!code ++]
		8255, 8256, 8260, 8280, 8281, 8284, 8285, 8288, 8708, 8710, // [!code ++]
		8770, 50800, 50900, 50101, 50301, 50401, 50501, 50601, 50701, 50801, // [!code ++]
		50901, 50102, 50302, 50402, 50502, 50602, 50702, 50802, 50902, 50103, // [!code ++]
		50303, 50403, 50503, 50603, 50703, 50803, 50700, 50600, 50500, 50400, // [!code ++]
		8775, 8776, 8780, 8790, 8791, 8800, 8801, 9000, 9001, 9002, // [!code ++]
		9003, 9004, 50104, 9005, 9007, 9050, 9150, 9151, 9160, 9200, // [!code ++]
		9500, 9501, 9502, 9503, 50100, 50816, 9006, 50916 // [!code ++]
	};
}
public class Spell : Ability
```

## Scene

[`@@ -110,6 +110,8 @@ public enum Mode`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Scene.cs#L110-L115)
```cs:line-numbers=110

	public ParticleSystem psRainSplashWater;

	public ParticleSystem psFey; // [!code ++]
 // [!code ++]
	public MeshPass[] passes;

	[NonSerialized]
```

## Thing

[`@@ -1069,7 +1069,11 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/Thing.cs#L1069-L1075)
```cs:line-numbers=1069
	}
	if (GetInt(107) > 0)
	{
		n.AddText("isLicked"); // [!code --]
		n.AddText("isLicked", FontColor.Great); // [!code ++]
	} // [!code ++]
	if (base.isRuneAdded) // [!code ++]
	{ // [!code ++]
		n.AddText("isRuneAdded", FontColor.Great); // [!code ++]
	}
	if (!base.c_idDeity.IsEmpty())
	{
```

## TraitBaseSpellbook

[`@@ -126,7 +126,7 @@ public static void ReadFailEffect(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitBaseSpellbook.cs#L126-L132)
```cs:line-numbers=126
	{
		c.Say("spell_fail_monster", c);
		c.PlaySound("spell_funnel");
		for (int i = 0; i < 1 + EClass._zone.DangerLv / 15 + EClass.rnd(3 + EClass._zone.DangerLv / 15); i++) // [!code --]
		for (int i = 0; i < Mathf.Clamp(1 + EClass._zone.DangerLv / 15 + EClass.rnd(3 + EClass._zone.DangerLv / 15), 1, 8); i++) // [!code ++]
		{
			Chara chara = CharaGen.CreateFromFilter("c_readFail", EClass._zone.DangerLv);
			EClass._zone.AddCard(chara, c.pos.GetNearestPoint(allowBlock: false, allowChara: false));
```

## TraitCrafter

[`@@ -15,7 +15,8 @@ public enum MixType`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitCrafter.cs#L15-L21)
```cs:line-numbers=15
		Talisman,
		Scratch,
		Incubator,
		Fortune // [!code --]
		Fortune, // [!code ++]
		RuneMold // [!code ++]
	}

	public enum AnimeType
```

[`@@ -270,6 +271,7 @@ public virtual Thing Craft(AI_UseCrafter ai)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitCrafter.cs#L270-L275)
```cs:line-numbers=270
	MixType mixType = source.type.ToEnum<MixType>();
	int num = source.num.Calc();
	Thing t = null;
	bool claimed; // [!code ++]
	switch (mixType)
	{
	case MixType.Food:
```

[`@@ -314,6 +316,44 @@ public virtual Thing Craft(AI_UseCrafter ai)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitCrafter.cs#L314-L319)
```cs:line-numbers=314
		t = CraftUtil.MixIngredients(t, ai.ings, CraftUtil.MixType.General, 999, EClass.pc).Thing;
		break;
	}
	case MixType.RuneMold: // [!code ++]
	{ // [!code ++]
		Thing eq = ai.ings[0]; // [!code ++]
		List<Element> list2 = eq.elements.ListRune(); // [!code ++]
		if (list2.Count == 0) // [!code ++]
		{ // [!code ++]
			Msg.SayNothingHappen(); // [!code ++]
			break; // [!code ++]
		} // [!code ++]
		if (eq.material.hardness > owner.material.hardness) // [!code ++]
		{ // [!code ++]
			Msg.Say("rune_tooHard", owner); // [!code ++]
			break; // [!code ++]
		} // [!code ++]
		EClass.ui.AddLayer<LayerList>().SetList2(list2, (Element a) => a.Name, delegate(Element a, ItemGeneral b) // [!code ++]
		{ // [!code ++]
			owner.ModNum(-1); // [!code ++]
			eq.Destroy(); // [!code ++]
			Thing thing7 = ThingGen.Create("rune"); // [!code ++]
			thing7.refVal = a.id; // [!code ++]
			thing7.encLV = a.vBase + a.vSource; // [!code ++]
			EClass.pc.Pick(thing7); // [!code ++]
			EClass.pc.PlaySound("intonation"); // [!code ++]
			EClass.pc.PlayEffect("intonation"); // [!code ++]
		}, delegate(Element a, ItemGeneral b) // [!code ++]
		{ // [!code ++]
			if (EClass.debug.showExtra) // [!code ++]
			{ // [!code ++]
				b.SetSubText(a.vBase.ToString() + a.vSource, 200, FontColor.Default, TextAnchor.MiddleRight); // [!code ++]
			} // [!code ++]
			b.Build(); // [!code ++]
		}).SetSize(500f) // [!code ++]
			.SetOnKill(delegate // [!code ++]
			{ // [!code ++]
			}) // [!code ++]
			.SetTitles("wRuneMold"); // [!code ++]
		break; // [!code ++]
	} // [!code ++]
	case MixType.Talisman:
	{
		int num4 = EClass.pc.Evalue(1418);
```

[`@@ -331,8 +371,7 @@ public virtual Thing Craft(AI_UseCrafter ai)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitCrafter.cs#L331-L338)
```cs:line-numbers=331
		break;
	}
	case MixType.Scratch:
	{ // [!code --]
		bool claimed = false; // [!code --]
		claimed = false; // [!code ++]
		Prize(20, "medal", "save", cat: false);
		Prize(10, "plat", "save", cat: false);
		Prize(10, "furniture", "nice", cat: true);
```

[`@@ -340,7 +379,6 @@ public virtual Thing Craft(AI_UseCrafter ai)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitCrafter.cs#L340-L346)
```cs:line-numbers=340
		Prize(4, "food", "", cat: false);
		Prize(1, "casino_coin", "", cat: false);
		break;
	} // [!code --]
	case MixType.Fortune:
	{
		EClass.player.seedFortune++;
```

[`@@ -409,6 +447,18 @@ public virtual Thing Craft(AI_UseCrafter ai)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitCrafter.cs#L409-L414)
```cs:line-numbers=409
			t.SetNum(num);
		}
		return t;
		void Prize(int chance, string s, string col, bool cat) // [!code ++]
		{ // [!code ++]
			if (!claimed && EClass.rnd(chance) == 0) // [!code ++]
			{ // [!code ++]
				t = (cat ? ThingGen.CreateFromCategory(s, EClass.pc.LV) : ThingGen.Create(s, -1, EClass.pc.LV)); // [!code ++]
				claimed = true; // [!code ++]
				if (col != "") // [!code ++]
				{ // [!code ++]
					Msg.SetColor(col); // [!code ++]
				} // [!code ++]
			} // [!code ++]
		} // [!code ++]
	}

	public override void TrySetAct(ActPlan p)
```

## TraitDrink

[`@@ -152,7 +152,8 @@ public override void OnDrink(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitDrink.cs#L152-L158)
```cs:line-numbers=152
		ActEffect.Proc(IdEffect, Power, owner.blessedState, c, null, new ActRef
		{
			n1 = N1,
			isPerfume = (this is TraitPerfume) // [!code --]
			isPerfume = (this is TraitPerfume), // [!code ++]
			refThing = owner.Thing // [!code ++]
		});
	}

```

## TraitKettle

[`@@ -56,6 +56,10 @@ public override bool CanCopy(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitKettle.cs#L56-L61)
```cs:line-numbers=56
	{
		return true;
	}
	if (t.HasElement(759)) // [!code ++]
	{ // [!code ++]
		return false; // [!code ++]
	} // [!code ++]
	if (t.sockets != null)
	{
		foreach (int socket in t.sockets)
```

## +TraitRuneMold

::: details File Created
```cs
public class TraitRuneMold : TraitCrafter
{
	public override string IdSource => "RuneMold";

	public override string CrafterTitle => "invSculpt";

	public override AnimeID IdAnimeProgress => AnimeID.Shiver;

	public override string idSoundProgress => "craft_sculpt";

	public override bool IsConsumeIng => false;

	public override bool CloseOnComplete => true;

	public virtual Rarity MaxRarity => Rarity.Normal;

	public override bool IsIngredient(string cat, Card c)
	{
		if (c.rarity > MaxRarity)
		{
			return false;
		}
		return base.IsIngredient(cat, c);
	}

	public override bool ShouldConsumeIng(SourceRecipe.Row item, int index)
	{
		return false;
	}
}
```

:::
## +TraitRuneMoldEarth

::: details File Created
```cs
public class TraitRuneMoldEarth : TraitRuneMold
{
	public override Rarity MaxRarity => Rarity.Superior;
}
```

:::
## +TraitRuneMoldMana

::: details File Created
```cs
public class TraitRuneMoldMana : TraitRuneMold
{
	public override Rarity MaxRarity => Rarity.Mythical;
}
```

:::
## +TraitRuneMoldSun

::: details File Created
```cs
public class TraitRuneMoldSun : TraitRuneMold
{
	public override Rarity MaxRarity => Rarity.Legendary;
}
```

:::
## TraitStairsDown

[`@@ -5,4 +5,6 @@ public class TraitStairsDown : TraitStairs`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/6efaca23ae6f065c87f46cfba18873dd637e0daa/Elin/TraitStairsDown.cs#L5-L8)
```cs:line-numbers=5
	public override string langOnUse => "stairsDown";

	public override bool IsDownstairs => true;
 // [!code ++]
	public override int InstallBottomPriority => 20000; // [!code ++]
}
```

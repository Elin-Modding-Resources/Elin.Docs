---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 22 files modified. 2 new files created.
version: EA 23.180 Nightly
changes: BaseListPeople/Card/Chara/CoreDebug/CraftUtil/ENC/InvOwnerMod/MATERIAL/Props/QuestSupplyCat/Recipe/SerializedCards/SocketData/SourceAsset/SourceChara/SourceThing/TCOrbitChara/TaskHarvest/Thing/ThingGen/Trait/+TraitRuneFree/+TryMakeRandomItemSource/WidgetStatsBar
---

# EA 23.180 Nightly

August 15, 2025

22 files modified. 2 new files created.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [Card (4)](#card)
```cs:no-line-numbers
public SocketData AddRune(int idEle, int v) // [!code --]
public SocketData AddRune(int idEle, int v, bool free) // [!code ++]
```
```cs:no-line-numbers
public int CountRune() // [!code --]
public int CountRune(bool countFree = true) // [!code ++]
```
```cs:no-line-numbers
public bool CanAddRune(SourceElement.Row row) // [!code --]
public bool CanAddRune(TraitMod mod) // [!code ++]
```
```cs:no-line-numbers
public Thing TryMakeRandomItem(int lv = -1) // [!code --]
public Thing TryMakeRandomItem(int lv = -1, TryMakeRandomItemSource itemSource = TryMakeRandomItemSource.Default, Chara crafter = null) // [!code ++]
```
## BaseListPeople

[`void AddText(Hobby h, string lang, bool fix)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/BaseListPeople.cs#L219-L225)
```cs:line-numbers=219
				{
					SourceElement.Row row = EClass.sources.elements.map[h.source.elements[j]];
					int num2 = h.source.elements[j + 1];
					float num3 = ((num2 < 0 || row.id == 2115 || row.id == 2207) ? ((float)(num2 / 10)) : Mathf.Max(0f, (long)num2 * (long)h.GetEfficiency(a) * a.homeBranch.efficiency / 100 / 1000)); // [!code --]
					float num3 = ((num2 < 0 || row.id == 2115 || row.id == 2207) ? ((float)(num2 / 10)) : Mathf.Max((h.GetEfficiency(a) > 0) ? 1 : 0, (long)num2 * (long)h.GetEfficiency(a) * a.homeBranch.efficiency / 100 / 1000)); // [!code ++]
					t.note.AddText("NoteText_small", "ãƒ» " + "workBonus_skill".lang(row.GetName().ToTitleCase(), ((num2 > 0) ? "+" : "") + num3) + ((row.id == 2115 || row.id == 2207) ? (" " + "fixedFactionSkill".lang()) : ""), (num2 >= 0) ? FontColor.Default : FontColor.Bad);
				}
			}
```

## Card

[`public virtual void ApplyMaterial(bool remove = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L2981-L2992)
```cs:line-numbers=2981

	public Card ChangeMaterial(int idNew, bool ignoreFixedMaterial = false)
	{
		return ChangeMaterial(EClass.sources.materials.map[idNew], ignoreFixedMaterial); // [!code --]
		return ChangeMaterial(EClass.sources.materials.map.TryGetValue(idNew, 1), ignoreFixedMaterial); // [!code ++]
	}

	public Card ChangeMaterial(string idNew, bool ignoreFixedMaterial = false)
	{
		return ChangeMaterial(EClass.sources.materials.alias[idNew], ignoreFixedMaterial); // [!code --]
		return ChangeMaterial(EClass.sources.materials.alias.TryGetValue(idNew, "oak"), ignoreFixedMaterial); // [!code ++]
	}

	public Card ChangeMaterial(SourceMaterial.Row row, bool ignoreFixedMaterial = false)
```

[`public void EjectSockets()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L3483-L3492)
```cs:line-numbers=3483

	public SocketData AddRune(Card rune)
	{
		return AddRune(rune.refVal, rune.encLV); // [!code --]
		return AddRune(rune.refVal, rune.encLV, rune.trait is TraitRuneFree); // [!code ++]
	}

	public SocketData AddRune(int idEle, int v) // [!code --]
	public SocketData AddRune(int idEle, int v, bool free) // [!code ++]
	{
		if (socketList == null)
		{
```

[`public SocketData AddRune(int idEle, int v)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L3497-L3503)
```cs:line-numbers=3497
	{
		idEle = idEle,
		value = v,
		type = SocketData.Type.Rune // [!code --]
		type = SocketData.Type.Rune, // [!code ++]
		isFree = free // [!code ++]
	};
	socketList.Add(socketData);
	if (IsWeapon || !row.IsWeaponEnc)
```

[`public SocketData GetRuneEnc(int idEle)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L3522-L3535)
```cs:line-numbers=3522
		return null;
	}

	public int CountRune() // [!code --]
	public int CountRune(bool countFree = true) // [!code ++]
	{
		int num = 0;
		if (socketList != null)
		{
			foreach (SocketData socket in socketList)
			{
				if (socket.type == SocketData.Type.Rune) // [!code --]
				if (socket.type == SocketData.Type.Rune && (countFree || !socket.isFree)) // [!code ++]
				{
					num++;
				}
```

[`public int MaxRune()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L3543-L3563)
```cs:line-numbers=3543
		return ((!IsUnique) ? 1 : 0) + Evalue(484);
	}

	public bool CanAddRune(SourceElement.Row row) // [!code --]
	public bool CanAddRune(TraitMod mod) // [!code ++]
	{
		SourceElement.Row source = mod.source; // [!code ++]
		if (category.slot == 0)
		{
			return false;
		}
		if (material.HasEnc(row.id)) // [!code --]
		if (material.HasEnc(source.id)) // [!code ++]
		{
			return false;
		}
		if (!IsWeapon && row.IsWeaponEnc) // [!code --]
		if (!IsWeapon && source.IsWeaponEnc) // [!code ++]
		{
			return false;
		}
		if (row.category == "resist") // [!code --]
		if (source.category == "resist") // [!code ++]
		{
			foreach (Element item in elements.ListElements())
			{
```

[`public bool CanAddRune(SourceElement.Row row)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L3567-L3573)
```cs:line-numbers=3567
			}
		}
	}
	string encSlot = row.encSlot; // [!code --]
	string encSlot = source.encSlot; // [!code ++]
	if (encSlot == null || encSlot.Length != 0)
	{
		switch (encSlot)
```

[`public bool CanAddRune(SourceElement.Row row)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L3575-L3581)
```cs:line-numbers=3575
		default:
		{
			bool flag = false;
			string[] array = row.encSlot.Split(','); // [!code --]
			string[] array = source.encSlot.Split(','); // [!code ++]
			foreach (string key in array)
			{
				if (EClass.sources.elements.alias[key].id == category.slot)
```

[`public bool CanAddRune(SourceElement.Row row)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L3595-L3601)
```cs:line-numbers=3595
				break;
			}
		}
		return CountRune() < MaxRune(); // [!code --]
		if (mod is TraitRuneFree) // [!code ++]
		{ // [!code ++]
			return true; // [!code ++]
		} // [!code ++]
		return CountRune(countFree: false) < MaxRune(); // [!code ++]
	}

	public bool HasRune()
```

[`bool chance(int i)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L5182-L5188)
```cs:line-numbers=5182
		}
	}

	public Thing TryMakeRandomItem(int lv = -1) // [!code --]
	public Thing TryMakeRandomItem(int lv = -1, TryMakeRandomItemSource itemSource = TryMakeRandomItemSource.Default, Chara crafter = null) // [!code ++]
	{
		if (lv == -1)
		{
```

[`public Thing TryMakeRandomItem(int lv = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L5214-L5223)
```cs:line-numbers=5214
		{
			text = "c_animal";
		}
		if (itemSource == TryMakeRandomItemSource.Cooking && crafter != null && crafter.HasElement(1205)) // [!code ++]
		{ // [!code ++]
			text = "c_human"; // [!code ++]
		} // [!code ++]
		for (int i = 0; i < 20; i++)
		{
			CardRow cardRow = SpawnList.Get(text).Select(lv + i);
			if (cardRow.model.Chara.race.corpse[0] != "_meat" && id != "milk" && id != "_egg" && id != "egg_fertilized") // [!code --]
			if ((cardRow.model.Chara.race.corpse[0] != "_meat" && id != "milk" && id != "_egg" && id != "egg_fertilized") || (itemSource == TryMakeRandomItemSource.Cooking && cardRow.model.HasElement(701))) // [!code ++]
			{
				continue;
			}
```

[`public virtual int GetPrice(CurrencyType currency = CurrencyType.Money, bool sel`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Card.cs#L6944-L6949)
```cs:line-numbers=6944
			{
			case "plat":
				return 500;
			case "rune_free": // [!code ++]
				return 1000; // [!code ++]
			case "whip_egg":
				return 3000;
			case "hammer_strip":
```

## Chara

[`public void OnSleep(int power, int days = 1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Chara.cs#L9225-L9246)
```cs:line-numbers=9225

	public void ModHeight(int a)
	{
		int height = bio.height; // [!code --]
		height = height * (100 + a) / 100 + ((a > 0) ? 1 : (-1)); // [!code --]
		if (height < 1) // [!code --]
		{ // [!code --]
			height = 1; // [!code --]
		} // [!code --]
		if (height != bio.height) // [!code --]
		if (!HasElement(450)) // [!code ++]
		{
			bio.height = height; // [!code --]
			Say((a > 0) ? "height_gain" : "height_lose", this); // [!code --]
			int height = bio.height; // [!code ++]
			height = height * (100 + a) / 100 + ((a > 0) ? 1 : (-1)); // [!code ++]
			if (height < 1) // [!code ++]
			{ // [!code ++]
				height = 1; // [!code ++]
			} // [!code ++]
			if (height != bio.height) // [!code ++]
			{ // [!code ++]
				bio.height = height; // [!code ++]
				Say((a > 0) ? "height_gain" : "height_lose", this); // [!code ++]
			} // [!code ++]
		}
	}

	public void ModWeight(int a, bool ignoreLimit = false)
	{
		if (a == 0) // [!code --]
		if (HasElement(450) || a == 0) // [!code ++]
		{
			return;
		}
```

## CoreDebug

[`public void UpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/CoreDebug.cs#L938-L943)
```cs:line-numbers=938
			EClass.pc.Pick(targetChara.MakeGene());
			EClass.pc.Pick(targetChara.MakeBraineCell());
			EClass.pc.Pick(targetChara.MakeEgg(effect: true, 10));
			targetChara.ModAffinity(EClass.pc, 10000); // [!code ++]
		}
		if (EClass.game.quests.Get<QuestDebt>() == null)
		{
```

## CraftUtil

[`public static void MakeDish(Thing food, int lv, Chara crafter = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/CraftUtil.cs#L70-L76)
```cs:line-numbers=70
		{
			thing = ThingGen.Create("_meat");
		}
		thing = thing.TryMakeRandomItem(lv); // [!code --]
		thing = thing.TryMakeRandomItem(lv, TryMakeRandomItemSource.Cooking, crafter); // [!code ++]
		TraitSeed.LevelSeed(thing, null, EClass.rnd(lv / 4) + 1);
		thing.SetEncLv(thing.encLV / 2);
		if (num > 0 && EClass.rnd(3) == 0)
```

[`public static Thing MakeLoveLunch(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/CraftUtil.cs#L119-L134)
```cs:line-numbers=119
	thing.MakeRefFrom(c);
	int num = c.uid + EClass.world.date.year * 10000 + EClass.world.date.month * 100;
	Rand.SetSeed(num);
	int num2 = 3 + EClass.rnd(3); // [!code --]
	float num2 = Mathf.Clamp(1f + Mathf.Sqrt(c.Evalue(287) / 5), 2f, 6f); // [!code ++]
	if (!EClass.debug.autoIdentify)
	{
		thing.c_IDTState = 5;
	}
	for (int i = 0; i < num2; i++) // [!code --]
	for (int i = 0; (float)i < num2; i++) // [!code ++]
	{
		Rand.SetSeed(num + i);
		AddIngredient(thing, c, GetRandomLoveLunchIngredient(c), writeCrafter: false);
	}
	thing.elements.SetBase(701, 0); // [!code ++]
	if (thing.Evalue(753) < 0) // [!code ++]
	{ // [!code ++]
		thing.elements.SetBase(753, 0); // [!code ++]
	} // [!code ++]
	Rand.SetSeed();
	return thing;
}
```

## ENC

[`public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ENC.cs#L8-L24)
```cs:line-numbers=8

	public const int r_DV = 650;

	public const int r_mana = 641; // [!code ++]
 // [!code ++]
	public const int mod_frustration = 624;

	public const int mod_flurry = 621; // [!code ++]
 // [!code ++]
	public const int mod_cleave = 622;

	public const int mod_feint = 623;

	public const int r_life = 640; // [!code --]
 // [!code --]
	public const int noDamage = 654;

	public const int r_mana = 641; // [!code --]
	public const int r_life = 640; // [!code ++]

	public const int onlyPet = 655;

```

[`public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ENC.cs#L40-L46)
```cs:line-numbers=40

	public const int convertFire = 850;

	public const int mod_flurry = 621; // [!code --]
	public const int mod_chaser = 620; // [!code ++]

	public const int convertImpact = 865;

```

[`public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ENC.cs#L48-L58)
```cs:line-numbers=48

	public const int permaCurse = 656;

	public const int mod_chaser = 620; // [!code --]
	public const int mod_talisman = 609; // [!code ++]

	public const int negateSleep = 424;

	public const int mod_splash = 608; // [!code --]
	public const int mod_scatter = 607; // [!code ++]

	public const int negateShockwave = 430;

```

[`public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ENC.cs#L96-L102)
```cs:line-numbers=96

	public const int resWeather = 408;

	public const int mod_talisman = 609; // [!code --]
	public const int mod_splash = 608; // [!code ++]

	public const int resMutation = 406;

```

[`public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ENC.cs#L120-L125)
```cs:line-numbers=120

	public const int sustain_PER = 443;

	public const int force_weapon = 482; // [!code ++]
 // [!code ++]
	public const int optimizeMana = 483;

	public const int slot_rune = 484;
```

[`public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ENC.cs#L130-L142)
```cs:line-numbers=130

	public const int creativeChef = 487;

	public const int deathagony = 488; // [!code --]
	public const int revealFaith = 481; // [!code ++]

	public const int force_weapon = 482; // [!code --]
	public const int deathagony = 488; // [!code ++]

	public const int mod_ammo = 600; // [!code --]
	public const int mod_reload = 601; // [!code ++]

	public const int mod_rapid = 602; // [!code --]
	public const int mod_ammo_knockback = 603; // [!code ++]

	public const int mod_ammo_recover = 604;

```

[`public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ENC.cs#L144-L162)
```cs:line-numbers=144

	public const int mod_drill = 606;

	public const int mod_scatter = 607; // [!code --]
 // [!code --]
	public const int sustain_DEX = 442;

	public const int mod_reload = 601; // [!code --]
	public const int mod_ammo = 600; // [!code ++]

	public const int revealFaith = 481; // [!code --]
	public const int strongStomach = 480; // [!code ++]

	public const int mod_ammo_knockback = 603; // [!code --]
	public const int mod_rapid = 602; // [!code ++]

	public const int bane_all = 468; // [!code --]
	public const int bane_fish = 467; // [!code ++]

	public const int strongStomach = 480; // [!code --]
	public const int bane_all = 468; // [!code ++]

	public const int sustain_WIL = 445;

```

[`public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ENC.cs#L164-L177)
```cs:line-numbers=164

	public const int sustain_LER = 444;

	public const int sustain_figure = 450; // [!code ++]
 // [!code ++]
	public const int bane_dragon = 460;

	public const int bane_undead = 461;

	public const int bane_fairy = 462; // [!code --]
 // [!code --]
	public const int sustain_CHA = 447;

	public const int bane_fairy = 462; // [!code ++]
 // [!code ++]
	public const int bane_animal = 463;

	public const int bane_man = 464;
```

[`public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ENC.cs#L180-L198)
```cs:line-numbers=180

	public const int bane_god = 466;

	public const int bane_fish = 467; // [!code --]
 // [!code --]
	public static readonly int[] IDS = new int[91] // [!code --]
	public static readonly int[] IDS = new int[92] // [!code ++]
	{
		653, 652, 651, 650, 624, 622, 623, 640, 654, 641, // [!code --]
		655, 851, 660, 661, 662, 663, 664, 665, 666, 850, // [!code --]
		621, 865, 852, 656, 620, 424, 608, 430, 429, 428, // [!code --]
		427, 426, 425, 423, 422, 421, 420, 419, 418, 417, // [!code --]
		416, 415, 414, 412, 411, 410, 409, 408, 609, 406, // [!code --]
		405, 404, 403, 402, 401, 400, 440, 441, 407, 443, // [!code --]
		483, 484, 485, 486, 487, 488, 482, 600, 602, 604, // [!code --]
		605, 606, 607, 442, 601, 481, 603, 468, 480, 445, // [!code --]
		446, 444, 460, 461, 462, 447, 463, 464, 465, 466, // [!code --]
		467 // [!code --]
		653, 652, 651, 650, 641, 624, 621, 622, 623, 654, // [!code ++]
		640, 655, 851, 660, 661, 662, 663, 664, 665, 666, // [!code ++]
		850, 620, 865, 852, 656, 609, 424, 607, 430, 429, // [!code ++]
		428, 427, 426, 425, 423, 422, 421, 420, 419, 418, // [!code ++]
		417, 416, 415, 414, 412, 411, 410, 409, 408, 608, // [!code ++]
		406, 405, 404, 403, 402, 401, 400, 440, 441, 407, // [!code ++]
		443, 482, 483, 484, 485, 486, 487, 481, 488, 601, // [!code ++]
		603, 604, 605, 606, 442, 600, 480, 602, 467, 468, // [!code ++]
		445, 446, 444, 450, 460, 461, 447, 462, 463, 464, // [!code ++]
		465, 466 // [!code ++]
	};
}
```

## InvOwnerMod

[`public override bool ShouldShowGuide(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/InvOwnerMod.cs#L30-L36)
```cs:line-numbers=30
	TraitMod traitMod = owner.trait as TraitMod;
	if (traitMod is TraitRune)
	{
		if (!t.CanAddRune(traitMod.source)) // [!code --]
		if (!t.CanAddRune(traitMod)) // [!code ++]
		{
			return false;
		}
```

## MATERIAL

[``](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/MATERIAL.cs#L4-L9)
```cs:line-numbers=4

public class MATERIAL : EClass
{
	public const byte idNull = 1; // [!code ++]
 // [!code ++]
	public const byte oak = 1;

	public const byte granite = 3;
```

[`public class MATERIAL : EClass`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/MATERIAL.cs#L30-L35)
```cs:line-numbers=30

	public const byte sand_sea = 97;

	public const string aliasNull = "oak"; // [!code ++]
 // [!code ++]
	public static SourceMaterial.Row sourceSnow = EClass.sources.materials.rows[48];

	public static SourceMaterial.Row sourceIce = EClass.sources.materials.rows[61];
```

## Props

[`void TryAdd(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Props.cs#L305-L311)
```cs:line-numbers=305
	}
	void TryAdd(Thing t)
	{
		if (t.HasElement(10) && !(t.trait is TraitFoodMeal) && !t.IsExcludeFromCraft(ing) && !stack.list.Contains(t)) // [!code --]
		if (t.HasElement(10) && !(t.trait is TraitFoodMeal) && !(t.trait is TraitFoodFishSlice) && !t.IsExcludeFromCraft(ing) && !stack.list.Contains(t)) // [!code ++]
		{
			stack.Add(t.Thing);
		}
```

## QuestSupplyCat

[`public override bool IsDestThing(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/QuestSupplyCat.cs#L24-L30)
```cs:line-numbers=24

	public override void SetIdThing()
	{
		List<SourceCategory.Row> list = EClass.sources.categories.rows.Where((SourceCategory.Row c) => c._parent == "meal").ToList(); // [!code --]
		List<SourceCategory.Row> list = EClass.sources.categories.rows.Where((SourceCategory.Row c) => c._parent == "meal" && c.id != "meal_lunch").ToList(); // [!code ++]
		idCat = list.RandomItem().id;
	}

```

## Recipe

[`static string CatName(string id)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Recipe.cs#L134-L140)
```cs:line-numbers=134

		public bool IsValidIngredient(Thing t)
		{
			if (ingType == IngType.CreativeFood && t.HasElement(10)) // [!code --]
			if (ingType == IngType.CreativeFood && t.HasElement(10) && !(t.trait is TraitFoodFishSlice)) // [!code ++]
			{
				return true;
			}
```

## SerializedCards

[`public void Restore(Map map, Map orgMap, bool addToZone, PartialMap partial = nu`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/SerializedCards.cs#L694-L700)
```cs:line-numbers=694
		}
		if (version >= 2 && card4.idDyeMat != -1)
		{
			card2.Dye(EClass.sources.materials.rows[card4.idDyeMat]); // [!code --]
			card2.Dye(EClass.sources.materials.rows.TryGet(card4.idDyeMat, 1)); // [!code ++]
		}
		card2.mapObj = card4.obj;
		if (card2.mapObj?.TryGetValue(2) != null)
```

## SocketData

[`public int value`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/SocketData.cs#L50-L55)
```cs:line-numbers=50
		}
	}

	public bool isFree // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			return bits[0]; // [!code ++]
		} // [!code ++]
		set // [!code ++]
		{ // [!code ++]
			bits[0] = value; // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	[OnSerializing]
	private void _OnSerializing(StreamingContext context)
	{
```

## SourceAsset

[`using System.Collections.Generic;`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/SourceAsset.cs#L1-L4)
```cs:line-numbers=1
using System.Collections.Generic;
using System.IO; // [!code ++]
using UnityEngine;

public class SourceAsset : EScriptable
```

[`public void SavePrefs(string id = "prefs")`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/SourceAsset.cs#L34-L40)
```cs:line-numbers=34

	public static void _SavePrefs(string id = "prefs")
	{
		IO.CopyAs(PrefPath + id, PrefPath + id + "_bk"); // [!code --]
		if (File.Exists(PrefPath + id)) // [!code ++]
		{ // [!code ++]
			IO.CopyAs(PrefPath + id, PrefPath + id + "_bk"); // [!code ++]
		} // [!code ++]
		Prefs prefs = new Prefs();
		prefs.version = 2;
		Debug.Log(EClass.sources.things.rows.Count);
```

## SourceChara

[`public override void SetRow(Row r)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/SourceChara.cs#L194-L199)
```cs:line-numbers=194

	public override void BackupPref()
	{
		SourceAsset._SavePrefs("prefs_auto"); // [!code ++]
		_rows.Clear();
		foreach (Row row in rows)
		{
```

## SourceThing

[`public override void SetRow(Row r)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/SourceThing.cs#L210-L215)
```cs:line-numbers=210

	public override void BackupPref()
	{
		SourceAsset._SavePrefs("prefs_auto"); // [!code ++]
		_rows.Clear();
		foreach (Row row in rows)
		{
```

## TCOrbitChara

[`public void RefreshAll()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/TCOrbitChara.cs#L68-L80)
```cs:line-numbers=68
	Emo2 emo = owner.emoIcon;
	if (emo == Emo2.none)
	{
		if (owner.isRestocking && (!owner.IsPCParty || EMono._zone.IsPCFaction) && owner.trait.GetRestockedIcon() != 0 && !(EMono._zone is Zone_Dungeon)) // [!code --]
		if (!owner.IsPC && ((owner.affinity.CanGiveCard() && !EMono.player.codex.DroppedCard(owner.id)) || owner.GetInt(71) == -2)) // [!code ++]
		{
			emo = owner.trait.GetRestockedIcon(); // [!code --]
			emo = Emo2.hintEvent; // [!code ++]
		}
		else if (!owner.IsPC && ((owner.affinity.CanGiveCard() && !EMono.player.codex.DroppedCard(owner.id)) || owner.GetInt(71) == -2)) // [!code --]
		else if (owner.isRestocking && (!owner.IsPCParty || EMono._zone.IsPCFaction) && owner.trait.GetRestockedIcon() != 0 && !(EMono._zone is Zone_Dungeon)) // [!code ++]
		{
			emo = Emo2.hintEvent; // [!code --]
			emo = owner.trait.GetRestockedIcon(); // [!code ++]
		}
		else
		{
```

## TaskHarvest

[`public void HarvestThing()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/TaskHarvest.cs#L583-L598)
```cs:line-numbers=583
			fixedQuality = true
		});
		Thing thing = ThingGen.Create(text, 1, Mathf.Max(1, lV * 2 / 3));
		if (thing != null) // [!code --]
		if (thing == null) // [!code ++]
		{
			thing.SetNum((int)num); // [!code --]
			thing.ChangeMaterial(target.material); // [!code --]
			thing.decay = decay; // [!code --]
			if (thing.IsDecayed && thing.IsFood) // [!code --]
			{ // [!code --]
				thing.elements.SetBase(73, -10); // [!code --]
			} // [!code --]
			EClass._map.TrySmoothPick(pos.IsBlocked ? owner.pos : pos, thing, EClass.pc); // [!code --]
			return; // [!code ++]
		} // [!code ++]
		if (EClass._zone.IsUserZone && target.isNPCProperty && thing.trait is TraitPotionLove) // [!code ++]
		{ // [!code ++]
			Msg.Say("spellbookCrumble", thing); // [!code ++]
			thing.Destroy(); // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		thing.SetNum((int)num); // [!code ++]
		thing.ChangeMaterial(target.material); // [!code ++]
		thing.decay = decay; // [!code ++]
		if (thing.IsDecayed && thing.IsFood) // [!code ++]
		{ // [!code ++]
			thing.elements.SetBase(73, -10); // [!code ++]
		}
		EClass._map.TrySmoothPick(pos.IsBlocked ? owner.pos : pos, thing, EClass.pc); // [!code ++]
	}
}
```

## Thing

[`public List<Element> ListValidTraits(bool isCraft, bool limit)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L837-L843)
```cs:line-numbers=837
{
	List<Element> list = ListLimitedValidTraits(limit);
	bool showFoodEnc = base.ShowFoodEnc;
	bool flag = EClass.pc.HasElement(1650); // [!code --]
	bool flag = EClass.debug.enable || EClass.pc.HasElement(1650); // [!code ++]
	if (showFoodEnc)
	{
		foreach (Element value in elements.dict.Values)
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L864-L894)
```cs:line-numbers=864
	{
		CheckJustCooked();
	}
	string text2 = ((trait is TraitLunchLove) ? "_heart".lang().TagColor(FontColor.Bad) : ""); // [!code ++]
	n.Clear();
	string text2 = ""; // [!code --]
	string text3 = ""; // [!code ++]
	TraitAbility traitAbility = trait as TraitAbility;
	bool showEQStats = base.IsEquipmentOrRangedOrAmmo;
	bool flag = mode == IInspect.NoteMode.Product;
	bool flag2 = base.IsIdentified || flag;
	text2 = base.Name; // [!code --]
	text3 = base.Name; // [!code ++]
	if (base.rarity == Rarity.Legendary || base.rarity == Rarity.Mythical)
	{
		string text3 = (text2.Contains("ã€Ž") ? "ã€Ž" : (text2.Contains("ã€Š") ? "ã€Š" : "")); // [!code --]
		if (text3 != "") // [!code --]
		string text4 = (text3.Contains("ã€Ž") ? "ã€Ž" : (text3.Contains("ã€Š") ? "ã€Š" : "")); // [!code ++]
		if (text4 != "") // [!code ++]
		{
			string[] array = text2.Split(text3); // [!code --]
			text2 = array[0] + Environment.NewLine + text3 + array[1]; // [!code --]
			string[] array = text3.Split(text4); // [!code ++]
			text3 = array[0] + Environment.NewLine + text4 + array[1]; // [!code ++]
		}
	}
	if (flag)
	{
		if (!(trait is TraitPotionAlchemy))
		{
			text2 = recipe.GetName(); // [!code --]
			text3 = recipe.GetName(); // [!code ++]
		}
		if (trait.CraftNum > 1)
		{
			text2 = text2 + " x " + trait.CraftNum; // [!code --]
			text3 = text3 + " x " + trait.CraftNum; // [!code ++]
		}
	}
	if (mode != IInspect.NoteMode.Recipe)
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L899-L953)
```cs:line-numbers=899
		}
		else
		{
			UIItem uIItem = n.AddHeaderCard(text2); // [!code --]
			UIItem uIItem = n.AddHeaderCard(text3); // [!code ++]
			SetImage(uIItem.image2);
			uIItem.image2.Rect().pivot = new Vector2(0.5f, 0.5f);
			string text4 = base.Num.ToFormat() ?? ""; // [!code --]
			string text5 = (Mathf.Ceil(0.01f * (float)base.ChildrenAndSelfWeight) * 0.1f).ToString("F1") + "s"; // [!code --]
			string text5 = base.Num.ToFormat() ?? ""; // [!code ++]
			string text6 = (Mathf.Ceil(0.01f * (float)base.ChildrenAndSelfWeight) * 0.1f).ToString("F1") + "s"; // [!code ++]
			if (things.Count > 0)
			{
				text4 = text4 + " (" + things.Count + ")"; // [!code --]
				text5 = text5 + " (" + things.Count + ")"; // [!code ++]
			}
			if (base.ChildrenAndSelfWeight != SelfWeight)
			{
				text5 = text5 + " (" + (Mathf.Ceil(0.01f * (float)SelfWeight) * 0.1f).ToString("F1") + "s)"; // [!code --]
				text6 = text6 + " (" + (Mathf.Ceil(0.01f * (float)SelfWeight) * 0.1f).ToString("F1") + "s)"; // [!code ++]
			}
			text2 = "_quantity".lang(text4 ?? "", text5); // [!code --]
			text3 = "_quantity".lang(text5 ?? "", text6); // [!code ++]
			if (flag && recipe != null && (bool)LayerCraft.Instance)
			{
				text2 = text2 + "  " + "_recipe_lv".lang(recipe.RecipeLv.ToString() ?? ""); // [!code --]
				text3 = text3 + "  " + "_recipe_lv".lang(recipe.RecipeLv.ToString() ?? ""); // [!code ++]
			}
			uIItem.text2.SetText(text2); // [!code --]
			uIItem.text2.SetText(text3); // [!code ++]
			if (showEQStats && flag2)
			{
				text2 = ""; // [!code --]
				text3 = ""; // [!code ++]
				if (DV != 0 || PV != 0 || base.HIT != 0 || base.DMG != 0 || Penetration != 0)
				{
					if (base.DMG != 0)
					{
						text2 = text2 + "DMG".lang() + ((base.DMG > 0) ? "+" : "") + base.DMG + ", "; // [!code --]
						text3 = text3 + "DMG".lang() + ((base.DMG > 0) ? "+" : "") + base.DMG + ", "; // [!code ++]
					}
					if (base.HIT != 0)
					{
						text2 = text2 + "HIT".lang() + ((base.HIT > 0) ? "+" : "") + base.HIT + ", "; // [!code --]
						text3 = text3 + "HIT".lang() + ((base.HIT > 0) ? "+" : "") + base.HIT + ", "; // [!code ++]
					}
					if (DV != 0)
					{
						text2 = text2 + "DV".lang() + ((DV > 0) ? "+" : "") + DV + ", "; // [!code --]
						text3 = text3 + "DV".lang() + ((DV > 0) ? "+" : "") + DV + ", "; // [!code ++]
					}
					if (PV != 0)
					{
						text2 = text2 + "PV".lang() + ((PV > 0) ? "+" : "") + PV + ", "; // [!code --]
						text3 = text3 + "PV".lang() + ((PV > 0) ? "+" : "") + PV + ", "; // [!code ++]
					}
					if (Penetration != 0)
					{
						text2 = text2 + "PEN".lang() + ((Penetration > 0) ? "+" : "") + Penetration + "%, "; // [!code --]
						text3 = text3 + "PEN".lang() + ((Penetration > 0) ? "+" : "") + Penetration + "%, "; // [!code ++]
					}
					text2 = text2.TrimEnd(' ').TrimEnd(','); // [!code --]
					text3 = text3.TrimEnd(' ').TrimEnd(','); // [!code ++]
				}
				if (!text2.IsEmpty()) // [!code --]
				if (!text3.IsEmpty()) // [!code ++]
				{
					n.AddText("NoteText_eqstats", text2); // [!code --]
					n.AddText("NoteText_eqstats", text3); // [!code ++]
				}
				if (trait is TraitToolRange traitToolRange)
				{
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L956-L983)
```cs:line-numbers=956
			}
			else
			{
				string text6 = ""; // [!code --]
				string text7 = ""; // [!code ++]
				if (EClass.debug.showExtra)
				{
					int totalQuality = GetTotalQuality();
					int totalQuality2 = GetTotalQuality(applyBonus: false);
					text6 = text6 + "Lv. " + base.LV + " TQ. " + GetTotalQuality() + ((totalQuality == totalQuality2) ? "" : (" (" + totalQuality2 + ")")); // [!code --]
					text7 = text7 + "Lv. " + base.LV + " TQ. " + GetTotalQuality() + ((totalQuality == totalQuality2) ? "" : (" (" + totalQuality2 + ")")); // [!code ++]
				}
				if (HasElement(10))
				{
					text6 = text6 + (text6.IsEmpty() ? "" : "  ") + "_nutrition".lang(Evalue(10).ToFormat() ?? ""); // [!code --]
					text7 = text7 + (text7.IsEmpty() ? "" : "  ") + "_nutrition".lang(Evalue(10).ToFormat() ?? ""); // [!code ++]
				}
				if ((base.category.IsChildOf("throw") || base.category.IsChildOf("resource") || trait.IsTool) && !(trait is TraitAbility))
				{
					text6 = text6 + (text6.IsEmpty() ? "" : "  ") + "_hardness".lang(base.material.hardness.ToString() ?? ""); // [!code --]
					text7 = text7 + (text7.IsEmpty() ? "" : "  ") + "_hardness".lang(base.material.hardness.ToString() ?? ""); // [!code ++]
				}
				if (flag && recipe != null && (bool)LayerCraft.Instance)
				{
					text6 = text6 + (text6.IsEmpty() ? "" : "  ") + "_max_quality".lang(recipe.GetQualityBonus().ToString() ?? ""); // [!code --]
					text7 = text7 + (text7.IsEmpty() ? "" : "  ") + "_max_quality".lang(recipe.GetQualityBonus().ToString() ?? ""); // [!code ++]
				}
				if (!text6.IsEmpty()) // [!code --]
				if (!text7.IsEmpty()) // [!code ++]
				{
					n.AddText("NoteText_eqstats", text6); // [!code --]
					n.AddText("NoteText_eqstats", text7); // [!code ++]
				}
			}
		}
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L1054-L1062)
```cs:line-numbers=1054
	}
	if (trait.Decay > 0)
	{
		string text7 = ""; // [!code --]
		text7 = (base.IsDecayed ? "isRotten" : (base.IsRotting ? "isRotting" : ((!base.IsFresn) ? "isNotFresh" : "isFresh"))); // [!code --]
		AddText(text7.lang(), FontColor.Default); // [!code --]
		string text8 = ""; // [!code ++]
		text8 = (base.IsDecayed ? "isRotten" : (base.IsRotting ? "isRotting" : ((!base.IsFresn) ? "isNotFresh" : "isFresh"))); // [!code ++]
		AddText(text8.lang(), FontColor.Default); // [!code ++]
	}
	if (base.isDyed)
	{
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L1064-L1071)
```cs:line-numbers=1064
	}
	if (base.IsEquipment)
	{
		text2 = "isEquipable".lang(Element.Get(base.category.slot).GetText()); // [!code --]
		AddText(text2, FontColor.Default); // [!code --]
		text3 = "isEquipable".lang(Element.Get(base.category.slot).GetText()); // [!code ++]
		AddText(text3, FontColor.Default); // [!code ++]
	}
	if (base.isFireproof)
	{
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L1277-L1287)
```cs:line-numbers=1277
		{
			elements.AddNote(n, (Element e) => listTrait.Contains(e), null, ElementContainer.NoteMode.BonusTrait, addRaceFeat: false, delegate(Element e, string s)
			{
				string text12 = s; // [!code --]
				string text13 = e.source.GetText("textExtra"); // [!code --]
				if (!text13.IsEmpty()) // [!code --]
				string text13 = s; // [!code ++]
				string text14 = e.source.GetText("textExtra"); // [!code ++]
				if (!text14.IsEmpty()) // [!code ++]
				{
					string text14 = ""; // [!code --]
					string text15 = ""; // [!code ++]
					if (e.id == 2 && mode == IInspect.NoteMode.Product)
					{
						int num2 = recipe.GetQualityBonus() / 10;
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L1289-L1306)
```cs:line-numbers=1289
						{
							num2++;
						}
						text14 = "qualityLimit".lang(num2.ToString() ?? ""); // [!code --]
						text15 = "qualityLimit".lang(num2.ToString() ?? ""); // [!code ++]
					}
					int num3 = e.Value / 10;
					num3 = ((e.Value < 0) ? (num3 - 1) : (num3 + 1));
					text13 = "Lv." + num3 + text14 + " " + text13; // [!code --]
					text14 = "Lv." + num3 + text15 + " " + text14; // [!code ++]
					if (infoMode && e.IsFoodTraitMain)
					{
						text13 += "traitAdditive".lang(); // [!code --]
						text14 += "traitAdditive".lang(); // [!code ++]
					}
					text12 += (" <size=12>" + text13 + "</size>").TagColor(FontColor.Passive); // [!code --]
					text13 += (" <size=12>" + text14 + "</size>").TagColor(FontColor.Passive); // [!code ++]
				}
				return text12; // [!code --]
				return text13; // [!code ++]
			}, delegate
			{
			});
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L1312-L1320)
```cs:line-numbers=1312
		if (base.c_mixedFoodData != null)
		{
			n.AddHeader("isMixedFood");
			foreach (string text15 in base.c_mixedFoodData.texts) // [!code --]
			foreach (string text16 in base.c_mixedFoodData.texts) // [!code ++]
			{
				AddText("_bullet".lang() + text15, FontColor.Default); // [!code --]
				AddText("_bullet".lang() + text16 + text2, FontColor.Default); // [!code ++]
			}
		}
	}
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L1333-L1353)
```cs:line-numbers=1333
		{
			item.AddEncNote(n, this, ElementContainer.NoteMode.BonusTrait, delegate(Element e, string s)
			{
				string text9 = s; // [!code --]
				string text10 = e.source.GetText("textExtra"); // [!code --]
				if (!text10.IsEmpty()) // [!code --]
				string text10 = s; // [!code ++]
				string text11 = e.source.GetText("textExtra"); // [!code ++]
				if (!text11.IsEmpty()) // [!code ++]
				{
					string text11 = ""; // [!code --]
					string text12 = ""; // [!code ++]
					int num = e.Value / 10;
					num = ((e.Value < 0) ? (num - 1) : (num + 1));
					text10 = "Lv." + num + text11 + " " + text10; // [!code --]
					text11 = "Lv." + num + text12 + " " + text11; // [!code ++]
					if (infoMode && e.IsFoodTraitMain)
					{
						text10 += "traitAdditive".lang(); // [!code --]
						text11 += "traitAdditive".lang(); // [!code ++]
					}
					text9 += (" <size=12>" + text10 + "</size>").TagColor(FontColor.Passive); // [!code --]
					text10 += (" <size=12>" + text11 + "</size>").TagColor(FontColor.Passive); // [!code ++]
				}
				return text9; // [!code --]
				return text10; // [!code ++]
			});
		}
	}
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Thing.cs#L1383-L1391)
```cs:line-numbers=1383
		{
			n.AddHeader("headerAttackEval");
			AttackProcess.Current.Prepare(chara ?? EClass.pc, this, null, null, 0, base.IsThrownWeapon);
			string text8 = AttackProcess.Current.GetText(); // [!code --]
			text8 = text8.TagColor(() => true); // [!code --]
			n.AddText(text8); // [!code --]
			string text9 = AttackProcess.Current.GetText(); // [!code ++]
			text9 = text9.TagColor(() => true); // [!code ++]
			n.AddText(text9); // [!code ++]
		}
	}
	if (base.ammoData != null)
```

## ThingGen

[`public static Thing CreateScroll(int ele, int num = 1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/ThingGen.cs#L182-L187)
```cs:line-numbers=182
		return thing;
	}

	public static Thing CreateRune(int ele, int v, bool free = false) // [!code ++]
	{ // [!code ++]
		Thing thing = Create(free ? "rune_free" : "rune"); // [!code ++]
		thing.refVal = ele; // [!code ++]
		thing.encLV = v; // [!code ++]
		return thing; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public static Thing CreateRod(int ele)
	{
		Thing thing = Create("rod");
```

## Trait

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Trait.cs#L1833-L1839)
```cs:line-numbers=1833
			{
			case ShopType.Moyer:
			{
				for (int num10 = 1; num10 <= 7; num10++) // [!code --]
				for (int num10 = 1; num10 <= 9; num10++) // [!code ++]
				{
					AddAdvWeek(num10);
				}
```

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/Trait.cs#L1872-L1877)
```cs:line-numbers=1872
				Add("1165", 1, 0);
				Add("plat", 100, 0);
				AddThing(ThingGen.CreateScroll(9160).SetNum(5));
				AddThing(ThingGen.CreateRune(450, 1, free: true)); // [!code ++]
				break;
			case ShopType.Gun:
				Add("bullet", 1, 0).SetNum(300 + EClass.rnd(100)).ChangeMaterial("iron");
```

## +TraitRuneFree

::: details File Created
```cs
public class TraitRuneFree : TraitRune
{
}
```

:::
## +TryMakeRandomItemSource

::: details File Created
```cs
public enum TryMakeRandomItemSource
{
	Default,
	Cooking
}
```

:::
## WidgetStatsBar

[`public class Extra`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/WidgetStatsBar.cs#L57-L62)
```cs:line-numbers=57
		public bool dv;

		public bool fertility;
 // [!code ++]
		public bool elec; // [!code ++]
	}

	public static WidgetStatsBar Instance;
```

[`public class Extra`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/WidgetStatsBar.cs#L95-L100)
```cs:line-numbers=95

	public Sprite iconFertility;

	public Sprite iconElec; // [!code ++]
 // [!code ++]
	private UIItem mold;

	public Extra extra => base.config.extra as Extra;
```

[`public void Build()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/WidgetStatsBar.cs#L206-L211)
```cs:line-numbers=206
			return (string)obj;
		}, () => ((EMono.Branch == null && !(EMono._zone is Zone_Tent)) || EMono._zone.MaxSoil - EMono._zone.GetSoilCost() >= 0) ? FontColor.Default : FontColor.Bad, () => EMono._zone.IsPCFaction || EMono._zone is Zone_Tent);
	}
	if (extra.elec) // [!code ++]
	{ // [!code ++]
		Add(null, "elec", iconElec, () => (EMono.Branch != null || EMono._zone is Zone_Tent) ? (EMono._zone.GetElectricity(cost: true) + " / " + EMono._zone.GetElectricity()) : "", () => ((EMono.Branch == null && !(EMono._zone is Zone_Tent)) || EMono._zone.GetElectricity() - EMono._zone.GetElectricity(cost: true) >= 0) ? FontColor.Default : FontColor.Bad, () => EMono._zone.IsPCFaction || EMono._zone is Zone_Tent); // [!code ++]
	} // [!code ++]
	if (extra.weight)
	{
		Add(null, "weight", iconWeight, () => ((float)EMono.pc.ChildrenWeight / 1000f).ToString("F1") + " / " + ((float)EMono.pc.WeightLimit / 1000f).ToString("F1"), () => EMono.pc.burden.GetPhase() switch
```

[`public override void OnSetContextMenu(UIContextMenu m)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/77fedd1d51e2a79b735391362b2fdaf980c590bb/Elin/WidgetStatsBar.cs#L383-L388)
```cs:line-numbers=383
		extra.fertility = a;
		Build();
	});
	uIContextMenu.AddToggle("elec", extra.elec, delegate(bool a) // [!code ++]
	{ // [!code ++]
		extra.elec = a; // [!code ++]
		Build(); // [!code ++]
	}); // [!code ++]
	uIContextMenu.AddToggle("invWeight", extra.weight, delegate(bool a)
	{
		extra.weight = a;
```

---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 25 files modified.
version: EA 23.97 Nightly
changes: AI_Fuck/AI_Idle/ActNTR/BaseListPeople/BaseTileMap/CharaBody/ENC/FACTION/FEAT/FOOD/Game/GrowSystem/GrowSystemTree/Hobby/HotItemHeld/MUTATION/Map/POLICY/Point/RenderRow/SKILL/StatsMana/TaskHarvest/Thing/TraitCobWeb
---

# EA 23.97 Nightly

March 2, 2025

25 files modified.

## Important Changes

**None.**
## AI_Fuck

[`@@ -68,7 +68,7 @@ public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/AI_Fuck.cs#L68-L74)
```cs:line-numbers=68
	{
		cc.SetTempHand(1104, -1);
	}
	maxProgress = 25; // [!code --]
	maxProgress = (ntr ? 15 : 25); // [!code ++]
	if (succubus)
	{
		cc.Talk("seduce");
```

[`@@ -80,6 +80,10 @@ public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/AI_Fuck.cs#L80-L85)
```cs:line-numbers=80
		switch (Type)
		{
		case FuckType.fuck:
			if (ntr) // [!code ++]
			{ // [!code ++]
				cc.Say("ntr", cc, tc); // [!code ++]
			} // [!code ++]
			cc.LookAt(tc);
			tc.LookAt(cc);
			switch (i % 4)
```

[`@@ -275,6 +279,10 @@ public void Finish()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/AI_Fuck.cs#L275-L280)
```cs:line-numbers=275
		SuccubusExp(chara, chara2);
		SuccubusExp(chara2, chara);
		chara2.ModAffinity(chara, flag ? 10 : (-5));
		if (ntr && chara.HasElement(1239) && chara2.ExistsOnMap) // [!code ++]
		{ // [!code ++]
			chara2.stamina.Mod(-1000000); // [!code ++]
		} // [!code ++]
		break;
	}
	case FuckType.tame:
```

## AI_Idle

[`@@ -135,7 +135,7 @@ public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/AI_Idle.cs#L135-L141)
```cs:line-numbers=135
					}
				}
			}
			if (actRevive != null && EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon && a.Value.c_wasInPcParty).ToList().Count > 0 && owner.UseAbility(actRevive.source.alias, owner)) // [!code --]
			if (actRevive != null && owner.IsPCFaction && EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon && a.Value.c_wasInPcParty).ToList().Count > 0 && owner.UseAbility(actRevive.source.alias, owner)) // [!code ++]
			{
				yield return KeepRunning();
			}
```

## ActNTR

[`@@ -4,7 +4,11 @@ public override bool CanPerform()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/ActNTR.cs#L4-L10)
```cs:line-numbers=4
{
	if (Act.TC.isChara)
	{
		return Act.TC.Chara.conSleep != null; // [!code --]
		if (Act.TC.Chara.conSleep == null) // [!code ++]
		{ // [!code ++]
			return Act.CC.HasElement(1239); // [!code ++]
		} // [!code ++]
		return true; // [!code ++]
	}
	return false;
}
```

## BaseListPeople

[`@@ -198,6 +198,15 @@ void AddText(Hobby h, string lang, bool fix)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseListPeople.cs#L198-L203)
```cs:line-numbers=198
				int num = Mathf.Max(1, h.source.things[i + 1].ToInt() * efficiency * a.homeBranch.GetProductBonus(a) / 100 / 1000);
				string text3 = h.source.things[i];
				string s = (text3.StartsWith("#") ? EClass.sources.categories.map[text3.Replace("#", "")].GetName() : EClass.sources.cards.map[h.source.things[i]].GetName());
				if (h.source.alias == "Breeding") // [!code ++]
				{ // [!code ++]
					num = a.race.breeder * 100 / 2500; // [!code ++]
					num = num * ((!(text3 == "_egg")) ? 1 : 2) / 3; // [!code ++]
					if (a.race.breeder > 0 && num <= 0) // [!code ++]
					{ // [!code ++]
						num = 1; // [!code ++]
					} // [!code ++]
				} // [!code ++]
				t.note.AddText("NoteText_small", "ãƒ» " + "work_produce".lang(s.ToTitleCase(), num.ToString() ?? ""));
			}
			if (!h.source.elements.IsEmpty())
```

[`@@ -235,8 +244,8 @@ public virtual void SetSubText(Chara a, ItemGeneral b)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseListPeople.cs#L235-L242)
```cs:line-numbers=235
		break;
	case LayerPeople.ShowMode.Work:
	{
		string lang = a.GetTextWork(simple: true) + "," + a.GetTextHobby(simple: true); // [!code --]
		b.SetSubText(lang, 300); // [!code --]
		string text = a.GetTextWork(simple: true) + "," + a.GetTextHobby(simple: true); // [!code ++]
		b.SetSubText(text.TrimEnd(','), 300); // [!code ++]
		break;
	}
	}
```

## BaseTileMap

[`@@ -1254,449 +1254,8 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L1254-L1702)
```cs:line-numbers=1254
			fogged = true;
		}
	}
	goto IL_7b3a; // [!code --]
	IL_7b3a: // [!code --]
	if (detail.things.Count == 0 && detail.charas.Count == 0) // [!code --]
	{ // [!code --]
		return; // [!code --]
	} // [!code --]
	int num3 = 0; // [!code --]
	thingPos.x = 0f; // [!code --]
	thingPos.y = 0f; // [!code --]
	thingPos.z = 0f; // [!code --]
	freePos.x = (freePos.y = (freePos.z = 0f)); // [!code --]
	if (this.cell.HasRamp) // [!code --]
	{ // [!code --]
		Vector3 rampFix = sourceBlock.tileType.GetRampFix(this.cell.blockDir); // [!code --]
		param.x += rampFix.x; // [!code --]
		param.y += rampFix.y; // [!code --]
		param.z += rampFix.z; // [!code --]
		freePos.x += rampFix.x; // [!code --]
		freePos.y += rampFix.y; // [!code --]
		freePos.z += rampFix.z; // [!code --]
	} // [!code --]
	param.y += (flag ? 0f : ((this.cell._bridge != 0) ? this.cell.sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight)); // [!code --]
	orgPos.x = (orgX = param.x); // [!code --]
	orgPos.y = (orgY = param.y); // [!code --]
	orgPos.z = (orgZ = param.z); // [!code --]
	if (flag && liquidLv > 0) // [!code --]
	{ // [!code --]
		if (liquidLv > 10) // [!code --]
		{ // [!code --]
			liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code --]
		} // [!code --]
		liquidLv -= (int)(floatY * 0.5f); // [!code --]
		param.liquidLv = liquidLv; // [!code --]
		param.y -= TileType.FloorWaterShallow.FloorHeight; // [!code --]
	} // [!code --]
	Thing thing = null; // [!code --]
	bool shadow = liquidLv == 0; // [!code --]
	float num4 = 0f; // [!code --]
	float num5 = 0f; // [!code --]
	bool flag6 = false; // [!code --]
	float num6 = 0f; // [!code --]
	bool flag7 = false; // [!code --]
	float num7 = 0f; // [!code --]
	if (detail.things.Count > 0 && isSeen) // [!code --]
	{ // [!code --]
		_ = zSetting.max1; // [!code --]
		float num8 = 0f; // [!code --]
		for (int j = 0; j < detail.things.Count; j++) // [!code --]
		{ // [!code --]
			Thing t = detail.things[j]; // [!code --]
			if ((fogged && !t.isRoofItem) || ((t.isHidden || t.trait.HideInAdv || t.isMasked) && !EMono.scene.actionMode.ShowMaskedThings) || (t.isRoofItem && ((this.room == null && !sourceBlock.tileType.IsFullBlock && !EMono._zone.IsPCFaction) || (lowBlock && !showFullWall && this.room != null) || (noRoofMode && currentRoom == null))) || (flag3 && !t.isRoofItem)) // [!code --]
			{ // [!code --]
				continue; // [!code --]
			} // [!code --]
			TileType tileType = t.trait.tileType; // [!code --]
			bool isInstalled = t.IsInstalled; // [!code --]
			SourcePref pref = t.Pref; // [!code --]
			if (!isInstalled && t.category.tileDummy != 0) // [!code --]
			{ // [!code --]
				pref = rendererObjDummy.shadowPref; // [!code --]
			} // [!code --]
			float num9 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code --]
			if (t.ignoreStackHeight) // [!code --]
			{ // [!code --]
				thingPos.y -= num4; // [!code --]
			} // [!code --]
			shadow = thingPos.y < 0.16f && num7 < 0.16f; // [!code --]
			_ = pref.bypassShadow; // [!code --]
			param.shadowFix = 0f - thingPos.y; // [!code --]
			param.liquidLv = ((thingPos.y + (float)t.altitude < 0.1f) ? liquidLv : 0); // [!code --]
			if (t.isRoofItem) // [!code --]
			{ // [!code --]
				param.snow = isSnowCovered && !this.cell.isClearSnow; // [!code --]
				SetRoofHeight(param, this.cell, cx, cz); // [!code --]
				_actorPos.x = param.x; // [!code --]
				_actorPos.y = param.y; // [!code --]
				_actorPos.z = param.z + num8; // [!code --]
				if (this.room != null) // [!code --]
				{ // [!code --]
					param.color = GetRoofLight(this.room.lot); // [!code --]
				} // [!code --]
				shadow = false; // [!code --]
				param.liquidLv = 0; // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				param.snow = snowed; // [!code --]
				_actorPos.x = orgX + num5; // [!code --]
				_actorPos.y = orgY; // [!code --]
				_actorPos.z = orgZ + num8 + thingPos.z; // [!code --]
				if (tileType.CanStack || !isInstalled) // [!code --]
				{ // [!code --]
					if (thing?.id != t.id) // [!code --]
					{ // [!code --]
						_actorPos.x += thingPos.x; // [!code --]
					} // [!code --]
					_actorPos.y += thingPos.y; // [!code --]
					if (t.trait.IgnoreLastStackHeight && (thing == null || !thing.trait.IgnoreLastStackHeight)) // [!code --]
					{ // [!code --]
						thingPos.y -= num4; // [!code --]
						if (thing != null) // [!code --]
						{ // [!code --]
							_actorPos.z -= 0.2f; // [!code --]
							thingPos.z -= 0.2f; // [!code --]
						} // [!code --]
						_actorPos.y -= num4; // [!code --]
					} // [!code --]
					_actorPos.z += renderSetting.thingZ + (float)j * -0.01f + zSetting.mod1 * thingPos.y; // [!code --]
				} // [!code --]
				if (isInstalled) // [!code --]
				{ // [!code --]
					if (t.TileType.IsRamp) // [!code --]
					{ // [!code --]
						Vector3 rampFix2 = t.TileType.GetRampFix(t.dir, pref); // [!code --]
						orgX += rampFix2.x; // [!code --]
						orgY += rampFix2.y; // [!code --]
						orgZ += rampFix2.z; // [!code --]
						freePos.x += rampFix2.x; // [!code --]
						freePos.y += rampFix2.y; // [!code --]
						freePos.z += rampFix2.z; // [!code --]
						if (!this.cell.IsTopWater || t.altitude > 0) // [!code --]
						{ // [!code --]
							num7 += rampFix2.y; // [!code --]
						} // [!code --]
						liquidLv -= (int)(rampFix2.y * 150f); // [!code --]
						if (liquidLv < 0) // [!code --]
						{ // [!code --]
							liquidLv = 0; // [!code --]
						} // [!code --]
					} // [!code --]
					else if (!flag7 && t.trait.IsChangeFloorHeight && !t.ignoreStackHeight) // [!code --]
					{ // [!code --]
						orgY += num9 + (float)t.altitude * altitudeFix.y; // [!code --]
						orgZ += (float)t.altitude * altitudeFix.z; // [!code --]
						freePos.y += num9 + (float)t.altitude * altitudeFix.y; // [!code --]
						if (!this.cell.IsTopWater || t.altitude > 0) // [!code --]
						{ // [!code --]
							num7 += num9 + (float)t.altitude * altitudeFix.y; // [!code --]
						} // [!code --]
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
						_actorPos.z += pref.z; // [!code --]
						thingPos.z += pref.z; // [!code --]
						liquidLv -= (int)(num9 * 150f); // [!code --]
						if (liquidLv < 0) // [!code --]
						{ // [!code --]
							liquidLv = 0; // [!code --]
						} // [!code --]
					} // [!code --]
					else // [!code --]
					{ // [!code --]
						thingPos.y += num9; // [!code --]
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
						_actorPos.z += pref.z; // [!code --]
						if (pref.height >= 0f) // [!code --]
						{ // [!code --]
							thingPos.z += pref.z; // [!code --]
						} // [!code --]
					} // [!code --]
					if (!tileType.UseMountHeight && j > 10) // [!code --]
					{ // [!code --]
						flag7 = true; // [!code --]
					} // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					thingPos.y += num9; // [!code --]
					_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
					_actorPos.z += pref.z; // [!code --]
					thingPos.z += pref.z; // [!code --]
				} // [!code --]
				if (t.isFloating && isWater && !hasBridge && !flag) // [!code --]
				{ // [!code --]
					flag = true; // [!code --]
					float num10 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code --]
					orgY += 0.01f * floatY - num10; // [!code --]
					num6 = num9; // [!code --]
					_actorPos.y += 0.01f * floatY - num10; // [!code --]
					if (liquidLv > 10) // [!code --]
					{ // [!code --]
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code --]
					} // [!code --]
					liquidLv -= (int)(floatY * 0.5f); // [!code --]
					if (liquidLv < 0) // [!code --]
					{ // [!code --]
						liquidLv = 0; // [!code --]
					} // [!code --]
					param.liquidLv = liquidLv; // [!code --]
				} // [!code --]
				num4 = num9; // [!code --]
				if (t.sourceCard.multisize && !t.trait.IsGround) // [!code --]
				{ // [!code --]
					num8 += zSetting.multiZ; // [!code --]
				} // [!code --]
				orgZ += t.renderer.data.stackZ; // [!code --]
				if (param.liquidLv > 0) // [!code --]
				{ // [!code --]
					param.liquidLv += pref.liquidMod; // [!code --]
					if (param.liquidLv < 1) // [!code --]
					{ // [!code --]
						param.liquidLv = 1; // [!code --]
					} // [!code --]
					else if (param.liquidLv > 99 + pref.liquidModMax) // [!code --]
					{ // [!code --]
						param.liquidLv = 99 + pref.liquidModMax; // [!code --]
					} // [!code --]
				} // [!code --]
			} // [!code --]
			if (isInstalled && tileType.UseMountHeight) // [!code --]
			{ // [!code --]
				if (tileType != TileType.Illumination || !this.cell.HasObj) // [!code --]
				{ // [!code --]
					if (noRoofMode && currentRoom == null && t.altitude >= lowWallObjAltitude) // [!code --]
					{ // [!code --]
						continue; // [!code --]
					} // [!code --]
					if (hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code --]
					{ // [!code --]
						Room room = ((t.dir == 0) ? this.cell.Back.room : this.cell.Left.room); // [!code --]
						if (t.trait.AlwaysHideOnLowWall) // [!code --]
						{ // [!code --]
							if (room == null || !room.data.showWallItem) // [!code --]
							{ // [!code --]
								continue; // [!code --]
							} // [!code --]
						} // [!code --]
						else if (t.altitude >= lowWallObjAltitude) // [!code --]
						{ // [!code --]
							continue; // [!code --]
						} // [!code --]
					} // [!code --]
				} // [!code --]
				if (tileType.UseHangZFix) // [!code --]
				{ // [!code --]
					flag6 = true; // [!code --]
				} // [!code --]
				tileType.GetMountHeight(ref _actorPos, Point.shared.Set(index), t.dir, t); // [!code --]
				shadow = false; // [!code --]
				param.liquidLv = 0; // [!code --]
				if (t.freePos) // [!code --]
				{ // [!code --]
					_actorPos.x += t.fx; // [!code --]
					_actorPos.y += t.fy; // [!code --]
				} // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				if (t.altitude != 0) // [!code --]
				{ // [!code --]
					_actorPos += altitudeFix * t.altitude; // [!code --]
					if (t.altitude > 2 && ((this.cell.Back.room != null && this.cell.Back.IsRoomEdge) || (this.cell.Left.room != null && this.cell.Left.IsRoomEdge)) && hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code --]
					{ // [!code --]
						continue; // [!code --]
					} // [!code --]
				} // [!code --]
				if (t.freePos) // [!code --]
				{ // [!code --]
					_actorPos.x = orgX + t.fx - freePos.x; // [!code --]
					_actorPos.y = orgY + t.fy - freePos.y; // [!code --]
				} // [!code --]
				if (t.trait is TraitDoor && (t.trait as TraitDoor).IsOpen()) // [!code --]
				{ // [!code --]
					_actorPos.z += -0.5f; // [!code --]
				} // [!code --]
			} // [!code --]
			if (!t.sourceCard.multisize || (t.pos.x == cx && t.pos.z == cz)) // [!code --]
			{ // [!code --]
				if (iconMode != 0) // [!code --]
				{ // [!code --]
					int num11 = 0; // [!code --]
					switch (iconMode) // [!code --]
					{ // [!code --]
					case CardIconMode.Visibility: // [!code --]
						if (t.isMasked) // [!code --]
						{ // [!code --]
							num11 = 17; // [!code --]
						} // [!code --]
						break; // [!code --]
					case CardIconMode.State: // [!code --]
						if (t.placeState == PlaceState.installed) // [!code --]
						{ // [!code --]
							num11 = 18; // [!code --]
						} // [!code --]
						break; // [!code --]
					case CardIconMode.Deconstruct: // [!code --]
						if (t.isDeconstructing) // [!code --]
						{ // [!code --]
							num11 = 14; // [!code --]
						} // [!code --]
						break; // [!code --]
					} // [!code --]
					if (t.isNPCProperty && !EMono.debug.godBuild) // [!code --]
					{ // [!code --]
						num11 = 13; // [!code --]
					} // [!code --]
					if (num11 != 0) // [!code --]
					{ // [!code --]
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num11); // [!code --]
					} // [!code --]
				} // [!code --]
				t.SetRenderParam(param); // [!code --]
				if (_lowblock && t.trait.UseLowblock && !this.cell.HasFullBlock) // [!code --]
				{ // [!code --]
					param.tile += ((param.tile < 0f) ? (-64) : 64); // [!code --]
				} // [!code --]
				if (t.trait is TraitTrolley && EMono.pc.ai is AI_Trolley aI_Trolley && aI_Trolley.trolley.owner == t) // [!code --]
				{ // [!code --]
					RenderParam _param = new RenderParam(param); // [!code --]
					EMono.core.actionsLateUpdate.Add(delegate // [!code --]
					{ // [!code --]
						t.SetRenderParam(_param); // [!code --]
						_actorPos.x = EMono.pc.renderer.position.x; // [!code --]
						_actorPos.y = EMono.pc.renderer.position.y - pref.height; // [!code --]
						_actorPos.z = EMono.pc.renderer.position.z + 0.02f; // [!code --]
						t.renderer.Draw(_param, ref _actorPos, !t.noShadow && (shadow || tileType.AlwaysShowShadow)); // [!code --]
					}); // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					t.renderer.Draw(param, ref _actorPos, !t.noShadow && (shadow || tileType.AlwaysShowShadow)); // [!code --]
				} // [!code --]
			} // [!code --]
			if (isInstalled) // [!code --]
			{ // [!code --]
				num5 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
			} // [!code --]
			param.x = orgX; // [!code --]
			param.y = orgY; // [!code --]
			param.z = orgZ; // [!code --]
			param.color = floorLight; // [!code --]
			thing = t; // [!code --]
			if (pref.Float) // [!code --]
			{ // [!code --]
				liquidLv = 0; // [!code --]
			} // [!code --]
		} // [!code --]
	} // [!code --]
	orgY += num6; // [!code --]
	if (detail.charas.Count <= 0) // [!code --]
	{ // [!code --]
		return; // [!code --]
	} // [!code --]
	param.shadowFix = 0f - num7; // [!code --]
	param.color += 1310720f; // [!code --]
	float max = zSetting.max2; // [!code --]
	for (int k = 0; k < detail.charas.Count; k++) // [!code --]
	{ // [!code --]
		Chara chara = detail.charas[k]; // [!code --]
		if (chara.host != null || (chara != EMono.pc && chara != LayerDrama.alwaysVisible && (flag3 || fogged || (!showAllCards && !EMono.player.CanSee(chara))))) // [!code --]
		{ // [!code --]
			continue; // [!code --]
		} // [!code --]
		_actorPos.x = orgX; // [!code --]
		_actorPos.y = orgY; // [!code --]
		_actorPos.z = orgZ; // [!code --]
		chara.SetRenderParam(param); // [!code --]
		_ = chara.IsAliveInCurrentZone; // [!code --]
		if (chara.isRestrained) // [!code --]
		{ // [!code --]
			TraitShackle restrainer = chara.GetRestrainer(); // [!code --]
			if (restrainer != null) // [!code --]
			{ // [!code --]
				Vector3 getRestrainPos = restrainer.GetRestrainPos; // [!code --]
				if (getRestrainPos != default(Vector3)) // [!code --]
				{ // [!code --]
					Vector3 position = restrainer.owner.renderer.position; // [!code --]
					float defCharaHeight = EMono.setting.render.defCharaHeight; // [!code --]
					float num12 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code --]
					_actorPos.x = position.x + getRestrainPos.x * (float)((restrainer.owner.dir % 2 == 0) ? 1 : (-1)); // [!code --]
					_actorPos.y = position.y + num12; // [!code --]
					_actorPos.z = position.z + getRestrainPos.z; // [!code --]
					param.liquidLv = 0; // [!code --]
					param.shadowFix = orgY - _actorPos.y; // [!code --]
					chara.renderer.SetFirst(first: true); // [!code --]
					chara.renderer.Draw(param, ref _actorPos, drawShadow: true); // [!code --]
					param.shadowFix = 0f; // [!code --]
					continue; // [!code --]
				} // [!code --]
			} // [!code --]
		} // [!code --]
		if (!chara.sourceCard.multisize || (chara.pos.x == cx && chara.pos.z == cz)) // [!code --]
		{ // [!code --]
			if (chara.IsDeadOrSleeping && chara.IsPCC) // [!code --]
			{ // [!code --]
				float num13 = chara.renderer.data.size.y * 0.3f; // [!code --]
				if (thingPos.y > max) // [!code --]
				{ // [!code --]
					thingPos.y = max; // [!code --]
				} // [!code --]
				float num14 = thingPos.y + num13; // [!code --]
				float num15 = (float)k * -0.01f; // [!code --]
				if (num14 > zSetting.thresh1) // [!code --]
				{ // [!code --]
					num15 = zSetting.mod1; // [!code --]
				} // [!code --]
				_actorPos.x += thingPos.x; // [!code --]
				_actorPos.y += thingPos.y; // [!code --]
				_actorPos.z += renderSetting.laydownZ + num15; // [!code --]
				param.liquidLv = ((thingPos.y == 0f && liquidLv > 0) ? 90 : 0); // [!code --]
				thingPos.y += num13 * 0.8f; // [!code --]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0); // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				param.liquidLv = liquidLv; // [!code --]
				if (param.liquidLv > 0) // [!code --]
				{ // [!code --]
					param.liquidLv += chara.Pref.liquidMod; // [!code --]
					if (param.liquidLv < 1) // [!code --]
					{ // [!code --]
						param.liquidLv = 1; // [!code --]
					} // [!code --]
					else if (param.liquidLv > 99 + chara.Pref.liquidModMax) // [!code --]
					{ // [!code --]
						param.liquidLv = 99 + chara.Pref.liquidModMax; // [!code --]
					} // [!code --]
				} // [!code --]
				if (!chara.IsPC && !chara.renderer.IsMoving && detail.charas.Count > 1 && (detail.charas.Count != 2 || !detail.charas[0].IsDeadOrSleeping || !detail.charas[0].IsPCC)) // [!code --]
				{ // [!code --]
					_actorPos += renderSetting.charaPos[1 + ((num3 < 4) ? num3 : 3)]; // [!code --]
				} // [!code --]
				_actorPos.z += 0.01f * (float)k + renderSetting.charaZ; // [!code --]
				num3++; // [!code --]
				if (flag6) // [!code --]
				{ // [!code --]
					_actorPos.z += chara.renderer.data.hangedFixZ; // [!code --]
				} // [!code --]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0); // [!code --]
			} // [!code --]
		} // [!code --]
		param.x = orgX; // [!code --]
		param.y = orgY; // [!code --]
		param.z = orgZ; // [!code --]
	} // [!code --]
	return; // [!code --]
	IL_6f1f: // [!code --]
	int num16; // [!code --]
	if (!showRoof || !roof || this.cell.room == null || this.cell.Front.room == null || this.cell.Right.room == null) // [!code --]
	{ // [!code --]
		param.tile = num16; // [!code --]
		rendererFov.Draw(param); // [!code --]
	} // [!code --]
	goto IL_6f7f; // [!code --]
	IL_6f7f: // [!code --]
	goto IL_7b6a; // [!code ++]
	IL_6faf: // [!code ++]
	if (isSnowCovered && (sourceBlock.id != 0 || this.cell.hasDoor) && !snowed && !this.cell.isClearSnow && ((!this.cell.Front.HasRoof && !this.cell.Front.HasBlock) || (!this.cell.Right.HasRoof && !this.cell.Right.HasBlock)))
	{
		snowed = true;
```

[`@@ -1721,16 +1280,16 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L1721-L1736)
```cs:line-numbers=1721
			{
				if (sourceEffect2.anime.Length > 2)
				{
					float num17 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code --]
					if (!(num17 >= (float)sourceEffect2.anime[0])) // [!code --]
					float num3 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code ++]
					if (!(num3 >= (float)sourceEffect2.anime[0])) // [!code ++]
					{
						param.tile += num17; // [!code --]
						param.tile += num3; // [!code ++]
					}
				}
				else
				{
					float num18 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code --]
					param.tile += num18; // [!code --]
					float num4 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code ++]
					param.tile += num4; // [!code ++]
				}
			}
			if (this.cell.effect.IsFire)
```

[`@@ -1919,11 +1478,11 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L1919-L1929)
```cs:line-numbers=1919
		param.matColor = 104025f;
		renderFootmark.Draw(param);
	}
	goto IL_7b3a; // [!code --]
	goto IL_7b6a; // [!code ++]
	IL_1668:
	if (this.cell.isSlopeEdge)
	{
		float num19 = (float)height * _heightMod.y; // [!code --]
		float num5 = (float)height * _heightMod.y; // [!code ++]
		orgY = param.y;
		orgZ = param.z;
		param.dir = this.cell.blockDir;
```

[`@@ -1953,17 +1512,17 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L1953-L1969)
```cs:line-numbers=1953
				param.matColor = 104025f;
			}
		}
		for (int l = 0; (float)l < num19 / heightBlockSize; l++) // [!code --]
		for (int j = 0; (float)j < num5 / heightBlockSize; j++) // [!code ++]
		{
			param.y += ugFix.y;
			param.z += ugFix.z + slopeFixZ * (float)l; // [!code --]
			param.z += ugFix.z + slopeFixZ * (float)j; // [!code ++]
			defBlock.renderData.Draw(param);
			if (this.cell.pcSync && EMono.player.lightPower > 0f)
			{
				float num20 = param.tile; // [!code --]
				float num6 = param.tile; // [!code ++]
				param.tile = 0f;
				rendererFov.Draw(param);
				param.tile = num20; // [!code --]
				param.tile = num6; // [!code ++]
			}
		}
		param.y = orgY;
```

[`@@ -1974,29 +1533,29 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L1974-L2002)
```cs:line-numbers=1974
	{
		orgY = param.y;
		orgZ = param.z;
		int num21 = 0; // [!code --]
		int num7 = 0; // [!code ++]
		if (sourceBlock.tileType.IsFullBlock)
		{
			SourceBlock.Row row3 = sourceBlock;
			num21 = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length]; // [!code --]
			num7 = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length]; // [!code ++]
		}
		else
		{
			SourceBlock.Row row3 = sourceFloor._defBlock;
			num21 = row3._tiles[this.cell.blockDir % row3._tiles.Length]; // [!code --]
			num7 = row3._tiles[this.cell.blockDir % row3._tiles.Length]; // [!code ++]
		}
		if (((this.cell.Front.shore / 12) & 1) == 0 && this.cell.Front.sourceFloor.tileType.IsWater && this.cell.Front.height <= height && this.cell.Front.sourceBlock.tileType.RenderWaterBlock)
		{
			param.y = (float)(cz - cx) * screen.tileAlign.y - (this.cell.Front.sourceFloor.tileType.IsDeepWater ? 0.6f : 0.4f) + (float)(int)this.cell.Front.height * _heightMod.y;
			param.z = 1000f + param.x * screen.tileWeight.x + param.y * screen.tileWeight.z;
			param.tile = num21 + ((!this.cell.Front.sourceFloor.tileType.IsDeepWater) ? 3000000 : 0); // [!code --]
			param.tile = num7 + ((!this.cell.Front.sourceFloor.tileType.IsDeepWater) ? 3000000 : 0); // [!code ++]
			rendererWaterBlock.Draw(param);
		}
		if (((this.cell.Right.shore / 12) & 8) == 0 && this.cell.Right.sourceFloor.tileType.IsWater && this.cell.Right.height <= height && this.cell.Right.sourceBlock.tileType.RenderWaterBlock)
		{
			param.y = (float)(cz - cx) * screen.tileAlign.y - (this.cell.Right.sourceFloor.tileType.IsDeepWater ? 0.6f : 0.4f) + (float)(int)this.cell.Right.height * _heightMod.y;
			param.z = 1000f + param.x * screen.tileWeight.x + param.y * screen.tileWeight.z;
			param.tile = num21 + ((!this.cell.Right.sourceFloor.tileType.IsDeepWater) ? 3000000 : 0); // [!code --]
			param.tile = num7 + ((!this.cell.Right.sourceFloor.tileType.IsDeepWater) ? 3000000 : 0); // [!code ++]
			rendererWaterBlock.Draw(param);
		}
		param.y = orgY;
```

[`@@ -2037,10 +1596,10 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2037-L2046)
```cs:line-numbers=2037
		{
			param.matColor = 104025f;
		}
		for (int m = 0; m < ((!this.cell.isSkyFloor) ? 1 : EMono._map.config.skyBlockHeight); m++) // [!code --]
		for (int k = 0; k < ((!this.cell.isSkyFloor) ? 1 : EMono._map.config.skyBlockHeight); k++) // [!code ++]
		{
			param.y += ugFix.y;
			param.z += ugFix.z + slopeFixZ * (float)m; // [!code --]
			param.z += ugFix.z + slopeFixZ * (float)k; // [!code ++]
			defBlock2.renderData.Draw(param);
		}
		param.y = orgY;
```

[`@@ -2094,20 +1653,20 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2094-L2113)
```cs:line-numbers=2094
				}
				sourceFloor.renderData.Draw(param);
			}
			int num22 = 0; // [!code --]
			int num8 = 0; // [!code ++]
			if (isSnowCovered && sourceFloor == FLOOR.sourceSnow && !this.cell.hasDoor)
			{
				if (!this.cell.Right.IsSnowTile && this.cell.Right.topHeight == this.cell.topHeight)
				{
					num22++; // [!code --]
					num8++; // [!code ++]
				}
				if (!this.cell.Front.IsSnowTile && this.cell.Front.topHeight == this.cell.topHeight)
				{
					num22 += 2; // [!code --]
					num8 += 2; // [!code ++]
				}
				if (num22 != 0) // [!code --]
				if (num8 != 0) // [!code ++]
				{
					param.tile = 448 + num22 + 12; // [!code --]
					param.tile = 448 + num8 + 12; // [!code ++]
					param.z -= 0.1f;
					sourceFloor.renderData.Draw(param);
					param.z += 0.1f;
```

[`@@ -2178,7 +1737,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2178-L2184)
```cs:line-numbers=2178
					}
				}
			}
			if (this.cell.autotile != 0 && sourceFloor.autotile != 0 && (!hasBridge || this.cell.bridgeHeight - this.cell.height > 3) && !this.cell.skipRender && num22 == 0) // [!code --]
			if (this.cell.autotile != 0 && sourceFloor.autotile != 0 && (!hasBridge || this.cell.bridgeHeight - this.cell.height > 3) && !this.cell.skipRender && num8 == 0) // [!code ++]
			{
				pass = (isWater ? passAutoTileWater : passAutoTile);
				batch = pass.batches[pass.batchIdx];
```

[`@@ -2197,16 +1756,16 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2197-L2212)
```cs:line-numbers=2197
		}
		if (isWater)
		{
			int num23 = 12; // [!code --]
			int num24 = this.cell.shore / num23; // [!code --]
			int num25 = this.cell.shore % num23; // [!code --]
			int num9 = 12; // [!code ++]
			int num10 = this.cell.shore / num9; // [!code ++]
			int num11 = this.cell.shore % num9; // [!code ++]
			bool isShoreSand = this.cell.isShoreSand;
			if (this.cell.shore != 0)
			{
				Cell cell = ((((uint)num24 & (true ? 1u : 0u)) != 0) ? this.cell.Back : ((((uint)num24 & 2u) != 0) ? this.cell.Right : ((((uint)num24 & 4u) != 0) ? this.cell.Front : this.cell.Left))); // [!code --]
				Cell cell = ((((uint)num10 & (true ? 1u : 0u)) != 0) ? this.cell.Back : ((((uint)num10 & 2u) != 0) ? this.cell.Right : ((((uint)num10 & 4u) != 0) ? this.cell.Front : this.cell.Left))); // [!code ++]
				if (isShoreSand && !cell.sourceFloor.isBeach)
				{
					cell = ((((uint)num24 & 8u) != 0) ? this.cell.Left : ((((uint)num24 & 4u) != 0) ? this.cell.Front : ((((uint)num24 & 2u) != 0) ? this.cell.Right : this.cell.Back))); // [!code --]
					cell = ((((uint)num10 & 8u) != 0) ? this.cell.Left : ((((uint)num10 & 4u) != 0) ? this.cell.Front : ((((uint)num10 & 2u) != 0) ? this.cell.Right : this.cell.Back))); // [!code ++]
				}
				if (!cell.IsSnowTile)
				{
```

[`@@ -2218,7 +1777,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2218-L2224)
```cs:line-numbers=2218
						batch.matrices[pass.idx].m03 = param.x;
						batch.matrices[pass.idx].m13 = param.y;
						batch.matrices[pass.idx].m23 = param.z;
						batch.tiles[pass.idx] = 768 + this.cell.shore / num23; // [!code --]
						batch.tiles[pass.idx] = 768 + this.cell.shore / num9; // [!code ++]
						batch.colors[pass.idx] = param.color;
						batch.matColors[pass.idx] = param.matColor;
						pass.idx++;
```

[`@@ -2226,38 +1785,38 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2226-L2263)
```cs:line-numbers=2226
						{
							pass.NextBatch();
						}
						num25 = 2; // [!code --]
						num11 = 2; // [!code ++]
					}
					else
					{
						num25 = cell.sourceFloor.edge; // [!code --]
						num11 = cell.sourceFloor.edge; // [!code ++]
					}
					param.tile = (24 + num25 / 2) * 32 + num25 % 2 * 16 + num24; // [!code --]
					param.tile = (24 + num11 / 2) * 32 + num11 % 2 * 16 + num10; // [!code ++]
					rendererShore.Draw(param);
				}
			}
			if (this.cell.Back.isShoreSand && ((uint)(this.cell.Back.shore / num23) & 8u) != 0 && this.cell.Left.isShoreSand && ((uint)(this.cell.Left.shore / num23) & (true ? 1u : 0u)) != 0) // [!code --]
			if (this.cell.Back.isShoreSand && ((uint)(this.cell.Back.shore / num9) & 8u) != 0 && this.cell.Left.isShoreSand && ((uint)(this.cell.Left.shore / num9) & (true ? 1u : 0u)) != 0) // [!code ++]
			{
				param.tile = 785f;
				param.matColor = GetColorInt(ref this.cell.BackLeft.matFloor.matColor, this.cell.BackLeft.sourceFloor.colorMod);
				passShore.Add(param);
				Draw(60);
			}
			if (this.cell.Back.isShoreSand && ((uint)(this.cell.Back.shore / num23) & 2u) != 0 && this.cell.Right.isShoreSand && ((uint)(this.cell.Right.shore / num23) & (true ? 1u : 0u)) != 0) // [!code --]
			if (this.cell.Back.isShoreSand && ((uint)(this.cell.Back.shore / num9) & 2u) != 0 && this.cell.Right.isShoreSand && ((uint)(this.cell.Right.shore / num9) & (true ? 1u : 0u)) != 0) // [!code ++]
			{
				param.tile = 786f;
				param.matColor = GetColorInt(ref this.cell.BackRight.matFloor.matColor, this.cell.BackRight.sourceFloor.colorMod);
				passShore.Add(param);
				Draw(56);
			}
			if (this.cell.Front.isShoreSand && ((uint)(this.cell.Front.shore / num23) & 2u) != 0 && this.cell.Right.isShoreSand && ((uint)(this.cell.Right.shore / num23) & 4u) != 0) // [!code --]
			if (this.cell.Front.isShoreSand && ((uint)(this.cell.Front.shore / num9) & 2u) != 0 && this.cell.Right.isShoreSand && ((uint)(this.cell.Right.shore / num9) & 4u) != 0) // [!code ++]
			{
				param.tile = 787f;
				param.matColor = GetColorInt(ref this.cell.FrontRight.matFloor.matColor, this.cell.FrontRight.sourceFloor.colorMod);
				passShore.Add(param);
				Draw(48);
			}
			if (this.cell.Front.isShoreSand && ((uint)(this.cell.Front.shore / num23) & 8u) != 0 && this.cell.Left.isShoreSand && ((uint)(this.cell.Left.shore / num23) & 4u) != 0) // [!code --]
			if (this.cell.Front.isShoreSand && ((uint)(this.cell.Front.shore / num9) & 8u) != 0 && this.cell.Left.isShoreSand && ((uint)(this.cell.Left.shore / num9) & 4u) != 0) // [!code ++]
			{
				param.tile = 788f;
				param.matColor = GetColorInt(ref this.cell.FrontLeft.matFloor.matColor, this.cell.FrontLeft.sourceFloor.colorMod);
```

[`@@ -2280,36 +1839,48 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2280-L2315)
```cs:line-numbers=2280
					pass.NextBatch();
				}
			}
			bool flag8 = false; // [!code --]
			bool flag6 = false; // [!code ++]
			if (isShoreSand)
			{
				if (((uint)num24 & (true ? 1u : 0u)) != 0) // [!code --]
				if (((uint)num10 & (true ? 1u : 0u)) != 0) // [!code ++]
				{
					if (((uint)num24 & 8u) != 0) // [!code --]
					if (((uint)num10 & 8u) != 0) // [!code ++]
					{
						Draw(16); // [!code --]
						flag8 = true; // [!code --]
						if ((num10 & 2) == 0 && (num10 & 4) == 0) // [!code ++]
						{ // [!code ++]
							Draw(16); // [!code ++]
						} // [!code ++]
						flag6 = true; // [!code ++]
					}
					if (((uint)num24 & 2u) != 0) // [!code --]
					if (((uint)num10 & 2u) != 0) // [!code ++]
					{
						Draw(20); // [!code --]
						flag8 = true; // [!code --]
						if ((num10 & 8) == 0 && (num10 & 4) == 0) // [!code ++]
						{ // [!code ++]
							Draw(20); // [!code ++]
						} // [!code ++]
						flag6 = true; // [!code ++]
					}
				}
				if (((uint)num24 & 4u) != 0) // [!code --]
				if (((uint)num10 & 4u) != 0) // [!code ++]
				{
					if (((uint)num24 & 8u) != 0) // [!code --]
					if (((uint)num10 & 8u) != 0) // [!code ++]
					{
						Draw(24); // [!code --]
						flag8 = true; // [!code --]
						if ((num10 & 2) == 0 && (num10 & 1) == 0) // [!code ++]
						{ // [!code ++]
							Draw(24); // [!code ++]
						} // [!code ++]
						flag6 = true; // [!code ++]
					}
					if (((uint)num24 & 2u) != 0) // [!code --]
					if (((uint)num10 & 2u) != 0) // [!code ++]
					{
						Draw(28); // [!code --]
						flag8 = true; // [!code --]
						if ((num10 & 8) == 0 && (num10 & 1) == 0) // [!code ++]
						{ // [!code ++]
							Draw(28); // [!code ++]
						} // [!code ++]
						flag6 = true; // [!code ++]
					}
				}
				if (!flag8) // [!code --]
				if (!flag6) // [!code ++]
				{
					if (!this.cell.Front.sourceFloor.tileType.IsWater && !this.cell.Front.isDeck)
					{
```

[`@@ -2321,7 +1892,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2321-L2327)
```cs:line-numbers=2321
					}
				}
			}
			if (!flag8) // [!code --]
			if (!flag6) // [!code ++]
			{
				if (!this.cell.Back.sourceFloor.tileType.IsWater && !this.cell.Back.isDeck)
				{
```

[`@@ -2329,7 +1900,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2329-L2335)
```cs:line-numbers=2329
					batch = pass.batches[pass.batchIdx];
					batch.tiles[pass.idx] = 608 + waterAnimeIndex % 4;
					batch.matColors[pass.idx] = 104025f;
					if (((uint)(this.cell.shore / num23) & (true ? 1u : 0u)) != 0) // [!code --]
					if (((uint)(this.cell.shore / num9) & (true ? 1u : 0u)) != 0) // [!code ++]
					{
						if (isShoreSand)
						{
```

[`@@ -2367,7 +1938,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2367-L2373)
```cs:line-numbers=2367
					batch = pass.batches[pass.batchIdx];
					batch.tiles[pass.idx] = 612 + waterAnimeIndex % 4;
					batch.matColors[pass.idx] = 104025f;
					if (((uint)(this.cell.shore / num23) & 8u) != 0) // [!code --]
					if (((uint)(this.cell.shore / num9) & 8u) != 0) // [!code ++]
					{
						if (isShoreSand)
						{
```

[`@@ -2483,16 +2054,16 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2483-L2498)
```cs:line-numbers=2483
			param.z += bridgeFix.z;
			param.dir = 0;
			SourceBlock.Row row4 = sourceBridge._bridgeBlock;
			float num26 = (float)(this.cell.bridgeHeight - this.cell.height) * _heightMod.y; // [!code --]
			float num12 = (float)(this.cell.bridgeHeight - this.cell.height) * _heightMod.y; // [!code ++]
			if (this.cell.sourceFloor.tileType == TileType.Sky)
			{
				num26 += (float)EMono._map.config.skyBlockHeight; // [!code --]
				num12 += (float)EMono._map.config.skyBlockHeight; // [!code ++]
			}
			int num27 = (int)(num26 / heightBlockSize) + 2; // [!code --]
			int num13 = (int)(num12 / heightBlockSize) + 2; // [!code ++]
			if (this.cell.bridgePillar != 0)
			{
				row4 = EMono.sources.blocks.rows[this.cell.bridgePillar];
				param.tile = row4._tiles[0] + ((num27 == 2) ? 32 : 0); // [!code --]
				param.tile = row4._tiles[0] + ((num13 == 2) ? 32 : 0); // [!code ++]
				param.mat = ((sourceBridge.DefaultMaterial == row4.DefaultMaterial) ? sourceBridge.DefaultMaterial : row4.DefaultMaterial);
				param.matColor = ((row4.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, row4.colorMod));
			}
```

[`@@ -2504,9 +2075,9 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2504-L2512)
```cs:line-numbers=2504
			}
			param.y += ugFixBridgeTop.y;
			param.z += ugFixBridgeTop.z;
			for (int n = 0; n < num27; n++) // [!code --]
			for (int l = 0; l < num13; l++) // [!code ++]
			{
				if (n == num27 - 1) // [!code --]
				if (l == num13 - 1) // [!code ++]
				{
					param.y = (float)(cz - cx) * screen.tileAlign.y + (float)height * _heightMod.y + ugFixBridgeBottom.y;
					param.z = 1000f + param.x * screen.tileWeight.x + param.y * screen.tileWeight.z + (float)height * _heightMod.z + ugFixBridgeBottom.z;
```

[`@@ -2538,13 +2109,13 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2538-L2550)
```cs:line-numbers=2538
	{
		snowed = false;
	}
	num16 = 0; // [!code --]
	int num14 = 0; // [!code ++]
	if (sourceBlock.id != 0)
	{
		this.tileType = sourceBlock.tileType;
		roomHeight = 0f;
		int blockDir = this.cell.blockDir;
		bool flag9 = false; // [!code --]
		bool flag7 = false; // [!code ++]
		switch (wallClipMode)
		{
		case WallClipMode.ByRoom:
```

[`@@ -2588,8 +2159,8 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2588-L2595)
```cs:line-numbers=2588
					}
				}
			}
			flag9 = (this.room != null && this.room.data.atrium) || (this.cell.room != null && this.cell.room.data.atrium); // [!code --]
			if (flag9) // [!code --]
			flag7 = (this.room != null && this.room.data.atrium) || (this.cell.room != null && this.cell.room.data.atrium); // [!code ++]
			if (flag7) // [!code ++]
			{
				_lowblock = false;
			}
```

[`@@ -2611,8 +2182,8 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2611-L2618)
```cs:line-numbers=2611
					roomHeight = 0f;
					break;
				}
				int num28 = ((this.room.data.maxHeight == 0) ? 2 : this.room.data.maxHeight); // [!code --]
				roomHeight = EMono.setting.render.roomHeightMod * (float)((this.room.lot.height < num28) ? this.room.lot.height : num28) + 0.01f * (float)this.room.lot.heightFix; // [!code --]
				int num15 = ((this.room.data.maxHeight == 0) ? 2 : this.room.data.maxHeight); // [!code ++]
				roomHeight = EMono.setting.render.roomHeightMod * (float)((this.room.lot.height < num15) ? this.room.lot.height : num15) + 0.01f * (float)this.room.lot.heightFix; // [!code ++]
			}
			break;
		case WallClipMode.ByLot:
```

[`@@ -2658,11 +2229,11 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2658-L2668)
```cs:line-numbers=2658
		}
		if (!_lowblock && (double)roomHeight > 1.2 && this.tileType.RepeatBlock)
		{
			num16 = 1; // [!code --]
			num14 = 1; // [!code ++]
		}
		else if (lowBlock)
		{
			num16 = 2; // [!code --]
			num14 = 2; // [!code ++]
		}
		param.mat = matBlock;
		param.dir = this.cell.blockDir;
```

[`@@ -2709,11 +2280,11 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2709-L2719)
```cs:line-numbers=2709
				}
				if (!_lowblock)
				{
					int num29 = ((currentRoom.data.maxHeight == 0) ? 2 : currentRoom.data.maxHeight); // [!code --]
					roomHeight = EMono.setting.render.roomHeightMod * (float)((currentRoom.lot.height < num29) ? currentRoom.lot.height : num29) + 0.01f * (float)currentRoom.lot.heightFix; // [!code --]
					int num16 = ((currentRoom.data.maxHeight == 0) ? 2 : currentRoom.data.maxHeight); // [!code ++]
					roomHeight = EMono.setting.render.roomHeightMod * (float)((currentRoom.lot.height < num16) ? currentRoom.lot.height : num16) + 0.01f * (float)currentRoom.lot.heightFix; // [!code ++]
				}
			}
			if (flag9) // [!code --]
			if (flag7) // [!code ++]
			{
				_lowblock = (!this.cell.Front.HasFullBlock || !this.cell.Right.HasFullBlock) && (!this.cell.Front.HasFullBlock || !this.cell.Left.HasFullBlock) && (!this.cell.Back.HasFullBlock || !this.cell.Right.HasFullBlock) && (!this.cell.Back.HasFullBlock || !this.cell.Left.HasFullBlock);
				if (_lowblock)
```

[`@@ -2743,62 +2314,62 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2743-L2804)
```cs:line-numbers=2743
			{
				sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFixBlock, this.cell.hasDoor, this.cell.effect?.FireAmount ?? 0, isBlock: true);
			}
			Room room2 = this.cell.Front.room ?? this.cell.room; // [!code --]
			if (room2 == null && this.cell.Right.room != null) // [!code --]
			Room room = this.cell.Front.room ?? this.cell.room; // [!code ++]
			if (room == null && this.cell.Right.room != null) // [!code ++]
			{
				room2 = this.cell.Right.room; // [!code --]
				room = this.cell.Right.room; // [!code ++]
			}
			if (!invisible && room2 != null) // [!code --]
			if (!invisible && room != null) // [!code ++]
			{
				if (room2.lot.idDeco != 0 && !this.cell.hasDoor) // [!code --]
				if (room.lot.idDeco != 0 && !this.cell.hasDoor) // [!code ++]
				{
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco); // [!code --]
					param.matColor = room2.lot.colDeco; // [!code --]
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room.lot.idDeco); // [!code ++]
					param.matColor = room.lot.colDeco; // [!code ++]
					float y = param.y;
					param.y += (float)room2.lot.decoFix * 0.01f; // [!code --]
					param.y += (float)room.lot.decoFix * 0.01f; // [!code ++]
					rendererWallDeco.Draw(param);
					param.y = y;
				}
				if (room2.lot.idDeco2 != 0 && roomHeight != 0f && (float)room2.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code --]
				if (room.lot.idDeco2 != 0 && roomHeight != 0f && (float)room.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code ++]
				{
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco2); // [!code --]
					param.matColor = room2.lot.colDeco2; // [!code --]
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room.lot.idDeco2); // [!code ++]
					param.matColor = room.lot.colDeco2; // [!code ++]
					float y2 = param.y;
					float num30 = param.z; // [!code --]
					param.y += (float)room2.lot.decoFix2 * 0.01f; // [!code --]
					param.z += (float)room2.lot.decoFix2 * 0.01f * heightModDeco; // [!code --]
					float num17 = param.z; // [!code ++]
					param.y += (float)room.lot.decoFix2 * 0.01f; // [!code ++]
					param.z += (float)room.lot.decoFix2 * 0.01f * heightModDeco; // [!code ++]
					rendererWallDeco.Draw(param);
					param.y = y2;
					param.z = num30; // [!code --]
					param.z = num17; // [!code ++]
				}
			}
			room2 = this.cell.Right.room ?? this.cell.room; // [!code --]
			if (room2 == null && this.cell.Front.room != null) // [!code --]
			room = this.cell.Right.room ?? this.cell.room; // [!code ++]
			if (room == null && this.cell.Front.room != null) // [!code ++]
			{
				room2 = this.cell.Front.room; // [!code --]
				room = this.cell.Front.room; // [!code ++]
			}
			if (!invisible && room2 != null) // [!code --]
			if (!invisible && room != null) // [!code ++]
			{
				if (room2.lot.idDeco != 0 && !this.cell.hasDoor) // [!code --]
				if (room.lot.idDeco != 0 && !this.cell.hasDoor) // [!code ++]
				{
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco) * -1; // [!code --]
					param.matColor = room2.lot.colDeco; // [!code --]
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room.lot.idDeco) * -1; // [!code ++]
					param.matColor = room.lot.colDeco; // [!code ++]
					float y3 = param.y;
					param.y += (float)room2.lot.decoFix * 0.01f; // [!code --]
					param.y += (float)room.lot.decoFix * 0.01f; // [!code ++]
					rendererWallDeco.Draw(param);
					param.y = y3;
				}
				if (room2.lot.idDeco2 != 0 && roomHeight != 0f && (float)room2.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code --]
				if (room.lot.idDeco2 != 0 && roomHeight != 0f && (float)room.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code ++]
				{
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco2) * -1; // [!code --]
					param.matColor = room2.lot.colDeco2; // [!code --]
					param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room.lot.idDeco2) * -1; // [!code ++]
					param.matColor = room.lot.colDeco2; // [!code ++]
					float y4 = param.y;
					float num31 = param.z; // [!code --]
					param.y += (float)room2.lot.decoFix2 * 0.01f; // [!code --]
					param.z += (float)room2.lot.decoFix2 * 0.01f * heightModDeco; // [!code --]
					float num18 = param.z; // [!code ++]
					param.y += (float)room.lot.decoFix2 * 0.01f; // [!code ++]
					param.z += (float)room.lot.decoFix2 * 0.01f * heightModDeco; // [!code ++]
					rendererWallDeco.Draw(param);
					param.y = y4;
					param.z = num31; // [!code --]
					param.z = num18; // [!code ++]
				}
			}
			break;
```

[`@@ -2813,56 +2384,167 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2813-L2868)
```cs:line-numbers=2813
			orgY = param.y;
			orgZ = param.z;
			param.color = (this.tileType.IsFence ? (floorLight - (float)((int)(_shadowStrength * 0.8f * 50f) * 262144)) : blockLight);
			bool flag10 = blockDir == 1 || _lowblock || flag9; // [!code --]
			bool flag11 = blockDir == 0 || _lowblock || flag9; // [!code --]
			bool flag8 = blockDir == 1 || _lowblock || flag7; // [!code ++]
			bool flag9 = blockDir == 0 || _lowblock || flag7; // [!code ++]
			if (!showFullWall && currentRoom != null)
			{
				if (!flag10) // [!code --]
				if (!flag8) // [!code ++]
				{
					if (currentRoom == this.cell.room || (this.cell.lotWall && this.cell.room?.lot == currentLot && this.cell.Front.room != currentRoom))
					{
						if (!this.cell.IsRoomEdge || (this.cell.Front.room != this.cell.room && this.cell.FrontRight.room != this.cell.room))
						{
							flag10 = true; // [!code --]
							flag8 = true; // [!code ++]
						}
					}
					else if ((!this.cell.Front.lotWall || this.cell.Front.room?.lot != currentLot) && this.cell.Front.room != currentRoom)
					{
						flag10 = true; // [!code --]
						flag8 = true; // [!code ++]
					}
				}
				if (!flag11) // [!code --]
				if (!flag9) // [!code ++]
				{
					if (currentRoom == this.cell.room || (this.cell.lotWall && this.cell.room?.lot == currentLot && this.cell.Right.room != currentRoom))
					{
						if (!this.cell.IsRoomEdge || (this.cell.Right.room != this.cell.room && this.cell.FrontRight.room != this.cell.room))
						{
							flag11 = true; // [!code --]
							flag9 = true; // [!code ++]
						}
					}
					else if ((!this.cell.Right.lotWall || this.cell.Right.room?.lot != currentLot) && this.cell.Right.room != currentRoom)
					{
						flag11 = true; // [!code --]
						flag9 = true; // [!code ++]
					}
				}
			}
			if (blockDir == 0 || blockDir == 2)
			{
				param.dir = 0;
				Room room3 = this.cell.Front.room ?? this.cell.room; // [!code --]
				Room room2 = this.cell.Front.room ?? this.cell.room; // [!code ++]
				if (room2 != null && this.tileType.IsWall) // [!code ++]
				{ // [!code ++]
					if (room2.lot.idDeco != 0 && !this.cell.hasDoor) // [!code ++]
					{ // [!code ++]
						param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco); // [!code ++]
						param.matColor = room2.lot.colDeco; // [!code ++]
						param.y += (float)room2.lot.decoFix * 0.01f; // [!code ++]
						rendererWallDeco.Draw(param); // [!code ++]
						param.y = orgY; // [!code ++]
					} // [!code ++]
					if (room2.lot.idDeco2 != 0 && roomHeight != 0f && !flag8 && (float)room2.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code ++]
					{ // [!code ++]
						param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room2.lot.idDeco2); // [!code ++]
						param.matColor = room2.lot.colDeco2; // [!code ++]
						param.y += (float)room2.lot.decoFix2 * 0.01f; // [!code ++]
						param.z += (float)room2.lot.decoFix2 * 0.01f * heightModDeco; // [!code ++]
						rendererWallDeco.Draw(param); // [!code ++]
						param.y = orgY; // [!code ++]
						param.z = orgZ; // [!code ++]
					} // [!code ++]
				} // [!code ++]
				Cell left = this.cell.Left; // [!code ++]
				if (blockDir == 2 && left.sourceBlock.tileType.IsWallOrFence && !this.cell.crossWall) // [!code ++]
				{ // [!code ++]
					_sourceBlock = left.sourceBlock; // [!code ++]
					param.mat = left.matBlock; // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					_sourceBlock = sourceBlock; // [!code ++]
					param.mat = matBlock; // [!code ++]
				} // [!code ++]
				this.tileType = _sourceBlock.tileType; // [!code ++]
				param.tile = (tile = _sourceBlock._tiles[0] + ((flag8 && !this.tileType.IsFence) ? 32 : 0)); // [!code ++]
				if (_sourceBlock.useAltColor) // [!code ++]
				{ // [!code ++]
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, _sourceBlock.colorMod)); // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, _sourceBlock.colorMod)); // [!code ++]
				} // [!code ++]
				if (roomHeight == 0f || flag8 || !this.tileType.RepeatBlock) // [!code ++]
				{ // [!code ++]
					if (!this.cell.hasDoor) // [!code ++]
					{ // [!code ++]
						_sourceBlock.renderData.Draw(param); // [!code ++]
					} // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix, this.cell.hasDoor, this.cell.effect?.FireAmount ?? 0); // [!code ++]
				} // [!code ++]
				param.z += cornerWallFix2.z; // [!code ++]
				if ((blockDir == 2 || (this.cell.Front.HasWallOrFence && this.cell.Front.blockDir != 0)) != this.cell.isToggleWallPillar) // [!code ++]
				{ // [!code ++]
					if (this.cell.Back.IsSnowTile && this.cell.Right.IsSnowTile) // [!code ++]
					{ // [!code ++]
						param.snow = true; // [!code ++]
					} // [!code ++]
					param.tile = _sourceBlock._tiles[0] + ((flag8 && flag9 && !this.tileType.IsFence && !flag7) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code ++]
					if (roomHeight == 0f || !this.tileType.RepeatBlock || (flag8 && flag9 && !flag7)) // [!code ++]
					{ // [!code ++]
						_sourceBlock.renderData.Draw(param); // [!code ++]
					} // [!code ++]
					else // [!code ++]
					{ // [!code ++]
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix); // [!code ++]
					} // [!code ++]
				} // [!code ++]
				if (!flag8 && !showRoof && this.cell.Left.HasWallOrFence && this.cell.Left.blockDir != 0 && !this.cell.isToggleWallPillar) // [!code ++]
				{ // [!code ++]
					orgX = param.x; // [!code ++]
					param.tile = _sourceBlock._tiles[0] + ((flag8 && !this.tileType.IsFence && !flag7) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code ++]
					param.x += cornerWallFix3.x; // [!code ++]
					param.y += cornerWallFix3.y; // [!code ++]
					param.z += cornerWallFix3.z; // [!code ++]
					if (!flag7 && (roomHeight == 0f || flag8)) // [!code ++]
					{ // [!code ++]
						_sourceBlock.renderData.Draw(param); // [!code ++]
					} // [!code ++]
					else // [!code ++]
					{ // [!code ++]
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight + cornerWallFix.y, ref renderSetting.peakFix); // [!code ++]
					} // [!code ++]
					param.x = orgX; // [!code ++]
				} // [!code ++]
				else if (this.cell.FrontLeft.HasWallOrFence && this.cell.FrontLeft.blockDir != 0 && (!flag8 || !this.cell.Left.HasWall) && !this.cell.isToggleWallPillar) // [!code ++]
				{ // [!code ++]
					orgX = param.x; // [!code ++]
					param.tile = _sourceBlock._tiles[0] + ((flag8 && !this.tileType.IsFence && !flag7) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code ++]
					param.x += cornerWallFix.x; // [!code ++]
					param.y += cornerWallFix.y; // [!code ++]
					param.z += cornerWallFix.z; // [!code ++]
					if (!flag7 && (roomHeight == 0f || flag8)) // [!code ++]
					{ // [!code ++]
						_sourceBlock.renderData.Draw(param); // [!code ++]
					} // [!code ++]
					else // [!code ++]
					{ // [!code ++]
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight + cornerWallFix.y, ref renderSetting.peakFix); // [!code ++]
					} // [!code ++]
					param.x = orgX; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (blockDir == 1 || blockDir == 2) // [!code ++]
			{ // [!code ++]
				param.y = orgY; // [!code ++]
				param.z = orgZ; // [!code ++]
				param.dir = 1; // [!code ++]
				Room room3 = this.cell.Right.room ?? this.cell.room; // [!code ++]
				if (room3 != null && this.tileType.IsWall)
				{
					if (room3.lot.idDeco != 0 && !this.cell.hasDoor)
					{
						param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room3.lot.idDeco); // [!code --]
						param.tile = -EMono.sources.blocks.rows[0].ConvertTile(1000 + room3.lot.idDeco); // [!code ++]
						param.matColor = room3.lot.colDeco;
						param.y += (float)room3.lot.decoFix * 0.01f;
						rendererWallDeco.Draw(param);
						param.y = orgY;
					}
					if (room3.lot.idDeco2 != 0 && roomHeight != 0f && !flag10 && (float)room3.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code --]
					if (room3.lot.idDeco2 != 0 && roomHeight != 0f && !flag9 && (float)room3.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code ++]
					{
						param.tile = EMono.sources.blocks.rows[0].ConvertTile(1000 + room3.lot.idDeco2); // [!code --]
						param.tile = -EMono.sources.blocks.rows[0].ConvertTile(1000 + room3.lot.idDeco2); // [!code ++]
						param.matColor = room3.lot.colDeco2;
						param.y += (float)room3.lot.decoFix2 * 0.01f;
						param.z += (float)room3.lot.decoFix2 * 0.01f * heightModDeco;
```

[`@@ -2871,11 +2553,29 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2871-L2881)
```cs:line-numbers=2871
						param.z = orgZ;
					}
				}
				Cell left = this.cell.Left; // [!code --]
				if (blockDir == 2 && left.sourceBlock.tileType.IsWallOrFence && !this.cell.crossWall) // [!code --]
				if (blockDir == 2 && this.cell.room == null && this.cell.Right.room != null) // [!code ++]
				{
					_sourceBlock = left.sourceBlock; // [!code --]
					param.mat = left.matBlock; // [!code --]
					Room room4 = this.cell.Right.room; // [!code ++]
					maxHeight = (float)(cz - cx) * screen.tileAlign.y + (float)room4.lot.mh * _heightMod.y; // [!code ++]
					if (showRoof) // [!code ++]
					{ // [!code ++]
						roomHeight = room4.lot.realHeight; // [!code ++]
					} // [!code ++]
					else if ((noRoofMode && currentRoom == null) || (_lowblock && !this.tileType.ForceRpeatBlock)) // [!code ++]
					{ // [!code ++]
						roomHeight = 0f; // [!code ++]
					} // [!code ++]
					else // [!code ++]
					{ // [!code ++]
						int num19 = ((room4.data.maxHeight == 0) ? 2 : room4.data.maxHeight); // [!code ++]
						roomHeight = EMono.setting.render.roomHeightMod * (float)((room4.lot.height < num19) ? room4.lot.height : num19) + 0.01f * (float)room4.lot.heightFix; // [!code ++]
					} // [!code ++]
				} // [!code ++]
				Cell back2 = this.cell.Back; // [!code ++]
				if (blockDir == 2 && back2.sourceBlock.tileType.IsWallOrFence && !this.cell.crossWall) // [!code ++]
				{ // [!code ++]
					_sourceBlock = back2.sourceBlock; // [!code ++]
					param.mat = back2.matBlock; // [!code ++]
				}
				else
				{
```

[`@@ -2883,7 +2583,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2883-L2889)
```cs:line-numbers=2883
					param.mat = matBlock;
				}
				this.tileType = _sourceBlock.tileType;
				param.tile = (tile = _sourceBlock._tiles[0] + ((flag10 && !this.tileType.IsFence) ? 32 : 0)); // [!code --]
				param.tile = (tile = -_sourceBlock._tiles[0] + ((flag9 && !this.tileType.IsFence) ? (-32) : 0)); // [!code ++]
				if (_sourceBlock.useAltColor)
				{
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, _sourceBlock.colorMod));
```

[`@@ -2892,7 +2592,8 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2892-L2898)
```cs:line-numbers=2892
				{
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, _sourceBlock.colorMod));
				}
				if (roomHeight == 0f || flag10 || !this.tileType.RepeatBlock) // [!code --]
				param.color += _rightWallShade; // [!code ++]
				if (roomHeight == 0f || flag9 || !this.tileType.RepeatBlock) // [!code ++]
				{
					if (!this.cell.hasDoor)
					{
```

[`@@ -2903,15 +2604,15 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2903-L2917)
```cs:line-numbers=2903
				{
					_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix, this.cell.hasDoor, this.cell.effect?.FireAmount ?? 0);
				}
				param.z += cornerWallFix2.z; // [!code --]
				if ((blockDir == 2 || (this.cell.Front.HasWallOrFence && this.cell.Front.blockDir != 0)) != this.cell.isToggleWallPillar) // [!code --]
				if ((this.cell.Right.HasWallOrFence && this.cell.Right.blockDir != 1) != this.cell.isToggleWallPillar && (blockDir != 2 || !this.cell.isToggleWallPillar)) // [!code ++]
				{
					if (this.cell.Back.IsSnowTile && this.cell.Right.IsSnowTile) // [!code --]
					if (this.cell.Left.IsSnowTile && this.cell.Front.IsSnowTile) // [!code ++]
					{
						param.snow = true;
					}
					param.tile = _sourceBlock._tiles[0] + ((flag10 && flag11 && !this.tileType.IsFence && !flag9) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code --]
					if (roomHeight == 0f || !this.tileType.RepeatBlock || (flag10 && flag11 && !flag9)) // [!code --]
					orgX = param.x; // [!code ++]
					param.tile = _sourceBlock._tiles[0] + ((flag9 && !this.tileType.IsFence && !flag7) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code ++]
					if (!flag7 && (roomHeight == 0f || !this.tileType.RepeatBlock || flag9)) // [!code ++]
					{
						_sourceBlock.renderData.Draw(param);
					}
```

[`@@ -2919,203 +2620,513 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/BaseTileMap.cs#L2919-L3121)
```cs:line-numbers=2919
					{
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix);
					}
					param.x = orgX; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			param.y = orgY; // [!code ++]
			param.z = orgZ; // [!code ++]
			break; // [!code ++]
		} // [!code ++]
		case BlockRenderMode.HalfBlock: // [!code ++]
			param.color = floorLight; // [!code ++]
			_sourceBlock = ((sourceBlock.id == 5) ? EMono.sources.blocks.rows[matBlock.defBlock] : sourceBlock); // [!code ++]
			param.tile = _sourceBlock._tiles[0]; // [!code ++]
			param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, _sourceBlock.colorMod)); // [!code ++]
			param.tile2 = _sourceBlock.sourceAutoFloor._tiles[0]; // [!code ++]
			param.halfBlockColor = ((_sourceBlock.sourceAutoFloor.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, _sourceBlock.sourceAutoFloor.colorMod)); // [!code ++]
			sourceBlock.renderData.Draw(param); // [!code ++]
			break; // [!code ++]
		case BlockRenderMode.Pillar: // [!code ++]
		{ // [!code ++]
			RenderData renderData2 = sourceBlock.renderData; // [!code ++]
			param.tile = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length]; // [!code ++]
			param.matColor = ((sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, sourceBlock.colorMod)); // [!code ++]
			int num20 = this.cell.objDir + ((this.cell.objDir >= 7) ? this.cell.objDir : 0) + 1; // [!code ++]
			if (num20 == 0) // [!code ++]
			{ // [!code ++]
				renderData2.Draw(param); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				renderData2.DrawRepeat(param, num20, sourceBlock.tileType.RepeatSize); // [!code ++]
			} // [!code ++]
			param.tile = renderData2.idShadow; // [!code ++]
			SourcePref shadowPref2 = renderData2.shadowPref; // [!code ++]
			int shadow4 = shadowPref2.shadow; // [!code ++]
			passShadow.AddShadow(param.x + renderData2.offsetShadow.x, param.y + renderData2.offsetShadow.y, param.z + renderData2.offsetShadow.z, ShadowData.Instance.items[shadow4], shadowPref2, 0, param.snow); // [!code ++]
			break; // [!code ++]
		} // [!code ++]
		default: // [!code ++]
			param.color = floorLight; // [!code ++]
			param.tile = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length] + ((_lowblock && this.tileType.UseLowWallTiles) ? 3000000 : 0); // [!code ++]
			param.matColor = ((sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, sourceBlock.colorMod)); // [!code ++]
			if (roomHeight == 0f) // [!code ++]
			{ // [!code ++]
				sourceBlock.renderData.Draw(param); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFixBlock); // [!code ++]
			} // [!code ++]
			break; // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (this.cell.pcSync && EMono.player.lightPower > 0f && !cinemaMode) // [!code ++]
	{ // [!code ++]
		if (this.cell.room != null || !this.cell.IsRoomEdge || !showRoof) // [!code ++]
		{ // [!code ++]
			goto IL_6f4f; // [!code ++]
		} // [!code ++]
		if (this.cell._block == 0 || !this.cell.sourceBlock.tileType.RepeatBlock) // [!code ++]
		{ // [!code ++]
			Room obj = this.cell.FrontRight.room; // [!code ++]
			if (obj == null || !obj.HasRoof) // [!code ++]
			{ // [!code ++]
				goto IL_6f4f; // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
	goto IL_6faf; // [!code ++]
	IL_7b6a: // [!code ++]
	if (detail.things.Count == 0 && detail.charas.Count == 0) // [!code ++]
	{ // [!code ++]
		return; // [!code ++]
	} // [!code ++]
	int num21 = 0; // [!code ++]
	thingPos.x = 0f; // [!code ++]
	thingPos.y = 0f; // [!code ++]
	thingPos.z = 0f; // [!code ++]
	freePos.x = (freePos.y = (freePos.z = 0f)); // [!code ++]
	if (this.cell.HasRamp) // [!code ++]
	{ // [!code ++]
		Vector3 rampFix = sourceBlock.tileType.GetRampFix(this.cell.blockDir); // [!code ++]
		param.x += rampFix.x; // [!code ++]
		param.y += rampFix.y; // [!code ++]
		param.z += rampFix.z; // [!code ++]
		freePos.x += rampFix.x; // [!code ++]
		freePos.y += rampFix.y; // [!code ++]
		freePos.z += rampFix.z; // [!code ++]
	} // [!code ++]
	param.y += (flag ? 0f : ((this.cell._bridge != 0) ? this.cell.sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight)); // [!code ++]
	orgPos.x = (orgX = param.x); // [!code ++]
	orgPos.y = (orgY = param.y); // [!code ++]
	orgPos.z = (orgZ = param.z); // [!code ++]
	if (flag && liquidLv > 0) // [!code ++]
	{ // [!code ++]
		if (liquidLv > 10) // [!code ++]
		{ // [!code ++]
			liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code ++]
		} // [!code ++]
		liquidLv -= (int)(floatY * 0.5f); // [!code ++]
		param.liquidLv = liquidLv; // [!code ++]
		param.y -= TileType.FloorWaterShallow.FloorHeight; // [!code ++]
	} // [!code ++]
	Thing thing = null; // [!code ++]
	bool shadow = liquidLv == 0; // [!code ++]
	float num22 = 0f; // [!code ++]
	float num23 = 0f; // [!code ++]
	bool flag10 = false; // [!code ++]
	float num24 = 0f; // [!code ++]
	bool flag11 = false; // [!code ++]
	float num25 = 0f; // [!code ++]
	if (detail.things.Count > 0 && isSeen) // [!code ++]
	{ // [!code ++]
		_ = zSetting.max1; // [!code ++]
		float num26 = 0f; // [!code ++]
		for (int m = 0; m < detail.things.Count; m++) // [!code ++]
		{ // [!code ++]
			Thing t = detail.things[m]; // [!code ++]
			if ((fogged && !t.isRoofItem) || ((t.isHidden || t.trait.HideInAdv || t.isMasked) && !EMono.scene.actionMode.ShowMaskedThings) || (t.isRoofItem && ((this.room == null && !sourceBlock.tileType.IsFullBlock && !EMono._zone.IsPCFaction) || (lowBlock && !showFullWall && this.room != null) || (noRoofMode && currentRoom == null))) || (flag3 && !t.isRoofItem)) // [!code ++]
			{ // [!code ++]
				continue; // [!code ++]
			} // [!code ++]
			TileType tileType = t.trait.tileType; // [!code ++]
			bool isInstalled = t.IsInstalled; // [!code ++]
			SourcePref pref = t.Pref; // [!code ++]
			if (!isInstalled && t.category.tileDummy != 0) // [!code ++]
			{ // [!code ++]
				pref = rendererObjDummy.shadowPref; // [!code ++]
			} // [!code ++]
			float num27 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code ++]
			if (t.ignoreStackHeight) // [!code ++]
			{ // [!code ++]
				thingPos.y -= num22; // [!code ++]
			} // [!code ++]
			shadow = thingPos.y < 0.16f && num25 < 0.16f; // [!code ++]
			_ = pref.bypassShadow; // [!code ++]
			param.shadowFix = 0f - thingPos.y; // [!code ++]
			param.liquidLv = ((thingPos.y + (float)t.altitude < 0.1f) ? liquidLv : 0); // [!code ++]
			if (t.isRoofItem) // [!code ++]
			{ // [!code ++]
				param.snow = isSnowCovered && !this.cell.isClearSnow; // [!code ++]
				SetRoofHeight(param, this.cell, cx, cz); // [!code ++]
				_actorPos.x = param.x; // [!code ++]
				_actorPos.y = param.y; // [!code ++]
				_actorPos.z = param.z + num26; // [!code ++]
				if (this.room != null) // [!code ++]
				{ // [!code ++]
					param.color = GetRoofLight(this.room.lot); // [!code ++]
				} // [!code ++]
				shadow = false; // [!code ++]
				param.liquidLv = 0; // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				param.snow = snowed; // [!code ++]
				_actorPos.x = orgX + num23; // [!code ++]
				_actorPos.y = orgY; // [!code ++]
				_actorPos.z = orgZ + num26 + thingPos.z; // [!code ++]
				if (tileType.CanStack || !isInstalled) // [!code ++]
				{ // [!code ++]
					if (thing?.id != t.id) // [!code ++]
					{ // [!code ++]
						_actorPos.x += thingPos.x; // [!code ++]
					} // [!code ++]
					_actorPos.y += thingPos.y; // [!code ++]
					if (t.trait.IgnoreLastStackHeight && (thing == null || !thing.trait.IgnoreLastStackHeight)) // [!code ++]
					{ // [!code ++]
						thingPos.y -= num22; // [!code ++]
						if (thing != null) // [!code ++]
						{ // [!code ++]
							_actorPos.z -= 0.2f; // [!code ++]
							thingPos.z -= 0.2f; // [!code ++]
						} // [!code ++]
						_actorPos.y -= num22; // [!code ++]
					} // [!code ++]
					_actorPos.z += renderSetting.thingZ + (float)m * -0.01f + zSetting.mod1 * thingPos.y; // [!code ++]
				}
				if (!flag10 && !showRoof && this.cell.Left.HasWallOrFence && this.cell.Left.blockDir != 0 && !this.cell.isToggleWallPillar) // [!code --]
				if (isInstalled) // [!code ++]
				{
					orgX = param.x; // [!code --]
					param.tile = _sourceBlock._tiles[0] + ((flag10 && !this.tileType.IsFence && !flag9) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code --]
					param.x += cornerWallFix3.x; // [!code --]
					param.y += cornerWallFix3.y; // [!code --]
					param.z += cornerWallFix3.z; // [!code --]
					if (!flag9 && (roomHeight == 0f || flag10)) // [!code --]
					if (t.TileType.IsRamp) // [!code ++]
					{
						_sourceBlock.renderData.Draw(param); // [!code --]
						Vector3 rampFix2 = t.TileType.GetRampFix(t.dir, pref); // [!code ++]
						orgX += rampFix2.x; // [!code ++]
						orgY += rampFix2.y; // [!code ++]
						orgZ += rampFix2.z; // [!code ++]
						freePos.x += rampFix2.x; // [!code ++]
						freePos.y += rampFix2.y; // [!code ++]
						freePos.z += rampFix2.z; // [!code ++]
						if (!this.cell.IsTopWater || t.altitude > 0) // [!code ++]
						{ // [!code ++]
							num25 += rampFix2.y; // [!code ++]
						} // [!code ++]
						liquidLv -= (int)(rampFix2.y * 150f); // [!code ++]
						if (liquidLv < 0) // [!code ++]
						{ // [!code ++]
							liquidLv = 0; // [!code ++]
						} // [!code ++]
					} // [!code ++]
					else if (!flag11 && t.trait.IsChangeFloorHeight && !t.ignoreStackHeight) // [!code ++]
					{ // [!code ++]
						orgY += num27 + (float)t.altitude * altitudeFix.y; // [!code ++]
						orgZ += (float)t.altitude * altitudeFix.z; // [!code ++]
						freePos.y += num27 + (float)t.altitude * altitudeFix.y; // [!code ++]
						if (!this.cell.IsTopWater || t.altitude > 0) // [!code ++]
						{ // [!code ++]
							num25 += num27 + (float)t.altitude * altitudeFix.y; // [!code ++]
						} // [!code ++]
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
						_actorPos.z += pref.z; // [!code ++]
						thingPos.z += pref.z; // [!code ++]
						liquidLv -= (int)(num27 * 150f); // [!code ++]
						if (liquidLv < 0) // [!code ++]
						{ // [!code ++]
							liquidLv = 0; // [!code ++]
						} // [!code ++]
					}
					else
					{
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight + cornerWallFix.y, ref renderSetting.peakFix); // [!code --]
						thingPos.y += num27; // [!code ++]
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
						_actorPos.z += pref.z; // [!code ++]
						if (pref.height >= 0f) // [!code ++]
						{ // [!code ++]
							thingPos.z += pref.z; // [!code ++]
						} // [!code ++]
					} // [!code ++]
					if (!tileType.UseMountHeight && m > 10) // [!code ++]
					{ // [!code ++]
						flag11 = true; // [!code ++]
					}
					param.x = orgX; // [!code --]
				}
				else if (this.cell.FrontLeft.HasWallOrFence && this.cell.FrontLeft.blockDir != 0 && (!flag10 || !this.cell.Left.HasWall) && !this.cell.isToggleWallPillar) // [!code --]
				else // [!code ++]
				{
					orgX = param.x; // [!code --]
					param.tile = _sourceBlock._tiles[0] + ((flag10 && !this.tileType.IsFence && !flag9) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code --]
					param.x += cornerWallFix.x; // [!code --]
					param.y += cornerWallFix.y; // [!code --]
					param.z += cornerWallFix.z; // [!code --]
					if (!flag9 && (roomHeight == 0f || flag10)) // [!code --]
					thingPos.y += num27; // [!code ++]
					_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
					_actorPos.z += pref.z; // [!code ++]
					thingPos.z += pref.z; // [!code ++]
				} // [!code ++]
				if (t.isFloating && isWater && !hasBridge && !flag) // [!code ++]
				{ // [!code ++]
					flag = true; // [!code ++]
					float num28 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code ++]
					orgY += 0.01f * floatY - num28; // [!code ++]
					num24 = num27; // [!code ++]
					_actorPos.y += 0.01f * floatY - num28; // [!code ++]
					if (liquidLv > 10) // [!code ++]
					{
						_sourceBlock.renderData.Draw(param); // [!code --]
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code ++]
					} // [!code ++]
					liquidLv -= (int)(floatY * 0.5f); // [!code ++]
					if (liquidLv < 0) // [!code ++]
					{ // [!code ++]
						liquidLv = 0; // [!code ++]
					} // [!code ++]
					param.liquidLv = liquidLv; // [!code ++]
				} // [!code ++]
				num22 = num27; // [!code ++]
				if (t.sourceCard.multisize && !t.trait.IsGround) // [!code ++]
				{ // [!code ++]
					num26 += zSetting.multiZ; // [!code ++]
				} // [!code ++]
				orgZ += t.renderer.data.stackZ; // [!code ++]
				if (param.liquidLv > 0) // [!code ++]
				{ // [!code ++]
					param.liquidLv += pref.liquidMod; // [!code ++]
					if (param.liquidLv < 1) // [!code ++]
					{ // [!code ++]
						param.liquidLv = 1; // [!code ++]
					}
					else // [!code --]
					else if (param.liquidLv > 99 + pref.liquidModMax) // [!code ++]
					{
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight + cornerWallFix.y, ref renderSetting.peakFix); // [!code --]
						param.liquidLv = 99 + pref.liquidModMax; // [!code ++]
					}
					param.x = orgX; // [!code --]
				}
			}
			if (blockDir == 1 || blockDir == 2) // [!code --]
			if (isInstalled && tileType.UseMountHeight) // [!code ++]
			{
				param.y = orgY; // [!code --]
				param.z = orgZ; // [!code --]
				param.dir = 1; // [!code --]
				Room room4 = this.cell.Right.room ?? this.cell.room; // [!code --]
				if (room4 != null && this.tileType.IsWall) // [!code --]
				if (tileType != TileType.Illumination || !this.cell.HasObj) // [!code ++]
				{
					if (room4.lot.idDeco != 0 && !this.cell.hasDoor) // [!code --]
					if (noRoofMode && currentRoom == null && t.altitude >= lowWallObjAltitude) // [!code ++]
					{
						param.tile = -EMono.sources.blocks.rows[0].ConvertTile(1000 + room4.lot.idDeco); // [!code --]
						param.matColor = room4.lot.colDeco; // [!code --]
						param.y += (float)room4.lot.decoFix * 0.01f; // [!code --]
						rendererWallDeco.Draw(param); // [!code --]
						param.y = orgY; // [!code --]
						continue; // [!code ++]
					}
					if (room4.lot.idDeco2 != 0 && roomHeight != 0f && !flag11 && (float)room4.lot.decoFix2 * 0.01f + heightLimitDeco < roomHeight + maxHeight - param.y) // [!code --]
					if (hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code ++]
					{
						param.tile = -EMono.sources.blocks.rows[0].ConvertTile(1000 + room4.lot.idDeco2); // [!code --]
						param.matColor = room4.lot.colDeco2; // [!code --]
						param.y += (float)room4.lot.decoFix2 * 0.01f; // [!code --]
						param.z += (float)room4.lot.decoFix2 * 0.01f * heightModDeco; // [!code --]
						rendererWallDeco.Draw(param); // [!code --]
						param.y = orgY; // [!code --]
						param.z = orgZ; // [!code --]
						Room room5 = ((t.dir == 0) ? this.cell.Back.room : this.cell.Left.room); // [!code ++]
						if (t.trait.AlwaysHideOnLowWall) // [!code ++]
						{ // [!code ++]
							if (room5 == null || !room5.data.showWallItem) // [!code ++]
							{ // [!code ++]
								continue; // [!code ++]
							} // [!code ++]
						} // [!code ++]
						else if (t.altitude >= lowWallObjAltitude) // [!code ++]
						{ // [!code ++]
							continue; // [!code ++]
						} // [!code ++]
					}
				}
				if (blockDir == 2 && this.cell.room == null && this.cell.Right.room != null) // [!code --]
				if (tileType.UseHangZFix) // [!code ++]
				{
					Room room5 = this.cell.Right.room; // [!code --]
					maxHeight = (float)(cz - cx) * screen.tileAlign.y + (float)room5.lot.mh * _heightMod.y; // [!code --]
					if (showRoof) // [!code --]
					{ // [!code --]
						roomHeight = room5.lot.realHeight; // [!code --]
					} // [!code --]
					else if ((noRoofMode && currentRoom == null) || (_lowblock && !this.tileType.ForceRpeatBlock)) // [!code --]
					{ // [!code --]
						roomHeight = 0f; // [!code --]
					} // [!code --]
					else // [!code --]
					{ // [!code --]
						int num32 = ((room5.data.maxHeight == 0) ? 2 : room5.data.maxHeight); // [!code --]
						roomHeight = EMono.setting.render.roomHeightMod * (float)((room5.lot.height < num32) ? room5.lot.height : num32) + 0.01f * (float)room5.lot.heightFix; // [!code --]
					} // [!code --]
					flag10 = true; // [!code ++]
				}
				Cell back2 = this.cell.Back; // [!code --]
				if (blockDir == 2 && back2.sourceBlock.tileType.IsWallOrFence && !this.cell.crossWall) // [!code --]
				tileType.GetMountHeight(ref _actorPos, Point.shared.Set(index), t.dir, t); // [!code ++]
				shadow = false; // [!code ++]
				param.liquidLv = 0; // [!code ++]
				if (t.freePos) // [!code ++]
				{
					_sourceBlock = back2.sourceBlock; // [!code --]
					param.mat = back2.matBlock; // [!code --]
					_actorPos.x += t.fx; // [!code ++]
					_actorPos.y += t.fy; // [!code ++]
				}
				else // [!code --]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				if (t.altitude != 0) // [!code ++]
				{
					_sourceBlock = sourceBlock; // [!code --]
					param.mat = matBlock; // [!code --]
					_actorPos += altitudeFix * t.altitude; // [!code ++]
					if (t.altitude > 2 && ((this.cell.Back.room != null && this.cell.Back.IsRoomEdge) || (this.cell.Left.room != null && this.cell.Left.IsRoomEdge)) && hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code ++]
					{ // [!code ++]
						continue; // [!code ++]
					} // [!code ++]
				}
				this.tileType = _sourceBlock.tileType; // [!code --]
				param.tile = (tile = -_sourceBlock._tiles[0] + ((flag11 && !this.tileType.IsFence) ? (-32) : 0)); // [!code --]
				if (_sourceBlock.useAltColor) // [!code --]
				if (t.freePos) // [!code ++]
				{
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, _sourceBlock.colorMod)); // [!code --]
					_actorPos.x = orgX + t.fx - freePos.x; // [!code ++]
					_actorPos.y = orgY + t.fy - freePos.y; // [!code ++]
				}
				else // [!code --]
				if (t.trait is TraitDoor && (t.trait as TraitDoor).IsOpen()) // [!code ++]
				{
					param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, _sourceBlock.colorMod)); // [!code --]
					_actorPos.z += -0.5f; // [!code ++]
				}
				param.color += _rightWallShade; // [!code --]
				if (roomHeight == 0f || flag11 || !this.tileType.RepeatBlock) // [!code --]
			} // [!code ++]
			if (!t.sourceCard.multisize || (t.pos.x == cx && t.pos.z == cz)) // [!code ++]
			{ // [!code ++]
				if (iconMode != 0) // [!code ++]
				{
					if (!this.cell.hasDoor) // [!code --]
					int num29 = 0; // [!code ++]
					switch (iconMode) // [!code ++]
					{
						_sourceBlock.renderData.Draw(param); // [!code --]
					case CardIconMode.Visibility: // [!code ++]
						if (t.isMasked) // [!code ++]
						{ // [!code ++]
							num29 = 17; // [!code ++]
						} // [!code ++]
						break; // [!code ++]
					case CardIconMode.State: // [!code ++]
						if (t.placeState == PlaceState.installed) // [!code ++]
						{ // [!code ++]
							num29 = 18; // [!code ++]
						} // [!code ++]
						break; // [!code ++]
					case CardIconMode.Deconstruct: // [!code ++]
						if (t.isDeconstructing) // [!code ++]
						{ // [!code ++]
							num29 = 14; // [!code ++]
						} // [!code ++]
						break; // [!code ++]
					}
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix, this.cell.hasDoor, this.cell.effect?.FireAmount ?? 0); // [!code --]
				} // [!code --]
				if ((this.cell.Right.HasWallOrFence && this.cell.Right.blockDir != 1) != this.cell.isToggleWallPillar && (blockDir != 2 || !this.cell.isToggleWallPillar)) // [!code --]
				{ // [!code --]
					if (this.cell.Left.IsSnowTile && this.cell.Front.IsSnowTile) // [!code --]
					if (t.isNPCProperty && !EMono.debug.godBuild) // [!code ++]
					{
						param.snow = true; // [!code --]
						num29 = 13; // [!code ++]
					}
					orgX = param.x; // [!code --]
					param.tile = _sourceBlock._tiles[0] + ((flag11 && !this.tileType.IsFence && !flag9) ? 32 : 0) + (this.tileType.IsFence ? 32 : 64); // [!code --]
					if (!flag9 && (roomHeight == 0f || !this.tileType.RepeatBlock || flag11)) // [!code --]
					if (num29 != 0) // [!code ++]
					{
						_sourceBlock.renderData.Draw(param); // [!code --]
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num29); // [!code ++]
					}
					else // [!code --]
				} // [!code ++]
				t.SetRenderParam(param); // [!code ++]
				if (_lowblock && t.trait.UseLowblock && !this.cell.HasFullBlock) // [!code ++]
				{ // [!code ++]
					param.tile += ((param.tile < 0f) ? (-64) : 64); // [!code ++]
				} // [!code ++]
				if (t.trait is TraitTrolley && EMono.pc.ai is AI_Trolley aI_Trolley && aI_Trolley.trolley.owner == t) // [!code ++]
				{ // [!code ++]
					RenderParam _param = new RenderParam(param); // [!code ++]
					EMono.core.actionsLateUpdate.Add(delegate // [!code ++]
					{
						_sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFix); // [!code --]
					} // [!code --]
					param.x = orgX; // [!code --]
						t.SetRenderParam(_param); // [!code ++]
						_actorPos.x = EMono.pc.renderer.position.x; // [!code ++]
						_actorPos.y = EMono.pc.renderer.position.y - pref.height; // [!code ++]
						_actorPos.z = EMono.pc.renderer.position.z + 0.02f; // [!code ++]
						t.renderer.Draw(_param, ref _actorPos, !t.noShadow && (shadow || tileType.AlwaysShowShadow)); // [!code ++]
					}); // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					t.renderer.Draw(param, ref _actorPos, !t.noShadow && (shadow || tileType.AlwaysShowShadow)); // [!code ++]
				}
			}
			if (isInstalled) // [!code ++]
			{ // [!code ++]
				num23 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
			} // [!code ++]
			param.x = orgX; // [!code ++]
			param.y = orgY;
			param.z = orgZ;
			break; // [!code --]
		} // [!code --]
		case BlockRenderMode.HalfBlock: // [!code --]
			param.color = floorLight;
			_sourceBlock = ((sourceBlock.id == 5) ? EMono.sources.blocks.rows[matBlock.defBlock] : sourceBlock); // [!code --]
			param.tile = _sourceBlock._tiles[0]; // [!code --]
			param.matColor = ((_sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, _sourceBlock.colorMod)); // [!code --]
			param.tile2 = _sourceBlock.sourceAutoFloor._tiles[0]; // [!code --]
			param.halfBlockColor = ((_sourceBlock.sourceAutoFloor.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, _sourceBlock.sourceAutoFloor.colorMod)); // [!code --]
			sourceBlock.renderData.Draw(param); // [!code --]
			break; // [!code --]
		case BlockRenderMode.Pillar: // [!code --]
		{ // [!code --]
			RenderData renderData2 = sourceBlock.renderData; // [!code --]
			param.tile = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length]; // [!code --]
			param.matColor = ((sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, sourceBlock.colorMod)); // [!code --]
			int num33 = this.cell.objDir + ((this.cell.objDir >= 7) ? this.cell.objDir : 0) + 1; // [!code --]
			if (num33 == 0) // [!code --]
			thing = t; // [!code ++]
			if (pref.Float) // [!code ++]
			{
				renderData2.Draw(param); // [!code --]
				liquidLv = 0; // [!code ++]
			}
			else // [!code --]
		} // [!code ++]
	} // [!code ++]
	orgY += num24; // [!code ++]
	if (detail.charas.Count <= 0) // [!code ++]
	{ // [!code ++]
		return; // [!code ++]
	} // [!code ++]
	param.shadowFix = 0f - num25; // [!code ++]
	param.color += 1310720f; // [!code ++]
	float max = zSetting.max2; // [!code ++]
	for (int n = 0; n < detail.charas.Count; n++) // [!code ++]
	{ // [!code ++]
		Chara chara = detail.charas[n]; // [!code ++]
		if (chara.host != null || (chara != EMono.pc && chara != LayerDrama.alwaysVisible && (flag3 || fogged || (!showAllCards && !EMono.player.CanSee(chara))))) // [!code ++]
		{ // [!code ++]
			continue; // [!code ++]
		} // [!code ++]
		_actorPos.x = orgX; // [!code ++]
		_actorPos.y = orgY; // [!code ++]
		_actorPos.z = orgZ; // [!code ++]
		chara.SetRenderParam(param); // [!code ++]
		_ = chara.IsAliveInCurrentZone; // [!code ++]
		if (chara.isRestrained) // [!code ++]
		{ // [!code ++]
			TraitShackle restrainer = chara.GetRestrainer(); // [!code ++]
			if (restrainer != null) // [!code ++]
			{
				renderData2.DrawRepeat(param, num33, sourceBlock.tileType.RepeatSize); // [!code --]
				Vector3 getRestrainPos = restrainer.GetRestrainPos; // [!code ++]
				if (getRestrainPos != default(Vector3)) // [!code ++]
				{ // [!code ++]
					Vector3 position = restrainer.owner.renderer.position; // [!code ++]
					float defCharaHeight = EMono.setting.render.defCharaHeight; // [!code ++]
					float num30 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code ++]
					_actorPos.x = position.x + getRestrainPos.x * (float)((restrainer.owner.dir % 2 == 0) ? 1 : (-1)); // [!code ++]
					_actorPos.y = position.y + num30; // [!code ++]
					_actorPos.z = position.z + getRestrainPos.z; // [!code ++]
					param.liquidLv = 0; // [!code ++]
					param.shadowFix = orgY - _actorPos.y; // [!code ++]
					chara.renderer.SetFirst(first: true); // [!code ++]
					chara.renderer.Draw(param, ref _actorPos, drawShadow: true); // [!code ++]
					param.shadowFix = 0f; // [!code ++]
					continue; // [!code ++]
				} // [!code ++]
			}
			param.tile = renderData2.idShadow; // [!code --]
			SourcePref shadowPref2 = renderData2.shadowPref; // [!code --]
			int shadow4 = shadowPref2.shadow; // [!code --]
			passShadow.AddShadow(param.x + renderData2.offsetShadow.x, param.y + renderData2.offsetShadow.y, param.z + renderData2.offsetShadow.z, ShadowData.Instance.items[shadow4], shadowPref2, 0, param.snow); // [!code --]
			break; // [!code --]
		}
		default: // [!code --]
			param.color = floorLight; // [!code --]
			param.tile = sourceBlock._tiles[this.cell.blockDir % sourceBlock._tiles.Length] + ((_lowblock && this.tileType.UseLowWallTiles) ? 3000000 : 0); // [!code --]
			param.matColor = ((sourceBlock.colorMod == 0) ? 104025 : GetColorInt(ref matBlock.matColor, sourceBlock.colorMod)); // [!code --]
			if (roomHeight == 0f) // [!code --]
		if (!chara.sourceCard.multisize || (chara.pos.x == cx && chara.pos.z == cz)) // [!code ++]
		{ // [!code ++]
			if (chara.IsDeadOrSleeping && chara.IsPCC) // [!code ++]
			{
				sourceBlock.renderData.Draw(param); // [!code --]
				float num31 = chara.renderer.data.size.y * 0.3f; // [!code ++]
				if (thingPos.y > max) // [!code ++]
				{ // [!code ++]
					thingPos.y = max; // [!code ++]
				} // [!code ++]
				float num32 = thingPos.y + num31; // [!code ++]
				float num33 = (float)n * -0.01f; // [!code ++]
				if (num32 > zSetting.thresh1) // [!code ++]
				{ // [!code ++]
					num33 = zSetting.mod1; // [!code ++]
				} // [!code ++]
				_actorPos.x += thingPos.x; // [!code ++]
				_actorPos.y += thingPos.y; // [!code ++]
				_actorPos.z += renderSetting.laydownZ + num33; // [!code ++]
				param.liquidLv = ((thingPos.y == 0f && liquidLv > 0) ? 90 : 0); // [!code ++]
				thingPos.y += num31 * 0.8f; // [!code ++]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0); // [!code ++]
			}
			else
			{
				sourceBlock.renderData.DrawRepeatTo(param, maxHeight, roomHeight, ref renderSetting.peakFixBlock); // [!code --]
				param.liquidLv = liquidLv; // [!code ++]
				if (param.liquidLv > 0) // [!code ++]
				{ // [!code ++]
					param.liquidLv += chara.Pref.liquidMod; // [!code ++]
					if (param.liquidLv < 1) // [!code ++]
					{ // [!code ++]
						param.liquidLv = 1; // [!code ++]
					} // [!code ++]
					else if (param.liquidLv > 99 + chara.Pref.liquidModMax) // [!code ++]
					{ // [!code ++]
						param.liquidLv = 99 + chara.Pref.liquidModMax; // [!code ++]
					} // [!code ++]
				} // [!code ++]
				if (!chara.IsPC && !chara.renderer.IsMoving && detail.charas.Count > 1 && (detail.charas.Count != 2 || !detail.charas[0].IsDeadOrSleeping || !detail.charas[0].IsPCC)) // [!code ++]
				{ // [!code ++]
					_actorPos += renderSetting.charaPos[1 + ((num21 < 4) ? num21 : 3)]; // [!code ++]
				} // [!code ++]
				_actorPos.z += 0.01f * (float)n + renderSetting.charaZ; // [!code ++]
				num21++; // [!code ++]
				if (flag10) // [!code ++]
				{ // [!code ++]
					_actorPos.z += chara.renderer.data.hangedFixZ; // [!code ++]
				} // [!code ++]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0); // [!code ++]
			}
			break; // [!code --]
		}
		param.x = orgX; // [!code ++]
		param.y = orgY; // [!code ++]
		param.z = orgZ; // [!code ++]
	}
	if (this.cell.pcSync && EMono.player.lightPower > 0f && !cinemaMode) // [!code --]
	return; // [!code ++]
	IL_6f4f: // [!code ++]
	if (!showRoof || !roof || this.cell.room == null || this.cell.Front.room == null || this.cell.Right.room == null) // [!code ++]
	{
		if (this.cell.room != null || !this.cell.IsRoomEdge || !showRoof) // [!code --]
		{ // [!code --]
			goto IL_6f1f; // [!code --]
		} // [!code --]
		if (this.cell._block == 0 || !this.cell.sourceBlock.tileType.RepeatBlock) // [!code --]
		{ // [!code --]
			Room obj = this.cell.FrontRight.room; // [!code --]
			if (obj == null || !obj.HasRoof) // [!code --]
			{ // [!code --]
				goto IL_6f1f; // [!code --]
			} // [!code --]
		} // [!code --]
		param.tile = num14; // [!code ++]
		rendererFov.Draw(param); // [!code ++]
	}
	goto IL_6f7f; // [!code --]
	goto IL_6faf; // [!code ++]
	void Draw(int tile)
	{
		pass = passEdge;
```

## CharaBody

[`@@ -130,6 +130,10 @@ public bool IsEquippable(Thing thing, BodySlot slot, bool text = true)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/CharaBody.cs#L130-L135)
```cs:line-numbers=130
		}
		break;
	}
	if (slot.thing != null && slot.thing.blessedState <= BlessedState.Cursed) // [!code ++]
	{ // [!code ++]
		return CannotEquip(); // [!code ++]
	} // [!code ++]
	if (IsTooHeavyToEquip(thing))
	{
		if (EClass.core.IsGameStarted && owner.IsPC && text)
```

## ENC

[`@@ -54,7 +54,7 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/ENC.cs#L54-L60)
```cs:line-numbers=54

	public const int mod_scatter = 607;

	public const int encSpell = 411; // [!code --]
	public const int bane_animal = 463; // [!code ++]

	public const int mod_precision = 605;

```

[`@@ -68,7 +68,7 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/ENC.cs#L68-L74)
```cs:line-numbers=68

	public const int negateConfusion = 425;

	public const int negateSleep = 424; // [!code --]
	public const int mod_drill = 606; // [!code ++]

	public const int negateFear = 423;

```

[`@@ -82,9 +82,11 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/ENC.cs#L82-L90)
```cs:line-numbers=82

	public const int invisibility = 415;

	public const int sustain_STR = 440; // [!code ++]
 // [!code ++]
	public const int encHit = 414;

	public const int slowCorruption = 412; // [!code --]
	public const int encSpell = 411; // [!code ++]

	public const int throwReturn = 410;

```

[`@@ -92,7 +94,7 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/ENC.cs#L92-L98)
```cs:line-numbers=92

	public const int resWeather = 408;

	public const int mod_drill = 606; // [!code --]
	public const int travelSpeed = 407; // [!code ++]

	public const int resMutation = 406;

```

[`@@ -108,13 +110,13 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/ENC.cs#L108-L120)
```cs:line-numbers=108

	public const int negateTeleport = 400;

	public const int sustain_STR = 440; // [!code --]
	public const int slowCorruption = 412; // [!code ++]

	public const int sustain_END = 441;

	public const int travelSpeed = 407; // [!code --]
	public const int negateSleep = 424; // [!code ++]

	public const int optimizeMana = 483; // [!code --]
	public const int slot_rune = 484; // [!code ++]

	public const int mod_ammo_recover = 604;

```

[`@@ -126,7 +128,7 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/ENC.cs#L126-L132)
```cs:line-numbers=126

	public const int mod_ammo = 600;

	public const int slot_rune = 484; // [!code --]
	public const int optimizeMana = 483; // [!code ++]

	public const int force_weapon = 482;

```

[`@@ -150,30 +152,28 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/ENC.cs#L150-L179)
```cs:line-numbers=150

	public const int sustain_PER = 443;

	public const int sustain_LER = 444; // [!code --]
 // [!code --]
	public const int bane_animal = 463; // [!code --]
	public const int sustain_WIL = 445; // [!code ++]

	public const int sustain_MAG = 446;

	public const int sustain_WIL = 445; // [!code --]
 // [!code --]
	public const int sustain_CHA = 447; // [!code --]
	public const int sustain_LER = 444; // [!code ++]

	public const int bane_dragon = 460;

	public const int bane_undead = 461;

	public const int sustain_CHA = 447; // [!code ++]
 // [!code ++]
	public static readonly int[] IDS = new int[82]
	{
		652, 651, 650, 641, 640, 621, 620, 623, 622, 653,
		624, 654, 851, 656, 660, 661, 662, 663, 664, 665,
		666, 850, 608, 865, 852, 655, 607, 411, 605, 429, // [!code --]
		428, 427, 426, 425, 424, 423, 422, 421, 420, 416, // [!code --]
		415, 414, 412, 410, 409, 408, 606, 406, 405, 404, // [!code --]
		403, 402, 401, 400, 440, 441, 407, 483, 604, 603, // [!code --]
		602, 601, 600, 484, 482, 481, 480, 468, 467, 465, // [!code --]
		464, 466, 462, 442, 443, 444, 463, 446, 445, 447, // [!code --]
		460, 461 // [!code --]
		666, 850, 608, 865, 852, 655, 607, 463, 605, 429, // [!code ++]
		428, 427, 426, 425, 606, 423, 422, 421, 420, 416, // [!code ++]
		415, 440, 414, 411, 410, 409, 408, 407, 406, 405, // [!code ++]
		404, 403, 402, 401, 400, 412, 441, 424, 484, 604, // [!code ++]
		603, 602, 601, 600, 483, 482, 481, 480, 468, 467, // [!code ++]
		465, 464, 466, 462, 442, 443, 445, 446, 444, 460, // [!code ++]
		461, 447 // [!code ++]
	};
}
```

## FACTION

[`@@ -4,13 +4,15 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FACTION.cs#L4-L16)
```cs:line-numbers=4

public class FACTION
{
	public const int bfSea = 3605; // [!code ++]
 // [!code ++]
	public const int bfFertile = 3700;

	public const int bfHill = 3603;

	public const int bfBeach = 3604;

	public const int bfCave = 3500; // [!code --]
	public const int fRation = 2207; // [!code ++]

	public const int bfGeyser = 3701;

```

[`@@ -22,13 +24,11 @@ public class FACTION`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FACTION.cs#L22-L34)
```cs:line-numbers=22

	public const int bfPlain = 3600;

	public const int bfSea = 3605; // [!code --]
 // [!code --]
	public const int fRation = 2207; // [!code --]
	public const int bfCave = 3500; // [!code ++]

	public const int actBuildAnywhere = 4003; // [!code --]
	public const int fAttraction = 2206; // [!code ++]

	public const int fSafety = 2205; // [!code --]
	public const int fLoyal = 2117; // [!code ++]

	public const int fFood = 2204;

```

[`@@ -38,37 +38,41 @@ public class FACTION`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FACTION.cs#L38-L74)
```cs:line-numbers=38

	public const int fElec = 2201;

	public const int bfTranquil = 3703; // [!code --]
 // [!code --]
	public const int fSoil = 2200;

	public const int fLuck = 2118; // [!code ++]
 // [!code ++]
	public const int fConstruction = 2003; // [!code ++]
 // [!code ++]
	public const int fHeirloom = 2120;

	public const int fTaxEvasion = 2119;

	public const int fLuck = 2118; // [!code --]
	public const int fAdmin = 2115; // [!code ++]

	public const int fLoyal = 2117; // [!code --]
	public const int fEducation = 2116; // [!code ++]

	public const int fAttraction = 2206; // [!code --]
	public const int fSafety = 2205; // [!code ++]

	public const int bfVolcano = 3704; // [!code --]
	public const int bfTranquil = 3703; // [!code ++]

	public const int bfMushroom = 3801; // [!code --]
	public const int bfHunt = 3705; // [!code ++]

	public const int bfFish = 3706;

	public const int actBuildInspect = 4006; // [!code ++]
 // [!code ++]
	public const int actBuildRecipe = 4005;

	public const int actBuildInspect = 4006; // [!code --]
	public const int actBuildCollect = 4004; // [!code ++]
 // [!code ++]
	public const int actBuildAnywhere = 4003; // [!code ++]

	public const int actBuildTerrain = 4002;

	public const int actBuildMine = 4001;

	public const int fEducation = 2116; // [!code --]
 // [!code --]
	public const int actBuildCut = 4000; // [!code --]
	public const int bfVolcano = 3704; // [!code ++]

	public const int bfStart = 3900;

```

[`@@ -78,44 +82,40 @@ public class FACTION`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FACTION.cs#L78-L121)
```cs:line-numbers=78

	public const int bfGum = 3803;

	public const int bfHunt = 3705; // [!code --]
 // [!code --]
	public const int bfSilica = 3802; // [!code --]
	public const int actBuildCut = 4000; // [!code ++]

	public const int bfCoal = 3800; // [!code --]
	public const int bfMushroom = 3801; // [!code ++]

	public const int bfLandmark5 = 3784; // [!code --]
	public const int bfSilica = 3802; // [!code ++]

	public const int bfLandmark4 = 3783; // [!code --]
	public const int bfFreshAir = 3708; // [!code ++]

	public const int bfLandmark3 = 3782; // [!code --]
	public const int bfBasin = 3709; // [!code ++]

	public const int bfLandmark2 = 3781; // [!code --]
	public const int bfBreed = 3710; // [!code ++]

	public const int bfLandmark1 = 3780;

	public const int bfBreed = 3710; // [!code --]
 // [!code --]
	public const int bfBasin = 3709; // [!code --]
	public const int bfMonster = 3707; // [!code ++]

	public const int bfFreshAir = 3708; // [!code --]
	public const int bfLandmark3 = 3782; // [!code ++]

	public const int bfMonster = 3707; // [!code --]
	public const int bfLandmark4 = 3783; // [!code ++]

	public const int actBuildCollect = 4004; // [!code --]
	public const int bfLandmark5 = 3784; // [!code ++]

	public const int fAdmin = 2115; // [!code --]
	public const int bfCoal = 3800; // [!code ++]

	public const int fConstruction = 2003; // [!code --]
	public const int bfLandmark2 = 3781; // [!code ++]

	public static readonly int[] IDS = new int[52]
	{
		3700, 3603, 3604, 3500, 3701, 3702, 3602, 3601, 3600, 3605, // [!code --]
		2207, 4003, 2205, 2204, 2203, 2202, 2201, 3703, 2200, 2120, // [!code --]
		2119, 2118, 2117, 2206, 3704, 3801, 3706, 4005, 4006, 4002, // [!code --]
		4001, 2116, 4000, 3900, 3805, 3804, 3803, 3705, 3802, 3800, // [!code --]
		3784, 3783, 3782, 3781, 3780, 3710, 3709, 3708, 3707, 4004, // [!code --]
		2115, 2003 // [!code --]
		3605, 3700, 3603, 3604, 2207, 3701, 3702, 3602, 3601, 3600, // [!code ++]
		3500, 2206, 2117, 2204, 2203, 2202, 2201, 2200, 2118, 2003, // [!code ++]
		2120, 2119, 2115, 2116, 2205, 3703, 3705, 3706, 4006, 4005, // [!code ++]
		4004, 4003, 4002, 4001, 3704, 3900, 3805, 3804, 3803, 4000, // [!code ++]
		3801, 3802, 3708, 3709, 3710, 3780, 3707, 3782, 3783, 3784, // [!code ++]
		3800, 3781 // [!code ++]
	};
}
public class Faction : EClass
```

## FEAT

[`@@ -3,34 +3,16 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FEAT.cs#L3-L36)
```cs:line-numbers=3

public class FEAT
{
	public const int featUndead = 1210; // [!code --]
 // [!code --]
	public const int featMartial = 1635; // [!code --]
 // [!code --]
	public const int featNegotiate = 1634; // [!code --]
 // [!code --]
	public const int featSpotting = 1633; // [!code --]
 // [!code --]
	public const int featEvade = 1632; // [!code --]
 // [!code --]
	public const int featDefense = 1631; // [!code --]
 // [!code --]
	public const int featHardy = 1630; // [!code --]
 // [!code --]
	public const int featSPD = 1629; // [!code --]
 // [!code --]
	public const int featLuck = 1628; // [!code --]
 // [!code --]
	public const int featCHA = 1627;

	public const int featWIL = 1626;

	public const int featMAG = 1625;

	public const int featFaith = 1636; // [!code --]
 // [!code --]
	public const int featLER = 1624;

	public const int featPER = 1623; // [!code ++]
 // [!code ++]
	public const int featEND = 1622;

	public const int featDEX = 1621;
```

[`@@ -41,7 +23,7 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FEAT.cs#L41-L47)
```cs:line-numbers=41

	public const int featMana = 1611;

	public const int featLife = 1610; // [!code --]
	public const int featEarthStrength = 1411; // [!code ++]

	public const int featManaMeat = 1421;

```

[`@@ -53,38 +35,32 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FEAT.cs#L53-L90)
```cs:line-numbers=53

	public const int featWitch = 1417;

	public const int featPER = 1623; // [!code --]
 // [!code --]
	public const int featAnimalLover = 1640; // [!code --]
 // [!code --]
	public const int featResCurse = 1641; // [!code --]
 // [!code --]
	public const int featSleeper = 1642; // [!code --]
 // [!code --]
	public const int featFluffyTail = 1209; // [!code --]
	public const int featInquisitor = 1416; // [!code ++]

	public const int featSlowFood = 1200; // [!code --]
	public const int featFoxMaid = 1415; // [!code ++]

	public const int featManaBond = 1201; // [!code --]
	public const int featWhiteVixen = 1414; // [!code ++]

	public const int featFastLearner = 1202; // [!code --]
	public const int featFairysan = 1413; // [!code ++]

	public const int featGrowParts = 1203; // [!code --]
	public const int featLuckyCat = 1412; // [!code ++]

	public const int featFairyWeak = 1204; // [!code --]
	public const int featLuck = 1628; // [!code ++]

	public const int featCannibalism = 1205; // [!code --]
	public const int featLife = 1610; // [!code ++]

	public const int featMelilithCurse = 1206; // [!code --]
	public const int featSPD = 1629; // [!code ++]

	public const int featFoxBless = 1207; // [!code --]
	public const int featParty = 1645; // [!code ++]

	public const int featFoxLearn = 1208; // [!code --]
	public const int featDefense = 1631; // [!code ++]

	public const int featChef = 1658; // [!code --]
	public const int featReboot = 1410; // [!code ++]

	public const int featManaCost = 1657;

	public const int featScavenger = 1656; // [!code ++]
 // [!code ++]
	public const int featModelBeliever = 1655;

	public const int featHeavyCasting = 1654;
```

[`@@ -105,19 +81,51 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FEAT.cs#L105-L123)
```cs:line-numbers=105

	public const int featLonelySoul = 1646;

	public const int featParty = 1645; // [!code --]
 // [!code --]
	public const int featBodyParts = 1644;

	public const int featSorter = 1643;

	public const int featInquisitor = 1416; // [!code --]
	public const int featSleeper = 1642; // [!code ++]

	public const int featFoxMaid = 1415; // [!code --]
	public const int featResCurse = 1641; // [!code ++]

	public const int featScavenger = 1656; // [!code --]
	public const int featAnimalLover = 1640; // [!code ++]

	public const int featFairysan = 1413; // [!code --]
	public const int featFaith = 1636; // [!code ++]
 // [!code ++]
	public const int featMartial = 1635; // [!code ++]
 // [!code ++]
	public const int featNegotiate = 1634; // [!code ++]
 // [!code ++]
	public const int featSpotting = 1633; // [!code ++]
 // [!code ++]
	public const int featEvade = 1632; // [!code ++]
 // [!code ++]
	public const int featHardy = 1630; // [!code ++]
 // [!code ++]
	public const int featBoost = 1409; // [!code ++]
 // [!code ++]
	public const int featChef = 1658; // [!code ++]
 // [!code ++]
	public const int featPaladin = 1407; // [!code ++]
 // [!code ++]
	public const int featShiva = 1224; // [!code ++]
 // [!code ++]
	public const int featLoyal = 1225; // [!code ++]
 // [!code ++]
	public const int featUnderground = 1226; // [!code ++]
 // [!code ++]
	public const int featServant = 1227; // [!code ++]
 // [!code ++]
	public const int featDemigod = 1228; // [!code ++]
 // [!code ++]
	public const int featLittleOne = 1229; // [!code ++]
 // [!code ++]
	public const int featAdam = 1230; // [!code ++]
 // [!code ++]
	public const int featNirvana = 1231; // [!code ++]
 // [!code ++]
	public const int featCosmicHorror = 1233; // [!code ++]

	public const int featHeavyEater = 1234;

```

[`@@ -129,8 +137,12 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FEAT.cs#L129-L136)
```cs:line-numbers=129

	public const int featElder = 1238;

	public const int featDemon = 1239; // [!code ++]
 // [!code ++]
	public const int featGod_element1 = 1300;

	public const int featGod_earth1 = 1305; // [!code ++]
 // [!code ++]
	public const int featGod_wind1 = 1310;

	public const int featGod_machine1 = 1315;
```

[`@@ -139,33 +151,39 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FEAT.cs#L139-L171)
```cs:line-numbers=139

	public const int featGod_harvest1 = 1325;

	public const int featAcidBody = 1223; // [!code ++]
 // [!code ++]
	public const int featGod_luck1 = 1330;

	public const int featGod_harmony1 = 1335; // [!code --]
	public const int featSplit = 1222; // [!code ++]

	public const int featGod_oblivion1 = 1340; // [!code --]
	public const int featFate = 1220; // [!code ++]

	public const int featGod_trickery1 = 1345; // [!code --]
	public const int featPaladin2 = 1408; // [!code ++]

	public const int featGod_moonshadow1 = 1350; // [!code --]
	public const int featSlowFood = 1200; // [!code ++]

	public const int featGod_strife1 = 1355; // [!code --]
	public const int featManaBond = 1201; // [!code ++]

	public const int featWarrior = 1400; // [!code --]
	public const int featFastLearner = 1202; // [!code ++]

	public const int featThief = 1401; // [!code --]
	public const int featGrowParts = 1203; // [!code ++]

	public const int featWizard = 1402; // [!code --]
	public const int featFairyWeak = 1204; // [!code ++]

	public const int featCosmicHorror = 1233; // [!code --]
	public const int featCannibalism = 1205; // [!code ++]

	public const int featBaby = 1232; // [!code --]
	public const int featMelilithCurse = 1206; // [!code ++]

	public const int featNirvana = 1231; // [!code --]
	public const int featFoxBless = 1207; // [!code ++]

	public const int featAdam = 1230; // [!code --]
	public const int featFoxLearn = 1208; // [!code ++]

	public const int featWhiteVixen = 1414; // [!code --]
	public const int featFluffyTail = 1209; // [!code ++]
 // [!code ++]
	public const int featUndead = 1210; // [!code ++]
 // [!code ++]
	public const int featSnail = 1211; // [!code ++]

	public const int featFairyResist = 1212;

```

[`@@ -183,64 +201,48 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FEAT.cs#L183-L246)
```cs:line-numbers=183

	public const int featElderCrab = 1219;

	public const int featFarmer = 1403; // [!code --]
 // [!code --]
	public const int featFate = 1220; // [!code --]
 // [!code --]
	public const int featSplit = 1222; // [!code --]
	public const int featSpike = 1221; // [!code ++]

	public const int featSnail = 1211; // [!code --]
	public const int featGod_harmony1 = 1335; // [!code ++]

	public const int featAcidBody = 1223; // [!code --]
	public const int featBaby = 1232; // [!code ++]

	public const int featShiva = 1224; // [!code --]
	public const int featGod_trickery1 = 1345; // [!code ++]

	public const int featLoyal = 1225; // [!code --]
	public const int featGod_oblivion1 = 1340; // [!code ++]

	public const int featUnderground = 1226; // [!code --]
	public const int featGod_moonshadow1 = 1350; // [!code ++]

	public const int featServant = 1227; // [!code --]
	public const int featGod_strife1 = 1355; // [!code ++]

	public const int featDemigod = 1228; // [!code --]
	public const int featWarrior = 1400; // [!code ++]

	public const int featLittleOne = 1229; // [!code --]
	public const int featWizard = 1402; // [!code ++]

	public const int featSpike = 1221; // [!code --]
	public const int featFarmer = 1403; // [!code ++]

	public const int featArcher = 1404;

	public const int featGod_earth1 = 1305; // [!code --]
 // [!code --]
	public const int featTourist = 1406; // [!code --]
 // [!code --]
	public const int featPianist = 1405;

	public const int featPaladin2 = 1408; // [!code --]
 // [!code --]
	public const int featReboot = 1410; // [!code --]
 // [!code --]
	public const int featEarthStrength = 1411; // [!code --]
 // [!code --]
	public const int featBoost = 1409; // [!code --]
 // [!code --]
	public const int featLuckyCat = 1412; // [!code --]
	public const int featThief = 1401; // [!code ++]

	public const int featPaladin = 1407; // [!code --]
	public const int featTourist = 1406; // [!code ++]

	public static readonly int[] IDS = new int[112] // [!code --]
	public static readonly int[] IDS = new int[113] // [!code ++]
	{
		1210, 1635, 1634, 1633, 1632, 1631, 1630, 1629, 1628, 1627, // [!code --]
		1626, 1625, 1636, 1624, 1622, 1621, 1620, 1612, 1611, 1610, // [!code --]
		1421, 1420, 1419, 1418, 1417, 1623, 1640, 1641, 1642, 1209, // [!code --]
		1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1658, // [!code --]
		1657, 1655, 1654, 1653, 1652, 1651, 1650, 1649, 1648, 1647, // [!code --]
		1646, 1645, 1644, 1643, 1416, 1415, 1656, 1413, 1234, 1235, // [!code --]
		1236, 1237, 1238, 1300, 1310, 1315, 1320, 1325, 1330, 1335, // [!code --]
		1340, 1345, 1350, 1355, 1400, 1401, 1402, 1233, 1232, 1231, // [!code --]
		1230, 1414, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, // [!code --]
		1403, 1220, 1222, 1211, 1223, 1224, 1225, 1226, 1227, 1228, // [!code --]
		1229, 1221, 1404, 1305, 1406, 1405, 1408, 1410, 1411, 1409, // [!code --]
		1412, 1407 // [!code --]
		1627, 1626, 1625, 1624, 1623, 1622, 1621, 1620, 1612, 1611, // [!code ++]
		1411, 1421, 1420, 1419, 1418, 1417, 1416, 1415, 1414, 1413, // [!code ++]
		1412, 1628, 1610, 1629, 1645, 1631, 1410, 1657, 1656, 1655, // [!code ++]
		1654, 1653, 1652, 1651, 1650, 1649, 1648, 1647, 1646, 1644, // [!code ++]
		1643, 1642, 1641, 1640, 1636, 1635, 1634, 1633, 1632, 1630, // [!code ++]
		1409, 1658, 1407, 1224, 1225, 1226, 1227, 1228, 1229, 1230, // [!code ++]
		1231, 1233, 1234, 1235, 1236, 1237, 1238, 1239, 1300, 1305, // [!code ++]
		1310, 1315, 1320, 1325, 1223, 1330, 1222, 1220, 1408, 1200, // [!code ++]
		1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, // [!code ++]
		1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1221, // [!code ++]
		1335, 1232, 1345, 1340, 1350, 1355, 1400, 1402, 1403, 1404, // [!code ++]
		1405, 1401, 1406 // [!code ++]
	};
}
public class Feat : Element
```

[`@@ -472,6 +474,13 @@ public List<string> Apply(int a, ElementContainer owner, bool hint = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FEAT.cs#L472-L477)
```cs:line-numbers=472
		ModBase(956, a * 10, hide: false);
		ModBase(950, a * -5, hide: false);
		break;
	case 1239: // [!code ++]
		ModBase(956, a * 5, hide: false); // [!code ++]
		ModBase(959, a * 5, hide: false); // [!code ++]
		ModBase(423, a, hide: false); // [!code ++]
		ModBase(424, a, hide: false); // [!code ++]
		ModBase(421, a, hide: false); // [!code ++]
		break; // [!code ++]
	case 1233:
		ModBase(954, a * 10, hide: false);
		ModBase(423, a, hide: false);
```

## FOOD

[`@@ -1,22 +1,22 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/FOOD.cs#L1-L22)
```cs:line-numbers=1
public class FOOD
{
	public const int gainWeight = 705; // [!code --]
	public const int food_CHA = 700; // [!code ++]

	public const int food_bug = 704; // [!code --]
	public const int food_cat = 701; // [!code ++]

	public const int food_love = 703; // [!code --]
	public const int food_god = 758; // [!code ++]
 // [!code ++]
	public const int justcooked = 757; // [!code ++]

	public const int food_poison = 702;

	public const int food_cat = 701; // [!code --]
	public const int gainWeight = 705; // [!code ++]

	public const int justcooked = 757; // [!code --]
	public const int food_bug = 704; // [!code ++]

	public const int food_god = 758; // [!code --]
	public const int food_love = 703; // [!code ++]

	public const int loseWeight = 706;

	public const int food_CHA = 700; // [!code --]
 // [!code --]
	public static readonly int[] IDS = new int[9] { 705, 704, 703, 702, 701, 757, 758, 706, 700 }; // [!code --]
	public static readonly int[] IDS = new int[9] { 700, 701, 758, 757, 702, 705, 704, 703, 706 }; // [!code ++]
}
```

## Game

[`@@ -466,6 +466,9 @@ public void OnLoad()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/Game.cs#L466-L471)
```cs:line-numbers=466
	{
		EClass.game.principal = IO.DeepCopy(EClass.setting.start.principals[0]);
		player.resetPrincipal = true;
	} // [!code ++]
	if (player.resetPrincipal) // [!code ++]
	{ // [!code ++]
		GameDifficultySetting gameDifficultySetting = EClass.setting.start.difficulties[idDifficulty];
		EClass.game.principal.id = -1;
		EClass.game.principal.permadeath = gameDifficultySetting.deleteGameOnDeath;
```

## GrowSystem

[`@@ -506,8 +506,11 @@ public void OnProgressComplete(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/GrowSystem.cs#L506-L513)
```cs:line-numbers=506

	public void PopMineObj(Chara c = null)
	{
		OnMineObj(c); // [!code --]
		TryPopSeed(c); // [!code --]
		if (!EClass._zone.IsUserZone || !EClass.game.principal.disableUsermapBenefit) // [!code ++]
		{ // [!code ++]
			OnMineObj(c); // [!code ++]
			TryPopSeed(c); // [!code ++]
		} // [!code ++]
	}

	public virtual void OnMineObj(Chara c = null)
```

## GrowSystemTree

[`@@ -170,7 +170,7 @@ public override void OnMineObj(Chara c = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/GrowSystemTree.cs#L170-L176)
```cs:line-numbers=170
		TryPick(GrowSystem.cell, IsPalulu ? "leaf_palulu" : "bark", -1, 1 + PlantBonus() / 2);
		TryPick(GrowSystem.cell, "log", id, 1 + EClass.rnd(3) + PlantBonus(), applySeed: true);
		TryPick(GrowSystem.cell, "resin", -1, 1 + PlantBonus() / 2);
		if ((!EClass._zone.IsUserZone || !EClass.game.principal.disableUsermapBenefit) && !EClass.player.isAutoFarming) // [!code --]
		if (!EClass.player.isAutoFarming) // [!code ++]
		{
			if (EClass.rnd(500) == 0)
			{
```

[`@@ -185,7 +185,7 @@ public override void OnMineObj(Chara c = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/GrowSystemTree.cs#L185-L191)
```cs:line-numbers=185
	}
	TryPick(GrowSystem.cell, "bark", -1, EClass.rnd(3) + PlantBonus());
	TryPick(GrowSystem.cell, "resin", -1, 1 + PlantBonus() / 2);
	if ((!EClass._zone.IsUserZone || !EClass.game.principal.disableUsermapBenefit) && !EClass.player.isAutoFarming) // [!code --]
	if (!EClass.player.isAutoFarming) // [!code ++]
	{
		TryPick(GrowSystem.cell, TraitSeed.MakeSeed(GrowSystem.cell.sourceObj, plant).SetNum(1 + EClass.rnd(3)), c);
		if (EClass.rnd(100) == 0)
```

## Hobby

[`@@ -35,6 +35,10 @@ public int GetEfficiency(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/Hobby.cs#L35-L40)
```cs:line-numbers=35
	{
		return 0;
	}
	if (source.alias == "Breeding") // [!code ++]
	{ // [!code ++]
		return c.race.breeder; // [!code ++]
	} // [!code ++]
	if (c.currentZone == null || c.currentZone == EClass._zone)
	{
		if ((!source.destTrait.IsEmpty() || !source.workTag.IsEmpty()) && !GetAI(c).SetDestination())
```

[`@@ -54,10 +58,6 @@ public int GetEfficiency(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/Hobby.cs#L54-L63)
```cs:line-numbers=54
			}
		}
	}
	if (source.alias == "Breeding") // [!code --]
	{ // [!code --]
		num = num * c.race.breeder / 100; // [!code --]
	} // [!code --]
	num += GetLv(c);
	if (c.affinity.value < 0)
	{
```

## HotItemHeld

[`@@ -374,13 +374,6 @@ public bool TrySetToolAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/HotItemHeld.cs#L374-L386)
```cs:line-numbers=374
		{
			return true;
		}
		if (thing.HasElement(286) && p.TrySetAct(new TaskPlow // [!code --]
		{ // [!code --]
			pos = pos.Copy() // [!code --]
		})) // [!code --]
		{ // [!code --]
			return true; // [!code --]
		} // [!code --]
		if (thing.HasElement(230) && p.TrySetAct(new TaskDig
		{
			pos = pos.Copy(),
```

[`@@ -389,14 +382,7 @@ public bool TrySetToolAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/HotItemHeld.cs#L389-L402)
```cs:line-numbers=389
		{
			return true;
		}
		if (TaskMine.CanMine(pos, thing) && p.TrySetAct(new TaskMine // [!code --]
		{ // [!code --]
			pos = pos.Copy() // [!code --]
		})) // [!code --]
		{ // [!code --]
			return true; // [!code --]
		} // [!code --]
		if (thing.HasElement(225) && p.TrySetAct(new TaskChopWood // [!code --]
		if (thing.HasElement(286) && p.TrySetAct(new TaskPlow // [!code ++]
		{
			pos = pos.Copy()
		}))
```

[`@@ -404,6 +390,20 @@ public bool TrySetToolAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/HotItemHeld.cs#L404-L409)
```cs:line-numbers=404
			return true;
		}
	}
	if (TaskMine.CanMine(pos, thing) && p.TrySetAct(new TaskMine // [!code ++]
	{ // [!code ++]
		pos = pos.Copy() // [!code ++]
	})) // [!code ++]
	{ // [!code ++]
		return true; // [!code ++]
	} // [!code ++]
	if (thing.HasElement(225) && p.TrySetAct(new TaskChopWood // [!code ++]
	{ // [!code ++]
		pos = pos.Copy() // [!code ++]
	})) // [!code ++]
	{ // [!code ++]
		return true; // [!code ++]
	} // [!code ++]
	if (pos.HasChara)
	{
		_ = pos.FirstChara;
```

## MUTATION

[`@@ -1,40 +1,32 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/MUTATION.cs#L1-L40)
```cs:line-numbers=1
public class MUTATION
{
	public const int mutationSpeedN = 1519; // [!code --]
 // [!code --]
	public const int mutationSpeed = 1518; // [!code --]
	public const int mutationRegen = 1516; // [!code ++]

	public const int mutationRegenN = 1517; // [!code --]
	public const int etherPoisonHand = 1565; // [!code ++]

	public const int mutationRegen = 1516; // [!code --]
	public const int mutationSkin = 1510; // [!code ++]

	public const int mutationSkinN = 1511;

	public const int mutationDex = 1514; // [!code --]
 // [!code --]
	public const int mutationEye = 1512;

	public const int mutationSkin = 1510; // [!code --]
	public const int mutationEyeN = 1513; // [!code ++]

	public const int mutationStr = 1520; // [!code --]
	public const int mutationDex = 1514; // [!code ++]

	public const int mutationDexN = 1515;

	public const int mutationStrN = 1521; // [!code --]
 // [!code --]
	public const int mutationEyeN = 1513; // [!code --]
 // [!code --]
	public const int mutationChaN = 1523; // [!code --]
	public const int mutationRegenN = 1517; // [!code ++]

	public const int etherPoisonHand = 1565; // [!code --]
	public const int etherManaBattery = 1564; // [!code ++]

	public const int mutationCha = 1522; // [!code --]
	public const int mutationSpeedN = 1519; // [!code ++]

	public const int etherProvoke = 1563;

	public const int etherArmor = 1562;

	public const int etherStupid = 1561; // [!code --]
	public const int mutationSpeed = 1518; // [!code ++]

	public const int etherWeak = 1560;

```

[`@@ -50,38 +42,46 @@ public class MUTATION`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/MUTATION.cs#L50-L87)
```cs:line-numbers=50

	public const int etherWing = 1554;

	public const int etherManaBattery = 1564; // [!code --]
	public const int etherEye = 1553; // [!code ++]

	public const int etherFeet = 1552;

	public const int etherUgly = 1551;

	public const int etherGravity = 1550; // [!code --]
	public const int etherStupid = 1561; // [!code ++]

	public const int mutationBodyN = 1531; // [!code --]
	public const int mutationStrN = 1521; // [!code ++]

	public const int mutationBody = 1530; // [!code --]
	public const int mutationStr = 1520; // [!code ++]

	public const int mutationLightningN = 1529; // [!code --]
	public const int mutationCha = 1522; // [!code ++]

	public const int mutationLightning = 1528; // [!code --]
	public const int mutationChaN = 1523; // [!code ++]

	public const int mutationColdN = 1527; // [!code --]
	public const int mutationBrainN = 1525; // [!code ++]

	public const int mutationCold = 1526;

	public const int mutationBrainN = 1525; // [!code --]
 // [!code --]
	public const int mutationBrain = 1524;

	public const int etherEye = 1553; // [!code --]
	public const int mutationLightning = 1528; // [!code ++]
 // [!code ++]
	public const int mutationLightningN = 1529; // [!code ++]
 // [!code ++]
	public const int mutationBody = 1530; // [!code ++]
 // [!code ++]
	public const int mutationBodyN = 1531; // [!code ++]
 // [!code ++]
	public const int mutationColdN = 1527; // [!code ++]
 // [!code ++]
	public const int etherGravity = 1550; // [!code ++]

	public static readonly int[] IDS = new int[38]
	{
		1519, 1518, 1517, 1516, 1511, 1514, 1512, 1510, 1520, 1515, // [!code --]
		1521, 1513, 1523, 1565, 1522, 1563, 1562, 1561, 1560, 1559, // [!code --]
		1558, 1557, 1556, 1555, 1554, 1564, 1552, 1551, 1550, 1531, // [!code --]
		1530, 1529, 1528, 1527, 1526, 1525, 1524, 1553 // [!code --]
		1516, 1565, 1510, 1511, 1512, 1513, 1514, 1515, 1517, 1564, // [!code ++]
		1519, 1563, 1562, 1518, 1560, 1559, 1558, 1557, 1556, 1555, // [!code ++]
		1554, 1553, 1552, 1551, 1561, 1521, 1520, 1522, 1523, 1525, // [!code ++]
		1526, 1524, 1528, 1529, 1530, 1531, 1527, 1550 // [!code ++]
	};
}
public class Mutation : Feat
```

## Map

[`@@ -1612,6 +1612,10 @@ public void ApplyBackerObj(Point p, int id = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/Map.cs#L1612-L1617)
```cs:line-numbers=1612

	public void DropBlockComponent(Point point, TileRow r, SourceMaterial.Row mat, bool recoverBlock, bool isPlatform = false, Chara c = null)
	{
		if (EClass._zone.IsUserZone && EClass.game.principal.disableUsermapBenefit) // [!code ++]
		{ // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		Thing thing = null;
		if (r.components.Length == 0)
		{
```

[`@@ -1663,6 +1667,10 @@ public void MineBlock(Point point, bool recoverBlock = false, Chara c = null, bo`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/Map.cs#L1663-L1668)
```cs:line-numbers=1663
	point.PlaySound(row.GetSoundDead(row2));
	row.AddBlood(point, 8);
	bool flag2 = c == null || c.IsAgent || c.IsPCFactionOrMinion;
	if (EClass._zone.IsUserZone && EClass.game.principal.disableUsermapBenefit) // [!code ++]
	{ // [!code ++]
		flag2 = false; // [!code ++]
	} // [!code ++]
	if (flag)
	{
		point.cell._roofBlock = 0;
```

[`@@ -1889,13 +1897,16 @@ public void MineObj(Point point, Task task = null, Chara c = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/Map.cs#L1889-L1901)
```cs:line-numbers=1889
	cell.gatherCount = 0;
	void Pop(Thing t)
	{
		if (EClass.scene.actionMode.IsBuildMode && EClass.debug.godBuild) // [!code --]
		if (!EClass._zone.IsUserZone || !EClass.game.principal.disableUsermapBenefit) // [!code ++]
		{
			EClass._map.PutAway(t); // [!code --]
		} // [!code --]
		else // [!code --]
		{ // [!code --]
			TrySmoothPick(point, t, c); // [!code --]
			if (EClass.scene.actionMode.IsBuildMode && EClass.debug.godBuild) // [!code ++]
			{ // [!code ++]
				EClass._map.PutAway(t); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				TrySmoothPick(point, t, c); // [!code ++]
			} // [!code ++]
		}
	}
}
```

[`@@ -1961,7 +1972,7 @@ public void _ValidateInstalled(int x, int y)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/Map.cs#L1961-L1967)
```cs:line-numbers=1961
		HitResult hitResult = item.TileType._HitTest(point, item.Thing, canIgnore: false);
		if (item.Thing.stackOrder != detail.things.IndexOf(item.Thing) || (hitResult != HitResult.Valid && hitResult != HitResult.Warning))
		{
			if (EClass._zone.IsPCFaction || !item.isNPCProperty) // [!code --]
			if (EClass._zone.IsPCFaction || (!item.isNPCProperty && !(item.trait is TraitHarvest))) // [!code ++]
			{
				item.SetPlaceState(PlaceState.roaming);
			}
```

## POLICY

[`@@ -3,7 +3,7 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/POLICY.cs#L3-L9)
```cs:line-numbers=3

public class POLICY
{
	public const int forcePanty = 2712; // [!code --]
	public const int bed_quality = 2812; // [!code ++]

	public const int platinum_ticket = 2815;

```

[`@@ -11,21 +11,21 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/POLICY.cs#L11-L31)
```cs:line-numbers=11

	public const int suite_room = 2813;

	public const int livestock_priv = 2715; // [!code --]
 // [!code --]
	public const int tourist_safety = 2811; // [!code --]
	public const int forcePanty = 2712; // [!code ++]

	public const int open_business = 2810;

	public const int home_discount = 2800;

	public const int livestock_priv = 2715; // [!code ++]
 // [!code ++]
	public const int store_ripoff = 2816;

	public const int bed_quality = 2812; // [!code --]
	public const int tourist_safety = 2811; // [!code ++]

	public const int store_premium = 2817;

	public const int celeb = 2822; // [!code --]
	public const int license_stolen = 2824; // [!code ++]

	public const int license_furniture = 2819;

```

[`@@ -33,9 +33,9 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/POLICY.cs#L33-L41)
```cs:line-numbers=33

	public const int legendary_heirloom = 2821;

	public const int legendary_exhibition = 2823; // [!code --]
	public const int celeb = 2822; // [!code ++]

	public const int license_stolen = 2824; // [!code --]
	public const int legendary_exhibition = 2823; // [!code ++]

	public const int milk_fan = 2825;

```

[`@@ -49,47 +49,47 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/POLICY.cs#L49-L95)
```cs:line-numbers=49

	public const int incomeTransfer = 2711;

	public const int self_sufficient = 2511; // [!code --]
	public const int nocturnal_life = 2508; // [!code ++]

	public const int noAnimal = 2709;

	public const int prohibition = 2503; // [!code ++]
 // [!code ++]
	public const int noMother = 2710;

	public const int food_for_people = 2502;

	public const int faith_tax = 2501;

	public const int wealth_tax = 2500; // [!code --]
 // [!code --]
	public const int prohibition = 2503; // [!code --]
 // [!code --]
	public const int impressment = 2504;

	public const int legal_drug = 2505;

	public const int inquisition = 2507; // [!code --]
	public const int human_right = 2506; // [!code ++]

	public const int nocturnal_life = 2508; // [!code --]
	public const int wealth_tax = 2500; // [!code ++]

	public const int vaccination = 2509;

	public const int ban_radio = 2510;

	public const int self_sufficient = 2511; // [!code ++]
 // [!code ++]
	public const int resident_tax = 2512;

	public const int human_right = 2506; // [!code --]
	public const int inquisition = 2507; // [!code ++]

	public const int taxfree = 2514;

	public const int resident_wanted = 2513; // [!code --]
	public const int noDM = 2708; // [!code ++]

	public const int auto_farm = 2707; // [!code --]
	public const int resident_wanted = 2513; // [!code ++]

	public const int demon_invocation = 2706;

	public const int taxTransfer = 2705;

	public const int noDM = 2708; // [!code --]
	public const int auto_farm = 2707; // [!code ++]

	public const int weed_no = 2703;

```

[`@@ -107,11 +107,11 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/POLICY.cs#L107-L117)
```cs:line-numbers=107

	public static readonly int[] IDS = new int[51]
	{
		2712, 2815, 2814, 2813, 2715, 2811, 2810, 2800, 2816, 2812, // [!code --]
		2817, 2822, 2819, 2820, 2821, 2823, 2824, 2825, 2826, 2827, // [!code --]
		2828, 2818, 2711, 2511, 2709, 2710, 2502, 2501, 2500, 2503, // [!code --]
		2504, 2505, 2507, 2508, 2509, 2510, 2512, 2506, 2514, 2513, // [!code --]
		2707, 2706, 2705, 2708, 2703, 2704, 2701, 2700, 2516, 2515, // [!code --]
		2812, 2815, 2814, 2813, 2712, 2810, 2800, 2715, 2816, 2811, // [!code ++]
		2817, 2824, 2819, 2820, 2821, 2822, 2823, 2825, 2826, 2827, // [!code ++]
		2828, 2818, 2711, 2508, 2709, 2503, 2710, 2502, 2501, 2504, // [!code ++]
		2505, 2506, 2500, 2509, 2510, 2511, 2512, 2507, 2514, 2708, // [!code ++]
		2513, 2706, 2705, 2707, 2703, 2704, 2701, 2700, 2516, 2515, // [!code ++]
		2702
	};
}
```

## Point

[`@@ -1088,7 +1088,7 @@ public Chara FindChara(Func<Chara, bool> func)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/Point.cs#L1088-L1094)
```cs:line-numbers=1088

	public T FindThing<T>() where T : Trait
	{
		if (detail != null) // [!code --]
		if (IsValid && detail != null) // [!code ++]
		{
			foreach (Thing thing in detail.things)
			{
```

## RenderRow

[`@@ -354,7 +354,7 @@ public void SetImage(Image image, Sprite sprite = null, int matCol = 0, bool set`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/RenderRow.cs#L354-L360)
```cs:line-numbers=354
	RectTransform rectTransform = image.Rect();
	SourcePref sourcePref = GetPref();
	rectTransform.pivot = renderData.imagePivot - new Vector2(0.01f * (float)sourcePref.pivotX, 0.01f * (float)sourcePref.pivotY);
	float x = Mathf.Abs(image.transform.localScale.x) * (float)(((bool)sprite || _tiles.Length == 0 || _tiles[dir % _tiles.Length] >= 0) ? 1 : (-1)); // [!code --]
	float x = Mathf.Abs(image.transform.localScale.x) * (float)((_tiles == null || _tiles.Length == 0 || _tiles[dir % _tiles.Length] >= 0) ? 1 : (-1)); // [!code ++]
	float y = image.transform.localScale.y;
	image.transform.localScale = new Vector3(x, y, image.transform.localScale.z);
	sourcePref.Validate();
```

## SKILL

[`@@ -1,7 +1,5 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L1-L7)
```cs:line-numbers=1
public class SKILL
{
	public const int tactics = 132; // [!code --]
 // [!code --]
	public const int twowield = 131;

	public const int twohand = 130;
```

[`@@ -10,7 +8,7 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L10-L16)
```cs:line-numbers=10

	public const int armorHeavy = 122;

	public const int acidproof = 51; // [!code --]
	public const int fireproof = 50; // [!code ++]

	public const int weaponBlunt = 111;

```

[`@@ -18,17 +16,17 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L18-L34)
```cs:line-numbers=18

	public const int weaponCrossbow = 109;

	public const int fireproof = 50; // [!code --]
	public const int acidproof = 51; // [!code ++]

	public const int marksman = 133; // [!code --]
	public const int tactics = 132; // [!code ++]

	public const int armorLight = 120;

	public const int eyeofmind = 134; // [!code --]
	public const int marksman = 133; // [!code ++]

	public const int parasite = 227; // [!code --]
	public const int riding = 226; // [!code ++]

	public const int evasion = 150; // [!code --]
	public const int strategy = 135; // [!code ++]

	public const int climbing = 242;

```

[`@@ -42,15 +40,15 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L42-L56)
```cs:line-numbers=42

	public const int digging = 230;

	public const int PDR = 55; // [!code --]
	public const int parasite = 227; // [!code ++]

	public const int riding = 226; // [!code --]
	public const int eyeofmind = 134; // [!code ++]

	public const int lumberjack = 225; // [!code --]
	public const int PDR = 55; // [!code ++]

	public const int mining = 220;

	public const int fishing = 245; // [!code --]
	public const int spotting = 210; // [!code ++]

	public const int weightlifting = 207;

```

[`@@ -60,7 +58,9 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L60-L66)
```cs:line-numbers=60

	public const int evasionPlus = 151;

	public const int strategy = 135; // [!code --]
	public const int evasion = 150; // [!code ++]
 // [!code ++]
	public const int lumberjack = 225; // [!code ++]

	public const int EDR = 56;

```

[`@@ -68,6 +68,8 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L68-L73)
```cs:line-numbers=68

	public const int life = 60;

	public const int fishing = 245; // [!code ++]
 // [!code ++]
	public const int mana = 61;

	public const int vigor = 62;
```

[`@@ -94,11 +96,11 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L94-L104)
```cs:line-numbers=94

	public const int WIL = 75;

	public const int MAG = 76; // [!code --]
 // [!code --]
	public const int evasionPerfect = 57;

	public const int CHA = 77; // [!code --]
	public const int MAG = 76; // [!code ++]
 // [!code ++]
	public const int LUC = 78; // [!code ++]

	public const int SPD = 79;

```

[`@@ -112,8 +114,6 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L112-L119)
```cs:line-numbers=112

	public const int antiMagic = 93;

	public const int martial = 100; // [!code --]
 // [!code --]
	public const int weaponAxe = 102;

	public const int weaponStaff = 103;
```

[`@@ -128,11 +128,11 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L128-L138)
```cs:line-numbers=128

	public const int throwing = 108;

	public const int LUC = 78; // [!code --]
	public const int CHA = 77; // [!code ++]

	public const int gathering = 250;

	public const int spotting = 210; // [!code --]
	public const int martial = 100; // [!code ++]

	public const int blacksmith = 256;

```

[`@@ -268,13 +268,13 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/SKILL.cs#L268-L280)
```cs:line-numbers=268

	public static readonly int[] IDS = new int[133]
	{
		132, 131, 130, 123, 122, 51, 111, 110, 109, 50, // [!code --]
		133, 120, 134, 227, 150, 242, 241, 240, 237, 235, // [!code --]
		230, 55, 226, 225, 220, 245, 207, 200, 152, 151, // [!code --]
		135, 56, 101, 60, 61, 62, 64, 65, 66, 67, // [!code --]
		68, 70, 71, 72, 73, 74, 75, 76, 57, 77, // [!code --]
		79, 80, 90, 91, 92, 93, 100, 102, 103, 104, // [!code --]
		105, 106, 107, 108, 78, 250, 210, 256, 916, 917, // [!code --]
		131, 130, 123, 122, 50, 111, 110, 109, 51, 132, // [!code ++]
		120, 133, 226, 135, 242, 241, 240, 237, 235, 230, // [!code ++]
		227, 134, 55, 220, 210, 207, 200, 152, 151, 150, // [!code ++]
		225, 56, 101, 60, 245, 61, 62, 64, 65, 66, // [!code ++]
		67, 68, 70, 71, 72, 73, 74, 75, 57, 76, // [!code ++]
		78, 79, 80, 90, 91, 92, 93, 102, 103, 104, // [!code ++]
		105, 106, 107, 108, 77, 250, 100, 256, 916, 917, // [!code ++]
		918, 919, 920, 921, 922, 923, 924, 925, 926, 950,
		951, 952, 915, 953, 955, 956, 957, 958, 959, 960,
		961, 962, 963, 964, 965, 970, 972, 255, 954, 914,
```

## StatsMana

[`@@ -49,9 +49,10 @@ public override void Mod(int a)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/StatsMana.cs#L49-L57)
```cs:line-numbers=49
		}
		BaseStats.CC.Say("mana_overflow", BaseStats.CC);
		BaseStats.CC.DamageHP(num, 921, 100, AttackSource.ManaBackfire);
		if (BaseStats.CC.IsAliveInCurrentZone) // [!code --]
		Chara cC = BaseStats.CC; // [!code ++]
		if (cC.IsAliveInCurrentZone) // [!code ++]
		{
			BaseStats.CC.elements.ModExp(303, Mathf.Clamp(-a * 10, 10, 200)); // [!code --]
			cC.elements.ModExp(303, Mathf.Clamp(-a * 10, 10, 200)); // [!code ++]
		}
	}
}
```

## TaskHarvest

[`@@ -255,7 +255,11 @@ public override void OnCreateProgress(Progress_Custom p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/TaskHarvest.cs#L255-L261)
```cs:line-numbers=255
	p.interval = 1;
	p.onProgressBegin = delegate
	{
		if (base.IsTooHard) // [!code --]
		if (TryGetAct(owner, pos) == null) // [!code ++]
		{ // [!code ++]
			p.Cancel(); // [!code ++]
		} // [!code ++]
		else if (base.IsTooHard) // [!code ++]
		{
			owner.Say((mode == HarvestType.Disassemble) ? "tooHardToDisassemble" : "tooHardToHarvest", owner, i);
			p.Cancel();
```

[`@@ -371,7 +375,10 @@ public override void OnCreateProgress(Progress_Custom p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/TaskHarvest.cs#L371-L377)
```cs:line-numbers=371
		{
			exp = target.Num * 5;
			num2 = target.Num / 3 + EClass.rnd(target.Num / 3 + 2);
			HarvestThing(); // [!code --]
			if (!EClass._zone.IsUserZone || !EClass.game.principal.disableUsermapBenefit || !target.isNPCProperty) // [!code ++]
			{ // [!code ++]
				HarvestThing(); // [!code ++]
			} // [!code ++]
		}
		if (EClass._zone.IsCrime(owner, this) && EClass.rnd(3) != 0)
		{
```

## Thing

[`@@ -997,7 +997,7 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/Thing.cs#L997-L1003)
```cs:line-numbers=997
	{
		int key = base.category.skill;
		int key2 = 132;
		if (base.IsRangedWeapon) // [!code --]
		if (base.IsRangedWeapon && !base.IsMeleeWeapon) // [!code ++]
		{
			key2 = 133;
		}
```

## TraitCobWeb

[`@@ -1,4 +1,4 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/74544b2f43b3e9721ed5eef944e8c57e30e9ab4b/Elin/TraitCobWeb.cs#L1-L4)
```cs:line-numbers=1
public class TraitCobWeb : Trait // [!code --]
public class TraitCobWeb : TraitHarvest // [!code ++]
{
	public override string ReqHarvest => "gathering,1";
}
```

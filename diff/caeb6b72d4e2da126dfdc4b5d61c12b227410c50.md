---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 16 files modified. 1 new file created.
version: EA 23.86 Nightly
changes: COBJ/Card/CoreRef/ELEMENT/ElementContainer/HotItemHeld/InvOwnerChangeMaterial/InvOwnerMod/RecipeCard/+SocketData/SourceMaterial/TaskBuild/Thing/TraitCrafter/TraitKettle/TraitObj/Zone
---

# EA 23.86 Nightly

February 5, 2025

16 files modified. 1 new file created.

## Important Changes

**None.**
## COBJ

[`@@ -31,4 +31,6 @@ public class COBJ`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/COBJ.cs#L31-L34)
```cs:line-numbers=31
	public const int charaGenes = 15;

	public const int corruptionHistory = 16;
 // [!code ++]
	public const int socketList = 17; // [!code ++]
}
```

## Card

[`@@ -870,18 +870,6 @@ public bool isRestocking`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Card.cs#L870-L887)
```cs:line-numbers=870
		}
	}

	public bool isRuneAdded // [!code --]
	{ // [!code --]
		get // [!code --]
		{ // [!code --]
			return _bits2[8]; // [!code --]
		} // [!code --]
		set // [!code --]
		{ // [!code --]
			_bits2[8] = value; // [!code --]
		} // [!code --]
	} // [!code --]
 // [!code --]
	public bool isBackerContent => c_idBacker != 0;

	public SourceBacker.Row sourceBacker
```

[`@@ -1693,6 +1681,18 @@ public Thing ammoData`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Card.cs#L1693-L1698)
```cs:line-numbers=1693
		}
	}

	public List<SocketData> socketList // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			return GetObj<List<SocketData>>(17); // [!code ++]
		} // [!code ++]
		set // [!code ++]
		{ // [!code ++]
			SetObj(17, value); // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public Thing c_copyContainer
	{
		get
```

[`@@ -3288,6 +3288,58 @@ public void EjectSockets()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Card.cs#L3288-L3293)
```cs:line-numbers=3288
		}
	}

	public SocketData AddRune(Card rune) // [!code ++]
	{ // [!code ++]
		return AddRune(rune.refVal, rune.encLV); // [!code ++]
	} // [!code ++]
 // [!code ++]
	public SocketData AddRune(int idEle, int v) // [!code ++]
	{ // [!code ++]
		if (socketList == null) // [!code ++]
		{ // [!code ++]
			socketList = new List<SocketData>(); // [!code ++]
		} // [!code ++]
		SocketData socketData = new SocketData // [!code ++]
		{ // [!code ++]
			idEle = idEle, // [!code ++]
			value = v, // [!code ++]
			type = SocketData.Type.Rune // [!code ++]
		}; // [!code ++]
		socketList.Add(socketData); // [!code ++]
		elements.SetTo(idEle, v); // [!code ++]
		return socketData; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public SocketData GetRuneEnc(int idEle) // [!code ++]
	{ // [!code ++]
		if (socketList != null) // [!code ++]
		{ // [!code ++]
			foreach (SocketData socket in socketList) // [!code ++]
			{ // [!code ++]
				if (socket.type == SocketData.Type.Rune && socket.idEle == idEle) // [!code ++]
				{ // [!code ++]
					return socket; // [!code ++]
				} // [!code ++]
			} // [!code ++]
		} // [!code ++]
		return null; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public bool HasRune() // [!code ++]
	{ // [!code ++]
		if (socketList != null) // [!code ++]
		{ // [!code ++]
			foreach (SocketData socket in socketList) // [!code ++]
			{ // [!code ++]
				if (socket.type == SocketData.Type.Rune && !socket.dontConsumeSlot) // [!code ++]
				{ // [!code ++]
					return true; // [!code ++]
				} // [!code ++]
			} // [!code ++]
		} // [!code ++]
		return false; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public void OnChildNumChange(Card c)
	{
		if (ShouldTrySetDirtyInventory() && c.isThing)
```

## CoreRef

[`@@ -53,6 +53,24 @@ public class Affinity`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/CoreRef.cs#L53-L58)
```cs:line-numbers=53
			public Sprite love;
		}

		[Serializable] // [!code ++]
		public class Enc // [!code ++]
		{ // [!code ++]
			public Sprite mat; // [!code ++]
 // [!code ++]
			public Sprite cat; // [!code ++]
 // [!code ++]
			public Sprite enc; // [!code ++]
 // [!code ++]
			public Sprite rune; // [!code ++]
 // [!code ++]
			public Sprite trait; // [!code ++]
 // [!code ++]
			public Sprite mod; // [!code ++]
 // [!code ++]
			public Sprite weaponEnc; // [!code ++]
		} // [!code ++]
 // [!code ++]
		public Sprite suspend;

		public Sprite resume;
```

[`@@ -105,6 +123,8 @@ public class Affinity`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/CoreRef.cs#L105-L110)
```cs:line-numbers=105

		public Affinity affnity;

		public Enc enc; // [!code ++]
 // [!code ++]
		public UDInvTab invTab;

		public UDIconWeather weather;
```

## ELEMENT

[`@@ -649,7 +649,17 @@ public void _WriteNote(UINote n, Chara c, Act act)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/ELEMENT.cs#L649-L655)
```cs:line-numbers=649
	{
		n.Space(4);
		UIItem uIItem = n.AddExtra<UIItem>("costPrice");
		uIItem.text1.SetText(cost.cost.ToString() ?? "", (((cost.type == Act.CostType.MP) ? c.mana.value : c.stamina.value) >= cost.cost) ? FontColor.Good : FontColor.Bad); // [!code --]
		int num = cost.cost; // [!code ++]
		if (cost.type == Act.CostType.MP && c.Evalue(483) > 0) // [!code ++]
		{ // [!code ++]
			num = cost.cost * 100 / (100 + (int)Mathf.Sqrt(c.Evalue(483) * 10) * 3); // [!code ++]
		} // [!code ++]
		string text4 = cost.cost.ToString() ?? ""; // [!code ++]
		if (num != cost.cost) // [!code ++]
		{ // [!code ++]
			text4 = num + " (" + text4 + ")"; // [!code ++]
		} // [!code ++]
		uIItem.text1.SetText(text4, (((cost.type == Act.CostType.MP) ? c.mana.value : c.stamina.value) >= num) ? FontColor.Good : FontColor.Bad); // [!code ++]
		uIItem.image1.sprite = ((cost.type == Act.CostType.MP) ? EClass.core.refs.icons.mana : EClass.core.refs.icons.stamina);
		uIItem.image1.SetNativeSize();
	}
```

## ElementContainer

[`@@ -793,21 +793,41 @@ public void AddNote(UINote n, Func<Element, bool> isValid = null, Action onAdd =`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/ElementContainer.cs#L793-L813)
```cs:line-numbers=793
			{
				text = funcText(e, text);
			}
			n.AddText("NoteText_prefwidth", text, color); // [!code --]
			UIItem uIItem = n.AddText("NoteText_enc", text, color); // [!code ++]
			Sprite sprite = EClass.core.refs.icons.enc.enc; // [!code ++]
			Thing thing = Card?.Thing; // [!code ++]
			if (thing != null) // [!code ++]
			{ // [!code ++]
				if (thing.material.HasEnc(e.id)) // [!code ++]
				{ // [!code ++]
					sprite = EClass.core.refs.icons.enc.mat; // [!code ++]
				} // [!code ++]
				if (thing.GetRuneEnc(e.id) != null) // [!code ++]
				{ // [!code ++]
					sprite = EClass.core.refs.icons.enc.rune; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if ((bool)sprite) // [!code ++]
			{ // [!code ++]
				uIItem.image1.SetActive(enable: true); // [!code ++]
				uIItem.image1.sprite = sprite; // [!code ++]
			} // [!code ++]
			bool enable = e.HasTag("weaponEnc") || e is Ability || e.source.categorySub == "eleConvert" || e.source.categorySub == "eleAttack"; // [!code ++]
			uIItem.image2.SetActive(enable); // [!code ++]
			onAddNote?.Invoke(n, e);
			continue;
		}
		}
		UIItem uIItem = n.AddTopic("TopicAttribute", e.Name, "".TagColor((e.ValueWithoutLink > 0) ? SkinManager.CurrentColors.textGood : SkinManager.CurrentColors.textBad, e.ValueWithoutLink.ToString() ?? "")); // [!code --]
		if ((bool)uIItem.button1) // [!code --]
		UIItem uIItem2 = n.AddTopic("TopicAttribute", e.Name, "".TagColor((e.ValueWithoutLink > 0) ? SkinManager.CurrentColors.textGood : SkinManager.CurrentColors.textBad, e.ValueWithoutLink.ToString() ?? "")); // [!code ++]
		if ((bool)uIItem2.button1) // [!code ++]
		{
			uIItem.button1.tooltip.onShowTooltip = delegate(UITooltip t) // [!code --]
			uIItem2.button1.tooltip.onShowTooltip = delegate(UITooltip t) // [!code ++]
			{
				e.WriteNote(t.note, EClass.pc.elements);
			};
		}
		e.SetImage(uIItem.image1); // [!code --]
		Image image = uIItem.image2; // [!code --]
		e.SetImage(uIItem2.image1); // [!code ++]
		Image image = uIItem2.image2; // [!code ++]
		int value = (e.Potential - 80) / 20;
		image.enabled = e.Potential != 80;
		image.sprite = EClass.core.refs.spritesPotential[Mathf.Clamp(Mathf.Abs(value), 0, EClass.core.refs.spritesPotential.Count - 1)];
```

## HotItemHeld

[`@@ -31,7 +31,7 @@ public static bool CanRotate()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/HotItemHeld.cs#L31-L37)
```cs:line-numbers=31
	{
		return false;
	}
	if (!(EClass._zone is Zone_Tent) && !EClass._zone.IsPCFaction && EClass.pc.held.trait.CanBeOnlyBuiltInHome) // [!code --]
	if (!(EClass._zone is Zone_Tent) && !EClass._zone.IsPCFactionOrTent && EClass.pc.held.trait.CanBeOnlyBuiltInHome) // [!code ++]
	{
		return false;
	}
```

## InvOwnerChangeMaterial

[`@@ -21,7 +21,7 @@ public override bool ShouldShowGuide(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/InvOwnerChangeMaterial.cs#L21-L27)
```cs:line-numbers=21
	{
		return true;
	}
	if (!t.category.IsChildOf("currency") && !t.IsUnique && !t.isRuneAdded && t.trait.CanBeDropped && !t.source.fixedMaterial && !(t.trait is TraitCatalyst) && !(t.trait is TraitTile) && !(t.trait is TraitMaterialHammer)) // [!code --]
	if (!t.category.IsChildOf("currency") && !t.IsUnique && t.trait.CanBeDropped && !t.source.fixedMaterial && !(t.trait is TraitCatalyst) && !(t.trait is TraitTile) && !(t.trait is TraitMaterialHammer)) // [!code ++]
	{
		return !(t.trait is TraitSeed);
	}
```

## InvOwnerMod

[`@@ -16,14 +16,11 @@ public static bool IsValidRuneMod(Thing t, SourceElement.Row row, string idMat)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/InvOwnerMod.cs#L16-L29)
```cs:line-numbers=16
			}
		}
	}
	foreach (int key in t.material.elementMap.Keys) // [!code --]
	if (t.material.HasEnc(row.id)) // [!code ++]
	{
		if (key == row.id) // [!code --]
		{ // [!code --]
			return false; // [!code --]
		} // [!code --]
		return false; // [!code ++]
	}
	if (t.category.slot != 0 && !t.isRuneAdded) // [!code --]
	if (t.category.slot != 0 && !t.HasRune()) // [!code ++]
	{
		return !t.IsUnique;
	}
```

[`@@ -84,8 +81,7 @@ public override void _OnProcess(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/InvOwnerMod.cs#L84-L91)
```cs:line-numbers=84
	{
		SE.Play("intonation");
		EClass.pc.PlayEffect("intonation");
		t.elements.SetBase(owner.refVal, owner.encLV); // [!code --]
		t.isRuneAdded = true; // [!code --]
		t.AddRune(owner); // [!code ++]
		owner.ModNum(-1);
	}
	else
```

## RecipeCard

[`@@ -234,7 +234,7 @@ public override Thing Craft(BlessedState blessed, bool sound = false, List<Thing`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/RecipeCard.cs#L234-L240)
```cs:line-numbers=234
		{
			if (ing2.trait is TraitRune)
			{
				thing.elements.ModBase(ing2.refVal, ing2.encLV); // [!code --]
				thing.AddRune(ing2).dontConsumeSlot = true; // [!code ++]
			}
		}
	}
```

## +SocketData

::: details File Created
```cs
using System.Runtime.Serialization;
using Newtonsoft.Json;

public class SocketData : EClass
{
	public enum Type
	{
		Socket,
		Rune
	}

	[JsonProperty]
	public int[] ints = new int[5];

	public BitArray32 bits;

	public Type type
	{
		get
		{
			return ints[0].ToEnum<Type>();
		}
		set
		{
			ints[0] = (int)value;
		}
	}

	public int idEle
	{
		get
		{
			return ints[1];
		}
		set
		{
			ints[1] = value;
		}
	}

	public int value
	{
		get
		{
			return ints[2];
		}
		set
		{
			ints[2] = value;
		}
	}

	public bool dontConsumeSlot
	{
		get
		{
			return bits[0];
		}
		set
		{
			bits[0] = value;
		}
	}

	[OnSerializing]
	private void _OnSerializing(StreamingContext context)
	{
		ints[4] = (int)bits.Bits;
	}

	[OnDeserialized]
	private void _OnDeserialized(StreamingContext context)
	{
		bits.Bits = (uint)ints[4];
	}
}
```

:::
## SourceMaterial

[`@@ -122,6 +122,18 @@ public void SetTiles()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/SourceMaterial.cs#L122-L127)
```cs:line-numbers=122
		{
		}

		public bool HasEnc(int id) // [!code ++]
		{ // [!code ++]
			foreach (int key in elementMap.Keys) // [!code ++]
			{ // [!code ++]
				if (key == id) // [!code ++]
				{ // [!code ++]
					return true; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
 // [!code ++]
		public void AddBlood(Point p, int a = 1)
		{
			if (decal == 0)
```

## TaskBuild

[`@@ -83,7 +83,7 @@ public bool CanRotateBlock()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/TaskBuild.cs#L83-L89)
```cs:line-numbers=83
		{
			return false;
		}
		if (!(EClass._zone is Zone_Tent) && !EClass._zone.IsPCFaction && EClass.pc.held.trait.CanBeOnlyBuiltInHome) // [!code --]
		if (!(EClass._zone is Zone_Tent) && !EClass._zone.IsPCFactionOrTent && EClass.pc.held.trait.CanBeOnlyBuiltInHome) // [!code ++]
		{
			return false;
		}
```

[`@@ -177,7 +177,7 @@ public override HitResult GetHitResult()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/TaskBuild.cs#L177-L183)
```cs:line-numbers=177
		}
		if (!EClass.debug.ignoreBuildRule && !EClass._zone.IsPCFaction)
		{
			if (!(EClass._zone is Zone_Tent) && !EClass._zone.IsPCFaction && EClass.pc.held.trait.CanBeOnlyBuiltInHome) // [!code --]
			if (!(EClass._zone is Zone_Tent) && !EClass._zone.IsPCFactionOrTent && EClass.pc.held.trait.CanBeOnlyBuiltInHome) // [!code ++]
			{
				return HitResult.Invalid;
			}
```

## Thing

[`@@ -841,24 +841,24 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L841-L864)
```cs:line-numbers=841
		CheckJustCooked();
	}
	n.Clear();
	string text = ""; // [!code --]
	string text2 = ""; // [!code ++]
	TraitAbility traitAbility = trait as TraitAbility;
	bool showEQStats = base.IsEquipmentOrRanged || base.IsAmmo;
	bool flag = mode == IInspect.NoteMode.Product;
	bool flag2 = base.IsIdentified || flag;
	text = base.Name; // [!code --]
	text2 = base.Name; // [!code ++]
	if (base.rarity == Rarity.Legendary || base.rarity == Rarity.Mythical)
	{
		string text2 = (text.Contains("『") ? "『" : (text.Contains("《") ? "《" : "")); // [!code --]
		if (text2 != "") // [!code --]
		string text3 = (text2.Contains("『") ? "『" : (text2.Contains("《") ? "《" : "")); // [!code ++]
		if (text3 != "") // [!code ++]
		{
			string[] array = text.Split(text2); // [!code --]
			text = array[0] + Environment.NewLine + text2 + array[1]; // [!code --]
			string[] array = text2.Split(text3); // [!code ++]
			text2 = array[0] + Environment.NewLine + text3 + array[1]; // [!code ++]
		}
	}
	if (flag)
	{
		text = recipe.GetName(); // [!code --]
		text2 = recipe.GetName(); // [!code ++]
	}
	if (mode != IInspect.NoteMode.Recipe)
	{
```

[`@@ -868,57 +868,57 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L868-L924)
```cs:line-numbers=868
		}
		else
		{
			UIItem uIItem = n.AddHeaderCard(text); // [!code --]
			UIItem uIItem = n.AddHeaderCard(text2); // [!code ++]
			SetImage(uIItem.image2);
			uIItem.image2.Rect().pivot = new Vector2(0.5f, 0.5f);
			string text3 = base.Num.ToFormat() ?? ""; // [!code --]
			string text4 = (Mathf.Ceil(0.01f * (float)base.ChildrenAndSelfWeight) * 0.1f).ToString("F1") + "s"; // [!code --]
			string text4 = base.Num.ToFormat() ?? ""; // [!code ++]
			string text5 = (Mathf.Ceil(0.01f * (float)base.ChildrenAndSelfWeight) * 0.1f).ToString("F1") + "s"; // [!code ++]
			if (things.Count > 0)
			{
				text3 = text3 + " (" + things.Count + ")"; // [!code --]
				text4 = text4 + " (" + things.Count + ")"; // [!code ++]
			}
			if (base.ChildrenAndSelfWeight != SelfWeight)
			{
				text4 = text4 + " (" + (Mathf.Ceil(0.01f * (float)SelfWeight) * 0.1f).ToString("F1") + "s)"; // [!code --]
				text5 = text5 + " (" + (Mathf.Ceil(0.01f * (float)SelfWeight) * 0.1f).ToString("F1") + "s)"; // [!code ++]
			}
			text = "_quantity".lang(text3 ?? "", text4); // [!code --]
			text2 = "_quantity".lang(text4 ?? "", text5); // [!code ++]
			if (flag && recipe != null && (bool)LayerCraft.Instance)
			{
				text = text + "  " + "_recipe_lv".lang(recipe.RecipeLv.ToString() ?? ""); // [!code --]
				text2 = text2 + "  " + "_recipe_lv".lang(recipe.RecipeLv.ToString() ?? ""); // [!code ++]
			}
			uIItem.text2.SetText(text); // [!code --]
			uIItem.text2.SetText(text2); // [!code ++]
			if (showEQStats && flag2)
			{
				if (!flag)
				{
					text = ""; // [!code --]
					text2 = ""; // [!code ++]
					if (DV != 0 || PV != 0 || base.HIT != 0 || base.DMG != 0 || Penetration != 0)
					{
						if (base.DMG != 0)
						{
							text = text + "DMG".lang() + ((base.DMG > 0) ? "+" : "") + base.DMG + ", "; // [!code --]
							text2 = text2 + "DMG".lang() + ((base.DMG > 0) ? "+" : "") + base.DMG + ", "; // [!code ++]
						}
						if (base.HIT != 0)
						{
							text = text + "HIT".lang() + ((base.HIT > 0) ? "+" : "") + base.HIT + ", "; // [!code --]
							text2 = text2 + "HIT".lang() + ((base.HIT > 0) ? "+" : "") + base.HIT + ", "; // [!code ++]
						}
						if (DV != 0)
						{
							text = text + "DV".lang() + ((DV > 0) ? "+" : "") + DV + ", "; // [!code --]
							text2 = text2 + "DV".lang() + ((DV > 0) ? "+" : "") + DV + ", "; // [!code ++]
						}
						if (PV != 0)
						{
							text = text + "PV".lang() + ((PV > 0) ? "+" : "") + PV + ", "; // [!code --]
							text2 = text2 + "PV".lang() + ((PV > 0) ? "+" : "") + PV + ", "; // [!code ++]
						}
						if (Penetration != 0)
						{
							text = text + "PEN".lang() + ((Penetration > 0) ? "+" : "") + Penetration + "%, "; // [!code --]
							text2 = text2 + "PEN".lang() + ((Penetration > 0) ? "+" : "") + Penetration + "%, "; // [!code ++]
						}
						text = text.TrimEnd(' ').TrimEnd(','); // [!code --]
						text2 = text2.TrimEnd(' ').TrimEnd(','); // [!code ++]
					}
					if (!text.IsEmpty()) // [!code --]
					if (!text2.IsEmpty()) // [!code ++]
					{
						n.AddText("NoteText_eqstats", text); // [!code --]
						n.AddText("NoteText_eqstats", text2); // [!code ++]
					}
				}
				if (trait is TraitToolRange traitToolRange)
```

[`@@ -928,28 +928,28 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L928-L955)
```cs:line-numbers=928
			}
			else
			{
				string text5 = ""; // [!code --]
				string text6 = ""; // [!code ++]
				if (EClass.debug.showExtra)
				{
					int totalQuality = GetTotalQuality();
					int totalQuality2 = GetTotalQuality(applyBonus: false);
					text5 = text5 + "Lv. " + base.LV + " TQ. " + GetTotalQuality() + ((totalQuality == totalQuality2) ? "" : (" (" + totalQuality2 + ")")); // [!code --]
					text6 = text6 + "Lv. " + base.LV + " TQ. " + GetTotalQuality() + ((totalQuality == totalQuality2) ? "" : (" (" + totalQuality2 + ")")); // [!code ++]
				}
				if (HasElement(10))
				{
					text5 = text5 + (text5.IsEmpty() ? "" : "  ") + "_nutrition".lang(Evalue(10).ToFormat() ?? ""); // [!code --]
					text6 = text6 + (text6.IsEmpty() ? "" : "  ") + "_nutrition".lang(Evalue(10).ToFormat() ?? ""); // [!code ++]
				}
				if ((base.category.IsChildOf("resource") || trait.IsTool) && !(trait is TraitAbility))
				{
					text5 = text5 + (text5.IsEmpty() ? "" : "  ") + "_hardness".lang(base.material.hardness.ToString() ?? ""); // [!code --]
					text6 = text6 + (text6.IsEmpty() ? "" : "  ") + "_hardness".lang(base.material.hardness.ToString() ?? ""); // [!code ++]
				}
				if (flag && recipe != null && (bool)LayerCraft.Instance)
				{
					text5 = text5 + (text5.IsEmpty() ? "" : "  ") + "_max_quality".lang(recipe.GetQualityBonus().ToString() ?? ""); // [!code --]
					text6 = text6 + (text6.IsEmpty() ? "" : "  ") + "_max_quality".lang(recipe.GetQualityBonus().ToString() ?? ""); // [!code ++]
				}
				if (!text5.IsEmpty()) // [!code --]
				if (!text6.IsEmpty()) // [!code ++]
				{
					n.AddText("NoteText_eqstats", text5); // [!code --]
					n.AddText("NoteText_eqstats", text6); // [!code ++]
				}
			}
		}
```

[`@@ -990,9 +990,9 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L990-L998)
```cs:line-numbers=990
	}
	if (flag2)
	{
		n.AddText("isMadeOf".lang(base.material.GetText(), base.material.hardness.ToString() ?? "")); // [!code --]
		AddTextWithIcon("isMadeOf".lang(base.material.GetText(), base.material.hardness.ToString() ?? ""), EClass.core.refs.icons.enc.mat, FontColor.Default); // [!code ++]
	}
	n.AddText("isCategorized".lang(base.category.GetText())); // [!code --]
	AddText("isCategorized".lang(base.category.GetText()), FontColor.Default); // [!code ++]
	if (base.category.skill != 0)
	{
		int key = base.category.skill;
```

[`@@ -1010,177 +1010,177 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1010-L1186)
```cs:line-numbers=1010
			key = 305;
			key2 = 304;
		}
		n.AddText("isUseSkill".lang(EClass.sources.elements.map[key].GetName().ToTitleCase(wholeText: true), EClass.sources.elements.map[key2].GetName().ToTitleCase(wholeText: true))); // [!code --]
		AddText("isUseSkill".lang(EClass.sources.elements.map[key].GetName().ToTitleCase(wholeText: true), EClass.sources.elements.map[key2].GetName().ToTitleCase(wholeText: true)), FontColor.Default); // [!code ++]
	}
	if (base.IsContainer)
	{
		n.AddText("isContainer".lang(things.MaxCapacity.ToString() ?? "")); // [!code --]
		AddText("isContainer".lang(things.MaxCapacity.ToString() ?? ""), FontColor.Default); // [!code ++]
	}
	if (base.c_lockLv != 0)
	{
		n.AddText((base.c_lockedHard ? "isLockedHard" : "isLocked").lang(base.c_lockLv.ToString() ?? ""), FontColor.Warning); // [!code --]
		AddText((base.c_lockedHard ? "isLockedHard" : "isLocked").lang(base.c_lockLv.ToString() ?? ""), FontColor.Warning); // [!code ++]
	}
	if (base.isCrafted && recipe == null)
	{
		n.AddText("isCrafted".lang()); // [!code --]
		AddText("isCrafted".lang(), FontColor.Default); // [!code ++]
	}
	if (trait.Decay > 0)
	{
		string text6 = ""; // [!code --]
		text6 = (base.IsDecayed ? "isRotten" : (base.IsRotting ? "isRotting" : ((!base.IsFresn) ? "isNotFresh" : "isFresh"))); // [!code --]
		n.AddText(text6.lang()); // [!code --]
		string text7 = ""; // [!code ++]
		text7 = (base.IsDecayed ? "isRotten" : (base.IsRotting ? "isRotting" : ((!base.IsFresn) ? "isNotFresh" : "isFresh"))); // [!code ++]
		AddText(text7.lang(), FontColor.Default); // [!code ++]
	}
	if (base.isDyed)
	{
		n.AddText("isDyed".lang()); // [!code --]
		AddText("isDyed".lang(), FontColor.Default); // [!code ++]
	}
	if (base.IsEquipment)
	{
		text = "isEquipable".lang(Element.Get(base.category.slot).GetText()); // [!code --]
		n.AddText(text); // [!code --]
		text2 = "isEquipable".lang(Element.Get(base.category.slot).GetText()); // [!code ++]
		AddText(text2, FontColor.Default); // [!code ++]
	}
	if (base.isFireproof)
	{
		n.AddText("isFreproof"); // [!code --]
		AddText("isFreproof", FontColor.Default); // [!code ++]
	}
	if (base.isAcidproof)
	{
		n.AddText("isAcidproof"); // [!code --]
		AddText("isAcidproof", FontColor.Default); // [!code ++]
	}
	if (trait.Electricity > 0)
	{
		n.AddText("isGenerateElectricity".lang(trait.Electricity.ToString() ?? "")); // [!code --]
		AddText("isGenerateElectricity".lang(trait.Electricity.ToString() ?? ""), FontColor.Default); // [!code ++]
	}
	if (trait.Electricity < 0)
	{
		n.AddText("isConsumeElectricity".lang(Mathf.Abs(trait.Electricity).ToString() ?? "")); // [!code --]
		AddText("isConsumeElectricity".lang(Mathf.Abs(trait.Electricity).ToString() ?? ""), FontColor.Default); // [!code ++]
	}
	if (base.IsUnique)
	{
		n.AddText("isPrecious"); // [!code --]
		AddText("isPrecious", FontColor.Default); // [!code ++]
	}
	if (base.isCopy)
	{
		n.AddText("isCopy"); // [!code --]
		AddText("isCopy", FontColor.Default); // [!code ++]
	}
	if (!trait.CanBeDestroyed)
	{
		n.AddText("isIndestructable"); // [!code --]
		AddText("isIndestructable", FontColor.Default); // [!code ++]
	}
	if (GetInt(107) > 0)
	{
		n.AddText("isLicked", FontColor.Great); // [!code --]
		AddText("isLicked", FontColor.Great); // [!code ++]
	}
	if (base.isRuneAdded) // [!code --]
	if (HasRune()) // [!code ++]
	{
		n.AddText("isRuneAdded", FontColor.Great); // [!code --]
		AddTextWithIcon("isRuneAdded", EClass.core.refs.icons.enc.rune, FontColor.Great); // [!code ++]
	}
	if (!base.c_idDeity.IsEmpty())
	{
		Religion religion = EClass.game.religions.Find(base.c_idDeity) ?? EClass.game.religions.Eyth;
		n.AddText("isDeity".lang(religion.Name), FontColor.Myth); // [!code --]
		AddText("isDeity".lang(religion.Name), FontColor.Myth); // [!code ++]
	}
	if (base.isGifted && GetRoot() != EClass.pc)
	{
		n.AddText("isGifted", FontColor.Ether); // [!code --]
		AddText("isGifted", FontColor.Ether); // [!code ++]
	}
	if (base.isNPCProperty)
	{
		n.AddText("isNPCProperty", FontColor.Ether); // [!code --]
		AddText("isNPCProperty", FontColor.Ether); // [!code ++]
	}
	if (base.c_priceFix != 0)
	{
		n.AddText(((base.c_priceFix > 0) ? "isPriceUp" : "isPriceDown").lang(Mathf.Abs(base.c_priceFix).ToString() ?? ""), FontColor.Ether); // [!code --]
		AddText(((base.c_priceFix > 0) ? "isPriceUp" : "isPriceDown").lang(Mathf.Abs(base.c_priceFix).ToString() ?? ""), FontColor.Ether); // [!code ++]
	}
	if (base.noSell)
	{
		n.AddText("isNoSell", FontColor.Ether); // [!code --]
		AddText("isNoSell", FontColor.Ether); // [!code ++]
	}
	if (base.isStolen)
	{
		n.AddText("isStolen", FontColor.Ether); // [!code --]
		AddText("isStolen", FontColor.Ether); // [!code ++]
	}
	if (base.c_isImportant)
	{
		n.AddText("isMarkedImportant", FontColor.Ether); // [!code --]
		AddText("isMarkedImportant", FontColor.Ether); // [!code ++]
	}
	if (GetInt(25) != 0)
	{
		n.AddText("isDangerLv".lang((GetInt(25) + 1).ToString() ?? "", (EClass.pc.FameLv + 10).ToString() ?? "")); // [!code --]
		AddText("isDangerLv".lang((GetInt(25) + 1).ToString() ?? "", (EClass.pc.FameLv + 10).ToString() ?? ""), FontColor.Default); // [!code ++]
	}
	FontColor color = FontColor.Util; // [!code --]
	FontColor col2 = FontColor.Util; // [!code ++]
	if (trait is TraitTool && !(trait is TraitToolRange))
	{
		if (HasElement(220))
		{
			n.AddText("canMine".lang(), color); // [!code --]
			AddText("canMine".lang(), col2); // [!code ++]
		}
		if (HasElement(225))
		{
			n.AddText("canLumberjack".lang(), color); // [!code --]
			n.AddText("canLumberjack2".lang(), color); // [!code --]
			AddText("canLumberjack".lang(), col2); // [!code ++]
			AddText("canLumberjack2".lang(), col2); // [!code ++]
		}
		if (HasElement(230))
		{
			n.AddText("canDig", color); // [!code --]
			AddText("canDig", col2); // [!code ++]
		}
		if (HasElement(286))
		{
			n.AddText("canFarm", color); // [!code --]
			AddText("canFarm", col2); // [!code ++]
		}
		if (HasElement(245))
		{
			n.AddText("canFish", color); // [!code --]
			AddText("canFish", col2); // [!code ++]
		}
		if (HasElement(237))
		{
			n.AddText("canTame", color); // [!code --]
			AddText("canTame", col2); // [!code ++]
		}
	}
	if (trait is TraitToolMusic)
	{
		n.AddText("canPlayMusic".lang(), color); // [!code --]
		AddText("canPlayMusic".lang(), col2); // [!code ++]
	}
	if (Lang.Has("hint_" + trait.ToString()))
	{
		n.AddText("hint_" + trait.ToString(), FontColor.Util); // [!code --]
		AddText("hint_" + trait.ToString(), FontColor.Util); // [!code ++]
	}
	if (Lang.Has("hint_" + trait.ToString() + "2"))
	{
		n.AddText("hint_" + trait.ToString() + "2", FontColor.Util); // [!code --]
		AddText("hint_" + trait.ToString() + "2", FontColor.Util); // [!code ++]
	}
	if (HasTag(CTAG.tourism))
	{
		n.AddText("isTourism", FontColor.Util); // [!code --]
		AddText("isTourism", FontColor.Util); // [!code ++]
	}
	string langPlaceType = base.TileType.LangPlaceType;
	if (langPlaceType == "place_Door" || langPlaceType == "place_WallMount")
	{
		n.AddText(base.TileType.LangPlaceType + "_hint".lang(), FontColor.Util); // [!code --]
		AddText(base.TileType.LangPlaceType + "_hint".lang(), FontColor.Util); // [!code ++]
	}
	if (trait.IsHomeItem)
	{
		n.AddText("isHomeItem".lang(), FontColor.Util); // [!code --]
		AddText("isHomeItem".lang(), FontColor.Util); // [!code ++]
	}
	if (HasTag(CTAG.throwWeapon))
	{
		n.AddText("isThrowWeapon"); // [!code --]
		AddText("isThrowWeapon", FontColor.Default); // [!code ++]
	}
	if (EClass.debug.showExtra && HasTag(CTAG.throwWeaponEnemy))
	{
		n.AddText("isThrowWeaponEnemy"); // [!code --]
		AddText("isThrowWeaponEnemy", FontColor.Default); // [!code ++]
	}
	if (HasElement(10))
	{
		n.AddText("isEdible"); // [!code --]
		AddText("isEdible", FontColor.Default); // [!code ++]
	}
	if (HasTag(CTAG.rareResource))
	{
		n.AddText("isRareResource", FontColor.Great); // [!code --]
		AddText("isRareResource", FontColor.Great); // [!code ++]
	}
	if (trait is TraitBed traitBed)
	{
		n.AddText("isBed".lang(traitBed.MaxHolders.ToString() ?? "")); // [!code --]
		AddText("isBed".lang(traitBed.MaxHolders.ToString() ?? ""), FontColor.Default); // [!code ++]
	}
	bool flag3 = base.IsEquipmentOrRanged || base.IsAmmo || base.IsThrownWeapon;
	if (flag2)
```

[`@@ -1190,7 +1190,7 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1190-L1196)
```cs:line-numbers=1190
			Element element = elements.GetElement(653);
			if (element != null)
			{
				n.AddText("isAlive".lang(element.vBase.ToString() ?? "", (element.vExp / 10).ToString() ?? "", (element.ExpToNext / 10).ToString() ?? ""), FontColor.Great); // [!code --]
				AddText("isAlive".lang(element.vBase.ToString() ?? "", (element.vExp / 10).ToString() ?? "", (element.ExpToNext / 10).ToString() ?? ""), FontColor.Great); // [!code ++]
			}
			string[] rangedSubCats = new string[2] { "eleConvert", "eleAttack" };
			elements.AddNote(n, delegate(Element e)
```

[`@@ -1214,16 +1214,16 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1214-L1229)
```cs:line-numbers=1214
		{
			foreach (int socket in sockets)
			{
				n.AddText((socket == 0) ? "emptySocket".lang() : "socket".lang(EClass.sources.elements.map[socket / 100].GetName(), (socket % 100).ToString() ?? ""), FontColor.Gray); // [!code --]
				AddText((socket == 0) ? "emptySocket".lang() : "socket".lang(EClass.sources.elements.map[socket / 100].GetName(), (socket % 100).ToString() ?? ""), FontColor.Gray); // [!code ++]
			}
		}
	}
	else
	{
		n.AddText("isUnidentified".lang(), FontColor.Flavor); // [!code --]
		AddText("isUnidentified".lang(), FontColor.Flavor); // [!code ++]
		if (base.c_IDTState == 1)
		{
			n.AddText("isUnidentified2".lang(), FontColor.Flavor); // [!code --]
			AddText("isUnidentified2".lang(), FontColor.Flavor); // [!code ++]
		}
	}
	trait.WriteNote(n, flag2);
```

[`@@ -1238,11 +1238,11 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1238-L1248)
```cs:line-numbers=1238
		}
		elements.AddNote(n, (Element e) => list.Contains(e), null, ElementContainer.NoteMode.Trait, addRaceFeat: false, delegate(Element e, string s)
		{
			string text11 = s; // [!code --]
			string text12 = e.source.GetText("textExtra"); // [!code --]
			if (!text12.IsEmpty()) // [!code --]
			string text12 = s; // [!code ++]
			string text13 = e.source.GetText("textExtra"); // [!code ++]
			if (!text13.IsEmpty()) // [!code ++]
			{
				string text13 = ""; // [!code --]
				string text14 = ""; // [!code ++]
				if (e.id == 2 && mode == IInspect.NoteMode.Product)
				{
					int num2 = recipe.GetQualityBonus() / 10;
```

[`@@ -1250,18 +1250,18 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1250-L1267)
```cs:line-numbers=1250
					{
						num2++;
					}
					text13 = "qualityLimit".lang(num2.ToString() ?? ""); // [!code --]
					text14 = "qualityLimit".lang(num2.ToString() ?? ""); // [!code ++]
				}
				int num3 = e.Value / 10;
				num3 = ((e.Value < 0) ? (num3 - 1) : (num3 + 1));
				text12 = "Lv." + num3 + text13 + " " + text12; // [!code --]
				text13 = "Lv." + num3 + text14 + " " + text13; // [!code ++]
				if (infoMode && e.IsFoodTraitMain)
				{
					text12 += "traitAdditive".lang(); // [!code --]
					text13 += "traitAdditive".lang(); // [!code ++]
				}
				text11 += (" <size=12>" + text12 + "</size>").TagColor(FontColor.Passive); // [!code --]
				text12 += (" <size=12>" + text13 + "</size>").TagColor(FontColor.Passive); // [!code ++]
			}
			return text11; // [!code --]
			return text12; // [!code ++]
		}, delegate
		{
		});
```

[`@@ -1269,37 +1269,37 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1269-L1305)
```cs:line-numbers=1269
		{
			if (FoodEffect.IsHumanFlesh(this))
			{
				n.AddText("foodHuman".lang(), FontColor.Ether); // [!code --]
				AddText("foodHuman".lang(), FontColor.Ether); // [!code ++]
			}
			if (FoodEffect.IsUndeadFlesh(this))
			{
				n.AddText("foodUndead".lang(), FontColor.Ether); // [!code --]
				AddText("foodUndead".lang(), FontColor.Ether); // [!code ++]
			}
		}
		if (list.Count != list2.Count)
		{
			n.AddText("traitOther".lang((list2.Count - list.Count).ToString() ?? "")); // [!code --]
			AddText("traitOther".lang((list2.Count - list.Count).ToString() ?? ""), FontColor.Default); // [!code ++]
		}
		if (mode == IInspect.NoteMode.Product && HasTag(CTAG.dish_bonus))
		{
			n.AddHeader("HeaderAdditionalTrait", "additional_trait");
			source.model.elements.AddNote(n, (Element e) => e.IsFoodTraitMain, null, ElementContainer.NoteMode.Trait, addRaceFeat: false, delegate(Element e, string s)
			{
				string text8 = s; // [!code --]
				string text9 = e.source.GetText("textExtra"); // [!code --]
				if (!text9.IsEmpty()) // [!code --]
				string text9 = s; // [!code ++]
				string text10 = e.source.GetText("textExtra"); // [!code ++]
				if (!text10.IsEmpty()) // [!code ++]
				{
					string text10 = ""; // [!code --]
					string text11 = ""; // [!code ++]
					int num = e.Value / 10;
					num = ((e.Value < 0) ? (num - 1) : (num + 1));
					text9 = "Lv." + num + text10 + " " + text9; // [!code --]
					text10 = "Lv." + num + text11 + " " + text10; // [!code ++]
					if (infoMode && e.IsFoodTraitMain)
					{
						text9 += "traitAdditive".lang(); // [!code --]
						text10 += "traitAdditive".lang(); // [!code ++]
					}
					text8 += (" <size=12>" + text9 + "</size>").TagColor(FontColor.Passive); // [!code --]
					text9 += (" <size=12>" + text10 + "</size>").TagColor(FontColor.Passive); // [!code ++]
				}
				return text8; // [!code --]
				return text9; // [!code ++]
			});
		}
	}
```

[`@@ -1314,11 +1314,11 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1314-L1324)
```cs:line-numbers=1314
	}
	if (id == "statue_weird")
	{
		n.AddText("weirdStatue"); // [!code --]
		AddText("weirdStatue", FontColor.Default); // [!code ++]
	}
	if (base.isReplica)
	{
		n.AddText("isReplica", FontColor.Passive); // [!code --]
		AddText("isReplica", FontColor.Passive); // [!code ++]
	}
	if (flag2)
	{
```

[`@@ -1335,9 +1335,9 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1335-L1343)
```cs:line-numbers=1335
		{
			n.AddHeader("headerAttackEval");
			AttackProcess.Current.Prepare(chara ?? EClass.pc, this, null, null, 0, base.IsThrownWeapon);
			string text7 = AttackProcess.Current.GetText(); // [!code --]
			text7 = text7.TagColor(() => true); // [!code --]
			n.AddText(text7); // [!code --]
			string text8 = AttackProcess.Current.GetText(); // [!code ++]
			text8 = text8.TagColor(() => true); // [!code ++]
			n.AddText(text8); // [!code ++]
		}
	}
	if (base.ammoData != null)
```

[`@@ -1358,6 +1358,16 @@ public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1358-L1363)
```cs:line-numbers=1358
			}
		}
		n.Build();
		void AddText(string text, FontColor col) // [!code ++]
		{ // [!code ++]
			n.AddText("NoteText_enc", text, col); // [!code ++]
		} // [!code ++]
		void AddTextWithIcon(string text, Sprite sprite, FontColor col) // [!code ++]
		{ // [!code ++]
			UIItem uIItem2 = n.AddText("NoteText_enc", text, col); // [!code ++]
			uIItem2.image1.SetActive(enable: true); // [!code ++]
			uIItem2.image1.sprite = sprite; // [!code ++]
		} // [!code ++]
	}

	public static void AddAttackEvaluation(UINote n, Chara chara, Thing current = null)
```

[`@@ -1881,7 +1891,7 @@ public void DoAct(Act act)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Thing.cs#L1881-L1887)
```cs:line-numbers=1881

	public void TryLickEnchant(Chara c, bool msg = true, Chara tg = null, BodySlot slot = null)
	{
		if (!base.IsEquipmentOrRanged || base.IsCursed || base.rarity <= Rarity.Normal || GetInt(107) > 0 || base.isRuneAdded) // [!code --]
		if (!base.IsEquipmentOrRanged || base.IsCursed || base.rarity <= Rarity.Normal || GetInt(107) > 0) // [!code ++]
		{
			return;
		}
```

## TraitCrafter

[`@@ -306,10 +306,10 @@ public virtual Thing Craft(AI_UseCrafter ai)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/TraitCrafter.cs#L306-L315)
```cs:line-numbers=306
	case MixType.Sculpture:
	{
		t = ThingGen.Create(thing3);
		List<CardRow> list = EClass.player.codex.ListKills(); // [!code --]
		list.Add(EClass.sources.cards.map["putty"]); // [!code --]
		list.Add(EClass.sources.cards.map["snail"]); // [!code --]
		CardRow cardRow = list.RandomItemWeighted((CardRow a) => Mathf.Max(50 - a.LV, Mathf.Clamp(EClass.pc.Evalue(258) / 2, 1, a.LV * 2))); // [!code --]
		List<CardRow> list2 = EClass.player.codex.ListKills(); // [!code ++]
		list2.Add(EClass.sources.cards.map["putty"]); // [!code ++]
		list2.Add(EClass.sources.cards.map["snail"]); // [!code ++]
		CardRow cardRow = list2.RandomItemWeighted((CardRow a) => Mathf.Max(50 - a.LV, Mathf.Clamp(EClass.pc.Evalue(258) / 2, 1, a.LV * 2))); // [!code ++]
		t.c_idRefCard = cardRow.id;
		t.ChangeMaterial(thing.material);
		t.SetEncLv(Mathf.Min(EClass.rnd(EClass.rnd(Mathf.Max(5 + EClass.pc.Evalue(258) - cardRow.LV, 1))), 12));
```

[`@@ -321,22 +321,32 @@ public virtual Thing Craft(AI_UseCrafter ai)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/TraitCrafter.cs#L321-L342)
```cs:line-numbers=321
		Thing eq = ai.ings[0];
		Thing thing7 = eq.Duplicate(1);
		thing7.SetEncLv(0);
		List<Element> list2 = thing7.elements.ListRune(); // [!code --]
		if (list2.Count == 0) // [!code --]
		List<Element> list = thing7.elements.ListRune(); // [!code ++]
		if (list.Count == 0) // [!code ++]
		{
			Msg.SayNothingHappen();
			break;
		}
		foreach (Element item in list) // [!code ++]
		{ // [!code ++]
			SocketData runeEnc = eq.GetRuneEnc(item.id); // [!code ++]
			if (runeEnc != null) // [!code ++]
			{ // [!code ++]
				item.vBase = runeEnc.value; // [!code ++]
				item.vSource = 0; // [!code ++]
			} // [!code ++]
		} // [!code ++]
		if (eq.material.hardness > owner.material.hardness && !EClass.debug.enable)
		{
			Msg.Say("rune_tooHard", owner);
			break;
		}
		EClass.ui.AddLayer<LayerList>().SetList2(list2, (Element a) => a.Name, delegate(Element a, ItemGeneral b) // [!code --]
		EClass.ui.AddLayer<LayerList>().SetList2(list, (Element a) => a.Name, delegate(Element a, ItemGeneral b) // [!code ++]
		{
			owner.ModNum(-1);
			eq.Destroy();
			Thing thing8 = ThingGen.Create("rune");
			thing8.ChangeMaterial(owner.material); // [!code ++]
			thing8.refVal = a.id;
			thing8.encLV = a.vBase + a.vSource;
			EClass.pc.Pick(thing8);
```

## TraitKettle

[`@@ -48,7 +48,7 @@ public override bool CanJoinParty`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/TraitKettle.cs#L48-L54)
```cs:line-numbers=48

	public override bool CanCopy(Thing t)
	{
		if (t.noSell || t.isRuneAdded || t.HasElement(1229)) // [!code --]
		if (t.noSell || t.HasRune() || t.HasElement(1229)) // [!code ++]
		{
			return false;
		}
```

## TraitObj

[`@@ -1,4 +1,6 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/TraitObj.cs#L1-L4)
```cs:line-numbers=1
public class TraitObj : TraitTile
{
	public override TileRow source => EClass.sources.objs.rows[owner.refVal];
 // [!code ++]
	public override bool CanBeOnlyBuiltInHome => true; // [!code ++]
}
```

## Zone

[`@@ -463,6 +463,18 @@ public bool CanEnterBuildModeAnywhere`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/caeb6b72d4e2da126dfdc4b5d61c12b227410c50/Elin/Zone.cs#L463-L468)
```cs:line-numbers=463

	public bool IsPCFaction => base.mainFaction == EClass.pc.faction;

	public bool IsPCFactionOrTent // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			if (base.mainFaction != EClass.pc.faction) // [!code ++]
			{ // [!code ++]
				return EClass._zone is Zone_Tent; // [!code ++]
			} // [!code ++]
			return true; // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public bool IsStartZone => this == EClass.game.StartZone;

	public bool IsInstance => instance != null;
```

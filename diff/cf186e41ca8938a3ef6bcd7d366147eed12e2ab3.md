---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 7 files modified.
version: EA 23.251 Nightly
changes: AI_Idle/BaseTileMap/CoreDebug/DNA/TCOrbitChara/Thing/TraitMonsterBall
---

# EA 23.251 Nightly

December 21, 2025

7 files modified.

## Important Changes

**None.**
## AI_Idle

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/AI_Idle.cs#L69-L77)
```cs:line-numbers=69
					owner.Pick(thing);
				}
			}
			if (thing == null && !owner.IsPCParty) // [!code --]
			if (thing == null && !owner.IsPCFaction) // [!code ++]
			{
				if (!owner.IsPCFaction && EClass.rnd(8) != 0) // [!code --]
				if (EClass.rnd(8) != 0) // [!code ++]
				{
					owner.hunger.Mod(-30);
				}
```

## BaseTileMap

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2535-L2549)
```cs:line-numbers=2535
	bool shadow = liquidLv == 0;
	float num20 = 0f;
	float num21 = 0f;
	bool flag10 = false; // [!code --]
	float num22 = 0f;
	float num23 = 0f;
	bool flag11 = false; // [!code --]
	bool flag10 = false; // [!code ++]
	float num24 = 0f;
	bool flag11 = false; // [!code ++]
	float num25 = 0f; // [!code ++]
	if (detail.things.Count > 0 && isSeen)
	{
		_ = zSetting.max1;
		float num25 = 0f; // [!code --]
		float num26 = 0f; // [!code ++]
		for (int m = 0; m < detail.things.Count; m++)
		{
			Thing t = detail.things[m];
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2558-L2570)
```cs:line-numbers=2558
			{
				pref = rendererObjDummy.shadowPref;
			}
			float num26 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code --]
			float num27 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code ++]
			if (t.ignoreStackHeight)
			{
				thingPos = Vector3.zero; // [!code --]
				num23 = 0f; // [!code --]
				thingPos.y -= num20; // [!code ++]
				thingPos -= altitudeFix * num21; // [!code ++]
			}
			shadow = thingPos.y < 0.16f && num24 < 0.16f; // [!code --]
			shadow = thingPos.y < 0.16f && num25 < 0.16f; // [!code ++]
			_ = pref.bypassShadow;
			param.shadowFix = 0f - thingPos.y;
			param.liquidLv = ((thingPos.y + (float)t.altitude < 0.1f) ? liquidLv : 0);
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2574-L2580)
```cs:line-numbers=2574
				SetRoofHeight(param, this.cell, cx, cz);
				_actorPos.x = param.x;
				_actorPos.y = param.y;
				_actorPos.z = param.z + num25; // [!code --]
				_actorPos.z = param.z + num26; // [!code ++]
				if (this.room != null)
				{
					param.color = GetRoofLight(this.room.lot);
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2585-L2593)
```cs:line-numbers=2585
			else
			{
				param.snow = snowed;
				_actorPos.x = orgX + num21; // [!code --]
				_actorPos.x = orgX + num23; // [!code ++]
				_actorPos.y = orgY;
				_actorPos.z = orgZ + num25 + thingPos.z; // [!code --]
				_actorPos.z = orgZ + num26 + thingPos.z; // [!code ++]
				if (tileType.CanStack || !isInstalled)
				{
					if (thing?.id != t.id)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2620-L2626)
```cs:line-numbers=2620
						freePos.z += rampFix2.z;
						if (!this.cell.IsTopWater || t.altitude > 0)
						{
							num24 += rampFix2.y; // [!code --]
							num25 += rampFix2.y; // [!code ++]
						}
						liquidLv -= (int)(rampFix2.y * 150f);
						if (liquidLv < 0)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2630-L2641)
```cs:line-numbers=2630
					}
					else if (!flag11 && t.trait.IsChangeFloorHeight && !t.ignoreStackHeight)
					{
						orgY += num26 + (float)t.altitude * altitudeFix.y; // [!code --]
						orgY += num27 + (float)t.altitude * altitudeFix.y; // [!code ++]
						orgZ += (float)t.altitude * altitudeFix.z;
						freePos.y += num26 + (float)t.altitude * altitudeFix.y; // [!code --]
						freePos.y += num27 + (float)t.altitude * altitudeFix.y; // [!code ++]
						if (!this.cell.IsTopWater || t.altitude > 0)
						{
							num24 += num26 + (float)t.altitude * altitudeFix.y; // [!code --]
							num25 += num27 + (float)t.altitude * altitudeFix.y; // [!code ++]
						}
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1));
						_actorPos.z += pref.z;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2647-L2653)
```cs:line-numbers=2647
					}
					else
					{
						thingPos.y += num26; // [!code --]
						thingPos.y += num27; // [!code ++]
						if (tileType.UseMountHeight)
						{
							if (tileType != TileType.Illumination || !this.cell.HasObj)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2704-L2710)
```cs:line-numbers=2704
				}
				else
				{
					thingPos.y += num26; // [!code --]
					thingPos.y += num27; // [!code ++]
					_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1));
					_actorPos.z += pref.z;
					thingPos.z += pref.z;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2712-L2724)
```cs:line-numbers=2712
				if (t.isFloating && isWater && !hasBridge && !flag)
				{
					flag = true;
					float num27 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code --]
					orgY += 0.01f * floatY - num27; // [!code --]
					float num28 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code ++]
					orgY += 0.01f * floatY - num28; // [!code ++]
					if (!t.trait.IsChangeFloorHeight)
					{
						num22 = num26; // [!code --]
						num24 = num27; // [!code ++]
					}
					_actorPos.y += 0.01f * floatY - num27; // [!code --]
					_actorPos.y += 0.01f * floatY - num28; // [!code ++]
					if (liquidLv > 10)
					{
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2730-L2739)
```cs:line-numbers=2730
					}
					param.liquidLv = liquidLv;
				}
				num20 = num26; // [!code --]
				num20 = num27; // [!code ++]
				if (t.sourceCard.multisize && !t.trait.IsGround)
				{
					num25 += zSetting.multiZ; // [!code --]
					num26 += zSetting.multiZ; // [!code ++]
				}
				orgZ += t.renderer.data.stackZ;
				if (param.liquidLv > 0)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2754-L2762)
```cs:line-numbers=2754
				if (t.altitude != 0)
				{
					_actorPos += altitudeFix * t.altitude;
					num23 += (float)t.altitude; // [!code --]
					num22 += (float)t.altitude; // [!code ++]
					num21 = t.altitude; // [!code ++]
				}
				if (num23 >= 2f && ((this.cell.Back.room != null && this.cell.Back.IsRoomEdge) || (this.cell.Left.room != null && this.cell.Left.IsRoomEdge)) && hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code --]
				if (num22 >= 2f && ((this.cell.Back.room != null && this.cell.Back.IsRoomEdge) || (this.cell.Left.room != null && this.cell.Left.IsRoomEdge)) && hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code ++]
				{
					continue;
				}
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2774-L2808)
```cs:line-numbers=2774
			{
				if (iconMode != 0)
				{
					int num28 = 0; // [!code --]
					int num29 = 0; // [!code ++]
					switch (iconMode)
					{
					case CardIconMode.Visibility:
						if (t.isMasked)
						{
							num28 = 17; // [!code --]
							num29 = 17; // [!code ++]
						}
						break;
					case CardIconMode.State:
						if (t.placeState == PlaceState.installed)
						{
							num28 = 18; // [!code --]
							num29 = 18; // [!code ++]
						}
						break;
					case CardIconMode.Deconstruct:
						if (t.isDeconstructing)
						{
							num28 = 14; // [!code --]
							num29 = 14; // [!code ++]
						}
						break;
					}
					if (t.isNPCProperty && !EMono.debug.godBuild)
					{
						num28 = 13; // [!code --]
						num29 = 13; // [!code ++]
					}
					if (num28 != 0) // [!code --]
					if (num29 != 0) // [!code ++]
					{
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num28); // [!code --]
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num29); // [!code ++]
					}
				}
				t.SetRenderParam(param);
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2829-L2835)
```cs:line-numbers=2829
			}
			if (isInstalled)
			{
				num21 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
				num23 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
			}
			param.x = orgX;
			param.y = orgY;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2842-L2853)
```cs:line-numbers=2842
			}
		}
	}
	orgY += num22; // [!code --]
	orgY += num24; // [!code ++]
	if (detail.charas.Count <= 0)
	{
		return;
	}
	param.shadowFix = 0f - num24; // [!code --]
	param.shadowFix = 0f - num25; // [!code ++]
	param.color += 1310720f;
	float max = zSetting.max2;
	for (int n = 0; n < detail.charas.Count; n++)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2872-L2880)
```cs:line-numbers=2872
				{
					Vector3 position = restrainer.owner.renderer.position;
					float defCharaHeight = EMono.setting.render.defCharaHeight;
					float num29 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code --]
					float num30 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code ++]
					_actorPos.x = position.x + getRestrainPos.x * (float)((restrainer.owner.dir % 2 == 0) ? 1 : (-1));
					_actorPos.y = position.y + num29; // [!code --]
					_actorPos.y = position.y + num30; // [!code ++]
					_actorPos.z = position.z + getRestrainPos.z;
					param.liquidLv = 0;
					param.shadowFix = orgY - _actorPos.y;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2889-L2910)
```cs:line-numbers=2889
		{
			if (chara.IsDeadOrSleeping && chara.IsPCC)
			{
				float num30 = chara.renderer.data.size.y * 0.3f; // [!code --]
				float num31 = chara.renderer.data.size.y * 0.3f; // [!code ++]
				if (thingPos.y > max)
				{
					thingPos.y = max;
				}
				float num31 = thingPos.y + num30; // [!code --]
				float num32 = (float)n * -0.01f; // [!code --]
				if (num31 > zSetting.thresh1) // [!code --]
				float num32 = thingPos.y + num31; // [!code ++]
				float num33 = (float)n * -0.01f; // [!code ++]
				if (num32 > zSetting.thresh1) // [!code ++]
				{
					num32 = zSetting.mod1; // [!code --]
					num33 = zSetting.mod1; // [!code ++]
				}
				_actorPos.x += thingPos.x;
				_actorPos.y += thingPos.y;
				_actorPos.z += renderSetting.laydownZ + num32; // [!code --]
				_actorPos.z += renderSetting.laydownZ + num33; // [!code ++]
				param.liquidLv = ((thingPos.y == 0f && liquidLv > 0) ? 90 : 0);
				thingPos.y += num30 * 0.8f; // [!code --]
				thingPos.y += num31 * 0.8f; // [!code ++]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0);
			}
			else
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2914-L2924)
```cs:line-numbers=2914
				{
					if (chara.Pref.FloatUnderwater)
					{
						float num33 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code --]
						float num34 = floatYs[chara.uid % 10] + 10f + (float)(chara.uid % 30); // [!code --]
						orgY += 0.01f * num34 - num33; // [!code --]
						_actorPos.y += 0.01f * num34 - num33; // [!code --]
						param.shadowFix -= 0.01f * num34 - num33; // [!code --]
						float num34 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code ++]
						float num35 = floatYs[chara.uid % 10] + 10f + (float)(chara.uid % 30); // [!code ++]
						orgY += 0.01f * num35 - num34; // [!code ++]
						_actorPos.y += 0.01f * num35 - num34; // [!code ++]
						param.shadowFix -= 0.01f * num35 - num34; // [!code ++]
					}
				}
				else if (liquidLv > 0)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2927-L2938)
```cs:line-numbers=2927
					{
						if (liquidLv > 20)
						{
							float num35 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code --]
							orgY += 0.01f * floatY - num35; // [!code --]
							_actorPos.y += 0.01f * floatY - num35; // [!code --]
							int num36 = TileType.FloorWaterShallow.LiquidLV * 10; // [!code --]
							num36 -= (int)(floatY * 0.5f); // [!code --]
							param.liquidLv = num36; // [!code --]
							float num36 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code ++]
							orgY += 0.01f * floatY - num36; // [!code ++]
							_actorPos.y += 0.01f * floatY - num36; // [!code ++]
							int num37 = TileType.FloorWaterShallow.LiquidLV * 10; // [!code ++]
							num37 -= (int)(floatY * 0.5f); // [!code ++]
							param.liquidLv = num37; // [!code ++]
						}
						else
						{
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L2992-L3007)
```cs:line-numbers=2992
			{
				if (sourceEffect2.anime.Length > 2)
				{
					float num37 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code --]
					if (!(num37 >= (float)sourceEffect2.anime[0])) // [!code --]
					float num38 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code ++]
					if (!(num38 >= (float)sourceEffect2.anime[0])) // [!code ++]
					{
						param.tile += num37; // [!code --]
						param.tile += num38; // [!code ++]
					}
				}
				else
				{
					float num38 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code --]
					param.tile += num38; // [!code --]
					float num39 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code ++]
					param.tile += num39; // [!code ++]
				}
			}
			if (this.cell.effect.IsFire)
```

[`void Draw(int tile)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L3211-L3218)
```cs:line-numbers=3211

	public Vector3 GetThingPosition(Card tg, Point p)
	{
		Vector3 vector = Vector3.zero; // [!code --]
		Vector3 vector2 = vector; // [!code --]
		Vector3 zero = Vector3.zero; // [!code ++]
		float num = 0f;
		cell = p.cell;
		sourceFloor = cell.sourceFloor;
```

[`public Vector3 GetThingPosition(Card tg, Point p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L3220-L3252)
```cs:line-numbers=3220
	{
		if (cell.isFloating && !cell.IsSnowTile)
		{
			vector.z -= 1f; // [!code --]
			zero.z -= 1f; // [!code ++]
		}
		else if (!tg.sourceCard.multisize)
		{
			float num2 = ((cell._bridge != 0) ? cell.sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight);
			vector.y += num2; // [!code --]
			vector.z -= num2 * heightMod.z; // [!code --]
			zero.y += num2; // [!code ++]
			zero.z -= num2 * heightMod.z; // [!code ++]
		}
		if (cell.HasRamp)
		{
			Vector3 rampFix = cell.sourceBlock.tileType.GetRampFix(cell.blockDir);
			vector.x += rampFix.x; // [!code --]
			vector.y += rampFix.y; // [!code --]
			vector.z += rampFix.z; // [!code --]
			zero.x += rampFix.x; // [!code ++]
			zero.y += rampFix.y; // [!code ++]
			zero.z += rampFix.z; // [!code ++]
		}
	}
	if (tg.sourceCard.multisize)
	{
		vector.z -= 1f; // [!code --]
		zero.z -= 1f; // [!code ++]
	}
	SourcePref pref = tg.Pref;
	vector.x += pref.x * (float)((!tg.flipX) ? 1 : (-1)); // [!code --]
	vector.z += pref.z; // [!code --]
	zero.x += pref.x * (float)((!tg.flipX) ? 1 : (-1)); // [!code ++]
	zero.z += pref.z; // [!code ++]
	detail = cell.detail;
	if (tg.isChara)
	{
		return vector; // [!code --]
		return zero; // [!code ++]
	}
	bool flag = false;
	if (tg.TileType.UseMountHeight && !EMono.scene.actionMode.IsRoofEditMode(tg))
```

[`public Vector3 GetThingPosition(Card tg, Point p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L3257-L3269)
```cs:line-numbers=3257
	{
		if (tg.altitude != 0)
		{
			vector += altitudeFix * tg.altitude; // [!code --]
			zero += altitudeFix * tg.altitude; // [!code ++]
		}
		flag = true;
	}
	if (EMono.scene.actionMode.IsRoofEditMode(tg))
	{
		return vector; // [!code --]
		return zero; // [!code ++]
	}
	float num3 = 0f;
	if (detail != null && detail.things.Count > 0)
```

[`public Vector3 GetThingPosition(Card tg, Point p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L3282-L3314)
```cs:line-numbers=3282
			if (thing.TileType.IsRamp)
			{
				Vector3 rampFix2 = thing.TileType.GetRampFix(thing.dir, pref2);
				vector.x += rampFix2.x; // [!code --]
				vector.y += rampFix2.y; // [!code --]
				vector.z += rampFix2.z; // [!code --]
				zero.x += rampFix2.x; // [!code ++]
				zero.y += rampFix2.y; // [!code ++]
				zero.z += rampFix2.z; // [!code ++]
			}
			if (!flag && tileType.CanStack)
			{
				if (thing.ignoreStackHeight)
				{
					vector = vector2; // [!code --]
					zero.y -= num3; // [!code ++]
				}
				vector.y += num4; // [!code --]
				vector.x += pref2.stackX * (float)((!thing.flipX) ? 1 : (-1)); // [!code --]
				vector.z += pref2.z + thing.renderer.data.stackZ; // [!code --]
				zero.y += num4; // [!code ++]
				zero.x += pref2.stackX * (float)((!thing.flipX) ? 1 : (-1)); // [!code ++]
				zero.z += pref2.z + thing.renderer.data.stackZ; // [!code ++]
				if (!tileType.UseMountHeight && thing.altitude != 0)
				{
					vector += altitudeFix * thing.altitude; // [!code --]
					zero += altitudeFix * thing.altitude; // [!code ++]
					num4 += altitudeFix.y * (float)thing.altitude;
				}
				if (thing.trait.IgnoreLastStackHeight && (card == null || !card.trait.IgnoreLastStackHeight))
				{
					vector.y -= num3; // [!code --]
					zero.y -= num3; // [!code ++]
				}
				num3 = num4;
				vector.z += renderSetting.thingZ + num + (float)i * -0.01f + zSetting.mod1 * vector.y; // [!code --]
				if (thing.TileType.IsRamp || (thing.trait.IsChangeFloorHeight && !thing.ignoreStackHeight)) // [!code --]
				zero.z += renderSetting.thingZ + num + (float)i * -0.01f + zSetting.mod1 * zero.y; // [!code ++]
				if (!thing.TileType.IsRamp && thing.trait.IsChangeFloorHeight) // [!code ++]
				{
					vector2 = vector; // [!code --]
					_ = thing.ignoreStackHeight; // [!code ++]
				}
				if (thing.sourceCard.multisize)
				{
```

[`public Vector3 GetThingPosition(Card tg, Point p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/BaseTileMap.cs#L3320-L3337)
```cs:line-numbers=3320
		}
		if (flag)
		{
			return vector; // [!code --]
			return zero; // [!code ++]
		}
		if (tg.ignoreStackHeight)
		{
			vector = vector2; // [!code --]
			vector.z += (float)(detail?.things.Count ?? 0) * -0.01f; // [!code --]
			zero.y -= num3; // [!code ++]
			zero.z += (float)(detail?.things.Count ?? 0) * -0.01f; // [!code ++]
		}
		if (tg.altitude != 0)
		{
			vector += altitudeFix * tg.altitude; // [!code --]
			zero += altitudeFix * tg.altitude; // [!code ++]
		}
		return vector; // [!code --]
		return zero; // [!code ++]
	}

	public int GetApproximateBlocklight(Cell cell)
```

## CoreDebug

[`public void UpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/CoreDebug.cs#L959-L970)
```cs:line-numbers=959
		Chara targetChara = EClass.scene.mouseTarget.TargetChara;
		if (targetChara != null)
		{
			EClass.pc.Pick(CraftUtil.MakeBloodMeal(EClass.pc, targetChara)); // [!code --]
			EClass.pc.Pick(CraftUtil.MakeLoveLunch(targetChara)); // [!code --]
			EClass.pc.Pick(targetChara.MakeEgg(effect: true, 10));
			EClass.pc.Pick(targetChara.MakeGene()); // [!code ++]
			TraitFoodEggFertilized.Incubate(targetChara.MakeEgg(effect: false, 1, addToZone: false, 100), targetChara.pos.GetNearestPoint(allowBlock: false, allowChara: false));
			targetChara.ScaleByPrincipal(); // [!code ++]
		}
		targetChara.ScaleByPrincipal(); // [!code --]
		if (EClass.game.quests.Get<QuestDebt>() == null)
		{
			Chara chara = CharaGen.Create("loytel");
```

## DNA

[`public Element GetInvalidFeat(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/DNA.cs#L631-L640)
```cs:line-numbers=631
	for (int i = 0; i < vals.Count; i += 2)
	{
		Element element = Element.Create(vals[i], vals[i + 1]);
		if (element.source.category == "feat" && c.Evalue(element.id) >= element.source.max) // [!code --]
		if (!(element.source.category == "feat")) // [!code ++]
		{
			return element; // [!code --]
			continue; // [!code ++]
		} // [!code ++]
		if (c.Evalue(element.id) < element.source.max) // [!code ++]
		{ // [!code ++]
			Element orCreateElement = c.elements.GetOrCreateElement(element.id); // [!code ++]
			if (orCreateElement != null && orCreateElement.vLink == 0) // [!code ++]
			{ // [!code ++]
				continue; // [!code ++]
			} // [!code ++]
		}
		return element; // [!code ++]
	}
	return null;
}
```

## TCOrbitChara

[`public void RefreshAll()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/TCOrbitChara.cs#L146-L157)
```cs:line-numbers=146
		if (flag2)
		{
			float x = (float)owner.mana.max / (float)(owner.mana.max + owner.MaxHP);
			bgMP.SetActive(flag2); // [!code --]
			bgMP.transform.localScale = new Vector3(x, 1f, 1f);
		}
		barHP.transform.SetLocalScaleX(Mathf.Max(0f, num));
		barHP.SetActive(enable: true);
		bgHP.SetActive(enable: true);
		bgMP.SetActive(flag2); // [!code ++]
	}
	else
	{
```

## Thing

[`public override SourcePref Pref`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/Thing.cs#L69-L74)
```cs:line-numbers=69
			{
				return EClass.core.refs.prefs.blockWall;
			}
			if (tileType is TileTypeSlope) // [!code ++]
			{ // [!code ++]
				return EClass.core.refs.prefs.blockStairs; // [!code ++]
			} // [!code ++]
		}
		if (source.origin == null || source.pref.UsePref)
		{
```

## TraitMonsterBall

[`public override int GetValue()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/cf186e41ca8938a3ef6bcd7d366147eed12e2ab3/Elin/TraitMonsterBall.cs#L52-L57)
```cs:line-numbers=52
		{
			return base.GetValue();
		}
		return base.GetValue() * (100 + owner.LV * 15) / 100; // [!code --]
		long num = (long)base.GetValue() * (long)(100 + owner.LV * 15) / 100; // [!code ++]
		if (num > 214748364) // [!code ++]
		{ // [!code ++]
			num = 214748364L; // [!code ++]
		} // [!code ++]
		return (int)num; // [!code ++]
	}
}
```

---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 21 files modified.
version: EA 23.189 Nightly
changes: AI_PlayMusic/ActThrow/CalcPlat/Card/Chara/DramaCustomSequence/DramaManager/DramaOutcome/GameLang/Guild/Recipe/SpawnSetting/SurvivalManager/TraitChara/TraitCoreDefense/TraitMod/TraitRecipe/Zone/ZoneEventRaid/ZoneEventSiege/Zone_StartSiteSky
---

# EA 23.189 Nightly

August 28, 2025

21 files modified.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [ZoneEventSiege (1)](#zoneeventsiege)
```cs:no-line-numbers
public virtual Chara CreateChara(Point p, bool boss = false) // [!code --]
public virtual Chara CreateChara(Point p) // [!code ++]
```
## AI_PlayMusic

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/AI_PlayMusic.cs#L114-L119)
```cs:line-numbers=114
		case "harp":
			idSong = "harp_komori";
			break;
		case "shield_lute": // [!code ++]
		case "lute":
			idSong = "guitar_sad";
			break;
```

## ActThrow

[`public override bool CanPerform()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/ActThrow.cs#L28-L34)
```cs:line-numbers=28
	{
		Act.TP.Set(pcTarget.pos);
	}
	if (!Act.TP.IsHidden) // [!code --]
	if (!Act.TP.IsHidden && !Act.TP.IsSky) // [!code ++]
	{
		return Act.CC.CanSeeLos(Act.TP);
	}
```

## CalcPlat

[`public class CalcPlat : EClass`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/CalcPlat.cs#L5-L11)
```cs:line-numbers=5
public static int Learn(Chara c, Element e)
{
	int num = Mathf.Max(1, e.CostLearn * (c.HasElement(1202) ? 80 : 100) / 100);
	if (e.source.tag.Contains("guild") && Guild.Current.relation.rank < 2) // [!code --]
	if (e.source.tag.Contains("guild") && Guild.CurrentDrama.relation.rank < 2) // [!code ++]
	{
		return num * 2;
	}
```

[`public static int Train(Chara c, Element _e)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/CalcPlat.cs#L20-L26)
```cs:line-numbers=20
		return 0;
	}
	int num = Mathf.Max(1, element.CostTrain * (c.HasElement(1202) ? 80 : 100) / 100);
	if (element.source.tag.Contains("guild") && Guild.Current.relation.rank < 2) // [!code --]
	if (element.source.tag.Contains("guild") && Guild.CurrentDrama.relation.rank < 2) // [!code ++]
	{
		return num * 2;
	}
```

## Card

[`public static string ApplyTone(Chara c, ref string text, string _tones, int gend`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Card.cs#L6558-L6563)
```cs:line-numbers=6558
	string key = array[0];
	string text2 = "";
	MOD.tones.Initialize();
	Debug.Log(c.Name); // [!code ++]
	if (!Lang.setting.useTone || MOD.tones.list.Count == 0)
	{
		text2 = text.Replace("{", "").Replace("}", "");
```

[`public static string ApplyTone(Chara c, ref string text, string _tones, int gend`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Card.cs#L6571-L6577)
```cs:line-numbers=6571
		if (MOD.tones.all.ContainsKey(key))
		{
			StringBuilder stringBuilder = MOD.tones.ApplyTone(key, ref text, gender);
			if (Lang.isJP && c != null && c.trait.EnableTone) // [!code --]
			if (Lang.isJP && c != null) // [!code ++]
			{
				if (array.Length >= 2)
				{
```

## Chara

[`public void RestockEquip(bool onCreate)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Chara.cs#L4774-L4779)
```cs:line-numbers=4774
		if (trait is TraitBard)
		{
			AddThing(ThingGen.Create("lute"));
			if (EClass.debug.enable || EClass.rnd(50) == 0) // [!code ++]
			{ // [!code ++]
				EQ_ID("shield_lute"); // [!code ++]
			} // [!code ++]
		}
	}

```

## DramaCustomSequence

[`public string GetRumor(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/DramaCustomSequence.cs#L1486-L1492)
```cs:line-numbers=1486
	}
	if (HasTopic("unique", c.id))
	{
		manager.enableTone = false; // [!code --]
		return GetText(c, "unique", c.id);
	}
	if (EClass.rnd(2) == 0 && !c.trait.IDRumor.IsEmpty())
```

[`public string GetText(Chara c, string idSheet, string idTopic)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/DramaCustomSequence.cs#L1532-L1538)
```cs:line-numbers=1532
		return manager.customTalkTopics[idTopic];
	}
	string[] dialog = Lang.GetDialog(idSheet, idTopic);
	if (!manager.enableTone && !(idSheet == "general")) // [!code --]
	if (!(idSheet != "unique")) // [!code ++]
	{
		return dialog.RandomItem();
	}
```

## DramaManager

[`public void ParseLine(Dictionary<string, string> item)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/DramaManager.cs#L969-L975)
```cs:line-numbers=969
			}
			if (tg != null && (actor == "tg" || actor.IsEmpty()))
			{
				text = tg.ApplyTone(text); // [!code --]
				text = (enableTone ? tg.ApplyTone(text) : text); // [!code ++]
			}
			return text;
		})) as DramaEventTalk;
```

[`public bool CheckIF(string IF)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/DramaManager.cs#L1055-L1063)
```cs:line-numbers=1055
	case "WindRest":
		return EMono._zone is Zone_WindRest;
	case "guild_promote":
		return Guild.Current.relation.exp >= Guild.Current.relation.ExpToNext; // [!code --]
		return Guild.CurrentDrama.relation.exp >= Guild.CurrentDrama.relation.ExpToNext; // [!code ++]
	case "guild_maxpromote":
		return Guild.Current.relation.rank >= Guild.Current.relation.MaxRank; // [!code --]
		return Guild.CurrentDrama.relation.rank >= Guild.CurrentDrama.relation.MaxRank; // [!code ++]
	case "scratch_check":
		return EMono.game.dateScratch > EMono.game.world.date.GetRaw();
	case "sister_money":
```

[`public bool CheckIF(string IF)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/DramaManager.cs#L1077-L1089)
```cs:line-numbers=1077
	case "hasMelilithCurse":
		return EMono.pc.HasElement(1206);
	case "merchant":
		return Guild.Current == Guild.Merchant; // [!code --]
		return Guild.CurrentDrama == Guild.Merchant; // [!code ++]
	case "fighter":
		return Guild.Current == Guild.Fighter; // [!code --]
		return Guild.CurrentDrama == Guild.Fighter; // [!code ++]
	case "thief":
		return Guild.Current == Guild.Thief; // [!code --]
		return Guild.CurrentDrama == Guild.Thief; // [!code ++]
	case "mage":
		return Guild.Current == Guild.Mage; // [!code --]
		return Guild.CurrentDrama == Guild.Mage; // [!code ++]
	case "hasDLC":
		return Steam.HasDLC(array[1].ToEnum<ID_DLC>());
	case "hasFlag":
```

## DramaOutcome

[`public static bool If(DramaChoice item, Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/DramaOutcome.cs#L383-L389)
```cs:line-numbers=383

	public void guild_trial()
	{
		if (Guild.Current == EMono.game.factions.Merchant) // [!code --]
		if (Guild.CurrentDrama == EMono.game.factions.Merchant) // [!code ++]
		{
			EMono.game.quests.Start("guild_merchant", cc, assignQuest: false);
		}
```

[`public void guild_trial()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/DramaOutcome.cs#L395-L408)
```cs:line-numbers=395

	public void guild_join()
	{
		if (Guild.Current != EMono.game.factions.Merchant) // [!code --]
		if (Guild.CurrentDrama != EMono.game.factions.Merchant) // [!code ++]
		{
			(cc.trait as TraitGuildDoorman).OnJoinGuild();
		}
		Msg.Say("guild_join", Guild.Current.Name); // [!code --]
		Msg.Say("guild_join", Guild.CurrentDrama.Name); // [!code ++]
		SE.Play("questComplete");
		Guild.Current.relation.type = FactionRelation.RelationType.Member; // [!code --]
		Guild.CurrentQuest.ChangePhase(10); // [!code --]
		Guild.CurrentDrama.relation.type = FactionRelation.RelationType.Member; // [!code ++]
		Guild.CurrentDrama?.Quest.ChangePhase(10); // [!code ++]
	}

	public void guild_mageTrial()
```

[`public void guild_mageTrial()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/DramaOutcome.cs#L413-L419)
```cs:line-numbers=413

	public void guild_promote()
	{
		Guild.Current.relation.Promote(); // [!code --]
		Guild.CurrentDrama.relation.Promote(); // [!code ++]
		Guild.GetCurrentGuild()?.RefreshDevelopment();
	}

```

## GameLang

[`public static string ConvertDrama(string text, Chara c = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/GameLang.cs#L88-L95)
```cs:line-numbers=88
	stringBuilder.Replace("#player", EClass.player.title);
	stringBuilder.Replace("#title", EClass.player.title);
	stringBuilder.Replace("#zone", EClass._zone.Name);
	stringBuilder.Replace("#guild_title", Guild.Current.relation.TextTitle); // [!code --]
	stringBuilder.Replace("#guild", Guild.Current.Name); // [!code --]
	stringBuilder.Replace("#guild_title", Guild.CurrentDrama.relation.TextTitle); // [!code ++]
	stringBuilder.Replace("#guild", Guild.CurrentDrama.Name); // [!code ++]
	stringBuilder.Replace("#race", EClass.pc.race.GetName());
	stringBuilder.Replace("#pc", EClass.pc.NameSimple);
	stringBuilder.Replace("#aka", EClass.pc.Aka);
```

## Guild

[`public static Guild Current`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Guild.cs#L20-L25)
```cs:line-numbers=20
		}
	}

	public static Guild CurrentDrama // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			if ((bool)LayerDrama.Instance && EClass.game.IsSurvival) // [!code ++]
			{ // [!code ++]
				Chara chara = LayerDrama.Instance.drama.tg?.chara; // [!code ++]
				if (chara != null) // [!code ++]
				{ // [!code ++]
					switch (chara.id) // [!code ++]
					{ // [!code ++]
					case "guild_master_fighter": // [!code ++]
					case "guild_clerk_fighter": // [!code ++]
					case "guild_doorman_fighter": // [!code ++]
						return Fighter; // [!code ++]
					case "guild_master_thief": // [!code ++]
					case "guild_clerk_thief": // [!code ++]
					case "guild_doorman_thief": // [!code ++]
						return Thief; // [!code ++]
					case "guild_master_mage": // [!code ++]
					case "guild_clerk_mage": // [!code ++]
					case "guild_doorman_mage": // [!code ++]
						return Mage; // [!code ++]
					case "guild_master_merchant": // [!code ++]
					case "guild_clerk_merchant": // [!code ++]
						return Merchant; // [!code ++]
					} // [!code ++]
				} // [!code ++]
			} // [!code ++]
			return Current; // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public static GuildFighter Fighter => EClass.game.factions.Fighter;

	public static GuildMage Mage => EClass.game.factions.Mage;
```

[`public static Guild Current`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Guild.cs#L28-L34)
```cs:line-numbers=28

	public static GuildMerchant Merchant => EClass.game.factions.Merchant;

	public static QuestGuild CurrentQuest => Current?.Quest; // [!code --]
	public static QuestGuild CurrentQuest => CurrentDrama?.Quest; // [!code ++]

	public override string TextType => "sub_guild".lang();

```

## Recipe

[`public bool IsValidIngredient(Thing t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Recipe.cs#L138-L143)
```cs:line-numbers=138
		{
			return true;
		}
		Debug.Log(t.Name + "/" + tag + "/" + t.material.tag); // [!code ++]
		if (!tag.IsEmpty() && !t.material.tag.Contains(tag)) // [!code ++]
		{ // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
		if (useCat)
		{
			if (t.category.IsChildOf(id))
```

## SpawnSetting

[`public class SpawnSetting`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/SpawnSetting.cs#L2-L7)
```cs:line-numbers=2
{
	public int filterLv = -1;

	public int dangerLv = -1; // [!code ++]
 // [!code ++]
	public int fixedLv = -1;

	public int tries = 100;
```

## SurvivalManager

[`public bool OnMineWreck(Point point)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/SurvivalManager.cs#L310-L319)
```cs:line-numbers=310
	default:
		return false;
	}
	if (EClass.rnd(3) == 0 && EClass.game.survival.flags.spawnedFloor < 4) // [!code --]
	if (EClass.rnd(3 + EClass.game.survival.flags.spawnedFloor * 2) == 0 && EClass.game.survival.flags.spawnedFloor < 8) // [!code ++]
	{
		EClass.game.survival.flags.spawnedFloor++;
		return Pop(ThingGen.CreateFloor(40, 45).SetNum(3)); // [!code --]
		switch (EClass.game.survival.flags.spawnedFloor) // [!code ++]
		{ // [!code ++]
		case 5: // [!code ++]
		case 6: // [!code ++]
			return Pop(ThingGen.CreateFloor(33, 97).SetNum(3)); // [!code ++]
		case 7: // [!code ++]
		case 8: // [!code ++]
			return Pop(ThingGen.CreateFloor(43, 66).SetNum(3)); // [!code ++]
		default: // [!code ++]
			return Pop(ThingGen.CreateFloor(40, 45).SetNum(3)); // [!code ++]
		} // [!code ++]
	}
	if (EClass.rnd(20) == 0)
	{
```

[`public Point GetRandomPoint()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/SurvivalManager.cs#L430-L436)
```cs:line-numbers=430
		case "littleOne":
			return false;
		default:
			return EClass.game.cards.globalCharas.Find(r.id) == null; // [!code --]
			if (EClass.game.cards.globalCharas.Find(r.id) == null) // [!code ++]
			{ // [!code ++]
				return r.LV < flags.raidLv + 10; // [!code ++]
			} // [!code ++]
			return false; // [!code ++]
		}
	}).ToList();
}
```

## TraitChara

[`public virtual bool CanSellPlan`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/TraitChara.cs#L98-L115)
```cs:line-numbers=98

	public virtual Adv_Type AdvType => Adv_Type.None;

	public virtual bool EnableTone // [!code --]
	{ // [!code --]
		get // [!code --]
		{ // [!code --]
			if (IsUnique) // [!code --]
			{ // [!code --]
				return !LayerDrama.Instance; // [!code --]
			} // [!code --]
			return true; // [!code --]
		} // [!code --]
	} // [!code --]
 // [!code --]
	public virtual bool CanBeTamed
	{
		get
```

## TraitCoreDefense

[`public override void TrySetAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/TraitCoreDefense.cs#L32-L37)
```cs:line-numbers=32
				return true;
			});
		}
		if (EClass.debug.enable) // [!code ++]
		{ // [!code ++]
			p.TrySetAct("50", delegate // [!code ++]
			{ // [!code ++]
				SE.Play("warhorn"); // [!code ++]
				Msg.Say("warhorn"); // [!code ++]
				EClass.game.survival.flags.raidLv += 50; // [!code ++]
				return true; // [!code ++]
			}); // [!code ++]
		} // [!code ++]
	}
	ZoneEventDefenseGame ev = EClass._zone.events.GetEvent<ZoneEventDefenseGame>();
	if (ev == null)
```

## TraitMod

[`public class TraitMod : TraitItem`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/TraitMod.cs#L8-L14)
```cs:line-numbers=8

	public override bool CanStack => false;

	public SourceElement.Row source => EClass.sources.elements.map[owner.refVal]; // [!code --]
	public SourceElement.Row source => EClass.sources.elements.map.TryGetValue(owner.refVal, DefaultEnc); // [!code ++]

	public override void OnCreate(int lv)
	{
```

## TraitRecipe

[`public override void OnRead(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/TraitRecipe.cs#L24-L30)
```cs:line-numbers=24
	public override void SetName(ref string s)
	{
		int num = EClass.player.recipes.knownRecipes.TryGetValue(ID, 0);
		s = "_recipe".lang(recipe.Name.ToTitleCase(), s) + ((num == 0) ? "" : "recipe_learnt".lang(num.ToString() ?? "")); // [!code --]
		s = "_recipe".lang(recipe?.Name.ToTitleCase() ?? "???", s) + ((num == 0) ? "" : "recipe_learnt".lang(num.ToString() ?? "")); // [!code ++]
	}

	public override bool CanStackTo(Thing to)
```

## Zone

[`public virtual bool UseLight`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Zone.cs#L405-L412)
```cs:line-numbers=405

	public virtual ZoneScaleType ScaleType => ZoneScaleType.None;

	public virtual bool ScaleMonsterLevel => false; // [!code --]
 // [!code --]
	public virtual bool HiddenInRegionMap => false;

	public virtual FlockController.SpawnType FlockType => FlockController.SpawnType.Default;
```

[`public Chara SpawnMob(Point pos = null, SpawnSetting setting = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Zone.cs#L2723-L2756)
```cs:line-numbers=2723
			return s.biome == biome.name || s.biome.IsEmpty();
		}
	}) : SpawnList.Get(biome.spawn.GetRandomCharaId())))));
	int dangerLv = DangerLv; // [!code --]
	int num = ((setting.dangerLv == -1) ? DangerLv : setting.dangerLv); // [!code ++]
	CardBlueprint cardBlueprint = new CardBlueprint
	{
		rarity = Rarity.Normal,
		idEle = setting.idEle
	};
	int num = ((setting.filterLv == -1) ? dangerLv : setting.filterLv); // [!code --]
	int num2 = ((setting.filterLv == -1) ? num : setting.filterLv); // [!code ++]
	if (ScaleType == ZoneScaleType.Void)
	{
		num = ((dangerLv - 1) % 50 + 5) * 150 / 100; // [!code --]
		if (num >= 20 && EClass.rnd(100) < num) // [!code --]
		num2 = ((num - 1) % 50 + 5) * 150 / 100; // [!code ++]
		if (num2 >= 20 && EClass.rnd(100) < num2) // [!code ++]
		{
			num = dangerLv; // [!code --]
			num2 = num; // [!code ++]
		}
	}
	CardRow cardRow = (setting.id.IsEmpty() ? spawnList.Select(num, setting.levelRange) : EClass.sources.cards.map[setting.id]); // [!code --]
	int num2 = ((setting.fixedLv == -1) ? cardRow.LV : setting.fixedLv); // [!code --]
	CardRow cardRow = (setting.id.IsEmpty() ? spawnList.Select(num2, setting.levelRange) : EClass.sources.cards.map[setting.id]); // [!code ++]
	int num3 = ((setting.fixedLv == -1) ? cardRow.LV : setting.fixedLv); // [!code ++]
	if (ScaleType == ZoneScaleType.Void)
	{
		num2 = (50 + cardRow.LV) * Mathf.Max(1, (dangerLv - 1) / 50); // [!code --]
		num3 = (50 + cardRow.LV) * Mathf.Max(1, (num - 1) / 50); // [!code ++]
	}
	num2 += DangerLvBoost; // [!code --]
	num3 += DangerLvBoost; // [!code ++]
	if (setting.rarity == Rarity.Random)
	{
		if (EClass.rnd(100) == 0)
		{
			cardBlueprint.rarity = Rarity.Legendary;
			num2 = num2 * 125 / 100; // [!code --]
			num3 = num3 * 125 / 100; // [!code ++]
		}
	}
	else
```

[`public Chara SpawnMob(Point pos = null, SpawnSetting setting = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Zone.cs#L2759-L2776)
```cs:line-numbers=2759
	}
	if (setting.isBoss)
	{
		num2 = num2 * 150 / 100; // [!code --]
		num3 = num3 * 150 / 100; // [!code ++]
	}
	if (setting.isEvolved)
	{
		num2 = num2 * 2 + 20; // [!code --]
		num3 = num3 * 2 + 20; // [!code ++]
	}
	if (num2 != cardRow.LV) // [!code --]
	if (num3 != cardRow.LV) // [!code ++]
	{
		cardBlueprint.lv = num2; // [!code --]
		cardBlueprint.lv = num3; // [!code ++]
	}
	CardBlueprint.Set(cardBlueprint);
	Chara chara = CharaGen.Create(cardRow.id, num); // [!code --]
	Chara chara = CharaGen.Create(cardRow.id, num2); // [!code ++]
	AddCard(chara, pos);
	if (setting.forcedHostility.HasValue)
	{
```

## ZoneEventRaid

[`public class ZoneEventRaid : ZoneEventSiege`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/ZoneEventRaid.cs#L5-L11)
```cs:line-numbers=5
	public override void OnInit()
	{
		lv = Mathf.Max(1, EClass.game.survival.flags.raidLv);
		max = 5 + lv / 5; // [!code --]
		max = 5 + lv / 4; // [!code ++]
		base.OnInit();
	}

```

## ZoneEventSiege

[`public class ZoneEventSiege : ZoneEvent`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/ZoneEventSiege.cs#L20-L32)
```cs:line-numbers=20

	public override string id => "trial_siege";

	public override float roundInterval => Mathf.Max(0.5f, 1.5f - 0.01f * (float)lv); // [!code --]
	public override float roundInterval => Mathf.Max(0.1f, 1.5f - 0.01f * (float)lv); // [!code ++]

	public override Playlist playlist => EClass.Sound.playlistBattle;

	public virtual Chara CreateChara(Point p, bool boss = false) // [!code --]
	public virtual Chara CreateChara(Point p) // [!code ++]
	{
		return EClass._zone.SpawnMob(p, boss ? SpawnSetting.Boss(lv) : SpawnSetting.DefenseEnemy(lv)); // [!code --]
		bool flag = idx == max - 1; // [!code ++]
		SpawnSetting spawnSetting = ((lv >= 50 && idx == max - 2) ? SpawnSetting.Evolved(lv) : (flag ? SpawnSetting.Boss(lv) : SpawnSetting.DefenseEnemy(lv))); // [!code ++]
		spawnSetting.dangerLv = lv + 1; // [!code ++]
		return EClass._zone.SpawnMob(p, spawnSetting); // [!code ++]
	}

	public override void OnInit()
```

[`public override void OnVisit()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/ZoneEventSiege.cs#L55-L61)
```cs:line-numbers=55
public void SpawnMob()
{
	Point spawnPos = GetSpawnPos();
	Chara chara = CreateChara(spawnPos, idx == max - 1); // [!code --]
	Chara chara = CreateChara(spawnPos); // [!code ++]
	chara.hostility = Hostility.Enemy;
	members.Add(chara);
	uids.Add(chara.uid);
```

## Zone_StartSiteSky

[`public class Zone_StartSiteSky : Zone_StartSite`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e37e4b13a82800ed58152cd33304f0a5677f8d4e/Elin/Zone_StartSiteSky.cs#L10-L24)
```cs:line-numbers=10

	public override string IdBiome => "Plain";

	public override bool ScaleMonsterLevel // [!code --]
	public override ZoneScaleType ScaleType // [!code ++]
	{
		get
		{
			if (EClass.game.IsSurvival) // [!code --]
			if (!EClass.game.IsSurvival || EClass.game.survival.flags.raidLv < 100) // [!code ++]
			{
				return EClass.game.survival.flags.raidLv >= 100; // [!code --]
				return ZoneScaleType.None; // [!code ++]
			}
			return false; // [!code --]
			return ZoneScaleType.Void; // [!code ++]
		}
	}
}
```

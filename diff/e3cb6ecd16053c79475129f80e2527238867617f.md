---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 5 files modified.
version: EA 23.250 Nightly Patch 1
changes: BaseTileMap/Card/Chara/TCText/TraitASMR
---

# EA 23.250 Nightly Patch 1

December 20, 2025

5 files modified.

## Important Changes

**None.**
## BaseTileMap

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/BaseTileMap.cs#L2648-L2664)
```cs:line-numbers=2648
					else
					{
						thingPos.y += num26;
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
						_actorPos.z += pref.z; // [!code --]
						if (pref.height >= 0f) // [!code --]
						if (tileType.UseMountHeight) // [!code ++]
						{
							thingPos.z += pref.z; // [!code --]
							if (tileType != TileType.Illumination || !this.cell.HasObj) // [!code ++]
							{ // [!code ++]
								if (noRoofMode && currentRoom == null && t.altitude >= lowWallObjAltitude) // [!code ++]
								{ // [!code ++]
									continue; // [!code ++]
								} // [!code ++]
								if (hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code ++]
								{ // [!code ++]
									Room room5 = ((t.dir == 0) ? this.cell.Back.room : this.cell.Left.room); // [!code ++]
									if (t.trait.AlwaysHideOnLowWall) // [!code ++]
									{ // [!code ++]
										if (room5 == null || !room5.data.showWallItem) // [!code ++]
										{ // [!code ++]
											continue; // [!code ++]
										} // [!code ++]
									} // [!code ++]
									else if (t.altitude >= lowWallObjAltitude) // [!code ++]
									{ // [!code ++]
										continue; // [!code ++]
									} // [!code ++]
								} // [!code ++]
							} // [!code ++]
							if (tileType.UseHangZFix) // [!code ++]
							{ // [!code ++]
								flag10 = true; // [!code ++]
							} // [!code ++]
							tileType.GetMountHeight(ref _actorPos, Point.shared.Set(index), t.dir, t); // [!code ++]
							shadow = false; // [!code ++]
							param.liquidLv = 0; // [!code ++]
							if (t.freePos) // [!code ++]
							{ // [!code ++]
								_actorPos.x += t.fx; // [!code ++]
								_actorPos.y += t.fy; // [!code ++]
							} // [!code ++]
						}
						if (!t.TileType.UseMountHeight) // [!code --]
						else // [!code ++]
						{
							thingPos.y += (float)t.altitude * altitudeFix.y;
							thingPos.z += (float)t.altitude * altitudeFix.z;
						}
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
						_actorPos.z += pref.z; // [!code ++]
						if (pref.height >= 0f) // [!code ++]
						{ // [!code ++]
							thingPos.z += pref.z; // [!code ++]
						} // [!code ++]
					}
					if (!tileType.UseMountHeight && m > 10)
					{
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/BaseTileMap.cs#L2712-L2755)
```cs:line-numbers=2712
					}
				}
			}
			if (isInstalled && tileType.UseMountHeight) // [!code --]
			{ // [!code --]
				if (tileType != TileType.Illumination || !this.cell.HasObj) // [!code --]
				{ // [!code --]
					if (noRoofMode && currentRoom == null && t.altitude >= lowWallObjAltitude) // [!code --]
					{ // [!code --]
						continue; // [!code --]
					} // [!code --]
					if (hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code --]
					{ // [!code --]
						Room room5 = ((t.dir == 0) ? this.cell.Back.room : this.cell.Left.room); // [!code --]
						if (t.trait.AlwaysHideOnLowWall) // [!code --]
						{ // [!code --]
							if (room5 == null || !room5.data.showWallItem) // [!code --]
							{ // [!code --]
								continue; // [!code --]
							} // [!code --]
						} // [!code --]
						else if (t.altitude >= lowWallObjAltitude) // [!code --]
						{ // [!code --]
							continue; // [!code --]
						} // [!code --]
					} // [!code --]
				} // [!code --]
				if (tileType.UseHangZFix) // [!code --]
				{ // [!code --]
					flag10 = true; // [!code --]
				} // [!code --]
				tileType.GetMountHeight(ref _actorPos, Point.shared.Set(index), t.dir, t); // [!code --]
				shadow = false; // [!code --]
				param.liquidLv = 0; // [!code --]
				if (t.freePos) // [!code --]
				{ // [!code --]
					_actorPos.x += t.fx; // [!code --]
					_actorPos.y += t.fy; // [!code --]
				} // [!code --]
			} // [!code --]
			else // [!code --]
			if (!isInstalled || !tileType.UseMountHeight) // [!code ++]
			{
				if (t.altitude != 0)
				{
```

## Card

[`public void Create(string _id, int _idMat = -1, int genLv = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/Card.cs#L2767-L2773)
```cs:line-numbers=2767
	{
		rarity = bp.rarity;
	}
	else if ((category.slot != 0 && category.slot != 45 && category.slot != 44) || IsRangedWeapon) // [!code --]
	else if ((category.slot != 0 && category.slot != 45 && category.slot != 44) || category.tag.Contains("randomRarity")) // [!code ++]
	{
		if (EClass.rnd(10) == 0)
		{
```

[`public void DamageHP(long dmg, int ele, int eleP = 100, AttackSource attackSourc`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/Card.cs#L4250-L4256)
```cs:line-numbers=4250
					num6++;
				}
			}
			if (IsPCParty) // [!code --]
			if (IsPCFactionOrMinion) // [!code ++]
			{
				dmg = dmg * 100 / Mathf.Min(100 + num5 * 5, 120);
			}
```

[`public void TalkRaw(string text, string ref1 = null, string ref2 = null, bool fo`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/Card.cs#L6785-L6790)
```cs:line-numbers=6785
		text = text.Replace("#2", ref2);
	}
	HostRenderer.Say(ApplyNewLine(text));
	text = StripTalkSpeiclaCharacters(text); // [!code ++]
	bool flag = text.StartsWith("*");
	Msg.SetColor(text.StartsWith("(") ? Msg.colors.Thinking : (flag ? Msg.colors.Ono : Msg.colors.Talk));
	if (!flag)
```

[`public void TalkRaw(string text, string ref1 = null, string ref2 = null, bool fo`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/Card.cs#L6794-L6799)
```cs:line-numbers=6794
		Msg.Say(text.Replace("&", ""));
	}

	public string StripTalkSpeiclaCharacters(string text) // [!code ++]
	{ // [!code ++]
		switch (text[0]) // [!code ++]
		{ // [!code ++]
		case '@': // [!code ++]
		{ // [!code ++]
			if (text.Length > 1 && int.TryParse(text[1].ToString() ?? "", out var _)) // [!code ++]
			{ // [!code ++]
				return text.Substring(2); // [!code ++]
			} // [!code ++]
			break; // [!code ++]
		} // [!code ++]
		case '^': // [!code ++]
		case '|': // [!code ++]
			return text.Substring(1); // [!code ++]
		} // [!code ++]
		return text; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public string ApplyNewLine(string text)
	{
		if (text.Contains("&"))
```

## Chara

[`public string TalkTopic(string topic = "calm")`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/Chara.cs#L7013-L7019)
```cs:line-numbers=7013
	topicText = ApplyTone(topicText);
	topicText = topicText.Replace("~", "*");
	Msg.SetColor(flag2 ? Msg.colors.Thinking : (flag3 ? Msg.colors.Talk : Msg.colors.Ono));
	Msg.Say(topicText.Replace("&", "")); // [!code --]
	Msg.Say(StripTalkSpeiclaCharacters(topicText.Replace("&", ""))); // [!code ++]
	if (topic == "dead")
	{
		EClass.ui.popGame.PopText(ApplyNewLine(topicText.StripBrackets()), null, "PopTextDead", default(Color), pos.Position() + EClass.setting.render.tc.textPosDead);
```

[`public void TryTakeSharedItems(IEnumerable<Thing> containers, bool msg = true, b`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/Chara.cs#L7444-L7450)
```cs:line-numbers=7444
		}
		foreach (Thing thing4 in container.things)
		{
			if (!thing4.c_isImportant && thing4.IsIdentified) // [!code --]
			if (!thing4.c_isImportant && thing4.IsIdentified && thing4 != EClass.pc.held) // [!code ++]
			{
				if (num4 > 0 && thing4.id == "polish_powder")
				{
```

## TCText

[``](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/TCText.cs#L4-L10)
```cs:line-numbers=4

public class TCText : TCUI
{
	public static string[] popIDs = new string[2] { "PopTextSys", "PopTextGod" }; // [!code --]
	public static string[] popIDs = new string[4] { "PopTextSys", "PopTextGod", "PopTextASMR", "PopTextOPA" }; // [!code ++]

	public PopManager pop;

```

[`public void Say(string s, float duration = 0f)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/TCText.cs#L28-L33)
```cs:line-numbers=28
	{
		int num = int.Parse(s[1].ToString());
		p = pop.PopText(s.Substring(2), null, popIDs[num], default(Color), default(Vector3), duration);
		if (num == 3) // [!code ++]
		{ // [!code ++]
			Shaker.ShakeCam("opa"); // [!code ++]
		} // [!code ++]
		break;
	}
	case '^':
```

## TraitASMR

[`using UnityEngine;`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/TraitASMR.cs#L1-L5)
```cs:line-numbers=1
using UnityEngine; // [!code --]
 // [!code --]
public class TraitASMR : Trait
{
	public int tick;
```

[`public class TraitASMR : Trait`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/TraitASMR.cs#L8-L14)
```cs:line-numbers=8

	public override void OnCreate(int lv)
	{
		owner.c_idRefCard = GetParam(1) ?? ((EClass.rnd(EClass.debug.enable ? 2 : 10) == 0) ? "opatos" : ((EClass.rnd(2) == 0) ? "jure" : "")); // [!code --]
		ExcelData.Sheet dialogSheet = Lang.GetDialogSheet("asmr"); // [!code ++]
		owner.c_idRefCard = GetParam(1) ?? ((EClass.rnd(EClass.debug.enable ? 2 : 10) != 0) ? "jure" : dialogSheet.map.RandomItem()["id"]); // [!code ++]
	}

	public override void OnImportMap()
```

[`public override void Update()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/e3cb6ecd16053c79475129f80e2527238867617f/Elin/TraitASMR.cs#L28-L34)
```cs:line-numbers=28
	tick++;
	if (tick % 5 == 0)
	{
		Debug.Log(owner.c_idRefCard); // [!code --]
		string[] dialog = Lang.GetDialog("asmr", owner.c_idRefCard.IsEmpty("eyth"));
		if (dialog.IsEmpty())
		{
```

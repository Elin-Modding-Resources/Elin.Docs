---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 11 files modified.
version: EA 23.230 Nightly
changes: ActPlan/Card/ConChampagne/ConTransmute/GameDate/RenderRow/TaskHarvest/Thing/Trait/TraitLumiestCrimAle/Zone
---

# EA 23.230 Nightly

November 3, 2025

11 files modified.

## Important Changes

**None.**
## ActPlan

[`public void _Update(PointTarget target)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/ActPlan.cs#L576-L582)
```cs:line-numbers=576
						List<Chara> list2 = new List<Chara>();
						foreach (Chara chara in EClass._map.charas)
						{
							if (chara.IsPCPartyMinion && !chara.IsEscorted()) // [!code --]
							if (chara.IsPCFactionMinion && !chara.IsEscorted()) // [!code ++]
							{
								list2.Add(chara);
							}
```

## Card

[`public void SpawnLoot(Card origin)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/Card.cs#L5180-L5185)
```cs:line-numbers=5180
		{
			switch (id)
			{
			case "pumpkin": // [!code ++]
				if (chance(3)) // [!code ++]
				{ // [!code ++]
					list.Add(ThingGen.CreateFromCategory((EClass.rnd(2) == 0) ? "meal_cookie" : "meal_cake", 5 + EClass.rnd(EClass.rnd(50) + 1))); // [!code ++]
				} // [!code ++]
				break; // [!code ++]
			case "isca":
				list.Add(ThingGen.Create("blood_angel"));
				break;
```

[`public virtual void SetImage(Image image)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/Card.cs#L5996-L6006)
```cs:line-numbers=5996
		if (trait is TraitAbility)
		{
			(trait as TraitAbility).act.SetImage(image);
			return; // [!code ++]
		}
		else // [!code --]
		Sprite sprite = GetSprite(); // [!code ++]
		if (!c_idSpriteReplacer.IsEmpty()) // [!code ++]
		{
			sourceRenderCard.SetImage(image, GetSprite(), colorInt, setNativeSize: true, 0, 0, this); // [!code --]
			SpriteReplacer spriteReplacer = SpriteReplacer.dictSkins.TryGetValue(c_idSpriteReplacer); // [!code ++]
			if (spriteReplacer != null) // [!code ++]
			{ // [!code ++]
				RenderData renderData = ResourceCache.Load<RenderData>("Scene/Render/Data/chara_custom_" + ((spriteReplacer.data.GetSprite().texture.height <= 128) ? "128" : "256")); // [!code ++]
				sprite = spriteReplacer.data.GetSprite(); // [!code ++]
				sourceRenderCard.SetImage(image, sprite, colorInt, setNativeSize: true, 0, 0, renderData, spriteReplacer.data.pref ?? Pref); // [!code ++]
				return; // [!code ++]
			} // [!code ++]
		}
		sourceRenderCard.SetImage(image, sprite, colorInt, setNativeSize: true, 0, 0, this); // [!code ++]
	}

	public void ShowEmo(Emo _emo = Emo.none, float duration = 0f, bool skipSame = true)
```

## ConChampagne

[`public override void Tick()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/ConChampagne.cs#L14-L26)
```cs:line-numbers=14
		count += 15;
		owner.Talk("champagne");
		int num = Mathf.Max(EClass.curve(owner.CHA * 10, 400, 100), 100);
		if (EClass._zone.IsUserZone && !owner.IsPCFactionOrMinion && num > 500) // [!code --]
		if (!owner.IsPCFactionOrMinion && num > 500) // [!code ++]
		{
			num = 500;
		}
		foreach (Chara chara in EClass._map.charas)
		{
			if (chara != owner && chara.IsNeutralOrAbove() && owner.Dist(chara) <= 10) // [!code --]
			if (chara != owner && !chara.IsHostile(owner) && owner.Dist(chara) <= 10) // [!code ++]
			{
				chara.AddCondition<ConHero>(num);
				chara.AddCondition<ConEuphoric>(num);
```

## ConTransmute

[`public override void Tick()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/ConTransmute.cs#L13-L22)
```cs:line-numbers=13
	public override void OnStart()
	{
		owner._CreateRenderer();
		if (owner.IsPCParty) // [!code ++]
		{ // [!code ++]
			WidgetRoster.SetDirty(); // [!code ++]
		} // [!code ++]
	}

	public override void OnRemoved()
	{
		owner._CreateRenderer();
		if (owner.IsPCParty) // [!code ++]
		{ // [!code ++]
			WidgetRoster.SetDirty(); // [!code ++]
		} // [!code ++]
	}
}
```

## GameDate

[`public void AdvanceDay()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/GameDate.cs#L209-L215)
```cs:line-numbers=209
			EClass.world.SendPackage(p);
		}
	}
	if (base.day == 30 && base.month == 10 && (EClass.game.quests.IsStarted<QuestDebt>() || EClass.debug.enable)) // [!code --]
	if (base.day == 1 && base.month == 11 && (EClass.game.quests.IsStarted<QuestDebt>() || EClass.debug.enable)) // [!code ++]
	{
		Thing thing2 = ThingGen.Create("parchment");
		thing2.SetStr(53, "letter_crimale");
```

## RenderRow

[`public virtual SourcePref GetPref()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/RenderRow.cs#L349-L354)
```cs:line-numbers=349
	}

	public void SetImage(Image image, Sprite sprite = null, int matCol = 0, bool setNativeSize = true, int dir = 0, int idSkin = 0, Card card = null)
	{ // [!code ++]
		bool num = card != null && card.isChara && card.Chara.spriteReplacer != null && !card.HasHost; // [!code ++]
		SourcePref sourcePref = ((card != null) ? card.Pref : GetPref()); // [!code ++]
		RenderData renderData = (num ? card.renderer.data : this.renderData); // [!code ++]
		SetImage(image, sprite, matCol, setNativeSize, dir, idSkin, renderData, sourcePref); // [!code ++]
	} // [!code ++]
 // [!code ++]
	public void SetImage(Image image, Sprite sprite, int matCol, bool setNativeSize, int dir, int idSkin, RenderData _renderData, SourcePref _pref) // [!code ++]
	{
		image.sprite = sprite ?? GetSprite(dir, idSkin);
		int num = ((matCol == 0) ? 104025 : matCol);
```

[`public void SetImage(Image image, Sprite sprite = null, int matCol = 0, bool set`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/RenderRow.cs#L357-L376)
```cs:line-numbers=357
	color.a = 1f;
	image.color = color;
	RectTransform rectTransform = image.Rect();
	bool num3 = card != null && card.isChara && card.Chara.spriteReplacer != null && !card.HasHost; // [!code --]
	SourcePref sourcePref = ((card != null) ? card.Pref : GetPref()); // [!code --]
	RenderData renderData = (num3 ? card.renderer.data : this.renderData); // [!code --]
	rectTransform.pivot = renderData.imagePivot - new Vector2(0.01f * (float)sourcePref.pivotX, 0.01f * (float)sourcePref.pivotY); // [!code --]
	rectTransform.pivot = _renderData.imagePivot - new Vector2(0.01f * (float)_pref.pivotX, 0.01f * (float)_pref.pivotY); // [!code ++]
	float x = Mathf.Abs(image.transform.localScale.x) * (float)((_tiles == null || _tiles.Length == 0 || _tiles[dir % _tiles.Length] >= 0) ? 1 : (-1));
	float y = image.transform.localScale.y;
	image.transform.localScale = new Vector3(x, y, image.transform.localScale.z);
	sourcePref.Validate(); // [!code --]
	_pref.Validate(); // [!code ++]
	if (setNativeSize)
	{
		image.SetNativeSize();
		if (renderData.imageScale.x != 1f || renderData.imageScale.y != 1f || sourcePref.scaleIcon != 0) // [!code --]
		if (_renderData.imageScale.x != 1f || _renderData.imageScale.y != 1f || _pref.scaleIcon != 0) // [!code ++]
		{
			rectTransform.sizeDelta = new Vector2(rectTransform.sizeDelta.x * (renderData.imageScale.x + (float)sourcePref.scaleIcon * 0.01f), rectTransform.sizeDelta.y * (renderData.imageScale.y + (float)sourcePref.scaleIcon * 0.01f)); // [!code --]
			rectTransform.sizeDelta = new Vector2(rectTransform.sizeDelta.x * (_renderData.imageScale.x + (float)_pref.scaleIcon * 0.01f), rectTransform.sizeDelta.y * (_renderData.imageScale.y + (float)_pref.scaleIcon * 0.01f)); // [!code ++]
		}
	}
}
```

## TaskHarvest

[`public bool HaveHarvestThing()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/TaskHarvest.cs#L565-L570)
```cs:line-numbers=565
public void HarvestThing()
{
	string text = GetIdDismantled();
	if (target.id == "934" || target.id == "1002") // [!code ++]
	{ // [!code ++]
		Rand.SetSeed(target.uid); // [!code ++]
		text = ThingGen.CreateFromCategory((EClass.rnd(2) == 0) ? "meal_cookie" : "meal_cake", 5 + EClass.rnd(EClass.rnd(50) + 1)).id; // [!code ++]
		Rand.SetSeed(); // [!code ++]
	} // [!code ++]
	float num = target.Num;
	float num2 = 1.0999999f;
	if (target.trait.CraftNum > 1)
```

## Thing

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/Thing.cs#L1273-L1281)
```cs:line-numbers=1273
				{
					return false;
				}
				if (e.source.categorySub == "eleAttack" && !base.IsWeapon && !base.IsRangedWeapon && !base.IsAmmo && !base.IsThrownWeapon && !(trait is TraitToolMusic)) // [!code --]
				if (!e.IsGlobalElement) // [!code ++]
				{
					return false; // [!code --]
					if (e.source.tag.Contains("weaponEnc") && !base.IsWeapon && !base.IsRangedWeapon && !base.IsAmmo && !base.IsThrownWeapon && !(trait is TraitToolMusic)) // [!code ++]
					{ // [!code ++]
						return false; // [!code ++]
					} // [!code ++]
					if (e.source.IsWeaponEnc && !base.category.IsChildOf("shield") && !base.IsWeapon && !base.IsRangedWeapon && !base.IsAmmo && !base.IsThrownWeapon && !(trait is TraitToolMusic)) // [!code ++]
					{ // [!code ++]
						return false; // [!code ++]
					} // [!code ++]
				}
				return (!showEQStats || (e.id != 64 && e.id != 65 && e.id != 66 && e.id != 67)) ? true : false;
			}, null, ElementContainer.NoteMode.Default, addRaceFeat: false, delegate(Element e, string s)
```

## Trait

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/Trait.cs#L1770-L1775)
```cs:line-numbers=1770
				Add("714", 1, 0);
				Add("1017", 1, 0);
				Add("1155", 1, 0);
				Add("1287", 1, 0); // [!code ++]
				Add("1288", 1, 0); // [!code ++]
				Add("1289", 1, 0); // [!code ++]
				Add("1290", 1, 0); // [!code ++]
				Add("1011", 1, 0);
				AddThing(ThingGen.CreatePerfume(9500, 5));
				AddThing(ThingGen.CreatePerfume(9501, 5));
```

## TraitLumiestCrimAle

[`public class TraitLumiestCrimAle : TraitFoodMeal`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/TraitLumiestCrimAle.cs#L1-L4)
```cs:line-numbers=1
public class TraitLumiestCrimAle : TraitFoodMeal // [!code --]
public class TraitLumiestCrimAle : TraitFoodPrepared // [!code ++]
{
	public override bool CanBeHeldAsFurniture => true;

```

## Zone

[`public void Simulate()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/ddfdbaf15b7d873c06416584c2db6ce792213d37/Elin/Zone.cs#L1201-L1207)
```cs:line-numbers=1201
			{
				Msg.ignoreAll = true;
				chara2.Cure(CureType.Boss, 20 + num * 10);
				chara2.HealHP(Mathf.Max(1, chara2.MaxHP) * Mathf.Min(num, 20) / 20); // [!code --]
				chara2.HealHP((int)((long)Mathf.Max(1, chara2.MaxHP) * (long)Mathf.Min(num, 20) / 20)); // [!code ++]
				chara2.mana.Mod(Mathf.Max(1, chara2.mana.max) * Mathf.Min(num, 20) / 20);
				chara2.stamina.Mod(Mathf.Max(1, chara2.stamina.max) * Mathf.Min(num, 20) / 20);
				Msg.ignoreAll = false;
```

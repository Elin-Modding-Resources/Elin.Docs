---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 35 files modified. 2 new files created.
version: EA 23.77 Nightly
changes: ABILITY/+AI_Craft/+AI_Craft_Snowman/AI_Idle/AI_Slaughter/ActEffect/ActMelee/ActPlan/Card/Chara/DOMAIN/DramaOutcome/ELEMENT/ENC/FACTION/FEAT/FOOD/FactionBranch/GameDate/LayerLoadGame/LayerSkinDeco/MUTATION/Map/POLICY/SKILL/SLOT/SPELL/SourceElement/SourceManager/TraitChara/TraitManager/TraitMannequin/TraitMap/TraitNote/TraitSet/TraitToolButcher/VirtualDate
---

# EA 23.77 Nightly

January 16, 2025

35 files modified. 2 new files created.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [ELEMENT (1)](#element)
```cs:no-line-numbers
public static int GetResistDamage(int dmg, int v) // [!code --]
public static int GetResistDamage(int dmg, int v, int power = 0) // [!code ++]
```
### [TraitMap (5)](#traitmap)
```cs:no-line-numbers
public void Add(Card c) // [!code --]

```
```cs:no-line-numbers
public void Remove(Card c) // [!code --]

```
```cs:no-line-numbers
public Card GetRandom() // [!code --]

```
```cs:no-line-numbers
public Card GetRandom(Func<Trait, bool> func) // [!code --]

```
```cs:no-line-numbers
public bool Contains(Card c) // [!code --]

```
### [TraitSet (3)](#traitset)
```cs:no-line-numbers
public void Add(Card c) // [!code --]

```
```cs:no-line-numbers
public void Remove(Card c) // [!code --]

```
```cs:no-line-numbers
public bool Contains(Card c) // [!code --]

```
## ABILITY

[`@@ -4,8 +4,6 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ABILITY.cs#L4-L11)
```cs:line-numbers=4
{
	public const int AI_Drink = 5045;

	public const int TaskMoveInstalled = 5036; // [!code --]
 // [!code --]
	public const int ActNoItem = 5037;

	public const int ActThrow = 5038;
```

[`@@ -32,11 +30,11 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ABILITY.cs#L32-L42)
```cs:line-numbers=32

	public const int AI_Sleep = 5050;

	public const int TaskBuild = 5035; // [!code --]
 // [!code --]
	public const int ActZap = 5051;

	public const int TaskHarvest = 5053; // [!code --]
	public const int TaskMoveInstalled = 5036; // [!code ++]
 // [!code ++]
	public const int ActBash = 5052; // [!code ++]

	public const int AI_Bladder = 5054;

```

[`@@ -64,15 +62,15 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ABILITY.cs#L64-L78)
```cs:line-numbers=64

	public const int ActEscape = 6400;

	public const int ActBash = 5052; // [!code --]
 // [!code --]
	public const int ActSuicide = 6410;

	public const int GoalIdle = 5034; // [!code --]
	public const int TaskHarvest = 5053; // [!code ++]

	public const int AI_Equip = 5032; // [!code --]
	public const int ActDuplicate = 6420; // [!code ++]

	public const int Melee = 5002; // [!code --]
	public const int TaskBuild = 5035; // [!code ++]
 // [!code ++]
	public const int ActCancelTask = 5033; // [!code ++]

	public const int Ranged = 5003;

```

[`@@ -100,11 +98,11 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ABILITY.cs#L100-L110)
```cs:line-numbers=100

	public const int TaskAttack = 5015;

	public const int ActCancelTask = 5033; // [!code --]
 // [!code --]
	public const int TaskTame = 5016;

	public const int TaskPick = 5018; // [!code --]
	public const int GoalIdle = 5034; // [!code ++]
 // [!code ++]
	public const int TaskTalk = 5017; // [!code ++]

	public const int TaskReadBoard = 5019;

```

[`@@ -132,17 +130,15 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ABILITY.cs#L132-L148)
```cs:line-numbers=132

	public const int AI_Deconstruct = 5031;

	public const int TaskTalk = 5017; // [!code --]
 // [!code --]
	public const int ActRush = 6450; // [!code --]
	public const int AI_Equip = 5032; // [!code ++]

	public const int ActDuplicate = 6420; // [!code --]
	public const int TaskPick = 5018; // [!code ++]

	public const int breathe_Darkness = 50203; // [!code --]
	public const int ActCrabBreathe = 6500; // [!code ++]

	public const int ActJureHeal = 6901; // [!code --]
	public const int ActRush = 6450; // [!code ++]

	public const int ActLulwyTrick = 6902; // [!code --]
	public const int breathe_Mind = 50204; // [!code ++]

	public const int ActKizuamiTrick = 6903;

```

[`@@ -156,11 +152,11 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ABILITY.cs#L156-L166)
```cs:line-numbers=156

	public const int breathe_Lightning = 50202;

	public const int ActCrabBreathe = 6500; // [!code --]
	public const int breathe_Darkness = 50203; // [!code ++]

	public const int StManaCost = 6720; // [!code --]
	public const int ActCurse = 6600; // [!code ++]

	public const int breathe_Mind = 50204; // [!code --]
	public const int breathe_Poison = 50205; // [!code ++]

	public const int breathe_Nether = 50206;

```

[`@@ -180,21 +176,19 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ABILITY.cs#L180-L200)
```cs:line-numbers=180

	public const int breathe_Cut = 50214;

	public const int breathe_Poison = 50205; // [!code --]
 // [!code --]
	public const int ActWait = 5000; // [!code --]
	public const int breathe_Impact = 50215; // [!code ++]

	public const int ActManaAbsorb = 6900; // [!code --]
	public const int ActMelee = 5001; // [!code ++]

	public const int ActThrowPotion = 6661; // [!code --]
	public const int ActWait = 5000; // [!code ++]

	public const int ActCurse = 6600; // [!code --]
	public const int ActLulwyTrick = 6902; // [!code ++]

	public const int ActEntangle = 6601; // [!code --]
	public const int Melee = 5002; // [!code ++]

	public const int ActDraw = 6602; // [!code --]
	public const int ActJureHeal = 6901; // [!code ++]

	public const int ActMelee = 5001; // [!code --]
	public const int ActGazeMutation = 6622; // [!code ++]

	public const int ActNTR = 6603;

```

[`@@ -204,17 +198,17 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ABILITY.cs#L204-L220)
```cs:line-numbers=204

	public const int ActTouchSleep = 6612;

	public const int StTaunt = 6700; // [!code --]
	public const int ActGazeDim = 6620; // [!code ++]

	public const int ActGazeInsane = 6621;

	public const int ActGazeDim = 6620; // [!code --]
	public const int ActManaAbsorb = 6900; // [!code ++]

	public const int ActGazeMana = 6623;

	public const int ActDrainBlood = 6626; // [!code --]
	public const int ActDraw = 6602; // [!code ++]

	public const int ActInsult = 6630; // [!code --]
	public const int ActDrainBlood = 6626; // [!code ++]

	public const int ActScream = 6631;

```

[`@@ -228,22 +222,30 @@ public class ABILITY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ABILITY.cs#L228-L249)
```cs:line-numbers=228

	public const int ActDropMine = 6660;

	public const int ActGazeMutation = 6622; // [!code --]
	public const int ActThrowPotion = 6661; // [!code ++]
 // [!code ++]
	public const int StTaunt = 6700; // [!code ++]
 // [!code ++]
	public const int StManaCost = 6720; // [!code ++]
 // [!code ++]
	public const int ActInsult = 6630; // [!code ++]
 // [!code ++]
	public const int ActEntangle = 6601; // [!code ++]

	public static readonly int[] IDS = new int[114] // [!code --]
	public static readonly int[] IDS = new int[115] // [!code ++]
	{
		5045, 5036, 5037, 5038, 5039, 5040, 5041, 5042, 5043, 5044, // [!code --]
		5046, 5047, 5048, 5049, 5050, 5035, 5051, 5053, 5054, 5055, // [!code --]
		6001, 6003, 6011, 6012, 6013, 6015, 6018, 6019, 6020, 6050, // [!code --]
		6400, 5052, 6410, 5034, 5032, 5002, 5003, 5004, 5005, 5006, // [!code --]
		5007, 5008, 5009, 5010, 5011, 5012, 5013, 5014, 5015, 5033, // [!code --]
		5016, 5018, 5019, 5020, 5021, 5022, 5023, 5024, 5025, 5026, // [!code --]
		5027, 5028, 5029, 5030, 5031, 5017, 6450, 6420, 50203, 6901, // [!code --]
		6902, 6903, 6904, 7000, 50200, 50201, 50202, 6500, 6720, 50204, // [!code --]
		50206, 50207, 50208, 50209, 50210, 50211, 50212, 50213, 50214, 50205, // [!code --]
		5000, 6900, 6661, 6600, 6601, 6602, 5001, 6603, 6610, 6611, // [!code --]
		6612, 6700, 6621, 6620, 6623, 6626, 6630, 6631, 6640, 6641, // [!code --]
		6642, 6650, 6660, 6622 // [!code --]
		5045, 5037, 5038, 5039, 5040, 5041, 5042, 5043, 5044, 5046, // [!code ++]
		5047, 5048, 5049, 5050, 5051, 5036, 5052, 5054, 5055, 6001, // [!code ++]
		6003, 6011, 6012, 6013, 6015, 6018, 6019, 6020, 6050, 6400, // [!code ++]
		6410, 5053, 6420, 5035, 5033, 5003, 5004, 5005, 5006, 5007, // [!code ++]
		5008, 5009, 5010, 5011, 5012, 5013, 5014, 5015, 5016, 5034, // [!code ++]
		5017, 5019, 5020, 5021, 5022, 5023, 5024, 5025, 5026, 5027, // [!code ++]
		5028, 5029, 5030, 5031, 5032, 5018, 6500, 6450, 50204, 6903, // [!code ++]
		6904, 7000, 50200, 50201, 50202, 50203, 6600, 50205, 50206, 50207, // [!code ++]
		50208, 50209, 50210, 50211, 50212, 50213, 50214, 50215, 5001, 5000, // [!code ++]
		6902, 5002, 6901, 6622, 6603, 6610, 6611, 6612, 6620, 6621, // [!code ++]
		6900, 6623, 6602, 6626, 6631, 6640, 6641, 6642, 6650, 6660, // [!code ++]
		6661, 6700, 6720, 6630, 6601 // [!code ++]
	};
}
public class Ability : Act
```

## +AI_Craft

::: details File Created
```cs
public class AI_Craft : AIAct
{
	public Point pos;
}
```

:::
## +AI_Craft_Snowman

::: details File Created
```cs
using System.Collections.Generic;

public class AI_Craft_Snowman : AI_Craft
{
	public override IEnumerable<Status> Run()
	{
		yield return DoGoto(pos, 1);
		Progress_Custom seq = new Progress_Custom
		{
			onProgress = delegate
			{
				owner.LookAt(pos);
				Msg.SetColor(Msg.colors.Ono);
				Msg.Say(Lang.GetList("walk_snow").RandomItem());
				pos.PlaySound(MATERIAL.sourceSnow.soundFoot);
			},
			onProgressComplete = delegate
			{
				Thing thing = ThingGen.Create("snowman");
				EClass._zone.AddCard(thing, pos).Install();
				owner.Say("crafted", thing);
				owner.PlaySound(MATERIAL.sourceSnow.GetSoundDead());
				owner.PlayAnime(AnimeID.Jump);
				pos.TalkWitnesses(EClass.pc, (EClass.rnd(2) == 0) ? "nice_statue" : "ding_other", 5);
				EClass.pc.ModExp(258, 50);
			}
		}.SetDuration(25, 5);
		yield return Do(seq);
	}
}
```

:::
## AI_Idle

[`@@ -626,10 +626,10 @@ public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/AI_Idle.cs#L626-L635)
```cs:line-numbers=626
		{
			owner.pos.ForeachNeighbor(delegate(Point p)
			{
				Card card = p.FindThing<TraitBall>()?.owner; // [!code --]
				if (card != null) // [!code --]
				Card card2 = p.FindThing<TraitBall>()?.owner; // [!code ++]
				if (card2 != null) // [!code ++]
				{
					owner.Pick(card.Thing); // [!code --]
					owner.Pick(card2.Thing); // [!code ++]
				}
			});
		}
```

[`@@ -755,10 +755,10 @@ public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/AI_Idle.cs#L755-L764)
```cs:line-numbers=755
	{
		if (owner.id == "ashland" || owner.id == "fiama")
		{
			Trait trait = EClass._map.Installed.traits.restSpots.RandomItem(); // [!code --]
			if (trait != null) // [!code --]
			Card card = EClass._map.Installed.traits.restSpots.RandomItem(); // [!code ++]
			if (card != null) // [!code ++]
			{
				yield return DoGotoSpot(trait.owner); // [!code --]
				yield return DoGotoSpot(card); // [!code ++]
			}
			else
			{
```

## AI_Slaughter

[`@@ -31,7 +31,10 @@ public override bool Perform()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/AI_Slaughter.cs#L31-L37)
```cs:line-numbers=31
public override IEnumerable<Status> Run()
{
	yield return DoGoto(target);
	target.Chara.AddCondition<ConWait>(1000, force: true); // [!code --]
	if (target != owner) // [!code ++]
	{ // [!code ++]
		target.Chara.AddCondition<ConWait>(1000, force: true); // [!code ++]
	} // [!code ++]
	Progress_Custom seq = new Progress_Custom
	{
		canProgress = () => IsValidTC(target),
```

[`@@ -45,7 +48,10 @@ public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/AI_Slaughter.cs#L45-L51)
```cs:line-numbers=45
		{
			owner.LookAt(target);
			target.renderer.PlayAnime(AnimeID.Shiver);
			target.Chara.AddCondition<ConWait>(1000, force: true); // [!code --]
			if (target != owner) // [!code ++]
			{ // [!code ++]
				target.Chara.AddCondition<ConWait>(1000, force: true); // [!code ++]
			} // [!code ++]
			if (owner.Dist(target) > 1)
			{
				owner.TryMoveTowards(target.pos);
```

[`@@ -74,19 +80,36 @@ public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/AI_Slaughter.cs#L74-L92)
```cs:line-numbers=74
			}
			slaughtering = true;
			target.SetSale(sale: false);
			if (target.IsPCParty && !target.IsPC) // [!code ++]
			{ // [!code ++]
				if (target.Chara.host != null) // [!code ++]
				{ // [!code ++]
					ActRide.Unride(target.Chara.host, target.Chara.host.parasite == target.Chara, talk: false); // [!code ++]
				} // [!code ++]
				EClass.pc.party.RemoveMember(target.Chara); // [!code ++]
			} // [!code ++]
			target.Die();
			Msg.Say("goto_heaven", target);
			slaughtering = false;
			if (target.Chara.trait.IsUnique) // [!code --]
			if (!target.IsPC) // [!code ++]
			{ // [!code ++]
				if (target.Chara.trait.IsUnique) // [!code ++]
				{ // [!code ++]
					target.c_dateDeathLock = EClass.world.date.GetRaw() + 86400; // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					target.Chara.homeBranch.BanishMember(target.Chara, skipMsg: true); // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (owner != null) // [!code ++]
			{
				target.c_dateDeathLock = EClass.world.date.GetRaw() + 86400; // [!code --]
				owner.elements.ModExp(290, 200); // [!code ++]
			}
			else // [!code --]
			if (!EClass.pc.isDead) // [!code ++]
			{
				target.Chara.homeBranch.BanishMember(target.Chara, skipMsg: true); // [!code --]
				EClass.pc.stamina.Mod(-3); // [!code ++]
			}
			owner.elements.ModExp(290, 200); // [!code --]
			EClass.pc.stamina.Mod(-3); // [!code --]
			if (num)
			{
				Msg.Say("killcat");
```

## ActEffect

[`@@ -482,7 +482,7 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ActEffect.cs#L482-L488)
```cs:line-numbers=482
	case EffectId.Summon:
	{
		CC.Say("summon_ally", CC);
		if (EClass._zone.CountMinions(CC) > CC.MaxSummon || CC.c_uidMaster != 0) // [!code --]
		if (EClass._zone.CountMinions(CC) >= CC.MaxSummon || CC.c_uidMaster != 0) // [!code ++]
		{
			CC.Say("summon_ally_fail", CC);
			return;
```

[`@@ -515,7 +515,7 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ActEffect.cs#L515-L521)
```cs:line-numbers=515
		}
		for (int j = 0; j < num3; j++)
		{
			if (EClass._zone.CountMinions(CC) > CC.MaxSummon) // [!code --]
			if (EClass._zone.CountMinions(CC) >= CC.MaxSummon) // [!code ++]
			{
				break;
			}
```

## ActMelee

[`@@ -1,4 +1,5 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ActMelee.cs#L1-L4)
```cs:line-numbers=1
using System.Collections.Generic;
using UnityEngine; // [!code ++]

public class ActMelee : ActBaseAttack
{
```

[`@@ -119,7 +120,7 @@ public bool Attack(float dmgMulti = 1f, bool maxRoll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ActMelee.cs#L119-L125)
```cs:line-numbers=119
	bool usedTalisman = false;
	int count = 0;
	int num = Act.CC.Dist(Act.TC);
	Point obj = Act.TC.pos.Copy(); // [!code --]
	Point orgPos = Act.TC.pos.Copy(); // [!code ++]
	foreach (BodySlot slot in Act.CC.body.slots)
	{
		if (Act.TC == null || !Act.TC.IsAliveInCurrentZone)
```

[`@@ -141,33 +142,73 @@ public bool Attack(float dmgMulti = 1f, bool maxRoll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ActMelee.cs#L141-L173)
```cs:line-numbers=141
			ActRanged.TryReload(w);
		}
		int num2 = ((w != null) ? w.Evalue(606) : 0);
		if (w != null) // [!code --]
		int scatter = ((w != null) ? w.Evalue(607) : 0); // [!code ++]
		int chaser = ((w != null) ? w.Evalue(620) : 0); // [!code ++]
		if (Act.CC.IsPCFaction) // [!code ++]
		{
			w.Evalue(607); // [!code --]
			chaser += EClass.pc.faction.charaElements.Value(620); // [!code ++]
		}
		List<Point> list = EClass._map.ListPointsInLine(Act.CC.pos, Act.TC.pos, num2 / 10 + ((num2 % 10 > EClass.rnd(10)) ? 1 : 0) + 1);
		Attack(Act.TC, Act.TP); // [!code --]
		Attack(Act.TC, Act.TP, 1f); // [!code ++]
		if (num2 > 0)
		{
			foreach (Point item in list)
			{
				if (!item.Equals(obj)) // [!code --]
				if (!item.Equals(orgPos)) // [!code ++]
				{
					Chara firstChara = item.FirstChara;
					if (firstChara != null && firstChara.IsHostile(Act.CC))
					{
						Attack(firstChara, item); // [!code --]
						Attack(firstChara, item, 1f); // [!code ++]
					}
				}
			}
		}
		count++; // [!code --]
		void Attack(Card _tc, Point _tp) // [!code --]
		else if (scatter > 0) // [!code ++]
		{ // [!code ++]
			Act.TP.ForeachNeighbor(delegate(Point p) // [!code ++]
			{ // [!code ++]
				if (!p.Equals(orgPos)) // [!code ++]
				{ // [!code ++]
					Chara firstChara2 = p.FirstChara; // [!code ++]
					if (firstChara2 != null && firstChara2.IsHostile(Act.CC)) // [!code ++]
					{ // [!code ++]
						Attack(firstChara2, p, Mathf.Min(0.5f + 0.05f * Mathf.Sqrt(scatter), 1f + 0.01f * Mathf.Sqrt(scatter))); // [!code ++]
					} // [!code ++]
				} // [!code ++]
			}); // [!code ++]
		} // [!code ++]
		int num3 = count; // [!code ++]
		count = num3 + 1; // [!code ++]
		void Attack(Card _tc, Point _tp, float mtp) // [!code ++]
		{
			Act.TC = _tc;
			Act.TP = _tp;
			AttackProcess.Current.Prepare(Act.CC, w, Act.TC, Act.TP, count);
			bool flag2 = AttackProcess.Current.Perform(count, hasHit, dmgMulti, maxRoll); // [!code --]
			int num4 = 1; // [!code ++]
			if (chaser > 0) // [!code ++]
			{ // [!code ++]
				for (int i = 0; i < 10; i++) // [!code ++]
				{ // [!code ++]
					if (chaser > EClass.rnd((int)Mathf.Pow(4f, i + 2))) // [!code ++]
					{ // [!code ++]
						num4++; // [!code ++]
					} // [!code ++]
				} // [!code ++]
			} // [!code ++]
			bool flag2 = false; // [!code ++]
			for (int j = 0; j < num4; j++) // [!code ++]
			{ // [!code ++]
				if (j > 0) // [!code ++]
				{ // [!code ++]
					Msg.Say("attack_chaser"); // [!code ++]
				} // [!code ++]
				flag2 = AttackProcess.Current.Perform(count, hasHit, dmgMulti * mtp, maxRoll); // [!code ++]
				if (flag2) // [!code ++]
				{ // [!code ++]
					break; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (flag2)
			{
				hasHit = true;
```

## ActPlan

[`@@ -555,305 +555,314 @@ public void _Update(PointTarget target)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ActPlan.cs#L555-L859)
```cs:line-numbers=555
				}
			}
		});
		if (_pos.IsHidden || !IsSelfOrNeighbor) // [!code --]
		if (_pos.IsHidden) // [!code ++]
		{
			return;
		}
		items.ForeachReverse(delegate(Card _c) // [!code --]
		if (IsSelfOrNeighbor) // [!code ++]
		{
			Chara c = _c.Chara; // [!code --]
			if (c != null) // [!code --]
			items.ForeachReverse(delegate(Card _c) // [!code ++]
			{
				bool flag3 = EClass.pc.CanSee(c); // [!code --]
				if (flag3) // [!code --]
				Chara c = _c.Chara; // [!code ++]
				if (c != null) // [!code ++]
				{
					if (input == ActInput.LeftMouse && c.IsPCFaction && !c.IsPC && pos.FindThing<TraitHitchingPost>() != null) // [!code --]
					bool flag3 = EClass.pc.CanSee(c); // [!code ++]
					if (flag3) // [!code ++]
					{
						Chara ride = c; // [!code --]
						List<string> list = EClass.core.pccs.sets["ride"].map["body"].map.Keys.ToList(); // [!code --]
						int index = list.IndexOf(ride.c_idRidePCC); // [!code --]
						if (index == -1) // [!code --]
						if (input == ActInput.LeftMouse && c.IsPCFaction && !c.IsPC && pos.FindThing<TraitHitchingPost>() != null) // [!code ++]
						{
							index = 0; // [!code --]
							Chara ride = c; // [!code ++]
							List<string> list = EClass.core.pccs.sets["ride"].map["body"].map.Keys.ToList(); // [!code ++]
							int index = list.IndexOf(ride.c_idRidePCC); // [!code ++]
							if (index == -1) // [!code ++]
							{ // [!code ++]
								index = 0; // [!code ++]
							} // [!code ++]
							TrySetAct("ActChangeRideSkin", delegate // [!code ++]
							{ // [!code ++]
								UIContextMenu uIContextMenu = EClass.ui.CreateContextMenuInteraction(); // [!code ++]
								uIContextMenu.AddSlider("rideSkin", (float a) => list[(int)a].Split('-')[0] ?? "", index, delegate(float a) // [!code ++]
								{ // [!code ++]
									ride.c_idRidePCC = list[(int)a]; // [!code ++]
									ride._CreateRenderer(); // [!code ++]
								}, 0f, list.Count - 1, isInt: true, hideOther: false); // [!code ++]
								uIContextMenu.Show(); // [!code ++]
								return false; // [!code ++]
							}, c); // [!code ++]
						}
						TrySetAct("ActChangeRideSkin", delegate // [!code --]
						if (!c.IsPC && ((c.IsPCFaction && !c.IsDisabled) || EClass.debug.enable) && input == ActInput.AllAction) // [!code ++]
						{
							UIContextMenu uIContextMenu = EClass.ui.CreateContextMenuInteraction(); // [!code --]
							uIContextMenu.AddSlider("rideSkin", (float a) => list[(int)a].Split('-')[0] ?? "", index, delegate(float a) // [!code --]
							TrySetAct("actTrade", delegate // [!code ++]
							{
								ride.c_idRidePCC = list[(int)a]; // [!code --]
								ride._CreateRenderer(); // [!code --]
							}, 0f, list.Count - 1, isInt: true, hideOther: false); // [!code --]
							uIContextMenu.Show(); // [!code --]
							return false; // [!code --]
						}, c); // [!code --]
					} // [!code --]
					if (!c.IsPC && ((c.IsPCFaction && !c.IsDisabled) || EClass.debug.enable) && input == ActInput.AllAction) // [!code --]
					{ // [!code --]
						TrySetAct("actTrade", delegate // [!code --]
						{ // [!code --]
							LayerInventory.CreateContainer(c); // [!code --]
							return false; // [!code --]
						}, c); // [!code --]
					} // [!code --]
					if (c.host != null && EClass.pc.held != null && altAction) // [!code --]
					{ // [!code --]
						bool flag4 = true; // [!code --]
						if ((EClass.pc.held.trait is TraitThrown || EClass.pc.held.trait.IsTool) && !HotItemHeld.disableTool) // [!code --]
						{ // [!code --]
							flag4 = false; // [!code --]
								LayerInventory.CreateContainer(c); // [!code ++]
								return false; // [!code ++]
							}, c); // [!code ++]
						}
						if (!c.IsDisabled && flag4 && c.CanAcceptGift(EClass.pc, EClass.pc.held)) // [!code --]
						if (c.host != null && EClass.pc.held != null && altAction) // [!code ++]
						{
							string lang = "actGive"; // [!code --]
							if (c.Evalue(1232) > 0 && EClass.pc.held.trait is TraitDrinkMilkMother) // [!code --]
							bool flag4 = true; // [!code ++]
							if ((EClass.pc.held.trait is TraitThrown || EClass.pc.held.trait.IsTool) && !HotItemHeld.disableTool) // [!code ++]
							{
								lang = "actMilk"; // [!code --]
								flag4 = false; // [!code ++]
							}
							TrySetAct(lang, delegate // [!code --]
							if (!c.IsDisabled && flag4 && c.CanAcceptGift(EClass.pc, EClass.pc.held)) // [!code ++]
							{
								if (!c.IsValidGiftWeight(EClass.pc.held, 1)) // [!code --]
								{ // [!code --]
									c.Talk("tooHeavy"); // [!code --]
									return true; // [!code --]
								} // [!code --]
								if (EClass.core.config.game.confirmGive) // [!code --]
								string lang = "actGive"; // [!code ++]
								if (c.Evalue(1232) > 0 && EClass.pc.held.trait is TraitDrinkMilkMother) // [!code ++]
								{
									Dialog.YesNo("dialogGive".lang(EClass.pc.held.GetName(NameStyle.Full, 1)), func); // [!code --]
									lang = "actMilk"; // [!code ++]
								}
								else // [!code --]
								TrySetAct(lang, delegate // [!code ++]
								{
									func(); // [!code --]
								} // [!code --]
								return true; // [!code --]
							}, c); // [!code --]
									if (!c.IsValidGiftWeight(EClass.pc.held, 1)) // [!code ++]
									{ // [!code ++]
										c.Talk("tooHeavy"); // [!code ++]
										return true; // [!code ++]
									} // [!code ++]
									if (EClass.core.config.game.confirmGive) // [!code ++]
									{ // [!code ++]
										Dialog.YesNo("dialogGive".lang(EClass.pc.held.GetName(NameStyle.Full, 1)), func); // [!code ++]
									} // [!code ++]
									else // [!code ++]
									{ // [!code ++]
										func(); // [!code ++]
									} // [!code ++]
									return true; // [!code ++]
								}, c); // [!code ++]
							} // [!code ++]
						}
					}
				} // [!code --]
				if (input == ActInput.AllAction && EClass.pc.held != null && EClass.pc.held.trait is TraitDrink) // [!code --]
				{ // [!code --]
					TrySetAct(c.IsPC ? "actPour" : "ActThrow", delegate // [!code --]
					{ // [!code --]
						ActThrow.Throw(EClass.pc, c.pos, c, EClass.pc.held.Split(1)); // [!code --]
						return true; // [!code --]
					}, (c.host != null) ? c : EClass.pc.held); // [!code --]
				} // [!code --]
				if (!c.IsPC && c.host == null && ((!EClass.pc.isBlind && flag3) || input != ActInput.AllAction)) // [!code --]
				{ // [!code --]
					if (c.isRestrained && (input == ActInput.AllAction || (!c.IsRestrainedResident && !c.IsHostile()))) // [!code --]
					if (input == ActInput.AllAction && EClass.pc.held != null && EClass.pc.held.trait is TraitDrink) // [!code ++]
					{
						TrySetAct("ActUnrestrain", delegate // [!code --]
						TrySetAct(c.IsPC ? "actPour" : "ActThrow", delegate // [!code ++]
						{
							c.TryUnrestrain(force: true, EClass.pc); // [!code --]
							ActThrow.Throw(EClass.pc, c.pos, c, EClass.pc.held.Split(1)); // [!code ++]
							return true;
						}, c); // [!code --]
						}, (c.host != null) ? c : EClass.pc.held); // [!code ++]
					}
					if (!EClass.pc.isBlind && flag3 && input == ActInput.AllAction) // [!code --]
					if (!c.IsPC && c.host == null && ((!EClass.pc.isBlind && flag3) || input != ActInput.AllAction)) // [!code ++]
					{
						TrySetAct(ACT.Kick, c); // [!code --]
						if (c.IsMofuable) // [!code --]
						if (c.isRestrained && (input == ActInput.AllAction || (!c.IsRestrainedResident && !c.IsHostile()))) // [!code ++]
						{
							TrySetAct("ActCuddle", delegate // [!code --]
							TrySetAct("ActUnrestrain", delegate // [!code ++]
							{
								EClass.pc.Cuddle(c); // [!code --]
								c.TryUnrestrain(force: true, EClass.pc); // [!code ++]
								return true;
							}, c);
						}
						if (EClass.debug.showExtra) // [!code --]
						if (!EClass.pc.isBlind && flag3 && input == ActInput.AllAction) // [!code ++]
						{
							TrySetAct("inspect", delegate // [!code --]
							TrySetAct(ACT.Kick, c); // [!code ++]
							if (c.IsMofuable) // [!code ++]
							{
								c.Inspect(); // [!code --]
								return false; // [!code --]
							}, c); // [!code --]
								TrySetAct("ActCuddle", delegate // [!code ++]
								{ // [!code ++]
									EClass.pc.Cuddle(c); // [!code ++]
									return true; // [!code ++]
								}, c); // [!code ++]
							} // [!code ++]
							if (EClass.debug.showExtra) // [!code ++]
							{ // [!code ++]
								TrySetAct("inspect", delegate // [!code ++]
								{ // [!code ++]
									c.Inspect(); // [!code ++]
									return false; // [!code ++]
								}, c); // [!code ++]
							} // [!code ++]
						}
					}
				}
			} // [!code --]
			else if (_c.isThing) // [!code --]
			{ // [!code --]
				if (!EClass.pc.isBlind) // [!code --]
				else if (_c.isThing) // [!code ++]
				{
					Thing t = _c.Thing; // [!code --]
					if (input == ActInput.AllAction) // [!code --]
					if (!EClass.pc.isBlind) // [!code ++]
					{
						if ((EClass.debug.enable || EClass.player.HasKeyItem("license_illumination")) && t.LightData != null) // [!code --]
						Thing t = _c.Thing; // [!code ++]
						if (input == ActInput.AllAction) // [!code ++]
						{
							if (t.c_lightColor != 0) // [!code --]
							if ((EClass.debug.enable || EClass.player.HasKeyItem("license_illumination")) && t.LightData != null) // [!code ++]
							{
								TrySetAct("actClearLight", delegate // [!code --]
								if (t.c_lightColor != 0) // [!code ++]
								{ // [!code ++]
									TrySetAct("actClearLight", delegate // [!code ++]
									{ // [!code ++]
										t.c_lightColor = 0; // [!code ++]
										t.RecalculateFOV(); // [!code ++]
										t.renderer.GetTC<TCExtra>()?.RefreshColor(); // [!code ++]
										return false; // [!code ++]
									}, t); // [!code ++]
								} // [!code ++]
								TrySetAct("actSetLight", delegate // [!code ++]
								{
									t.c_lightColor = 0; // [!code --]
									t.RecalculateFOV(); // [!code --]
									t.renderer.GetTC<TCExtra>()?.RefreshColor(); // [!code --]
									Color lightColor = t.LightColor; // [!code ++]
									EClass.ui.AddLayer<LayerColorPicker>().SetColor(lightColor, lightColor, delegate(PickerState state, Color _c) // [!code ++]
									{ // [!code ++]
										t.c_lightColor = (byte)Mathf.Clamp(_c.r * 32f, 1f, 31f) * 1024 + (byte)Mathf.Clamp(_c.g * 32f, 1f, 31f) * 32 + (byte)Mathf.Clamp(_c.b * 32f, 1f, 31f); // [!code ++]
										t.RecalculateFOV(); // [!code ++]
										t.renderer.GetTC<TCExtra>()?.RefreshColor(); // [!code ++]
									}); // [!code ++]
									return false;
								}, t);
							}
							TrySetAct("actSetLight", delegate // [!code --]
							{ // [!code --]
								Color lightColor = t.LightColor; // [!code --]
								EClass.ui.AddLayer<LayerColorPicker>().SetColor(lightColor, lightColor, delegate(PickerState state, Color _c) // [!code --]
								{ // [!code --]
									t.c_lightColor = (byte)Mathf.Clamp(_c.r * 32f, 1f, 31f) * 1024 + (byte)Mathf.Clamp(_c.g * 32f, 1f, 31f) * 32 + (byte)Mathf.Clamp(_c.b * 32f, 1f, 31f); // [!code --]
									t.RecalculateFOV(); // [!code --]
									t.renderer.GetTC<TCExtra>()?.RefreshColor(); // [!code --]
								}); // [!code --]
								return false; // [!code --]
							}, t); // [!code --]
						} // [!code --]
						if (EClass.debug.enable && pos.cell.IsTopWater) // [!code --]
						{ // [!code --]
							TrySetAct("(debug) Toggle Float", delegate // [!code --]
							{ // [!code --]
								t.isFloating = !t.isFloating; // [!code --]
								return false; // [!code --]
							}, t); // [!code --]
						} // [!code --]
						if (!EClass._zone.IsUserZone || !t.isNPCProperty) // [!code --]
						{ // [!code --]
							if (t.trait.CanEat(EClass.pc)) // [!code --]
							if (EClass.debug.enable && pos.cell.IsTopWater) // [!code ++]
							{
								TrySetAct(new AI_Eat // [!code --]
								TrySetAct("(debug) Toggle Float", delegate // [!code ++]
								{
									target = t // [!code --]
									t.isFloating = !t.isFloating; // [!code ++]
									return false; // [!code ++]
								}, t);
							}
							if (t.trait.CanDrink(EClass.pc)) // [!code --]
							if (!EClass._zone.IsUserZone || !t.isNPCProperty) // [!code ++]
							{
								TrySetAct(new AI_Drink // [!code --]
								if (t.trait.CanEat(EClass.pc)) // [!code ++]
								{
									target = t // [!code --]
								}, t); // [!code --]
							} // [!code --]
							if (t.trait.CanRead(EClass.pc)) // [!code --]
							{ // [!code --]
								TrySetAct(new AI_Read // [!code --]
									TrySetAct(new AI_Eat // [!code ++]
									{ // [!code ++]
										target = t // [!code ++]
									}, t); // [!code ++]
								} // [!code ++]
								if (t.trait.CanDrink(EClass.pc)) // [!code ++]
								{
									target = t // [!code --]
								}, t); // [!code --]
							} // [!code --]
							if (t.trait.IsBlendBase) // [!code --]
							{ // [!code --]
								TrySetAct("invBlend", delegate // [!code --]
									TrySetAct(new AI_Drink // [!code ++]
									{ // [!code ++]
										target = t // [!code ++]
									}, t); // [!code ++]
								} // [!code ++]
								if (t.trait.CanRead(EClass.pc)) // [!code ++]
								{
									LayerDragGrid.Create(new InvOwnerBlend(t)); // [!code --]
									return true; // [!code --]
								}, t); // [!code --]
							} // [!code --]
							if (t.trait.CanName) // [!code --]
							{ // [!code --]
								TrySetAct("changeName", delegate // [!code --]
									TrySetAct(new AI_Read // [!code ++]
									{ // [!code ++]
										target = t // [!code ++]
									}, t); // [!code ++]
								} // [!code ++]
								if (t.trait.IsBlendBase) // [!code ++]
								{ // [!code ++]
									TrySetAct("invBlend", delegate // [!code ++]
									{ // [!code ++]
										LayerDragGrid.Create(new InvOwnerBlend(t)); // [!code ++]
										return true; // [!code ++]
									}, t); // [!code ++]
								} // [!code ++]
								if (t.trait.CanName) // [!code ++]
								{
									Dialog.InputName("dialogChangeName", t.c_refText.IsEmpty(""), delegate(bool cancel, string text) // [!code --]
									TrySetAct("changeName", delegate // [!code ++]
									{
										if (!cancel) // [!code --]
										Dialog.InputName("dialogChangeName", t.c_refText.IsEmpty(""), delegate(bool cancel, string text) // [!code ++]
										{
											t.c_refText = text; // [!code --]
										} // [!code --]
									}); // [!code --]
									return false; // [!code --]
								}, t); // [!code --]
											if (!cancel) // [!code ++]
											{ // [!code ++]
												t.c_refText = text; // [!code ++]
											} // [!code ++]
										}); // [!code ++]
										return false; // [!code ++]
									}, t); // [!code ++]
								} // [!code ++]
							} // [!code ++]
						} // [!code ++]
						if (isKey) // [!code ++]
						{ // [!code ++]
							_ = t.trait.CanBeAttacked; // [!code ++]
						} // [!code ++]
						else // [!code ++]
						{ // [!code ++]
							if (t.placeState == PlaceState.roaming && (_pos.cell.blocked || t.ignoreAutoPick || altAction || input == ActInput.AllAction || _pos.Equals(EClass.pc.pos)) && EClass.pc.CanPick(t)) // [!code ++]
							{ // [!code ++]
								listPick.Add(t); // [!code ++]
							} // [!code ++]
							if (t.IsInstalled) // [!code ++]
							{ // [!code ++]
								t.trait.TrySetToggleAct(this); // [!code ++]
								t.trait.TrySetAct(this); // [!code ++]
							}
						}
					}
					if (isKey) // [!code --]
				} // [!code ++]
				void func() // [!code ++]
				{ // [!code ++]
					EClass.pc.GiveGift(c, EClass.pc.SplitHeld(1) as Thing); // [!code ++]
				} // [!code ++]
			}); // [!code ++]
			if (listPick.Count > 0) // [!code ++]
			{ // [!code ++]
				if (listPick.Count == 1) // [!code ++]
				{ // [!code ++]
					Thing _t = listPick[0]; // [!code ++]
					if (!EClass._zone.IsRegion || (!_t.ignoreAutoPick && _t.pos.Equals(EClass.pc.pos)) || altAction) // [!code ++]
					{
						_ = t.trait.CanBeAttacked; // [!code --]
						TrySetAct("actPickOne", delegate // [!code ++]
						{ // [!code ++]
							EClass.pc.Pick(_t); // [!code ++]
							return true; // [!code ++]
						}, listPick[0], CursorSystem.Hand, 1, isHostileAct: false, localAct: false); // [!code ++]
					}
					else // [!code --]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					IList<Card> _cards = items.Copy(); // [!code ++]
					TrySetAct("actPickAll", delegate // [!code ++]
					{
						if (t.placeState == PlaceState.roaming && (_pos.cell.blocked || t.ignoreAutoPick || altAction || input == ActInput.AllAction || _pos.Equals(EClass.pc.pos)) && EClass.pc.CanPick(t)) // [!code --]
						foreach (Card item in _cards) // [!code ++]
						{
							listPick.Add(t); // [!code --]
						} // [!code --]
						if (t.IsInstalled) // [!code --]
						{ // [!code --]
							t.trait.TrySetToggleAct(this); // [!code --]
							t.trait.TrySetAct(this); // [!code --]
							if (item.isThing && item.placeState == PlaceState.roaming) // [!code ++]
							{ // [!code ++]
								EClass.pc.Pick(item.Thing); // [!code ++]
							} // [!code ++]
						}
					} // [!code --]
						return true; // [!code ++]
					}, null, CursorSystem.Hand, 1, isHostileAct: false, localAct: false); // [!code ++]
				}
			}
			void func() // [!code --]
			if (input == ActInput.AllAction && pos.IsSky) // [!code ++]
			{
				EClass.pc.GiveGift(c, EClass.pc.SplitHeld(1) as Thing); // [!code --]
				TrySetAct("actSkyJump", delegate // [!code ++]
				{ // [!code ++]
					EClass.pc.FallFromZone(); // [!code ++]
					return false; // [!code ++]
				}); // [!code ++]
			}
		}); // [!code --]
		if (listPick.Count > 0) // [!code --]
		{ // [!code --]
			if (listPick.Count == 1) // [!code --]
			if (_pos.Equals(cc.pos)) // [!code ++]
			{
				Thing _t = listPick[0]; // [!code --]
				if (!EClass._zone.IsRegion || (!_t.ignoreAutoPick && _t.pos.Equals(EClass.pc.pos)) || altAction) // [!code --]
				if (cc.held != null && !cc.held.IsHotItem) // [!code ++]
				{ // [!code ++]
					TrySetAct("actPick", delegate // [!code ++]
					{ // [!code ++]
						_ = cc.held; // [!code ++]
						cc.PickHeld(msg: true); // [!code ++]
						return false; // [!code ++]
					}, cc.held, CursorSystem.Inventory, 1, isHostileAct: false, localAct: false); // [!code ++]
				} // [!code ++]
				else if (!HasAct && !cc.isRestrained) // [!code ++]
				{ // [!code ++]
					TrySetAct(ACT.Wait); // [!code ++]
				} // [!code ++]
				if (EClass.pc.party.members.Count > 1) // [!code ++]
				{ // [!code ++]
					showOrder = true; // [!code ++]
				} // [!code ++]
				if (input == ActInput.AllAction && EClass.pc.held != null && !EClass.pc.held.trait.CanOnlyCarry) // [!code ++]
				{
					TrySetAct("actPickOne", delegate // [!code --]
					TrySetAct("actDrop", delegate // [!code ++]
					{
						EClass.pc.Pick(_t); // [!code --]
						EClass.pc.DropThing(EClass.pc.held.Thing); // [!code ++]
						return true;
					}, listPick[0], CursorSystem.Hand, 1, isHostileAct: false, localAct: false); // [!code --]
					}); // [!code ++]
				}
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				IList<Card> _cards = items.Copy(); // [!code --]
				TrySetAct("actPickAll", delegate // [!code --]
				if (cc.isRestrained) // [!code ++]
				{
					foreach (Card item in _cards) // [!code --]
					TrySetAct("ActUnrestrain", delegate // [!code ++]
					{
						if (item.isThing && item.placeState == PlaceState.roaming) // [!code --]
						{ // [!code --]
							EClass.pc.Pick(item.Thing); // [!code --]
						} // [!code --]
					} // [!code --]
					return true; // [!code --]
				}, null, CursorSystem.Hand, 1, isHostileAct: false, localAct: false); // [!code --]
						cc.TryUnrestrain(force: true, EClass.pc); // [!code ++]
						return true; // [!code ++]
					}, cc); // [!code ++]
				} // [!code ++]
			}
		}
		if (input == ActInput.AllAction && pos.IsSky) // [!code --]
		if (list.Count == 0 && input == ActInput.AllAction && pos.cell.IsSnowTile && !pos.IsBlocked && !pos.HasObj && !pos.HasThing) // [!code ++]
		{
			TrySetAct("actSkyJump", delegate // [!code --]
			TrySetAct(new AI_Craft_Snowman // [!code ++]
			{
				EClass.pc.FallFromZone(); // [!code --]
				return false; // [!code --]
				pos = pos.Copy() // [!code ++]
			});
		}
		if (!_pos.Equals(cc.pos)) // [!code --]
		{ // [!code --]
			return; // [!code --]
		} // [!code --]
		if (cc.held != null && !cc.held.IsHotItem) // [!code --]
		{ // [!code --]
			TrySetAct("actPick", delegate // [!code --]
			{ // [!code --]
				_ = cc.held; // [!code --]
				cc.PickHeld(msg: true); // [!code --]
				return false; // [!code --]
			}, cc.held, CursorSystem.Inventory, 1, isHostileAct: false, localAct: false); // [!code --]
		} // [!code --]
		else if (!HasAct && !cc.isRestrained) // [!code --]
		{ // [!code --]
			TrySetAct(ACT.Wait); // [!code --]
		} // [!code --]
		if (EClass.pc.party.members.Count > 1) // [!code --]
		{ // [!code --]
			showOrder = true; // [!code --]
		} // [!code --]
		if (input == ActInput.AllAction && EClass.pc.held != null && !EClass.pc.held.trait.CanOnlyCarry) // [!code --]
		{ // [!code --]
			TrySetAct("actDrop", delegate // [!code --]
			{ // [!code --]
				EClass.pc.DropThing(EClass.pc.held.Thing); // [!code --]
				return true; // [!code --]
			}); // [!code --]
		} // [!code --]
		if (cc.isRestrained) // [!code --]
		{ // [!code --]
			TrySetAct("ActUnrestrain", delegate // [!code --]
			{ // [!code --]
				cc.TryUnrestrain(force: true, EClass.pc); // [!code --]
				return true; // [!code --]
			}, cc); // [!code --]
		} // [!code --]
	}
	else
	{
```

## Card

[`@@ -3596,7 +3596,7 @@ public void DamageHP(int dmg, int ele, int eleP = 100, AttackSource attackSource`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/Card.cs#L3596-L3602)
```cs:line-numbers=3596
		}
		if (!e.source.aliasRef.IsEmpty() && attackSource != AttackSource.ManaBackfire)
		{
			dmg = Element.GetResistDamage(dmg, Evalue(e.source.aliasRef)); // [!code --]
			dmg = Element.GetResistDamage(dmg, Evalue(e.source.aliasRef), (origin != null) ? origin.Evalue(1238) : 0); // [!code ++]
			dmg = dmg * 100 / (100 + Mathf.Clamp(Evalue(961) * 5, -50, 200));
		}
		switch (e.id)
```

[`@@ -3821,7 +3821,7 @@ public void DamageHP(int dmg, int ele, int eleP = 100, AttackSource attackSource`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/Card.cs#L3821-L3827)
```cs:line-numbers=3821
					if (EClass.player.invlunerable)
					{
						EvadeDeath();
						goto IL_0992; // [!code --]
						goto IL_09ad; // [!code ++]
					}
				}
				if (IsPC && Evalue(1220) > 0 && Chara.stamina.value >= Chara.stamina.max / 2)
```

[`@@ -3833,8 +3833,8 @@ public void DamageHP(int dmg, int ele, int eleP = 100, AttackSource attackSource`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/Card.cs#L3833-L3840)
```cs:line-numbers=3833
			}
		}
	}
	goto IL_0992; // [!code --]
	IL_0992: // [!code --]
	goto IL_09ad; // [!code ++]
	IL_09ad: // [!code ++]
	if (trait.CanBeAttacked)
	{
		renderer.PlayAnime(AnimeID.HitObj);
```

[`@@ -5064,8 +5064,8 @@ public void Dye(string idMat)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/Card.cs#L5064-L5071)
```cs:line-numbers=5064

	public void Dye(SourceMaterial.Row mat)
	{
		isDyed = true; // [!code --]
		c_dyeMat = mat.id; // [!code --]
		isDyed = mat != null; // [!code ++]
		c_dyeMat = mat?.id ?? 0; // [!code ++]
		_colorInt = 0;
	}

```

## Chara

[`@@ -2578,7 +2578,7 @@ public override MoveResult _Move(Point newPoint, MoveType type = MoveType.Walk)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/Chara.cs#L2578-L2584)
```cs:line-numbers=2578
		{
			foreach (Thing thing2 in newPoint.Things)
			{
				if (thing2.IsInstalled && (thing2.trait.CanChangeHeight || thing2.Pref.Surface)) // [!code --]
				if (thing2.IsInstalled && (thing2.trait.IsChangeFloorHeight || thing2.Pref.Surface)) // [!code ++]
				{
					text = thing2.material.soundFoot;
				}
```

[`@@ -4571,6 +4571,7 @@ public void Revive(Point p = null, bool msg = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/Chara.cs#L4571-L4576)
```cs:line-numbers=4571
	}
	sleepiness.value = 0;
	hostility = OriginalHostility;
	RemoveCondition<StanceTaunt>(); // [!code ++]
	if (IsPC)
	{
		if (EClass.player.preventDeathPenalty)
```

## DOMAIN

[`@@ -2,42 +2,42 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/DOMAIN.cs#L2-L43)
```cs:line-numbers=2

public class DOMAIN
{
	public const int domArcane = 804; // [!code --]
 // [!code --]
	public const int domTest = 800; // [!code --]
 // [!code --]
	public const int domSurvival = 801;

	public const int domFaith = 802;

	public const int domOblivion = 813; // [!code ++]
 // [!code ++]
	public const int domTest = 800; // [!code ++]
 // [!code ++]
	public const int domMiracle = 803;

	public const int domEyth = 814; // [!code ++]
 // [!code ++]
	public const int domComm = 805;

	public const int domEyth = 814; // [!code --]
	public const int domHealing = 811; // [!code ++]

	public const int domWind = 807; // [!code --]
	public const int domEarth = 812; // [!code ++]

	public const int domHarvest = 808; // [!code --]
	public const int domLuck = 810; // [!code ++]

	public const int domMachine = 809;

	public const int domLuck = 810; // [!code --]
	public const int domArcane = 804; // [!code ++]

	public const int domHealing = 811; // [!code --]
	public const int domHarmony = 815; // [!code ++]

	public const int domOblivion = 813; // [!code --]
	public const int domHarvest = 808; // [!code ++]

	public const int domEarth = 812; // [!code --]
	public const int domWind = 807; // [!code ++]

	public const int domElement = 806;

	public const int domHarmony = 815; // [!code --]
 // [!code --]
	public static readonly int[] IDS = new int[16]
	{
		804, 800, 801, 802, 803, 805, 814, 807, 808, 809, // [!code --]
		810, 811, 813, 812, 806, 815 // [!code --]
		801, 802, 813, 800, 803, 814, 805, 811, 812, 810, // [!code ++]
		809, 804, 815, 808, 807, 806 // [!code ++]
	};
}
public class Domain : EClass
```

## DramaOutcome

[`@@ -38,9 +38,9 @@ public void StartNewGame2()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/DramaOutcome.cs#L38-L46)
```cs:line-numbers=38

	public void PutOutFire()
	{
		foreach (Card value in EMono._map.props.installed.traits.GetTraitSet<TraitHearth>().Values) // [!code --]
		foreach (Card item in EMono._map.props.installed.traits.GetTraitSet<TraitHearth>()) // [!code ++]
		{
			EMono._zone.AddCard(ThingGen.Create("dish_soup"), value.pos.GetRandomNeighbor()); // [!code --]
			EMono._zone.AddCard(ThingGen.Create("dish_soup"), item.pos.GetRandomNeighbor()); // [!code ++]
		}
	}

```

## ELEMENT

[`@@ -5,19 +5,19 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ELEMENT.cs#L5-L23)
```cs:line-numbers=5

public class ELEMENT
{
	public const int hotspring = 756; // [!code --]
	public const int antidote = 753; // [!code ++]

	public const int blood = 755;

	public const int nerve = 754; // [!code --]
	public const int rare = 751; // [!code ++]

	public const int antidote = 753; // [!code --]
	public const int comfort = 750; // [!code ++]

	public const int cute = 752; // [!code --]
	public const int hotspring = 756; // [!code ++]

	public const int rare = 751; // [!code --]
	public const int nerve = 754; // [!code ++]

	public const int comfort = 750; // [!code --]
	public const int cute = 752; // [!code ++]

	public const int _void = 0;

```

[`@@ -67,7 +67,7 @@ public class ELEMENT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ELEMENT.cs#L67-L73)
```cs:line-numbers=67

	public static readonly int[] IDS = new int[30]
	{
		756, 755, 754, 753, 752, 751, 750, 0, 5, 1, // [!code --]
		753, 755, 751, 750, 756, 754, 752, 0, 5, 1, // [!code ++]
		2, 3, 10, 11, 12, 13, 14, 16, 17, 18,
		15, 21, 22, 23, 24, 25, 26, 29, 85, 20
	};
```

[`@@ -903,12 +903,17 @@ public static int GetResistLv(int v)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ELEMENT.cs#L903-L914)
```cs:line-numbers=903
		{
			num = -2;
		}
		if (num > 4) // [!code ++]
		{ // [!code ++]
			num = 4; // [!code ++]
		} // [!code ++]
		return num;
	}

	public static int GetResistDamage(int dmg, int v) // [!code --]
	public static int GetResistDamage(int dmg, int v, int power = 0) // [!code ++]
	{
		int resistLv = GetResistLv(v);
		resistLv -= power; // [!code ++]
		if (resistLv >= 4)
		{
			return 0;
```

## ENC

[`@@ -10,10 +10,10 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ENC.cs#L10-L19)
```cs:line-numbers=10

	public const int r_mana = 641;

	public const int mod_drill = 606; // [!code --]
 // [!code --]
	public const int mod_scatter = 607;

	public const int mod_chaser = 620; // [!code ++]
 // [!code ++]
	public const int r_life = 640;

	public const int onlyPet = 655;
```

[`@@ -22,7 +22,7 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ENC.cs#L22-L28)
```cs:line-numbers=22

	public const int permaCurse = 656;

	public const int convertFire = 850; // [!code --]
	public const int convertCold = 851; // [!code ++]

	public const int absorbMP = 661;

```

[`@@ -36,9 +36,9 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ENC.cs#L36-L44)
```cs:line-numbers=36

	public const int meleeDistance = 666;

	public const int convertCold = 851; // [!code --]
	public const int convertFire = 850; // [!code ++]

	public const int mod_precision = 605; // [!code --]
	public const int mod_drill = 606; // [!code ++]

	public const int convertImpact = 865;

```

[`@@ -46,11 +46,11 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ENC.cs#L46-L56)
```cs:line-numbers=46

	public const int absorbHP = 660;

	public const int mod_ammo_recover = 604; // [!code --]
	public const int mod_precision = 605; // [!code ++]

	public const int sustain_CHA = 447; // [!code --]
	public const int resWeather = 408; // [!code ++]

	public const int mod_rapid = 602; // [!code --]
	public const int mod_ammo_knockback = 603; // [!code ++]

	public const int breathing = 429;

```

[`@@ -62,6 +62,8 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ENC.cs#L62-L67)
```cs:line-numbers=62

	public const int negateConfusion = 425;

	public const int negateSleep = 424; // [!code ++]
 // [!code ++]
	public const int negateFear = 423;

	public const int negateParalysis = 422;
```

[`@@ -72,23 +74,21 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ENC.cs#L72-L94)
```cs:line-numbers=72

	public const int seeInvisible = 416;

	public const int invisibility = 415; // [!code --]
 // [!code --]
	public const int sustain_STR = 440;

	public const int slowCorruption = 412; // [!code --]
	public const int invisibility = 415; // [!code ++]
 // [!code ++]
	public const int encSpell = 411; // [!code ++]

	public const int throwReturn = 410;

	public const int corruption = 409;

	public const int resWeather = 408; // [!code --]
 // [!code --]
	public const int travelSpeed = 407;

	public const int resMutation = 406;

	public const int slowDecay = 405; // [!code --]
	public const int mod_ammo_recover = 604; // [!code ++]

	public const int weightMod = 404;

```

[`@@ -100,13 +100,15 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ENC.cs#L100-L112)
```cs:line-numbers=100

	public const int negateTeleport = 400;

	public const int encSpell = 411; // [!code --]
	public const int slowCorruption = 412; // [!code ++]

	public const int sustain_END = 441;

	public const int negateSleep = 424; // [!code --]
	public const int slowDecay = 405; // [!code ++]

	public const int strongStomach = 480; // [!code --]
	public const int force_weapon = 482; // [!code ++]
 // [!code ++]
	public const int mod_rapid = 602; // [!code ++]

	public const int mod_reload = 601;

```

[`@@ -114,29 +116,27 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ENC.cs#L114-L142)
```cs:line-numbers=114

	public const int optimizeMana = 483;

	public const int force_weapon = 482; // [!code --]
 // [!code --]
	public const int revealFaith = 481;

	public const int strongStomach = 480; // [!code ++]
 // [!code ++]
	public const int bane_all = 468;

	public const int bane_fish = 467;

	public const int bane_god = 466;

	public const int bane_machine = 465; // [!code --]
 // [!code --]
	public const int bane_man = 464;

	public const int bane_animal = 463;

	public const int bane_fairy = 462;

	public const int bane_undead = 461; // [!code --]
	public const int bane_machine = 465; // [!code ++]

	public const int mod_ammo_knockback = 603; // [!code --]
	public const int bane_dragon = 460; // [!code ++]

	public const int sustain_PER = 443; // [!code --]
	public const int sustain_CHA = 447; // [!code ++]

	public const int sustain_MAG = 446;

```

[`@@ -144,19 +144,21 @@ public class ENC`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/ENC.cs#L144-L162)
```cs:line-numbers=144

	public const int sustain_LER = 444;

	public const int bane_dragon = 460; // [!code --]
	public const int bane_undead = 461; // [!code ++]
 // [!code ++]
	public const int sustain_PER = 443; // [!code ++]

	public const int sustain_DEX = 442;

	public static readonly int[] IDS = new int[74] // [!code --]
	public static readonly int[] IDS = new int[75] // [!code ++]
	{
		654, 653, 652, 651, 641, 606, 607, 640, 655, 650, // [!code --]
		656, 850, 661, 662, 663, 664, 665, 666, 851, 605, // [!code --]
		865, 852, 660, 604, 447, 602, 429, 428, 427, 426, // [!code --]
		425, 423, 422, 421, 420, 416, 415, 440, 412, 410, // [!code --]
		409, 408, 407, 406, 405, 404, 403, 402, 401, 400, // [!code --]
		411, 441, 424, 480, 601, 600, 483, 482, 481, 468, // [!code --]
		467, 466, 465, 464, 463, 462, 461, 603, 443, 446, // [!code --]
		445, 444, 460, 442 // [!code --]
		654, 653, 652, 651, 641, 607, 620, 640, 655, 650, // [!code ++]
		656, 851, 661, 662, 663, 664, 665, 666, 850, 606, // [!code ++]
		865, 852, 660, 605, 408, 603, 429, 428, 427, 426, // [!code ++]
		425, 424, 423, 422, 421, 420, 416, 440, 415, 411, // [!code ++]
		410, 409, 407, 406, 604, 404, 403, 402, 401, 400, // [!code ++]
		412, 441, 405, 482, 602, 601, 600, 483, 481, 480, // [!code ++]
		468, 467, 466, 464, 463, 462, 465, 460, 447, 446, // [!code ++]
		445, 444, 461, 443, 442 // [!code ++]
	};
}
```

## FACTION

[`@@ -4,72 +4,70 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FACTION.cs#L4-L75)
```cs:line-numbers=4

public class FACTION
{
	public const int bfCave = 3500; // [!code --]
 // [!code --]
	public const int bfPlain = 3600;

	public const int bfForest = 3601;

	public const int bfSnow = 3602;

	public const int fConstruction = 2003; // [!code --]
	public const int bfRuin = 3702; // [!code ++]

	public const int fRation = 2207; // [!code --]
	public const int bfHill = 3603; // [!code ++]

	public const int bfBeach = 3604; // [!code --]
	public const int bfFertile = 3700; // [!code ++]

	public const int bfSea = 3605;

	public const int bfFertile = 3700; // [!code --]
	public const int bfBeach = 3604; // [!code ++]
 // [!code ++]
	public const int bfCave = 3500; // [!code ++]

	public const int bfGeyser = 3701;

	public const int bfHill = 3603; // [!code --]
	public const int fRation = 2207; // [!code ++]

	public const int fAttraction = 2206; // [!code --]
	public const int actBuildCollect = 4004; // [!code ++]

	public const int fMoral = 2203; // [!code --]
	public const int fSafety = 2205; // [!code ++]

	public const int fFood = 2204;

	public const int fMoral = 2203; // [!code ++]
 // [!code ++]
	public const int fPromo = 2202;

	public const int fElec = 2201;

	public const int fLoyal = 2117; // [!code --]
 // [!code --]
	public const int fEducation = 2116; // [!code --]
 // [!code --]
	public const int fAdmin = 2115; // [!code --]
 // [!code --]
	public const int fTaxEvasion = 2119; // [!code --]
 // [!code --]
	public const int fHeirloom = 2120; // [!code --]
	public const int bfTranquil = 3703; // [!code ++]

	public const int fSoil = 2200;

	public const int bfRuin = 3702; // [!code --]
	public const int fHeirloom = 2120; // [!code ++]

	public const int fSafety = 2205; // [!code --]
	public const int fTaxEvasion = 2119; // [!code ++]

	public const int fLuck = 2118;

	public const int bfTranquil = 3703; // [!code --]
	public const int fLoyal = 2117; // [!code ++]

	public const int bfHunt = 3705; // [!code --]
	public const int fAttraction = 2206; // [!code ++]

	public const int bfVolcano = 3704;

	public const int actBuildRecipe = 4005; // [!code --]
	public const int bfLandmark5 = 3784; // [!code ++]

	public const int actBuildCollect = 4004; // [!code --]
	public const int bfFish = 3706; // [!code ++]

	public const int actBuildAnywhere = 4003; // [!code --]
	public const int actBuildRecipe = 4005; // [!code ++]
 // [!code ++]
	public const int actBuildInspect = 4006; // [!code ++]

	public const int actBuildTerrain = 4002;

	public const int actBuildMine = 4001;

	public const int fEducation = 2116; // [!code ++]
 // [!code ++]
	public const int actBuildCut = 4000;

	public const int bfStart = 3900;
```

[`@@ -80,42 +78,44 @@ public class FACTION`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FACTION.cs#L80-L121)
```cs:line-numbers=80

	public const int bfGum = 3803;

	public const int bfSilica = 3802; // [!code --]
	public const int bfHunt = 3705; // [!code ++]

	public const int actBuildInspect = 4006; // [!code --]
	public const int bfSilica = 3802; // [!code ++]

	public const int bfCoal = 3800;

	public const int bfMushroom = 3801; // [!code --]
	public const int actBuildAnywhere = 4003; // [!code ++]

	public const int bfMonster = 3707; // [!code --]
	public const int bfLandmark4 = 3783; // [!code ++]

	public const int bfFreshAir = 3708; // [!code --]
	public const int bfLandmark3 = 3782; // [!code ++]

	public const int bfBasin = 3709; // [!code --]
	public const int bfLandmark2 = 3781; // [!code ++]
 // [!code ++]
	public const int bfLandmark1 = 3780; // [!code ++]

	public const int bfBreed = 3710;

	public const int bfFish = 3706; // [!code --]
	public const int bfBasin = 3709; // [!code ++]

	public const int bfLandmark2 = 3781; // [!code --]
	public const int bfFreshAir = 3708; // [!code ++]

	public const int bfLandmark3 = 3782; // [!code --]
	public const int bfMonster = 3707; // [!code ++]

	public const int bfLandmark4 = 3783; // [!code --]
	public const int bfMushroom = 3801; // [!code ++]

	public const int bfLandmark5 = 3784; // [!code --]
	public const int fAdmin = 2115; // [!code ++]

	public const int bfLandmark1 = 3780; // [!code --]
	public const int fConstruction = 2003; // [!code ++]

	public static readonly int[] IDS = new int[52]
	{
		3500, 3600, 3601, 3602, 2003, 2207, 3604, 3605, 3700, 3701, // [!code --]
		3603, 2206, 2203, 2204, 2202, 2201, 2117, 2116, 2115, 2119, // [!code --]
		2120, 2200, 3702, 2205, 2118, 3703, 3705, 3704, 4005, 4004, // [!code --]
		4003, 4002, 4001, 4000, 3900, 3805, 3804, 3803, 3802, 4006, // [!code --]
		3800, 3801, 3707, 3708, 3709, 3710, 3706, 3781, 3782, 3783, // [!code --]
		3784, 3780 // [!code --]
		3600, 3601, 3602, 3702, 3603, 3700, 3605, 3604, 3500, 3701, // [!code ++]
		2207, 4004, 2205, 2204, 2203, 2202, 2201, 3703, 2200, 2120, // [!code ++]
		2119, 2118, 2117, 2206, 3704, 3784, 3706, 4005, 4006, 4002, // [!code ++]
		4001, 2116, 4000, 3900, 3805, 3804, 3803, 3705, 3802, 3800, // [!code ++]
		4003, 3783, 3782, 3781, 3780, 3710, 3709, 3708, 3707, 3801, // [!code ++]
		2115, 2003 // [!code ++]
	};
}
public class Faction : EClass
```

## FEAT

[`@@ -3,15 +3,33 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FEAT.cs#L3-L17)
```cs:line-numbers=3

public class FEAT
{
	public const int featStamina = 1612; // [!code --]
	public const int featSnail = 1211; // [!code ++]
 // [!code ++]
	public const int featFaith = 1636; // [!code ++]
 // [!code ++]
	public const int featMartial = 1635; // [!code ++]
 // [!code ++]
	public const int featNegotiate = 1634; // [!code ++]
 // [!code ++]
	public const int featSpotting = 1633; // [!code ++]
 // [!code ++]
	public const int featEvade = 1632; // [!code ++]
 // [!code ++]
	public const int featDefense = 1631; // [!code ++]
 // [!code ++]
	public const int featHardy = 1630; // [!code ++]
 // [!code ++]
	public const int featSPD = 1629; // [!code ++]
 // [!code ++]
	public const int featLuck = 1628; // [!code ++]

	public const int featCHA = 1627;

	public const int featWIL = 1626;

	public const int featMAG = 1625; // [!code --]
	public const int featAnimalLover = 1640; // [!code ++]

	public const int featLER = 1624; // [!code --]
	public const int featMAG = 1625; // [!code ++]

	public const int featPER = 1623;

```

[`@@ -21,9 +39,9 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FEAT.cs#L21-L29)
```cs:line-numbers=21

	public const int featSTR = 1620;

	public const int featLuck = 1628; // [!code --]
	public const int featStamina = 1612; // [!code ++]

	public const int featSwordsage = 1418; // [!code --]
	public const int featMana = 1611; // [!code ++]

	public const int featLife = 1610;

```

[`@@ -33,36 +51,44 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FEAT.cs#L33-L68)
```cs:line-numbers=33

	public const int featMilitant = 1419;

	public const int featWitch = 1417; // [!code --]
	public const int featSwordsage = 1418; // [!code ++]

	public const int featInquisitor = 1416; // [!code --]
	public const int featLER = 1624; // [!code ++]

	public const int featFoxMaid = 1415; // [!code --]
	public const int featResCurse = 1641; // [!code ++]

	public const int featWhiteVixen = 1414; // [!code --]
	public const int featSleeper = 1642; // [!code ++]

	public const int featFairysan = 1413; // [!code --]
	public const int featSorter = 1643; // [!code ++]

	public const int featLuckyCat = 1412; // [!code --]
	public const int featUndead = 1210; // [!code ++]

	public const int featSPD = 1629; // [!code --]
	public const int featSlowFood = 1200; // [!code ++]

	public const int featMana = 1611; // [!code --]
	public const int featManaBond = 1201; // [!code ++]

	public const int featHardy = 1630; // [!code --]
	public const int featFastLearner = 1202; // [!code ++]

	public const int featLonelySoul = 1646; // [!code --]
	public const int featGrowParts = 1203; // [!code ++]

	public const int featEvade = 1632; // [!code --]
	public const int featFairyWeak = 1204; // [!code ++]

	public const int featEarthStrength = 1411; // [!code --]
	public const int featCannibalism = 1205; // [!code ++]

	public const int featChef = 1658; // [!code --]
	public const int featMelilithCurse = 1206; // [!code ++]

	public const int featManaCost = 1657; // [!code --]
	public const int featFoxBless = 1207; // [!code ++]
 // [!code ++]
	public const int featFoxLearn = 1208; // [!code ++]
 // [!code ++]
	public const int featFluffyTail = 1209; // [!code ++]
 // [!code ++]
	public const int featChef = 1658; // [!code ++]

	public const int featScavenger = 1656;

	public const int featModelBeliever = 1655; // [!code ++]
 // [!code ++]
	public const int featHeavyCasting = 1654;

	public const int featDreamWaker = 1653;
```

[`@@ -75,57 +101,23 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FEAT.cs#L75-L131)
```cs:line-numbers=75

	public const int featDefender = 1649;

	public const int featDefense = 1631; // [!code --]
 // [!code --]
	public const int featRapidMagic = 1648;

	public const int featParty = 1645; // [!code --]
 // [!code --]
	public const int featBodyParts = 1644; // [!code --]
 // [!code --]
	public const int featSorter = 1643; // [!code --]
 // [!code --]
	public const int featSleeper = 1642; // [!code --]
 // [!code --]
	public const int featResCurse = 1641; // [!code --]
 // [!code --]
	public const int featAnimalLover = 1640; // [!code --]
 // [!code --]
	public const int featFaith = 1636; // [!code --]
 // [!code --]
	public const int featMartial = 1635; // [!code --]
 // [!code --]
	public const int featNegotiate = 1634; // [!code --]
 // [!code --]
	public const int featSpotting = 1633; // [!code --]
 // [!code --]
	public const int featSummoner = 1647;

	public const int featReboot = 1410; // [!code --]
 // [!code --]
	public const int featModelBeliever = 1655; // [!code --]
 // [!code --]
	public const int featPaladin2 = 1408; // [!code --]
 // [!code --]
	public const int featShiva = 1224; // [!code --]
 // [!code --]
	public const int featLoyal = 1225; // [!code --]
 // [!code --]
	public const int featUnderground = 1226; // [!code --]
 // [!code --]
	public const int featServant = 1227; // [!code --]
	public const int featLonelySoul = 1646; // [!code ++]

	public const int featDemigod = 1228; // [!code --]
	public const int featParty = 1645; // [!code ++]

	public const int featLittleOne = 1229; // [!code --]
	public const int featBodyParts = 1644; // [!code ++]

	public const int featAdam = 1230; // [!code --]
	public const int featWitch = 1417; // [!code ++]

	public const int featNirvana = 1231; // [!code --]
	public const int featInquisitor = 1416; // [!code ++]

	public const int featCosmicHorror = 1233; // [!code --]
	public const int featManaCost = 1657; // [!code ++]

	public const int featHeavyEater = 1234; // [!code --]
	public const int featWhiteVixen = 1414; // [!code ++]

	public const int featLightEater = 1235;

```

[`@@ -133,12 +125,12 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FEAT.cs#L133-L144)
```cs:line-numbers=133

	public const int featRoran = 1237;

	public const int featElder = 1238; // [!code ++]
 // [!code ++]
	public const int featGod_element1 = 1300;

	public const int featGod_earth1 = 1305;

	public const int featGod_wind1 = 1310; // [!code --]
 // [!code --]
	public const int featGod_machine1 = 1315;

	public const int featGod_healing1 = 1320;
```

[`@@ -149,41 +141,31 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FEAT.cs#L149-L189)
```cs:line-numbers=149

	public const int featGod_harmony1 = 1335;

	public const int featAcidBody = 1223; // [!code --]
 // [!code --]
	public const int featGod_oblivion1 = 1340;

	public const int featSplit = 1222; // [!code --]
 // [!code --]
	public const int featFate = 1220; // [!code --]
 // [!code --]
	public const int featBoost = 1409; // [!code --]
 // [!code --]
	public const int featSlowFood = 1200; // [!code --]
 // [!code --]
	public const int featManaBond = 1201; // [!code --]
	public const int featGod_trickery1 = 1345; // [!code ++]

	public const int featFastLearner = 1202; // [!code --]
	public const int featGod_moonshadow1 = 1350; // [!code ++]

	public const int featGrowParts = 1203; // [!code --]
	public const int featGod_strife1 = 1355; // [!code ++]

	public const int featFairyWeak = 1204; // [!code --]
	public const int featWarrior = 1400; // [!code ++]

	public const int featCannibalism = 1205; // [!code --]
	public const int featThief = 1401; // [!code ++]

	public const int featMelilithCurse = 1206; // [!code --]
	public const int featWizard = 1402; // [!code ++]

	public const int featFoxBless = 1207; // [!code --]
	public const int featFarmer = 1403; // [!code ++]

	public const int featFoxLearn = 1208; // [!code --]
	public const int featHeavyEater = 1234; // [!code ++]

	public const int featFluffyTail = 1209; // [!code --]
	public const int featCosmicHorror = 1233; // [!code ++]

	public const int featUndead = 1210; // [!code --]
	public const int featBaby = 1232; // [!code ++]

	public const int featSnail = 1211; // [!code --]
	public const int featNirvana = 1231; // [!code ++]

	public const int featFairyResist = 1212; // [!code --]
	public const int featFoxMaid = 1415; // [!code ++]

	public const int featElea = 1213;

```

[`@@ -199,46 +181,66 @@ public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FEAT.cs#L199-L244)
```cs:line-numbers=199

	public const int featElderCrab = 1219;

	public const int featFate = 1220; // [!code ++]
 // [!code ++]
	public const int featArcher = 1404; // [!code ++]
 // [!code ++]
	public const int featSpike = 1221;

	public const int featGod_trickery1 = 1345; // [!code --]
	public const int featAcidBody = 1223; // [!code ++]

	public const int featBaby = 1232; // [!code --]
	public const int featFairyResist = 1212; // [!code ++]

	public const int featGod_moonshadow1 = 1350; // [!code --]
	public const int featShiva = 1224; // [!code ++]

	public const int featGod_strife1 = 1355; // [!code --]
	public const int featLoyal = 1225; // [!code ++]

	public const int featWarrior = 1400; // [!code --]
	public const int featUnderground = 1226; // [!code ++]

	public const int featThief = 1401; // [!code --]
	public const int featServant = 1227; // [!code ++]

	public const int featFarmer = 1403; // [!code --]
	public const int featDemigod = 1228; // [!code ++]

	public const int featArcher = 1404; // [!code --]
	public const int featLittleOne = 1229; // [!code ++]
 // [!code ++]
	public const int featAdam = 1230; // [!code ++]
 // [!code ++]
	public const int featSplit = 1222; // [!code ++]

	public const int featPianist = 1405;

	public const int featGod_wind1 = 1310; // [!code ++]
 // [!code ++]
	public const int featPaladin = 1407; // [!code ++]
 // [!code ++]
	public const int featTourist = 1406;

	public const int featWizard = 1402; // [!code --]
	public const int featEarthStrength = 1411; // [!code ++]

	public const int featPaladin = 1407; // [!code --]
	public const int featLuckyCat = 1412; // [!code ++]
 // [!code ++]
	public const int featReboot = 1410; // [!code ++]
 // [!code ++]
	public const int featFairysan = 1413; // [!code ++]
 // [!code ++]
	public const int featBoost = 1409; // [!code ++]
 // [!code ++]
	public const int featPaladin2 = 1408; // [!code ++]

	public static readonly int[] IDS = new int[111] // [!code --]
	public static readonly int[] IDS = new int[112] // [!code ++]
	{
		1612, 1627, 1626, 1625, 1624, 1623, 1622, 1621, 1620, 1628, // [!code --]
		1418, 1610, 1421, 1420, 1419, 1417, 1416, 1415, 1414, 1413, // [!code --]
		1412, 1629, 1611, 1630, 1646, 1632, 1411, 1658, 1657, 1656, // [!code --]
		1654, 1653, 1652, 1651, 1650, 1649, 1631, 1648, 1645, 1644, // [!code --]
		1643, 1642, 1641, 1640, 1636, 1635, 1634, 1633, 1647, 1410, // [!code --]
		1655, 1408, 1224, 1225, 1226, 1227, 1228, 1229, 1230, 1231, // [!code --]
		1233, 1234, 1235, 1236, 1237, 1300, 1305, 1310, 1315, 1320, // [!code --]
		1325, 1330, 1335, 1223, 1340, 1222, 1220, 1409, 1200, 1201, // [!code --]
		1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211, // [!code --]
		1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1221, 1345, // [!code --]
		1232, 1350, 1355, 1400, 1401, 1403, 1404, 1405, 1406, 1402, // [!code --]
		1407 // [!code --]
		1211, 1636, 1635, 1634, 1633, 1632, 1631, 1630, 1629, 1628, // [!code ++]
		1627, 1626, 1640, 1625, 1623, 1622, 1621, 1620, 1612, 1611, // [!code ++]
		1610, 1421, 1420, 1419, 1418, 1624, 1641, 1642, 1643, 1210, // [!code ++]
		1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, // [!code ++]
		1658, 1656, 1655, 1654, 1653, 1652, 1651, 1650, 1649, 1648, // [!code ++]
		1647, 1646, 1645, 1644, 1417, 1416, 1657, 1414, 1235, 1236, // [!code ++]
		1237, 1238, 1300, 1305, 1315, 1320, 1325, 1330, 1335, 1340, // [!code ++]
		1345, 1350, 1355, 1400, 1401, 1402, 1403, 1234, 1233, 1232, // [!code ++]
		1231, 1415, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, // [!code ++]
		1404, 1221, 1223, 1212, 1224, 1225, 1226, 1227, 1228, 1229, // [!code ++]
		1230, 1222, 1405, 1310, 1407, 1406, 1411, 1412, 1410, 1413, // [!code ++]
		1409, 1408 // [!code ++]
	};
}
public class Feat : Element
```

## FOOD

[`@@ -1,22 +1,22 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FOOD.cs#L1-L22)
```cs:line-numbers=1
public class FOOD
{
	public const int food_cat = 701; // [!code --]
	public const int justcooked = 757; // [!code ++]

	public const int food_love = 703; // [!code --]
	public const int loseWeight = 706; // [!code ++]
 // [!code ++]
	public const int gainWeight = 705; // [!code ++]

	public const int food_bug = 704;

	public const int gainWeight = 705; // [!code --]
	public const int food_love = 703; // [!code ++]

	public const int loseWeight = 706; // [!code --]
	public const int food_poison = 702; // [!code ++]

	public const int justcooked = 757; // [!code --]
	public const int food_cat = 701; // [!code ++]

	public const int food_god = 758;

	public const int food_poison = 702; // [!code --]
 // [!code --]
	public const int food_CHA = 700;

	public static readonly int[] IDS = new int[9] { 701, 703, 704, 705, 706, 757, 758, 702, 700 }; // [!code --]
	public static readonly int[] IDS = new int[9] { 757, 706, 705, 704, 703, 702, 701, 758, 700 }; // [!code ++]
}
```

## FactionBranch

[`@@ -1421,6 +1421,7 @@ public void ChangeMemberType(Chara c, FactionMemberType type)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/FactionBranch.cs#L1421-L1426)
```cs:line-numbers=1421
{
	c.ClearBed();
	c.memberType = type;
	c.c_wasInPcParty = false; // [!code ++]
	RefreshEfficiency();
	c.RefreshWorkElements(elements);
	policies.Validate();
```

## GameDate

[`@@ -256,7 +256,7 @@ public void ShipGoods()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/GameDate.cs#L256-L262)
```cs:line-numbers=256
	{
		EClass.player.stats.shipMoney = 2147483647L;
	}
	shippingResult.total = (int)EClass.player.stats.shipMoney; // [!code --]
	shippingResult.total = EClass.player.stats.shipMoney; // [!code ++]
	shippingResult.hearthLv = zone.branch.lv;
	shippingResult.hearthExp = zone.branch.exp;
	shippingResult.debt = EClass.player.debt;
```

## LayerLoadGame

[`@@ -241,12 +241,12 @@ public void RefreshInfo(GameIndex i)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/LayerLoadGame.cs#L241-L252)
```cs:line-numbers=241
		{
			Dialog.YesNo("dialog_restoreWarning", delegate
			{
				GameIO.DeleteGame(idDest, cloud, deleteBackup: false); // [!code ++]
				IO.CopyDir(pathRoot + "/" + i.id, (cloud ? CorePath.RootSaveCloud : CorePath.RootSave) + "/" + idDest); // [!code ++]
				SE.WriteJournal(); // [!code ++]
				Close(); // [!code ++]
				Game.TryLoad(idDest, cloud, delegate
				{
					GameIO.DeleteGame(idDest, cloud, deleteBackup: false); // [!code --]
					IO.CopyDir(pathRoot + "/" + i.id, (cloud ? CorePath.RootSaveCloud : CorePath.RootSave) + "/" + idDest); // [!code --]
					SE.WriteJournal(); // [!code --]
					Close(); // [!code --]
					Game.Load(idDest, cloud);
				});
			});
```

## LayerSkinDeco

[`@@ -77,6 +77,11 @@ public override void OnUpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/LayerSkinDeco.cs#L77-L82)
```cs:line-numbers=77
				deco.reverse = a;
				selected.Refresh();
			});
			i.AddToggle("placeBeforeWidget", deco.bottom, delegate(bool a) // [!code ++]
			{ // [!code ++]
				deco.bottom = a; // [!code ++]
				selected.Refresh(); // [!code ++]
			}); // [!code ++]
			i.AddButton("removeDeco", delegate
			{
				widget.RemoveDeco(selected.owner);
```

[`@@ -151,6 +156,7 @@ public override void OnKill()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/LayerSkinDeco.cs#L151-L156)
```cs:line-numbers=151
			actor.transform.SetParent(widget.transform, worldPositionStays: true);
			deco.x = (int)actor.Rect().anchoredPosition.x;
			deco.y = (int)actor.Rect().anchoredPosition.y;
			actor.Refresh(); // [!code ++]
		}
	}
}
```

## MUTATION

[`@@ -1,34 +1,42 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/MUTATION.cs#L1-L34)
```cs:line-numbers=1
public class MUTATION
{
	public const int mutationRegen = 1516; // [!code --]
 // [!code --]
	public const int mutationDexN = 1515; // [!code --]
	public const int mutationStr = 1520; // [!code ++]

	public const int mutationDex = 1514; // [!code --]
	public const int mutationSpeedN = 1519; // [!code ++]

	public const int etherPoisonHand = 1565; // [!code --]
	public const int mutationSpeed = 1518; // [!code ++]

	public const int mutationEye = 1512; // [!code --]
	public const int mutationRegenN = 1517; // [!code ++]

	public const int mutationSkinN = 1511;

	public const int mutationDexN = 1515; // [!code ++]
 // [!code ++]
	public const int mutationEyeN = 1513; // [!code ++]
 // [!code ++]
	public const int mutationEye = 1512; // [!code ++]
 // [!code ++]
	public const int mutationSkin = 1510;

	public const int mutationRegenN = 1517; // [!code --]
	public const int mutationStrN = 1521; // [!code ++]

	public const int mutationEyeN = 1513; // [!code --]
	public const int mutationRegen = 1516; // [!code ++]

	public const int mutationSpeed = 1518; // [!code --]
	public const int mutationCha = 1522; // [!code ++]

	public const int etherManaBattery = 1564; // [!code --]
	public const int mutationDex = 1514; // [!code ++]

	public const int mutationStr = 1520; // [!code --]
	public const int mutationBrain = 1524; // [!code ++]
 // [!code ++]
	public const int etherPoisonHand = 1565; // [!code ++]
 // [!code ++]
	public const int mutationChaN = 1523; // [!code ++]

	public const int etherProvoke = 1563;

	public const int etherArmor = 1562;

	public const int mutationSpeedN = 1519; // [!code --]
	public const int etherStupid = 1561; // [!code ++]

	public const int etherWeak = 1560;

```

[`@@ -44,44 +52,36 @@ public class MUTATION`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/MUTATION.cs#L44-L87)
```cs:line-numbers=44

	public const int etherWing = 1554;

	public const int etherManaBattery = 1564; // [!code ++]
 // [!code ++]
	public const int etherEye = 1553;

	public const int etherFeet = 1552;

	public const int etherUgly = 1551;

	public const int etherStupid = 1561; // [!code --]
 // [!code --]
	public const int etherGravity = 1550;

	public const int mutationStrN = 1521; // [!code --]
 // [!code --]
	public const int mutationChaN = 1523; // [!code --]
 // [!code --]
	public const int mutationBrain = 1524; // [!code --]
 // [!code --]
	public const int mutationBrainN = 1525; // [!code --]
	public const int mutationBodyN = 1531; // [!code ++]

	public const int mutationCold = 1526; // [!code --]
	public const int mutationBody = 1530; // [!code ++]

	public const int mutationCha = 1522; // [!code --]
	public const int mutationLightningN = 1529; // [!code ++]

	public const int mutationLightning = 1528;

	public const int mutationLightningN = 1529; // [!code --]
 // [!code --]
	public const int mutationBody = 1530; // [!code --]
	public const int mutationColdN = 1527; // [!code ++]

	public const int mutationBodyN = 1531; // [!code --]
	public const int mutationCold = 1526; // [!code ++]

	public const int mutationColdN = 1527; // [!code --]
	public const int mutationBrainN = 1525; // [!code ++]

	public static readonly int[] IDS = new int[38]
	{
		1516, 1515, 1514, 1565, 1512, 1511, 1510, 1517, 1513, 1518, // [!code --]
		1564, 1520, 1563, 1562, 1519, 1560, 1559, 1558, 1557, 1556, // [!code --]
		1555, 1554, 1553, 1552, 1551, 1561, 1550, 1521, 1523, 1524, // [!code --]
		1525, 1526, 1522, 1528, 1529, 1530, 1531, 1527 // [!code --]
		1520, 1519, 1518, 1517, 1511, 1515, 1513, 1512, 1510, 1521, // [!code ++]
		1516, 1522, 1514, 1524, 1565, 1523, 1563, 1562, 1561, 1560, // [!code ++]
		1559, 1558, 1557, 1556, 1555, 1554, 1564, 1553, 1552, 1551, // [!code ++]
		1550, 1531, 1530, 1529, 1528, 1527, 1526, 1525 // [!code ++]
	};
}
public class Mutation : Feat
```

## Map

[`@@ -2675,9 +2675,9 @@ public void RefreshSunMap()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/Map.cs#L2675-L2683)
```cs:line-numbers=2675
		return;
	}
	sunMap.Clear();
	foreach (Trait value in EClass._map.props.installed.traits.suns.Values) // [!code --]
	foreach (Card sun in EClass._map.props.installed.traits.suns) // [!code ++]
	{
		foreach (Point item in value.ListPoints(null, onlyPassable: false)) // [!code --]
		foreach (Point item in sun.trait.ListPoints(null, onlyPassable: false)) // [!code ++]
		{
			sunMap.Add(item.index);
		}
```

## POLICY

[`@@ -3,27 +3,27 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/POLICY.cs#L3-L29)
```cs:line-numbers=3

public class POLICY
{
	public const int store_ripoff = 2816; // [!code --]
	public const int platinum_ticket = 2815; // [!code ++]

	public const int livestock_priv = 2715; // [!code --]
	public const int mass_exhibition = 2814; // [!code ++]

	public const int home_discount = 2800; // [!code --]
	public const int suite_room = 2813; // [!code ++]

	public const int open_business = 2810; // [!code --]
	public const int livestock_priv = 2715; // [!code ++]

	public const int tourist_safety = 2811;

	public const int bed_quality = 2812; // [!code --]
	public const int open_business = 2810; // [!code ++]

	public const int suite_room = 2813; // [!code --]
	public const int home_discount = 2800; // [!code ++]

	public const int mass_exhibition = 2814; // [!code --]
	public const int store_ripoff = 2816; // [!code ++]

	public const int platinum_ticket = 2815; // [!code --]
	public const int bed_quality = 2812; // [!code ++]

	public const int store_premium = 2817;

	public const int legendary_exhibition = 2823; // [!code --]
	public const int celeb = 2822; // [!code ++]

	public const int license_furniture = 2819;

```

[`@@ -31,10 +31,10 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/POLICY.cs#L31-L40)
```cs:line-numbers=31

	public const int legendary_heirloom = 2821;

	public const int celeb = 2822; // [!code --]
 // [!code --]
	public const int forcePanty = 2712;

	public const int legendary_exhibition = 2823; // [!code ++]
 // [!code ++]
	public const int license_stolen = 2824;

	public const int milk_fan = 2825;
```

[`@@ -49,12 +49,14 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/POLICY.cs#L49-L60)
```cs:line-numbers=49

	public const int incomeTransfer = 2711;

	public const int nocturnal_life = 2508; // [!code --]
	public const int self_sufficient = 2511; // [!code ++]

	public const int noAnimal = 2709;

	public const int noMother = 2710;

	public const int wealth_tax = 2500; // [!code ++]
 // [!code ++]
	public const int prohibition = 2503;

	public const int food_for_people = 2502;
```

[`@@ -65,30 +67,30 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/POLICY.cs#L65-L94)
```cs:line-numbers=65

	public const int legal_drug = 2505;

	public const int human_right = 2506; // [!code --]
	public const int inquisition = 2507; // [!code ++]

	public const int wealth_tax = 2500; // [!code --]
	public const int nocturnal_life = 2508; // [!code ++]

	public const int vaccination = 2509;

	public const int ban_radio = 2510;

	public const int self_sufficient = 2511; // [!code --]
 // [!code --]
	public const int resident_tax = 2512;

	public const int inquisition = 2507; // [!code --]
	public const int human_right = 2506; // [!code ++]

	public const int taxfree = 2514;

	public const int resident_wanted = 2513; // [!code --]
 // [!code --]
	public const int auto_farm = 2707;

	public const int resident_wanted = 2513; // [!code ++]
 // [!code ++]
	public const int demon_invocation = 2706;

	public const int taxTransfer = 2705;

	public const int noDM = 2708; // [!code ++]
 // [!code ++]
	public const int weed_no = 2703;

	public const int border_watch = 2704;
```

[`@@ -103,16 +105,14 @@ public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/POLICY.cs#L103-L118)
```cs:line-numbers=103

	public const int trash_no = 2702;

	public const int noDM = 2708; // [!code --]
 // [!code --]
	public static readonly int[] IDS = new int[51]
	{
		2816, 2715, 2800, 2810, 2811, 2812, 2813, 2814, 2815, 2817, // [!code --]
		2823, 2819, 2820, 2821, 2822, 2712, 2824, 2825, 2826, 2827, // [!code --]
		2828, 2818, 2711, 2508, 2709, 2710, 2503, 2502, 2501, 2504, // [!code --]
		2505, 2506, 2500, 2509, 2510, 2511, 2512, 2507, 2514, 2513, // [!code --]
		2707, 2706, 2705, 2703, 2704, 2701, 2700, 2516, 2515, 2702, // [!code --]
		2708 // [!code --]
		2815, 2814, 2813, 2715, 2811, 2810, 2800, 2816, 2812, 2817, // [!code ++]
		2822, 2819, 2820, 2821, 2712, 2823, 2824, 2825, 2826, 2827, // [!code ++]
		2828, 2818, 2711, 2511, 2709, 2710, 2500, 2503, 2502, 2501, // [!code ++]
		2504, 2505, 2507, 2508, 2509, 2510, 2512, 2506, 2514, 2707, // [!code ++]
		2513, 2706, 2705, 2708, 2703, 2704, 2701, 2700, 2516, 2515, // [!code ++]
		2702 // [!code ++]
	};
}
public class Policy : EClass
```

## SKILL

[`@@ -1,16 +1,14 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L1-L16)
```cs:line-numbers=1
public class SKILL
{
	public const int tactics = 132; // [!code --]
 // [!code --]
	public const int shield = 123; // [!code --]
 // [!code --]
	public const int twowield = 131;

	public const int twohand = 130;

	public const int fireproof = 50; // [!code --]
	public const int shield = 123; // [!code ++]

	public const int armorLight = 120; // [!code --]
	public const int armorHeavy = 122; // [!code ++]
 // [!code ++]
	public const int fireproof = 50; // [!code ++]

	public const int weaponBlunt = 111;

```

[`@@ -18,15 +16,17 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L18-L32)
```cs:line-numbers=18

	public const int weaponCrossbow = 109;

	public const int marksman = 133; // [!code --]
	public const int acidproof = 51; // [!code ++]

	public const int armorHeavy = 122; // [!code --]
	public const int tactics = 132; // [!code ++]

	public const int eyeofmind = 134; // [!code --]
	public const int armorLight = 120; // [!code ++]

	public const int parasite = 227; // [!code --]
	public const int marksman = 133; // [!code ++]

	public const int evasion = 150; // [!code --]
	public const int fishing = 245; // [!code ++]
 // [!code ++]
	public const int strategy = 135; // [!code ++]

	public const int climbing = 242;

```

[`@@ -40,8 +40,6 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L40-L47)
```cs:line-numbers=40

	public const int digging = 230;

	public const int acidproof = 51; // [!code --]
 // [!code --]
	public const int riding = 226;

	public const int lumberjack = 225;
```

[`@@ -58,7 +56,9 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L58-L64)
```cs:line-numbers=58

	public const int evasionPlus = 151;

	public const int strategy = 135; // [!code --]
	public const int evasion = 150; // [!code ++]
 // [!code ++]
	public const int eyeofmind = 134; // [!code ++]

	public const int PDR = 55;

```

[`@@ -66,7 +66,7 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L66-L72)
```cs:line-numbers=66

	public const int evasionPerfect = 57;

	public const int fishing = 245; // [!code --]
	public const int life = 60; // [!code ++]

	public const int mana = 61;

```

[`@@ -124,13 +124,13 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L124-L136)
```cs:line-numbers=124

	public const int weaponDagger = 107;

	public const int life = 60; // [!code --]
	public const int throwing = 108; // [!code ++]

	public const int CHA = 77;

	public const int gathering = 250;

	public const int throwing = 108; // [!code --]
	public const int parasite = 227; // [!code ++]

	public const int blacksmith = 256;

```

[`@@ -184,7 +184,7 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L184-L190)
```cs:line-numbers=184

	public const int resCut = 964;

	public const int resDecay = 970; // [!code --]
	public const int resImpact = 965; // [!code ++]

	public const int resDamage = 971;

```

[`@@ -196,7 +196,7 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L196-L202)
```cs:line-numbers=196

	public const int eleMind = 914;

	public const int resImpact = 965; // [!code --]
	public const int resDecay = 970; // [!code ++]

	public const int eleLightning = 912;

```

[`@@ -220,8 +220,6 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L220-L227)
```cs:line-numbers=220

	public const int cooking = 287;

	public const int eleDarkness = 913; // [!code --]
 // [!code --]
	public const int appraising = 289;

	public const int anatomy = 290;
```

[`@@ -238,6 +236,8 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L238-L243)
```cs:line-numbers=238

	public const int eleFire = 910;

	public const int env = 313; // [!code ++]
 // [!code ++]
	public const int disarmTrap = 293;

	public const int fun = 312;
```

[`@@ -246,7 +246,7 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L246-L252)
```cs:line-numbers=246

	public const int hygine = 310;

	public const int env = 313; // [!code --]
	public const int eleDarkness = 913; // [!code ++]

	public const int faith = 306;

```

[`@@ -258,26 +258,26 @@ public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SKILL.cs#L258-L283)
```cs:line-numbers=258

	public const int controlmana = 302;

	public const int meditation = 301; // [!code --]
 // [!code --]
	public const int memorization = 307;

	public const int meditation = 301; // [!code ++]
 // [!code ++]
	public static readonly int[] IDS = new int[131]
	{
		132, 123, 131, 130, 50, 120, 111, 110, 109, 133, // [!code --]
		122, 134, 227, 150, 242, 241, 240, 237, 235, 230, // [!code --]
		51, 226, 225, 220, 210, 207, 200, 152, 151, 135, // [!code --]
		55, 101, 57, 245, 61, 62, 64, 65, 66, 67, // [!code --]
		131, 130, 123, 122, 50, 111, 110, 109, 51, 132, // [!code ++]
		120, 133, 245, 135, 242, 241, 240, 237, 235, 230, // [!code ++]
		226, 225, 220, 210, 207, 200, 152, 151, 150, 134, // [!code ++]
		55, 101, 57, 60, 61, 62, 64, 65, 66, 67, // [!code ++]
		68, 70, 71, 72, 73, 74, 75, 56, 76, 78,
		79, 80, 90, 91, 92, 100, 102, 103, 104, 105,
		106, 107, 60, 77, 250, 108, 256, 916, 917, 918, // [!code --]
		106, 107, 108, 77, 250, 227, 256, 916, 917, 918, // [!code ++]
		919, 920, 921, 922, 923, 924, 925, 950, 951, 952,
		953, 954, 955, 956, 957, 958, 959, 960, 961, 962,
		963, 964, 970, 971, 972, 255, 915, 914, 965, 912, // [!code --]
		963, 964, 965, 971, 972, 255, 915, 914, 970, 912, // [!code ++]
		257, 258, 259, 260, 261, 280, 281, 285, 286, 287,
		913, 289, 290, 291, 292, 288, 300, 911, 910, 293, // [!code --]
		312, 311, 310, 313, 306, 305, 304, 303, 302, 301, // [!code --]
		307 // [!code --]
		289, 290, 291, 292, 288, 300, 911, 910, 313, 293, // [!code ++]
		312, 311, 310, 913, 306, 305, 304, 303, 302, 307, // [!code ++]
		301 // [!code ++]
	};
}
public class Skill : Element
```

## SLOT

[`@@ -1,40 +1,40 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SLOT.cs#L1-L40)
```cs:line-numbers=1
public class SLOT
{
	public const int waist = 37; // [!code --]
 // [!code --]
	public const int neck = 31; // [!code --]
 // [!code --]
	public const int token = 43; // [!code --]
 // [!code --]
	public const int arm = 34; // [!code --]
	public const int toolbelt = 44; // [!code ++]

	public const int torso = 32;

	public const int range = 41; // [!code --]
	public const int foot = 39; // [!code ++]

	public const int toolbelt = 44; // [!code --]
	public const int lightsource = 45; // [!code ++]

	public const int leg = 38;

	public const int foot = 39; // [!code --]
	public const int arm = 34; // [!code ++]

	public const int tool = 40; // [!code --]
	public const int waist = 37; // [!code ++]

	public const int lightsource = 45; // [!code --]
	public const int tool = 40; // [!code ++]

	public const int back = 33;

	public const int hand = 35; // [!code ++]
 // [!code ++]
	public const int neck = 31; // [!code ++]
 // [!code ++]
	public const int finger = 36;

	public const int ammo = 42; // [!code --]
	public const int range = 41; // [!code ++]

	public const int head = 30;

	public const int hand = 35; // [!code --]
	public const int ammo = 42; // [!code ++]
 // [!code ++]
	public const int token = 43; // [!code ++]

	public static readonly int[] IDS = new int[16]
	{
		37, 31, 43, 34, 32, 41, 44, 38, 39, 40, // [!code --]
		45, 33, 36, 42, 30, 35 // [!code --]
		44, 32, 39, 45, 38, 34, 37, 40, 33, 35, // [!code ++]
		31, 36, 41, 30, 42, 43 // [!code ++]
	};
}
```

## SPELL

[`@@ -1,73 +1,57 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L1-L73)
```cs:line-numbers=1
public class SPELL
{
	public const int bolt_Nether = 50306; // [!code --]
 // [!code --]
	public const int ball_Nerve = 50108; // [!code --]
 // [!code --]
	public const int ball_Nether = 50106; // [!code --]
 // [!code --]
	public const int hand_Nether = 50406; // [!code --]
 // [!code --]
	public const int arrow_Nether = 50506; // [!code --]
 // [!code --]
	public const int funnel_Nether = 50606; // [!code --]
	public const int ball_Sound = 50107; // [!code ++]

	public const int puddle_Sound = 50907; // [!code --]
	public const int puddle_Darkness = 50903; // [!code ++]

	public const int miasma_Sound = 50707; // [!code --]
	public const int bolt_Sound = 50307; // [!code ++]

	public const int hand_Sound = 50407;

	public const int miasma_Nether = 50706; // [!code --]
 // [!code --]
	public const int weapon_Nether = 50806; // [!code --]
 // [!code --]
	public const int puddle_Nether = 50906; // [!code --]
 // [!code --]
	public const int ball_Sound = 50107; // [!code --]
	public const int arrow_Sound = 50507; // [!code ++]

	public const int funnel_Sound = 50607;

	public const int arrow_Sound = 50507; // [!code --]
	public const int miasma_Sound = 50707; // [!code ++]

	public const int weapon_Sound = 50807;

	public const int bolt_Sound = 50307; // [!code --]
 // [!code --]
	public const int hand_Mind = 50404; // [!code --]
 // [!code --]
	public const int weapon_Poison = 50805; // [!code --]
	public const int ball_Nerve = 50108; // [!code ++]

	public const int bolt_Darkness = 50303; // [!code --]
	public const int weapon_Darkness = 50803; // [!code ++]

	public const int hand_Darkness = 50403; // [!code --]
	public const int ball_Holy = 50109; // [!code ++]

	public const int arrow_Darkness = 50503; // [!code --]
	public const int bolt_Nerve = 50308; // [!code ++]

	public const int funnel_Darkness = 50603; // [!code --]
	public const int hand_Nerve = 50408; // [!code ++]

	public const int miasma_Darkness = 50703; // [!code --]
	public const int arrow_Nerve = 50508; // [!code ++]

	public const int weapon_Darkness = 50803; // [!code --]
	public const int funnel_Nerve = 50608; // [!code ++]

	public const int puddle_Darkness = 50903; // [!code --]
	public const int miasma_Nerve = 50708; // [!code ++]

	public const int ball_Mind = 50104; // [!code --]
	public const int weapon_Nerve = 50808; // [!code ++]

	public const int bolt_Mind = 50304; // [!code --]
	public const int puddle_Nerve = 50908; // [!code ++]

	public const int puddle_Poison = 50905; // [!code --]
	public const int puddle_Sound = 50907; // [!code ++]

	public const int arrow_Mind = 50504; // [!code --]
	public const int puddle_Nether = 50906; // [!code ++]

	public const int miasma_Mind = 50704; // [!code --]
	public const int ball_Mind = 50104; // [!code ++]

	public const int weapon_Mind = 50804; // [!code --]
	public const int miasma_Nether = 50706; // [!code ++]

	public const int puddle_Mind = 50904;

	public const int miasma_Mind = 50704; // [!code ++]
 // [!code ++]
	public const int ball_Poison = 50105;

	public const int funnel_Mind = 50604; // [!code ++]
 // [!code ++]
	public const int bolt_Poison = 50305;

	public const int hand_Poison = 50405;
```

[`@@ -76,40 +60,46 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L76-L115)
```cs:line-numbers=76

	public const int funnel_Poison = 50605;

	public const int arrow_Mind = 50504; // [!code ++]
 // [!code ++]
	public const int miasma_Poison = 50705;

	public const int funnel_Mind = 50604; // [!code --]
	public const int hand_Mind = 50404; // [!code ++]

	public const int bolt_Nerve = 50308; // [!code --]
	public const int weapon_Poison = 50805; // [!code ++]

	public const int bolt_Ether = 50312; // [!code --]
	public const int puddle_Poison = 50905; // [!code ++]

	public const int arrow_Nerve = 50508; // [!code --]
	public const int ball_Nether = 50106; // [!code ++]

	public const int puddle_Magic = 50911; // [!code --]
	public const int bolt_Mind = 50304; // [!code ++]

	public const int ball_Ether = 50112; // [!code --]
	public const int bolt_Nether = 50306; // [!code ++]

	public const int hand_Ether = 50412; // [!code --]
	public const int hand_Nether = 50406; // [!code ++]

	public const int arrow_Ether = 50512; // [!code --]
	public const int arrow_Nether = 50506; // [!code ++]

	public const int funnel_Ether = 50612; // [!code --]
	public const int funnel_Nether = 50606; // [!code ++]

	public const int miasma_Ether = 50712; // [!code --]
	public const int weapon_Nether = 50806; // [!code ++]

	public const int weapon_Ether = 50812; // [!code --]
	public const int weapon_Mind = 50804; // [!code ++]

	public const int puddle_Ether = 50912;

	public const int hand_Holy = 50409; // [!code ++]
 // [!code ++]
	public const int miasma_Darkness = 50703; // [!code ++]
 // [!code ++]
	public const int ball_Acid = 50113;

	public const int bolt_Acid = 50313;

	public const int weapon_Magic = 50811; // [!code --]
 // [!code --]
	public const int hand_Acid = 50413;

	public const int arrow_Acid = 50513; // [!code ++]
 // [!code ++]
	public const int funnel_Acid = 50613;

	public const int miasma_Acid = 50713;
```

[`@@ -130,27 +120,29 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L130-L156)
```cs:line-numbers=130

	public const int miasma_Cut = 50714;

	public const int arrow_Acid = 50513; // [!code --]
	public const int weapon_Cut = 50814; // [!code ++]

	public const int miasma_Magic = 50711; // [!code --]
	public const int puddle_Cut = 50914; // [!code ++]

	public const int funnel_Magic = 50611; // [!code --]
	public const int ball_Impact = 50115; // [!code ++]

	public const int arrow_Magic = 50511; // [!code --]
	public const int bolt_Impact = 50315; // [!code ++]

	public const int funnel_Nerve = 50608; // [!code --]
	public const int hand_Impact = 50415; // [!code ++]

	public const int miasma_Nerve = 50708; // [!code --]
	public const int arrow_Impact = 50515; // [!code ++]

	public const int weapon_Nerve = 50808; // [!code --]
	public const int funnel_Impact = 50615; // [!code ++]

	public const int puddle_Nerve = 50908; // [!code --]
	public const int miasma_Impact = 50715; // [!code ++]

	public const int ball_Holy = 50109; // [!code --]
	public const int weapon_Ether = 50812; // [!code ++]

	public const int bolt_Holy = 50309; // [!code --]
	public const int miasma_Ether = 50712; // [!code ++]

	public const int hand_Holy = 50409; // [!code --]
	public const int funnel_Ether = 50612; // [!code ++]
 // [!code ++]
	public const int arrow_Ether = 50512; // [!code ++]

	public const int arrow_Holy = 50509;

```

[`@@ -174,9 +166,9 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L174-L182)
```cs:line-numbers=174

	public const int miasma_Chaos = 50710;

	public const int weapon_Chaos = 50810; // [!code --]
	public const int bolt_Holy = 50309; // [!code ++]

	public const int puddle_Chaos = 50910; // [!code --]
	public const int weapon_Chaos = 50810; // [!code ++]

	public const int ball_Magic = 50111;

```

[`@@ -184,15 +176,29 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L184-L198)
```cs:line-numbers=184

	public const int hand_Magic = 50411;

	public const int hand_Nerve = 50408; // [!code --]
	public const int arrow_Magic = 50511; // [!code ++]

	public const int ball_Darkness = 50103; // [!code --]
	public const int funnel_Magic = 50611; // [!code ++]

	public const int SpEarthquake = 9151; // [!code --]
	public const int miasma_Magic = 50711; // [!code ++]

	public const int weapon_Lightning = 50802; // [!code --]
	public const int weapon_Magic = 50811; // [!code ++]

	public const int SpReconstruction = 8288; // [!code --]
	public const int puddle_Magic = 50911; // [!code ++]
 // [!code ++]
	public const int ball_Ether = 50112; // [!code ++]
 // [!code ++]
	public const int bolt_Ether = 50312; // [!code ++]
 // [!code ++]
	public const int hand_Ether = 50412; // [!code ++]
 // [!code ++]
	public const int puddle_Chaos = 50910; // [!code ++]
 // [!code ++]
	public const int funnel_Darkness = 50603; // [!code ++]
 // [!code ++]
	public const int SpDrawMetal = 9502; // [!code ++]
 // [!code ++]
	public const int hand_Darkness = 50403; // [!code ++]

	public const int SpLevitate = 8300;

```

[`@@ -216,9 +222,9 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L216-L224)
```cs:line-numbers=216

	public const int SpRevive = 8430;

	public const int SpHOT = 8450; // [!code --]
	public const int SpReconstruction = 8288; // [!code ++]

	public const int SpRestoreBody = 8470; // [!code --]
	public const int SpHOT = 8450; // [!code ++]

	public const int SpRestoreMind = 8471;

```

[`@@ -238,15 +244,19 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L238-L252)
```cs:line-numbers=238

	public const int SpHero = 8504;

	public const int SpChangeMaterialG = 8286; // [!code --]
 // [!code --]
	public const int SpResEle = 8506;

	public const int SpChangeMaterial = 8285; // [!code --]
	public const int SpSpeedUp = 8510; // [!code ++]

	public const int SpFaith = 8281; // [!code --]
	public const int SpRestoreBody = 8470; // [!code ++]

	public const int weapon_Cut = 50814; // [!code --]
	public const int SpSilence = 8700; // [!code ++]
 // [!code ++]
	public const int SpChangeMaterialG = 8286; // [!code ++]
 // [!code ++]
	public const int SpChangeMaterialLesser = 8284; // [!code ++]
 // [!code ++]
	public const int weapon_Impact = 50815; // [!code ++]

	public const int ball_ = 7001;

```

[`@@ -268,9 +278,9 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L268-L276)
```cs:line-numbers=268

	public const int SpTeleportShort = 8201;

	public const int SpReturn = 8220; // [!code --]
	public const int SpChangeMaterial = 8285; // [!code ++]

	public const int SpEvac = 8221; // [!code --]
	public const int SpReturn = 8220; // [!code ++]

	public const int SpIdentify = 8230;

```

[`@@ -292,19 +302,15 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L292-L310)
```cs:line-numbers=292

	public const int SpLighten = 8280;

	public const int SpChangeMaterialLesser = 8284; // [!code --]
	public const int SpFaith = 8281; // [!code ++]

	public const int puddle_Lightning = 50902; // [!code --]
	public const int SpEvac = 8221; // [!code ++]

	public const int SpSpeedUp = 8510; // [!code --]
	public const int arrow_Darkness = 50503; // [!code ++]

	public const int SpWeakness = 8702;

	public const int SpDrawBacker = 9503; // [!code --]
 // [!code --]
	public const int ball_Fire = 50100; // [!code --]
 // [!code --]
	public const int bolt_Fire = 50300; // [!code --]
	public const int SpBane = 8706; // [!code ++]

	public const int hand_Fire = 50400;

```

[`@@ -328,9 +334,9 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L328-L336)
```cs:line-numbers=328

	public const int funnel_Cold = 50601;

	public const int miasma_Cold = 50701; // [!code --]
	public const int bolt_Fire = 50300; // [!code ++]

	public const int weapon_Cold = 50801; // [!code --]
	public const int miasma_Cold = 50701; // [!code ++]

	public const int puddle_Cold = 50901;

```

[`@@ -346,17 +352,21 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L346-L362)
```cs:line-numbers=346

	public const int miasma_Lightning = 50702;

	public const int SpDrawMetal = 9502; // [!code --]
	public const int weapon_Lightning = 50802; // [!code ++]

	public const int SpSilence = 8700; // [!code --]
	public const int puddle_Lightning = 50902; // [!code ++]

	public const int SpDrawMonster = 9501; // [!code --]
	public const int ball_Darkness = 50103; // [!code ++]

	public const int SpShutterHex = 9200; // [!code --]
	public const int bolt_Darkness = 50303; // [!code ++]
 // [!code ++]
	public const int weapon_Cold = 50801; // [!code ++]

	public const int SpWeakResEle = 8704;

	public const int SpBane = 8706; // [!code --]
	public const int ball_Fire = 50100; // [!code ++]
 // [!code ++]
	public const int SpDrawMonster = 9501; // [!code ++]

	public const int SpGravity = 8708;

```

[`@@ -380,9 +390,9 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L380-L388)
```cs:line-numbers=380

	public const int SpSummon = 9000;

	public const int SpSummonUndeadSister = 9001; // [!code --]
	public const int SpDrawBacker = 9503; // [!code ++]

	public const int SpSummonFire = 9002; // [!code --]
	public const int SpSummonUndeadSister = 9001; // [!code ++]

	public const int SpSummonTentacle = 9003;

```

[`@@ -398,35 +408,41 @@ public class SPELL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SPELL.cs#L398-L432)
```cs:line-numbers=398

	public const int SpMeteor = 9150;

	public const int SpEarthquake = 9151; // [!code ++]
 // [!code ++]
	public const int SpExterminate = 9160;

	public const int SpShutterHex = 9200; // [!code ++]
 // [!code ++]
	public const int SpWardMonster = 9500;

	public const int puddle_Cut = 50914; // [!code --]
	public const int SpSummonFire = 9002; // [!code ++]
 // [!code ++]
	public const int puddle_Impact = 50915; // [!code ++]

	public static readonly int[] IDS = new int[202] // [!code --]
	public static readonly int[] IDS = new int[210] // [!code ++]
	{
		50306, 50108, 50106, 50406, 50506, 50606, 50907, 50707, 50407, 50706, // [!code --]
		50806, 50906, 50107, 50607, 50507, 50807, 50307, 50404, 50805, 50303, // [!code --]
		50403, 50503, 50603, 50703, 50803, 50903, 50104, 50304, 50905, 50504, // [!code --]
		50704, 50804, 50904, 50105, 50305, 50405, 50505, 50605, 50705, 50604, // [!code --]
		50308, 50312, 50508, 50911, 50112, 50412, 50512, 50612, 50712, 50812, // [!code --]
		50912, 50113, 50313, 50811, 50413, 50613, 50713, 50813, 50913, 50114, // [!code --]
		50314, 50414, 50514, 50614, 50714, 50513, 50711, 50611, 50511, 50608, // [!code --]
		50708, 50808, 50908, 50109, 50309, 50409, 50509, 50609, 50709, 50809, // [!code --]
		50909, 50110, 50310, 50410, 50510, 50610, 50710, 50810, 50910, 50111, // [!code --]
		50311, 50411, 50408, 50103, 9151, 50802, 8288, 8300, 8380, 8390, // [!code --]
		8400, 8401, 8402, 8403, 8404, 8405, 8406, 8430, 8450, 8470, // [!code --]
		8471, 8480, 8490, 8491, 8500, 8501, 8502, 8503, 8504, 8286, // [!code --]
		8506, 8285, 8281, 50814, 7001, 7002, 7003, 7004, 7005, 7006, // [!code --]
		7007, 7800, 8200, 8201, 8220, 8221, 8230, 8232, 8240, 8241, // [!code --]
		8250, 8251, 8255, 8256, 8260, 8280, 8284, 50902, 8510, 8702, // [!code --]
		9503, 50100, 50300, 50400, 50500, 50600, 50700, 50800, 50900, 50101, // [!code --]
		50301, 50401, 50501, 50601, 50701, 50801, 50901, 50102, 50302, 50402, // [!code --]
		50502, 50602, 50702, 9502, 8700, 9501, 9200, 8704, 8706, 8708, // [!code --]
		8710, 8770, 8775, 8776, 8780, 8790, 8791, 8800, 8801, 9000, // [!code --]
		9001, 9002, 9003, 9004, 9005, 9006, 9007, 9050, 9150, 9160, // [!code --]
		9500, 50914 // [!code --]
		50107, 50903, 50307, 50407, 50507, 50607, 50707, 50807, 50108, 50803, // [!code ++]
		50109, 50308, 50408, 50508, 50608, 50708, 50808, 50908, 50907, 50906, // [!code ++]
		50104, 50706, 50904, 50704, 50105, 50604, 50305, 50405, 50505, 50605, // [!code ++]
		50504, 50705, 50404, 50805, 50905, 50106, 50304, 50306, 50406, 50506, // [!code ++]
		50606, 50806, 50804, 50912, 50409, 50703, 50113, 50313, 50413, 50513, // [!code ++]
		50613, 50713, 50813, 50913, 50114, 50314, 50414, 50514, 50614, 50714, // [!code ++]
		50814, 50914, 50115, 50315, 50415, 50515, 50615, 50715, 50812, 50712, // [!code ++]
		50612, 50512, 50509, 50609, 50709, 50809, 50909, 50110, 50310, 50410, // [!code ++]
		50510, 50610, 50710, 50309, 50810, 50111, 50311, 50411, 50511, 50611, // [!code ++]
		50711, 50811, 50911, 50112, 50312, 50412, 50910, 50603, 9502, 50403, // [!code ++]
		8300, 8380, 8390, 8400, 8401, 8402, 8403, 8404, 8405, 8406, // [!code ++]
		8430, 8288, 8450, 8471, 8480, 8490, 8491, 8500, 8501, 8502, // [!code ++]
		8503, 8504, 8506, 8510, 8470, 8700, 8286, 8284, 50815, 7001, // [!code ++]
		7002, 7003, 7004, 7005, 7006, 7007, 7800, 8200, 8201, 8285, // [!code ++]
		8220, 8230, 8232, 8240, 8241, 8250, 8251, 8255, 8256, 8260, // [!code ++]
		8280, 8281, 8221, 50503, 8702, 8706, 50400, 50500, 50600, 50700, // [!code ++]
		50800, 50900, 50101, 50301, 50401, 50501, 50601, 50300, 50701, 50901, // [!code ++]
		50102, 50302, 50402, 50502, 50602, 50702, 50802, 50902, 50103, 50303, // [!code ++]
		50801, 8704, 50100, 9501, 8708, 8710, 8770, 8775, 8776, 8780, // [!code ++]
		8790, 8791, 8800, 8801, 9000, 9503, 9001, 9003, 9004, 9005, // [!code ++]
		9006, 9007, 9050, 9150, 9151, 9160, 9200, 9500, 9002, 50915 // [!code ++]
	};
}
public class Spell : Ability
```

## SourceElement

[`@@ -355,7 +355,7 @@ public override void OnAfterImportData()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SourceElement.cs#L355-L361)
```cs:line-numbers=355
	}
	int num = 50000;
	int num2 = 0;
	for (int i = 910; i < 925; i++) // [!code --]
	for (int i = 910; i < 926; i++) // [!code ++]
	{
		Row ele = EClass.sources.elements.map[i];
		AddRow(ele, num + num2 + 100, "ball_");
```

## SourceManager

[`@@ -166,7 +166,7 @@ public void Init()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/SourceManager.cs#L166-L172)
```cs:line-numbers=166
	ACT.Init();
	TimeTable.Init();
	Element.ListAttackElements.Clear();
	for (int j = 910; j < 925; j++) // [!code --]
	for (int j = 910; j < 926; j++) // [!code ++]
	{
		Element.ListAttackElements.Add(EMono.sources.elements.map[j]);
	}
```

## TraitChara

[`@@ -16,7 +16,17 @@ public enum Adv_Type`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/TraitChara.cs#L16-L22)
```cs:line-numbers=16

	public virtual AI_Idle.Behaviour IdleBehaviour => AI_Idle.Behaviour.Default;

	public virtual bool CanAutoRevive => owner.isImported; // [!code --]
	public virtual bool CanAutoRevive // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			if (owner.isImported && !owner.isDestroyed) // [!code ++]
			{ // [!code ++]
				return !owner.IsGlobal; // [!code ++]
			} // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
	} // [!code ++]

	public virtual bool IsCitizen => false;

```

## TraitManager

[`@@ -68,18 +68,18 @@ public List<T> List<T>(Func<T, bool> func = null) where T : Trait`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/TraitManager.cs#L68-L85)
```cs:line-numbers=68
	List<T> list = new List<T>();
	if (func == null)
	{
		foreach (Card value in traitSet.Values) // [!code --]
		foreach (Card item in traitSet) // [!code ++]
		{
			list.Add(value.trait as T); // [!code --]
			list.Add(item.trait as T); // [!code ++]
		}
	}
	else
	{
		foreach (Card value2 in traitSet.Values) // [!code --]
		foreach (Card item2 in traitSet) // [!code ++]
		{
			if (func(value2.trait as T)) // [!code --]
			if (func(item2.trait as T)) // [!code ++]
			{
				list.Add(value2.trait as T); // [!code --]
				list.Add(item2.trait as T); // [!code ++]
			}
		}
	}
```

## TraitMannequin

[`@@ -2,6 +2,8 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/TraitMannequin.cs#L2-L7)
```cs:line-numbers=2

public class TraitMannequin : TraitItem
{
	public override bool CanStack => false; // [!code ++]
 // [!code ++]
	public override bool UseAltTiles => owner.things.Count > 0;

	public override bool CanUseFromInventory => false;
```

[`@@ -58,6 +60,7 @@ public override bool OnUse(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/TraitMannequin.cs#L58-L63)
```cs:line-numbers=58
			}
		}
	}
	owner.Dye((owner.things.Count > 0) ? owner.things[0].material : null); // [!code ++]
	SE.Equip();
	return true;
}
```

## TraitMap

[`@@ -1,44 +1,14 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/TraitMap.cs#L1-L44)
```cs:line-numbers=1
using System; // [!code --]
using System.Collections.Generic;
using System.Linq;

public class TraitMap : Dictionary<int, Trait> // [!code --]
public class TraitMap : HashSet<Card> // [!code ++]
{
	public void Add(Card c) // [!code --]
	{ // [!code --]
		Add(c.uid, c.trait); // [!code --]
	} // [!code --]
 // [!code --]
	public void Remove(Card c) // [!code --]
	{ // [!code --]
		Remove(c.uid); // [!code --]
	} // [!code --]
 // [!code --]
	public Card GetRandom() // [!code --]
	{ // [!code --]
		return this.RandomItem()?.owner; // [!code --]
	} // [!code --]
 // [!code --]
	public Card GetRandom(Func<Trait, bool> func) // [!code --]
	{ // [!code --]
		if (func == null) // [!code --]
		{ // [!code --]
			return GetRandom(); // [!code --]
		} // [!code --]
		return base.Values.Where(func).RandomItem()?.owner; // [!code --]
	} // [!code --]
 // [!code --]
	public Card GetRandomInstalled()
	{
		if (base.Count == 0)
		{
			return null;
		}
		return base.Values.Where((Trait a) => a.owner.placeState == PlaceState.installed).RandomItem()?.owner; // [!code --]
	} // [!code --]
 // [!code --]
	public bool Contains(Card c) // [!code --]
	{ // [!code --]
		return ContainsKey(c.uid); // [!code --]
		return this.Where((Card a) => a.placeState == PlaceState.installed).RandomItem(); // [!code ++]
	}
}
```

## TraitNote

[`@@ -1,5 +1,10 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/TraitNote.cs#L1-L5)
```cs:line-numbers=1
public class TraitNote : Trait
{
	public override bool CanStackTo(Thing to) // [!code ++]
	{ // [!code ++]
		return owner.c_note == to.c_note; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public override void OnCreate(int lv)
	{
		if (GetParam(1) != null)
```

## TraitSet

[`@@ -2,18 +2,8 @@`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/TraitSet.cs#L2-L19)
```cs:line-numbers=2
using System.Collections.Generic;
using System.Linq;

public class TraitSet : Dictionary<int, Card> // [!code --]
public class TraitSet : HashSet<Card> // [!code ++]
{
	public void Add(Card c) // [!code --]
	{ // [!code --]
		Add(c.uid, c); // [!code --]
	} // [!code --]
 // [!code --]
	public void Remove(Card c) // [!code --]
	{ // [!code --]
		Remove(c.uid); // [!code --]
	} // [!code --]
 // [!code --]
	public Trait GetRandom()
	{
		return this.RandomItem()?.trait;
```

[`@@ -30,11 +20,6 @@ public Trait GetRandom(Func<Card, bool> func)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/TraitSet.cs#L30-L40)
```cs:line-numbers=30
		{
			return GetRandom();
		}
		return base.Values.Where(func).RandomItem()?.trait; // [!code --]
	} // [!code --]
 // [!code --]
	public bool Contains(Card c) // [!code --]
	{ // [!code --]
		return ContainsKey(c.uid); // [!code --]
		return this.Where(func).RandomItem()?.trait; // [!code ++]
	}
}
```

## TraitToolButcher

[`@@ -6,7 +6,7 @@ public override void TrySetHeldAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/TraitToolButcher.cs#L6-L12)
```cs:line-numbers=6
{
	foreach (Chara chara in p.pos.Charas)
	{
		if (chara.IsPCParty || !chara.IsPCFaction) // [!code --]
		if (!chara.IsPCFaction || chara.IsPC) // [!code ++]
		{
			continue;
		}
```

## VirtualDate

[`@@ -54,9 +54,9 @@ public BranchMap GetBranchMap()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/956518335d9582092740d96a482d393530929e2c/Elin/VirtualDate.cs#L54-L62)
```cs:line-numbers=54
public void BuildSunMap()
{
	sunMap = new HashSet<int>();
	foreach (Trait value in EClass._map.props.installed.traits.suns.Values) // [!code --]
	foreach (Card sun in EClass._map.props.installed.traits.suns) // [!code ++]
	{
		foreach (Point item in value.ListPoints(null, onlyPassable: false)) // [!code --]
		foreach (Point item in sun.trait.ListPoints(null, onlyPassable: false)) // [!code ++]
		{
			sunMap.Add(item.index);
		}
```

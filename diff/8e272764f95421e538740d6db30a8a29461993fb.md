---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 13 files modified.
version: EA 23.238 Nightly
changes: AI_Fish/ActEffect/ActWater/CINT/COBJ/Card/CellEffect/Chara/ColorProfile/CraftUtil/EffectId/TraitDrink/WindowCharaMini
---

# EA 23.238 Nightly

November 21, 2025

13 files modified.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [CraftUtil (1)](#craftutil)
```cs:no-line-numbers
public static Thing MakeBloodMeal(Chara sucker, Chara feeder) // [!code --]
public static string GetBloodText(Chara c) // [!code ++]
```
## AI_Fish

[`public override void OnProgressComplete()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/AI_Fish.cs#L128-L134)
```cs:line-numbers=128
				}
			}
		}
		else // [!code --]
		else if (!owner.IsPCParty) // [!code ++]
		{
			foreach (Thing item in owner.things.List((Thing t) => t.source._origin == "fish"))
			{
```

## ActEffect

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1581-L1595)
```cs:line-numbers=1581
		{
			break;
		}
		int num8 = 0; // [!code --]
		int num12 = 0; // [!code ++]
		foreach (Condition condition5 in TC.conditions)
		{
			if (condition5.Type == ConditionType.Debuff)
			{
				num8++; // [!code --]
				num12++; // [!code ++]
			}
		}
		if (num8 == 0) // [!code --]
		if (num12 == 0) // [!code ++]
		{
			CC.SayNothingHappans();
			break;
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1606-L1619)
```cs:line-numbers=1606
		});
		TC.Say("abShutterHex", TC);
		Point center = CC.pos.Copy();
		List<Chara> list5 = TC.pos.ListCharasInRadius(TC, 4, (Chara c) => c == TC || c.IsHostile(CC)); // [!code --]
		for (int l = 0; l < num8; l++) // [!code --]
		List<Chara> list9 = TC.pos.ListCharasInRadius(TC, 4, (Chara c) => c == TC || c.IsHostile(CC)); // [!code ++]
		for (int m = 0; m < num12; m++) // [!code ++]
		{
			TweenUtil.Delay((float)l * 0.1f, delegate // [!code --]
			TweenUtil.Delay((float)m * 0.1f, delegate // [!code ++]
			{
				center.PlaySound("shutterhex");
			});
			foreach (Chara item5 in list5) // [!code --]
			foreach (Chara item5 in list9) // [!code ++]
			{
				if (item5.ExistsOnMap)
				{
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1622-L1633)
```cs:line-numbers=1622
					Color startColor = (componentInChildren.endColor = EClass.Colors.elementColors["eleHoly"]);
					componentInChildren.startColor = startColor;
					Point pos = item5.pos.Copy();
					TweenUtil.Delay((float)l * 0.1f, delegate // [!code --]
					TweenUtil.Delay((float)m * 0.1f, delegate // [!code ++]
					{
						effect.Play(center, 0f, pos);
					});
					int num9 = Dice.Create("SpShutterHex", power, CC, (actRef.refThing != null) ? null : actRef.act).Roll(); // [!code --]
					item5.DamageHP(num9, 919, power, AttackSource.None, CC, showEffect: false); // [!code --]
					int num13 = Dice.Create("SpShutterHex", power, CC, (actRef.refThing != null) ? null : actRef.act).Roll(); // [!code ++]
					item5.DamageHP(num13, 919, power, AttackSource.None, CC, showEffect: false); // [!code ++]
				}
			}
		}
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1681-L1706)
```cs:line-numbers=1681
			TC.Say((actRef.n1 == "money") ? "abStealNegateMoney" : "abStealNegate", TC);
			break;
		}
		Thing thing4 = null; // [!code --]
		bool flag9 = actRef.n1 == "food"; // [!code --]
		Thing thing5 = null; // [!code ++]
		bool flag7 = actRef.n1 == "food"; // [!code ++]
		if (actRef.n1 == "money")
		{
			int currency = TC.GetCurrency();
			if (currency > 0)
			{
				currency = Mathf.Clamp(EClass.rnd(currency / 10), 1, 100 + EClass.rndHalf(CC.LV * 200));
				thing4 = ThingGen.Create("money").SetNum(currency); // [!code --]
				thing5 = ThingGen.Create("money").SetNum(currency); // [!code ++]
				TC.ModCurrency(-currency);
			}
		}
		else
		{
			Func<Thing, bool> func = (Thing t) => true;
			if (flag9) // [!code --]
			if (flag7) // [!code ++]
			{
				func = (Thing t) => t.IsFood;
			}
			List<Thing> list6 = TC.things.List(delegate(Thing t) // [!code --]
			List<Thing> list5 = TC.things.List(delegate(Thing t) // [!code ++]
			{
				if (t.parentCard?.trait is TraitChestMerchant || t.trait is TraitTool || t.IsThrownWeapon)
				{
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1708-L1737)
```cs:line-numbers=1708
				}
				return t.trait.CanBeDestroyed && t.things.Count == 0 && t.invY != 1 && t.trait.CanBeStolen && !t.trait.CanOnlyCarry && !t.IsUnique && !t.isEquipped && t.blessedState == BlessedState.Normal && func(t);
			}, onlyAccessible: true);
			if (list6.Count > 0) // [!code --]
			if (list5.Count > 0) // [!code ++]
			{
				thing4 = list6.RandomItem(); // [!code --]
				if (thing4.Num > 1) // [!code --]
				thing5 = list5.RandomItem(); // [!code ++]
				if (thing5.Num > 1) // [!code ++]
				{
					thing4 = thing4.Split(1); // [!code --]
					thing5 = thing5.Split(1); // [!code ++]
				}
			}
			CC.AddCooldown(6640, 200);
		}
		if (thing4 == null) // [!code --]
		if (thing5 == null) // [!code ++]
		{
			CC.Say("abStealNothing", CC, TC);
			break;
		}
		thing4.SetInt(116, 1); // [!code --]
		TC.PlaySound(thing4.material.GetSoundDrop(thing4.sourceCard)); // [!code --]
		CC.Pick(thing4, msg: false); // [!code --]
		CC.Say("abSteal", CC, TC, thing4.Name); // [!code --]
		thing5.SetInt(116, 1); // [!code ++]
		TC.PlaySound(thing5.material.GetSoundDrop(thing5.sourceCard)); // [!code ++]
		CC.Pick(thing5, msg: false); // [!code ++]
		CC.Say("abSteal", CC, TC, thing5.Name); // [!code ++]
		if (actRef.n1 == "food")
		{
			if (CC.hunger.value != 0)
			{
				CC.InstantEat(thing4); // [!code --]
				CC.InstantEat(thing5); // [!code ++]
			}
		}
		else
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1756-L1762)
```cs:line-numbers=1756
		{
			break;
		}
		List<Thing> list9 = TC.things.List(delegate(Thing t) // [!code --]
		List<Thing> list4 = TC.things.List(delegate(Thing t) // [!code ++]
		{
			if (!t.isEquipped || t.blessedState == BlessedState.Doomed || t.IsToolbelt)
			{
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1764-L1778)
```cs:line-numbers=1764
			}
			return (t.blessedState < BlessedState.Blessed || EClass.rnd(10) == 0) ? true : false;
		});
		if (list9.Count == 0) // [!code --]
		if (list4.Count == 0) // [!code ++]
		{
			CC.SayNothingHappans();
			break;
		}
		Thing thing6 = list9.RandomItem(); // [!code --]
		TC.Say("curse_hit", TC, thing6); // [!code --]
		thing6.SetBlessedState((thing6.blessedState == BlessedState.Cursed) ? BlessedState.Doomed : BlessedState.Cursed); // [!code --]
		LayerInventory.SetDirty(thing6); // [!code --]
		Thing thing4 = list4.RandomItem(); // [!code ++]
		TC.Say("curse_hit", TC, thing4); // [!code ++]
		thing4.SetBlessedState((thing4.blessedState == BlessedState.Cursed) ? BlessedState.Doomed : BlessedState.Cursed); // [!code ++]
		LayerInventory.SetDirty(thing4); // [!code ++]
		break;
	}
	case EffectId.UncurseEQ:
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1791-L1816)
```cs:line-numbers=1791
		List<Thing> list = new List<Thing>();
		TC.things.Foreach(delegate(Thing t)
		{
			int num13 = 0; // [!code --]
			int num14 = 0; // [!code ++]
			if ((t.isEquipped || t.IsRangedWeapon || blessed) && t.blessedState < BlessedState.Normal)
			{
				if (t.blessedState == BlessedState.Cursed)
				{
					num13 = EClass.rnd(200); // [!code --]
					num14 = EClass.rnd(200); // [!code ++]
				}
				if (t.blessedState == BlessedState.Doomed)
				{
					num13 = EClass.rnd(1000); // [!code --]
					num14 = EClass.rnd(1000); // [!code ++]
				}
				if (blessed)
				{
					num13 /= 2; // [!code --]
					num14 /= 2; // [!code ++]
				}
				if (id == EffectId.UncurseEQGreater)
				{
					num13 /= 10; // [!code --]
					num14 /= 10; // [!code ++]
				}
				if (power >= num13) // [!code --]
				if (power >= num14) // [!code ++]
				{
					TC.Say("uncurseEQ_success", t);
					t.SetBlessedState(BlessedState.Normal);
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1854-L1871)
```cs:line-numbers=1854
				text3 = text4;
			}
		}
		Condition condition = Condition.Create(text3, power, delegate(Condition con) // [!code --]
		Condition condition2 = Condition.Create(text3, power, delegate(Condition con) // [!code ++]
		{
			if (!actRef.aliasEle.IsEmpty())
			{
				con.SetElement(EClass.sources.elements.alias[actRef.aliasEle].id);
			}
		});
		condition.isPerfume = TC.IsPC && actRef.isPerfume; // [!code --]
		Condition condition2 = TC.AddCondition(condition); // [!code --]
		if (condition2 != null && condition2.isPerfume) // [!code --]
		condition2.isPerfume = TC.IsPC && actRef.isPerfume; // [!code ++]
		Condition condition3 = TC.AddCondition(condition2); // [!code ++]
		if (condition3 != null && condition3.isPerfume) // [!code ++]
		{
			condition2.value = 3; // [!code --]
			condition3.value = 3; // [!code ++]
			Msg.Say("perfume", TC);
		}
		if (!text4.IsEmpty())
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1878-L1889)
```cs:line-numbers=1878
	{
		EClass.game.religions.Trickery.Talk("ability");
		bool hex = CC.IsHostile(TC);
		List<SourceStat.Row> list7 = EClass.sources.stats.rows.Where((SourceStat.Row con) => con.tag.Contains("random") && con.group == (hex ? "Debuff" : "Buff")).ToList(); // [!code --]
		List<SourceStat.Row> list6 = EClass.sources.stats.rows.Where((SourceStat.Row con) => con.tag.Contains("random") && con.group == (hex ? "Debuff" : "Buff")).ToList(); // [!code ++]
		int power2 = power;
		for (int m = 0; m < 4 + EClass.rnd(2); m++) // [!code --]
		for (int k = 0; k < 4 + EClass.rnd(2); k++) // [!code ++]
		{
			SourceStat.Row row2 = list7.RandomItem(); // [!code --]
			list7.Remove(row2); // [!code --]
			SourceStat.Row row2 = list6.RandomItem(); // [!code ++]
			list6.Remove(row2); // [!code ++]
			Proc(hex ? EffectId.DebuffKizuami : EffectId.Buff, CC, TC, power2, new ActRef
			{
				n1 = row2.alias
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L1906-L1918)
```cs:line-numbers=1906
			power = power * 2 / 3;
		}
		int a2 = power;
		int num10 = TC.WIL * (isPowerful ? 20 : 5); // [!code --]
		ConHolyVeil condition3 = TC.GetCondition<ConHolyVeil>(); // [!code --]
		if (condition3 != null) // [!code --]
		int num7 = TC.WIL * (isPowerful ? 20 : 5); // [!code ++]
		ConHolyVeil condition = TC.GetCondition<ConHolyVeil>(); // [!code ++]
		if (condition != null) // [!code ++]
		{
			num10 += condition3.power * 5; // [!code --]
			num7 += condition.power * 5; // [!code ++]
		}
		if (id != EffectId.DebuffKizuami && EClass.rnd(a2) < num10 / EClass.sources.stats.alias[n].hexPower && EClass.rnd(10) != 0) // [!code --]
		if (id != EffectId.DebuffKizuami && EClass.rnd(a2) < num7 / EClass.sources.stats.alias[n].hexPower && EClass.rnd(10) != 0) // [!code ++]
		{
			TC.Say("debuff_resist", TC);
			CC.DoHostileAction(TC);
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L2032-L2037)
```cs:line-numbers=2032
		}
		break;
	}
	case EffectId.TransBlood: // [!code ++]
	{ // [!code ++]
		tc.PlaySound("mutation"); // [!code ++]
		tc.PlayEffect("mutation"); // [!code ++]
		int num8 = ((actRef.refThing != null) ? actRef.refThing.GetInt(118) : actRef.refVal); // [!code ++]
		if (num8 == 0) // [!code ++]
		{ // [!code ++]
			num8 = tc.GetInt(118); // [!code ++]
			if (num8 == 0) // [!code ++]
			{ // [!code ++]
				num8 = EClass.game.seed + tc.uid; // [!code ++]
			} // [!code ++]
			num8++; // [!code ++]
		} // [!code ++]
		tc.Say("transBlood", tc); // [!code ++]
		tc.Talk("tail"); // [!code ++]
		tc.c_bloodData = null; // [!code ++]
		tc.SetInt(118, num8); // [!code ++]
		break; // [!code ++]
	} // [!code ++]
	case EffectId.Youth:
	{
		tc.PlaySound("mutation");
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L2109-L2124)
```cs:line-numbers=2109
		break;
	case EffectId.Revive:
	{
		List<KeyValuePair<int, Chara>> list4 = EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon && a.Value.c_wasInPcParty).ToList(); // [!code --]
		List<KeyValuePair<int, Chara>> list8 = EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon && a.Value.c_wasInPcParty).ToList(); // [!code ++]
		if (TC.IsPCFaction || TC.IsPCFactionMinion)
		{
			if (TC.IsPC && list4.Count == 0) // [!code --]
			if (TC.IsPC && list8.Count == 0) // [!code ++]
			{
				list4 = EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.CanRevive() && a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon).ToList(); // [!code --]
				list8 = EClass.game.cards.globalCharas.Where((KeyValuePair<int, Chara> a) => a.Value.CanRevive() && a.Value.isDead && a.Value.faction == EClass.pc.faction && !a.Value.isSummon).ToList(); // [!code ++]
			}
			if (list4.Count > 0) // [!code --]
			if (list8.Count > 0) // [!code ++]
			{
				list4.RandomItem().Value.Chara.GetRevived(); // [!code --]
				list8.RandomItem().Value.Chara.GetRevived(); // [!code ++]
				break;
			}
		}
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L2131-L2154)
```cs:line-numbers=2131
	case EffectId.DamageMindGreat:
	case EffectId.Weaken:
	{
		bool flag7 = id == EffectId.DamageBody || id == EffectId.DamageBodyGreat; // [!code --]
		bool mind = id == EffectId.DamageMind || id == EffectId.DamageMindGreat; // [!code --]
		int num7 = ((id == EffectId.DamageBody || id == EffectId.DamageMind) ? 1 : (4 + EClass.rnd(4))); // [!code --]
		bool flag10 = id == EffectId.DamageBody || id == EffectId.DamageBodyGreat; // [!code ++]
		bool mind2 = id == EffectId.DamageMind || id == EffectId.DamageMindGreat; // [!code ++]
		int num11 = ((id == EffectId.DamageBody || id == EffectId.DamageMind) ? 1 : (4 + EClass.rnd(4))); // [!code ++]
		if (id == EffectId.Weaken)
		{
			flag7 = EClass.rnd(2) == 0; // [!code --]
			mind = !flag7; // [!code --]
			num7 = 1; // [!code --]
			flag10 = EClass.rnd(2) == 0; // [!code ++]
			mind2 = !flag10; // [!code ++]
			num11 = 1; // [!code ++]
		}
		else
		{
			TC.PlayEffect("debuff");
			TC.PlaySound("debuff");
		}
		TC.Say(flag7 ? "damageBody" : "damageMind", TC); // [!code --]
		for (int k = 0; k < num7; k++) // [!code --]
		TC.Say(flag10 ? "damageBody" : "damageMind", TC); // [!code ++]
		for (int l = 0; l < num11; l++) // [!code ++]
		{
			TC.DamageTempElements(power, flag7, mind, id != EffectId.Weaken); // [!code --]
			TC.DamageTempElements(power, flag10, mind2, id != EffectId.Weaken); // [!code ++]
		}
		if (TC.IsPC)
		{
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L2161-L2194)
```cs:line-numbers=2161
	case EffectId.EnhanceBodyGreat:
	case EffectId.EnhanceMindGreat:
	{
		bool flag10 = id == EffectId.EnhanceBody || id == EffectId.EnhanceBodyGreat; // [!code --]
		bool mind2 = id == EffectId.EnhanceMind || id == EffectId.EnhanceMindGreat; // [!code --]
		bool flag8 = id == EffectId.EnhanceBody || id == EffectId.EnhanceBodyGreat; // [!code ++]
		bool mind = id == EffectId.EnhanceMind || id == EffectId.EnhanceMindGreat; // [!code ++]
		if (id != EffectId.EnhanceBody && id != EffectId.EnhanceMind)
		{
			EClass.rnd(4);
		}
		TC.Say(flag10 ? "enhanceBody" : "enhanceMind", TC); // [!code --]
		TC.Say(flag8 ? "enhanceBody" : "enhanceMind", TC); // [!code ++]
		TC.PlayEffect("buff");
		TC.PlaySound("buff");
		TC.EnhanceTempElements(power, flag10, mind2, onlyRenew: true); // [!code --]
		TC.EnhanceTempElements(power, flag8, mind, onlyRenew: true); // [!code ++]
		break;
	}
	case EffectId.RestoreBody:
	case EffectId.RestoreMind:
	{
		bool flag8 = id == EffectId.RestoreBody; // [!code --]
		bool flag9 = id == EffectId.RestoreBody; // [!code ++]
		if (flag)
		{
			Redirect(flag8 ? EffectId.DamageBodyGreat : EffectId.DamageMindGreat, BlessedState.Normal, default(ActRef)); // [!code --]
			Redirect(flag9 ? EffectId.DamageBodyGreat : EffectId.DamageMindGreat, BlessedState.Normal, default(ActRef)); // [!code ++]
			break;
		}
		TC.Say(flag8 ? "restoreBody" : "restoreMind", TC); // [!code --]
		TC.Say(flag9 ? "restoreBody" : "restoreMind", TC); // [!code ++]
		TC.PlaySound("heal");
		TC.PlayEffect("heal");
		TC.CureHost(flag8 ? CureType.CureBody : CureType.CureMind, power, state); // [!code --]
		TC.CureHost(flag9 ? CureType.CureBody : CureType.CureMind, power, state); // [!code ++]
		if (blessed)
		{
			Redirect(flag8 ? EffectId.EnhanceBodyGreat : EffectId.EnhanceMindGreat, BlessedState.Normal, default(ActRef)); // [!code --]
			Redirect(flag9 ? EffectId.EnhanceBodyGreat : EffectId.EnhanceMindGreat, BlessedState.Normal, default(ActRef)); // [!code ++]
		}
		break;
	}
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L2208-L2224)
```cs:line-numbers=2208
		{
			Debug.Log(actRef.act.id);
		}
		int num12 = Dice.Create((actRef.act != null && EClass.sources.calc.map.ContainsKey(actRef.act.ID)) ? actRef.act.ID : "SpHealLight", power, CC, (actRef.refThing != null) ? null : actRef.act).Roll(); // [!code --]
		int num10 = Dice.Create((actRef.act != null && EClass.sources.calc.map.ContainsKey(actRef.act.ID)) ? actRef.act.ID : "SpHealLight", power, CC, (actRef.refThing != null) ? null : actRef.act).Roll(); // [!code ++]
		if (actRef.refThing != null)
		{
			num12 = num12 * (100 + actRef.refThing.Evalue(750) * 10) / 100; // [!code --]
			num10 = num10 * (100 + actRef.refThing.Evalue(750) * 10) / 100; // [!code ++]
		}
		if (flag)
		{
			TC.DamageHP(num12 / 2, 919, power); // [!code --]
			TC.DamageHP(num10 / 2, 919, power); // [!code ++]
			break;
		}
		TC.HealHPHost(num12, (actRef.refThing == null && id != EffectId.JureHeal) ? HealSource.Magic : HealSource.Item); // [!code --]
		TC.HealHPHost(num10, (actRef.refThing == null && id != EffectId.JureHeal) ? HealSource.Magic : HealSource.Item); // [!code ++]
		TC.CureHost(CureType.Heal, power, state);
		TC.Say((power >= 300) ? "heal_heavy" : "heal_light", TC);
		break;
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L2322-L2329)
```cs:line-numbers=2322
		if (TC.HasElement(1211))
		{
			TC.Say("drinkSaltWater_snail", TC);
			int num11 = ((TC.hp > 10) ? (TC.hp - EClass.rnd(10)) : 10000); // [!code --]
			TC.DamageHP(num11, AttackSource.None, CC); // [!code --]
			int num9 = ((TC.hp > 10) ? (TC.hp - EClass.rnd(10)) : 10000); // [!code ++]
			TC.DamageHP(num9, AttackSource.None, CC); // [!code ++]
		}
		else if (TC.IsPC)
		{
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActEffect.cs#L2489-L2508)
```cs:line-numbers=2489
		{
			power /= 4;
		}
		List<Thing> list8 = TC.things.List((Thing t) => (t.Num <= 1 && t.IsEquipmentOrRanged && !t.IsToolbelt && !t.IsLightsource && t.isEquipped) ? true : false); // [!code --]
		if (list8.Count != 0) // [!code --]
		List<Thing> list7 = TC.things.List((Thing t) => (t.Num <= 1 && t.IsEquipmentOrRanged && !t.IsToolbelt && !t.IsLightsource && t.isEquipped) ? true : false); // [!code ++]
		if (list7.Count != 0) // [!code ++]
		{
			Thing thing5 = list8.RandomItem(); // [!code --]
			Thing thing6 = list7.RandomItem(); // [!code ++]
			TC.Say("acid_hit", TC);
			if (thing5.isAcidproof) // [!code --]
			if (thing6.isAcidproof) // [!code ++]
			{
				TC.Say("acid_nullify", thing5); // [!code --]
				TC.Say("acid_nullify", thing6); // [!code ++]
			}
			else if (thing5.encLV > -5) // [!code --]
			else if (thing6.encLV > -5) // [!code ++]
			{
				TC.Say("acid_rust", TC, thing5); // [!code --]
				thing5.ModEncLv(-1); // [!code --]
				LayerInventory.SetDirty(thing5); // [!code --]
				TC.Say("acid_rust", TC, thing6); // [!code ++]
				thing6.ModEncLv(-1); // [!code ++]
				LayerInventory.SetDirty(thing6); // [!code ++]
			}
			if (TC.IsPCParty)
			{
```

## ActWater

[`public override bool Perform()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActWater.cs#L20-L27)
```cs:line-numbers=20
	}
	foreach (Chara chara in Act.TP.Charas)
	{
		bool flag = false; // [!code ++]
		if (chara.HasCondition<ConBurning>())
		{
			flag = true; // [!code ++]
			chara.Talk("thanks");
		}
		else if (!chara.IsPCParty && EClass.rnd(2) == 0)
```

[`public override bool Perform()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ActWater.cs#L34-L40)
```cs:line-numbers=34
			continue;
		}
		chara.AddCondition<ConWet>();
		Act.CC.DoHostileAction(chara); // [!code --]
		if (!flag) // [!code ++]
		{ // [!code ++]
			Act.CC.DoHostileAction(chara); // [!code ++]
		} // [!code ++]
	}
	Act.CC.PlaySound("water_farm");
	waterCan.owner.ModCharge(-1);
```

## CINT

[`public class CINT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/CINT.cs#L148-L153)
```cs:line-numbers=148

	public const int godEaten = 117;

	public const int seedBlood = 118; // [!code ++]
 // [!code ++]
	public const int isTrained = 120;

	public const int isPrayed = 121;
```

## COBJ

[`public class COBJ`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/COBJ.cs#L35-L38)
```cs:line-numbers=35
	public const int socketList = 17;

	public const int mixedFoodData = 18;
 // [!code ++]
	public const int bloodData = 19; // [!code ++]
}
```

## Card

[`public MixedFoodData c_mixedFoodData`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/Card.cs#L1913-L1918)
```cs:line-numbers=1913
		}
	}

	public Thing c_bloodData // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			return GetObj<Thing>(19); // [!code ++]
		} // [!code ++]
		set // [!code ++]
		{ // [!code ++]
			SetObj(19, value); // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public byte[] c_textureData
	{
		get
```

## CellEffect

[`public int idEle`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/CellEffect.cs#L118-L123)
```cs:line-numbers=118
		}
	}

	public int refVal // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			return ints[7]; // [!code ++]
		} // [!code ++]
		set // [!code ++]
		{ // [!code ++]
			ints[7] = value; // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public string n1
	{
		get
```

## Chara

[`void ProcEffect()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/Chara.cs#L4195-L4201)
```cs:line-numbers=4195
			ActEffect.ProcAt(e.idEffect, e.power, e.isBlessed ? BlessedState.Blessed : (e.isCursed ? BlessedState.Cursed : BlessedState.Normal), this, this, new Point(pos), e.isHostileAct, new ActRef
			{
				aliasEle = EClass.sources.elements.map[e.idEle].alias,
				n1 = e.n1 // [!code --]
				n1 = e.n1, // [!code ++]
				refVal = e.refVal // [!code ++]
			});
			ClearEffect();
		}
```

[`public override string GetHoverText()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/Chara.cs#L6743-L6748)
```cs:line-numbers=6743
		{
			text2 += ("(" + faith.Name + ")").TagSize(14);
		}
		if (EClass.pc.HasElement(1250)) // [!code ++]
		{ // [!code ++]
			s += CraftUtil.GetBloodText(this).TagSize(14).TagColor(EClass.Colors.colorBlood); // [!code ++]
		} // [!code ++]
		return text + text2 + s;
	}

```

[`public bool CanBloom()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/Chara.cs#L8529-L8535)
```cs:line-numbers=8529
	{
		return false;
	}
	if (!EClass.debug.enable) // [!code --]
	if (!EClass.debug.godMode) // [!code ++]
	{
		if (base.c_daysWithPC > 360)
		{
```

## ColorProfile

[`public class PCLights`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/ColorProfile.cs#L140-L145)
```cs:line-numbers=140

	public Color colorHostile;

	public Color colorBlood; // [!code ++]
 // [!code ++]
	public Color colorBuff;

	public Color colorDebuff;
```

## CraftUtil

[`void SetSeed()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/CraftUtil.cs#L114-L140)
```cs:line-numbers=114
		}
	}

	public static Thing MakeBloodMeal(Chara sucker, Chara feeder) // [!code --]
	public static string GetBloodText(Chara c) // [!code ++]
	{
		Rand.SetSeed(EClass.game.seed + feeder.uid); // [!code --]
		Thing thing = ThingGen.CreateFromCategory("meal", 100); // [!code --]
		sucker.Say("food_blood", thing); // [!code --]
		MakeDish(thing, 100, null, EClass.game.seed + feeder.uid); // [!code --]
		if (thing.HasElement(709)) // [!code --]
		string text = ""; // [!code ++]
		List<Element> list = MakeBloodMeal(EClass.pc, c, msg: false).elements.ListElements((Element e) => e.IsFoodTraitMain, (Element a, Element b) => b.Value - a.Value); // [!code ++]
		int num = Mathf.Min(list.Count(), 3, EClass.debug.godMode ? 3 : (1 + EClass.pc.Evalue(6607) / 15)); // [!code ++]
		for (int i = 0; i < num; i++) // [!code ++]
		{ // [!code ++]
			Element element = list[i]; // [!code ++]
			string[] textArray = element.source.GetTextArray("textAlt"); // [!code ++]
			int num2 = Mathf.Clamp(element.Value / 10 + 1, (element.Value < 0 || textArray.Length <= 2) ? 1 : 2, textArray.Length - 1); // [!code ++]
			string text2 = textArray[num2]; // [!code ++]
			if (i != 0) // [!code ++]
			{ // [!code ++]
				text += ", "; // [!code ++]
			} // [!code ++]
			text += text2; // [!code ++]
		} // [!code ++]
		if (!text.IsEmpty()) // [!code ++]
		{
			thing.elements.Remove(709); // [!code --]
			text = " (" + text + ")"; // [!code ++]
		}
		if (thing.HasElement(708)) // [!code --]
		return text; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public static Thing MakeBloodMeal(Chara sucker, Chara feeder, bool msg = true) // [!code ++]
	{ // [!code ++]
		Thing c_bloodData = feeder.c_bloodData; // [!code ++]
		if (c_bloodData == null) // [!code ++]
		{
			thing.elements.Remove(708); // [!code --]
			int seed = ((feeder.GetInt(118) == 0) ? (EClass.game.seed + feeder.uid) : feeder.GetInt(118)); // [!code ++]
			Rand.SetSeed(seed); // [!code ++]
			c_bloodData = ThingGen.CreateFromCategory("meal", 100); // [!code ++]
			if (msg) // [!code ++]
			{ // [!code ++]
				sucker.Say("food_blood", c_bloodData); // [!code ++]
			} // [!code ++]
			MakeDish(c_bloodData, 100, null, seed); // [!code ++]
			c_bloodData.elements.SetTo(709, 0); // [!code ++]
			c_bloodData.elements.SetTo(708, 0); // [!code ++]
			c_bloodData.elements.SetTo(701, 0); // [!code ++]
			feeder.c_bloodData = c_bloodData.Duplicate(1); // [!code ++]
		}
		if (thing.HasElement(701)) // [!code --]
		else // [!code ++]
		{
			thing.elements.Remove(701); // [!code --]
			c_bloodData = c_bloodData.Duplicate(1); // [!code ++]
			if (msg) // [!code ++]
			{ // [!code ++]
				sucker.Say("food_blood", c_bloodData); // [!code ++]
			} // [!code ++]
		}
		thing.elements.ModBase(710, 20 + (int)Mathf.Min(Mathf.Sqrt(sucker.Evalue(6607) + Mathf.Max(sucker.LER, 0)), 50f)); // [!code --]
		thing.elements.SetTo(2, Mathf.Min(EClass.curve(feeder.LV, 30, 10, 65), 200)); // [!code --]
		return thing; // [!code --]
		c_bloodData.elements.SetTo(2, Mathf.Min(EClass.curve(feeder.LV, 30, 10, 65), 200)); // [!code ++]
		c_bloodData.elements.ModBase(710, 15 + (int)Mathf.Min(Mathf.Sqrt(sucker.Evalue(6607) + Mathf.Max(sucker.LER, 0)), 50f)); // [!code ++]
		return c_bloodData; // [!code ++]
	}

	public static Thing MakeBloodSample(Chara sucker, Chara feeder)
```

[`public static Thing MakeBloodSample(Chara sucker, Chara feeder)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/CraftUtil.cs#L148-L153)
```cs:line-numbers=148
		thing2.elements.SetTo(10, 0);
		thing2.MakeRefFrom(feeder);
		thing2.c_idRefCard = thing.id;
		thing2.SetInt(118, EClass.game.seed + feeder.uid); // [!code ++]
		return thing2;
	}

```

[`public static Card MixIngredients(Card product, List<Thing> ings, MixType type,`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/CraftUtil.cs#L369-L374)
```cs:line-numbers=369
				int value = ing.GetValue();
				num2 += value;
			}
			if (product.id == "1300" && product.GetInt(118) == 0) // [!code ++]
			{ // [!code ++]
				product.SetInt(118, ing.GetInt(118)); // [!code ++]
				product.c_idRefCard = ing.c_idRefCard; // [!code ++]
			} // [!code ++]
		}
	}
	if (isFood)
```

## EffectId

[`public enum EffectId`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/EffectId.cs#L132-L136)
```cs:line-numbers=132
	Rocket = 308,
	StripBlessing = 309,
	Flare = 310,
	GravityGun = 311 // [!code --]
	GravityGun = 311, // [!code ++]
	TransBlood = 312 // [!code ++]
}
```

## TraitDrink

[`public override void OnThrowGround(Chara c, Point p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/TraitDrink.cs#L183-L189)
```cs:line-numbers=183
	if (IdEffect != EffectId.Drink)
	{
		bool isHostileAct = c.IsPCParty && IsNeg;
		EClass._map.SetLiquid(p.x, p.z, new CellEffect // [!code --]
		CellEffect cellEffect = new CellEffect // [!code ++]
		{
			id = 4,
			idEffect = IdEffect,
```

[`public override void OnThrowGround(Chara c, Point p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/TraitDrink.cs#L195-L201)
```cs:line-numbers=195
			n1 = N1,
			isBlessed = (owner.blessedState >= BlessedState.Blessed),
			isCursed = (owner.blessedState <= BlessedState.Cursed)
		}); // [!code --]
		}; // [!code ++]
		if (IdEffect == EffectId.TransBlood) // [!code ++]
		{ // [!code ++]
			cellEffect.refVal = owner.GetInt(118); // [!code ++]
		} // [!code ++]
		EClass._map.SetLiquid(p.x, p.z, cellEffect); // [!code ++]
	}
	else
	{
```

## WindowCharaMini

[`using System;`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/WindowCharaMini.cs#L1-L3)
```cs:line-numbers=1
using System; // [!code ++]
using System.Linq;
using UnityEngine;

```

[`public void Refresh(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/8e272764f95421e538740d6db30a8a29461993fb/Elin/WindowCharaMini.cs#L193-L199)
```cs:line-numbers=193
		note.SetActive(enable: true);
		note.AddText("feat_pet".lang(chara.feat.ToString() ?? "", num.ToString() ?? ""));
		note.AddText("feat_inferior".lang(chara.CurrentGeneSlot.ToString() ?? "", chara.MaxGeneSlot.ToString() ?? "", ((genes != null) ? genes.inferior : 0).ToString() ?? ""));
		note.AddText((chara.isScaled ? "feat_pet_type2" : "feat_pet_type1").lang()); // [!code --]
		HintIcon componentInChildren = note.AddText("NoteText_with_hint", (chara.isScaled ? "feat_pet_type2" : "feat_pet_type1").lang()).GetComponentInChildren<HintIcon>(); // [!code ++]
		string text = (chara.isScaled ? "feat_pet_type2_hint" : "feat_pet_type1_hint").lang(); // [!code ++]
		if (!chara.isScaled && !chara.HasElement(1273)) // [!code ++]
		{ // [!code ++]
			text = text + Environment.NewLine + (chara.CanBloom() ? "petawaken2" : "petawaken1").lang(); // [!code ++]
		} // [!code ++]
		componentInChildren.tooltip.lang = text; // [!code ++]
		note.Space(8);
		foreach (CharaUpgrade.Item item6 in upgrades.items)
		{
```

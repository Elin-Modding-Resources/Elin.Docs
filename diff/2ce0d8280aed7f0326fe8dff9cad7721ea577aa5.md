---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 17 files modified. 1 new file created.
version: EA 23.269 Nightly Patch 2
changes: AI_Eat/Card/Chara/CharaGenes/CoreDebug/DNA/ELEMENT/FEAT/FoodEffect/InvOwnerGene/POLICY/SKILL/TraitBook/+TraitCoreUser/TraitGene/TraitParchmentBottle/WindowChara/WindowCharaMini
---

# EA 23.269 Nightly Patch 2

February 11, 2026

17 files modified. 1 new file created.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [CharaGenes (1)](#charagenes)
```cs:no-line-numbers
public void Remove(Chara c, DNA item) // [!code --]
public static void Remove(Chara c, DNA item) // [!code ++]
```
## AI_Eat

[`public override bool IsHostileAct`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/AI_Eat.cs#L23-L29)
```cs:line-numbers=23

	public bool IsValidTarget(Card c)
	{
		return c?.trait.CanEat(owner) ?? false; // [!code --]
		if (c != null) // [!code ++]
		{ // [!code ++]
			if (!c.trait.CanEat(owner)) // [!code ++]
			{ // [!code ++]
				if (c.trait is TraitGene && owner.IsPC) // [!code ++]
				{ // [!code ++]
					return owner.HasElement(1274); // [!code ++]
				} // [!code ++]
				return false; // [!code ++]
			} // [!code ++]
			return true; // [!code ++]
		} // [!code ++]
		return false; // [!code ++]
	}

	public override bool CanManualCancel()
```

## Card

[`public void DamageHP(long dmg, int ele, int eleP = 100, AttackSource attackSourc`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/Card.cs#L4714-L4720)
```cs:line-numbers=4714
					{
						ele2 = 922;
					}
					Say("reflect_thorne", this, origin); // [!code --]
					Say("reflect_thorne", origin, this); // [!code ++]
					origin.DamageHP((int)Mathf.Clamp(dmg / 10, 1f, MaxHP / (origin.IsPowerful ? 200 : 20)), ele2, Power, AttackSource.Condition, this);
				}
				if (HasElement(1223) && num14 <= Evalue(1223))
```

## Chara

[`public bool IsWealthy`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/Chara.cs#L1069-L1074)
```cs:line-numbers=1069

	public int MaxGeneSlot => race.geneCap - (HasElement(1237) ? 2 : 0) + Evalue(1242) + Evalue(1273);

	public int GeneCostMTP // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			if (!IsPC) // [!code ++]
			{ // [!code ++]
				return 100; // [!code ++]
			} // [!code ++]
			return 20; // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public int CurrentGeneSlot
	{
		get
```

[`public void Cuddle(Chara c, bool headpat = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/Chara.cs#L6271-L6277)
```cs:line-numbers=6271
		{
			ele = 922;
		}
		Say("reflect_thorne", c, this); // [!code --]
		Say("reflect_thorne", this, c); // [!code ++]
		DamageHP(10L, ele, Power, AttackSource.Condition);
	}
}
```

## CharaGenes

[`public class CharaGenes : EClass`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/CharaGenes.cs#L9-L20)
```cs:line-numbers=9
	[JsonProperty]
	public int inferior;

	public void Remove(Chara c, DNA item) // [!code --]
	public static void Remove(Chara c, DNA item) // [!code ++]
	{
		items.Remove(item); // [!code --]
		c.feat += item.cost; // [!code --]
		item.Apply(c, reverse: true); // [!code --]
		c.Refresh(); // [!code --]
		if (c.c_genes != null) // [!code ++]
		{ // [!code ++]
			c.c_genes.items.Remove(item); // [!code ++]
			c.feat += item.cost * c.GeneCostMTP / 100; // [!code ++]
			item.Apply(c, reverse: true); // [!code ++]
			c.Refresh(); // [!code ++]
			c.RemoveAllStances(); // [!code ++]
			Msg.Say("dna_loss", c, item.GetText()); // [!code ++]
		} // [!code ++]
	}

	public int GetTotalCost()
```

## CoreDebug

[`public void UpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/CoreDebug.cs#L954-L966)
```cs:line-numbers=954
	}
	if (Input.GetKeyDown(KeyCode.F2))
	{
		if (Input.GetKey(KeyCode.LeftShift)) // [!code --]
		{ // [!code --]
			Net.SendBook("test", "msg", BookCategory.Bottle, Lang.langCode, "msg2", "msg3", "msg4"); // [!code --]
		} // [!code --]
		else // [!code --]
		{ // [!code --]
			RefreshChat(); // [!code --]
		EClass._zone.development += 10; // [!code ++]
		EClass._zone.development *= EClass._zone.development; // [!code ++]
		Chara targetChara = EClass.scene.mouseTarget.TargetChara; // [!code ++]
		if (targetChara != null) // [!code ++]
		{ // [!code ++]
			EClass.pc.Pick(targetChara.MakeEgg(effect: true, 10)); // [!code ++]
			EClass.pc.Pick(targetChara.MakeGene()); // [!code ++]
			TraitFoodEggFertilized.Incubate(targetChara.MakeEgg(effect: false, 1, addToZone: false, 100), targetChara.pos.GetNearestPoint(allowBlock: false, allowChara: false)); // [!code ++]
			targetChara.ScaleByPrincipal(); // [!code ++]
		} // [!code ++]
		if (EClass.game.quests.Get<QuestDebt>() == null) // [!code ++]
		{ // [!code ++]
			Chara chara = CharaGen.Create("loytel"); // [!code ++]
			EClass._zone.AddCard(chara, EClass.pc.pos); // [!code ++]
			chara.SetGlobal(); // [!code ++]
			Quest q = EClass.game.quests.Add("debt", "loytel"); // [!code ++]
			EClass.game.quests.Start(q); // [!code ++]
			EClass.pc.party.RemoveMember(chara); // [!code ++]
			Hostility hostility2 = (chara.c_originalHostility = Hostility.Ally); // [!code ++]
			chara.hostility = hostility2; // [!code ++]
		}
		return;
	}
```

[`public void UpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/CoreDebug.cs#L1429-L1439)
```cs:line-numbers=1429
		{
			card.renderer.PlayAnime(AnimeID.Attack, animeDest);
		}
		static async void RefreshChat() // [!code --]
		{ // [!code --]
			List<Net.BookData> list2 = await Net.GetBook(BookCategory.Bottle, Lang.langCode); // [!code --]
			Debug.Log(list2[0].name + "/" + list2[0].msg + "/" + list2[0].msg2 + "/" + list2[0].msg3 + "/" + list2[0].msg4); // [!code --]
		} // [!code --]
	}

	public void InitDebugCommands()
```

## DNA

[`public void Apply(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/DNA.cs#L187-L193)
```cs:line-numbers=187
		c.c_genes.inferior++;
		return;
	}
	c.feat -= cost; // [!code --]
	c.feat -= cost * c.GeneCostMTP / 100; // [!code ++]
	Apply(c, reverse: false);
	c_genes.items.Add(this);
}
```

[`public void Apply(Chara c, bool reverse)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/DNA.cs#L216-L221)
```cs:line-numbers=216
				c.body.AddBodyPart(row.id);
			}
			c.body.RefreshBodyParts();
			if (c.IsPC && (bool)WidgetEquip.Instance) // [!code ++]
			{ // [!code ++]
				WidgetEquip.Instance.Rebuild(); // [!code ++]
			} // [!code ++]
			break;
		case "feat":
			c.SetFeat(num, c.elements.ValueWithoutLink(num) + ((!reverse) ? 1 : (-1)), !reverse);
```

[`public void WriteNote(UINote n)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/DNA.cs#L626-L636)
```cs:line-numbers=626
		}
	}

	public void WriteNoteExtra(UINote n, Chara tg) // [!code ++]
	{ // [!code ++]
		n.AddHeader("HeaderAdditionalTrait", "gene_hint"); // [!code ++]
		_ = tg.c_genes; // [!code ++]
		int num = slot; // [!code ++]
		if (num > 1 && tg.HasElement(1237)) // [!code ++]
		{ // [!code ++]
			num--; // [!code ++]
		} // [!code ++]
		int num2 = tg.MaxGeneSlot - tg.CurrentGeneSlot; // [!code ++]
		int num3 = num2 - num; // [!code ++]
		int maxGeneSlot = tg.MaxGeneSlot; // [!code ++]
		n.AddText("gene_hint_slot".lang(num2.ToString() ?? "", num3.ToString() ?? "", maxGeneSlot.ToString() ?? ""), (num3 >= 0) ? FontColor.Good : FontColor.Bad); // [!code ++]
		int num4 = cost * tg.GeneCostMTP / 100; // [!code ++]
		int num5 = tg.feat - num4; // [!code ++]
		n.AddText("gene_hint_cost".lang(tg.feat.ToString() ?? "", num4 + ((num4 == cost) ? "" : ("(" + cost + ")")), num5.ToString() ?? ""), (num5 >= 0) ? FontColor.Good : FontColor.Bad); // [!code ++]
	} // [!code ++]
 // [!code ++]
	public Element GetInvalidFeat(Chara c)
	{
		for (int i = 0; i < vals.Count; i += 2)
		{
			Element element = Element.Create(vals[i], vals[i + 1]);
			if (c.IsPC && element.id == 1415) // [!code ++]
			{ // [!code ++]
				return element; // [!code ++]
			} // [!code ++]
			if (!(element.source.category == "feat"))
			{
				continue;
```

## ELEMENT

[`public void AddEncNote(UINote n, Card Card, ElementContainer.NoteMode mode = Ele`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/ELEMENT.cs#L902-L907)
```cs:line-numbers=902
		{
			color = FontColor.FoodQuality;
		}
		if (id == 484 && owner != null && owner.Card != null && owner.Card.CountRune(countFree: false) >= owner.Card.MaxRune()) // [!code ++]
		{ // [!code ++]
			color = FontColor.Gray; // [!code ++]
		} // [!code ++]
		if (funcText != null)
		{
			text = funcText(this, text);
```

## FEAT

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L5-L43)
```cs:line-numbers=5
{
	public const int featUnderground = 1226;

	public const int featRapidArrow = 1652; // [!code --]
	public const int featFaith = 1636; // [!code ++]

	public const int featMagicManner = 1651; // [!code --]
	public const int featAnimalLover = 1640; // [!code ++]

	public const int featGourmet = 1650; // [!code --]
	public const int featResCurse = 1641; // [!code ++]

	public const int featDefender = 1649; // [!code --]
	public const int featSleeper = 1642; // [!code ++]

	public const int featRapidMagic = 1648; // [!code --]
	public const int featSorter = 1643; // [!code ++]

	public const int featSummoner = 1647; // [!code --]
	public const int featBodyParts = 1644; // [!code ++]

	public const int featLonelySoul = 1646; // [!code --]
	public const int featMartial = 1635; // [!code ++]

	public const int featParty = 1645;

	public const int featBodyParts = 1644; // [!code --]
	public const int featSummoner = 1647; // [!code ++]

	public const int featSorter = 1643; // [!code --]
	public const int featRapidMagic = 1648; // [!code ++]

	public const int featSleeper = 1642; // [!code --]
	public const int featDefender = 1649; // [!code ++]

	public const int featResCurse = 1641; // [!code --]
	public const int featGourmet = 1650; // [!code ++]

	public const int featAnimalLover = 1640; // [!code --]
	public const int featMagicManner = 1651; // [!code ++]

	public const int featFaith = 1636; // [!code --]
	public const int featRapidArrow = 1652; // [!code ++]

	public const int featMartial = 1635; // [!code --]
	public const int featLonelySoul = 1646; // [!code ++]
 // [!code ++]
	public const int featDreamWaker = 1653; // [!code ++]

	public const int featNegotiate = 1634;

	public const int featSpotting = 1633; // [!code --]
	public const int featEvade = 1632; // [!code ++]
 // [!code ++]
	public const int featMana = 1611; // [!code ++]

	public const int featStamina = 1612;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L49-L59)
```cs:line-numbers=49

	public const int featPER = 1623;

	public const int featLER = 1624; // [!code --]
	public const int featSpotting = 1633; // [!code ++]

	public const int featDreamWaker = 1653; // [!code --]
	public const int featLER = 1624; // [!code ++]

	public const int featMAG = 1625; // [!code --]
	public const int featWIL = 1626; // [!code ++]

	public const int featCHA = 1627;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L65-L78)
```cs:line-numbers=65

	public const int featDefense = 1631;

	public const int featEvade = 1632; // [!code --]
	public const int featMAG = 1625; // [!code ++]

	public const int featWIL = 1626; // [!code --]
	public const int featLife = 1610; // [!code ++]

	public const int featHeavyCasting = 1654;

	public const int featModelBeliever = 1655; // [!code --]
 // [!code --]
	public const int featScavenger = 1656;

	public const int featFairyResist = 1212;
```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L105-L111)
```cs:line-numbers=105

	public const int featCannibalism = 1205;

	public const int featMana = 1611; // [!code --]
	public const int featModelBeliever = 1655; // [!code ++]

	public const int featManaPrecision = 1214;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L141-L151)
```cs:line-numbers=141

	public const int featAcidBody = 1223;

	public const int featLife = 1610; // [!code --]
	public const int featNeckHunter = 1426; // [!code ++]

	public const int featShiva = 1224;

	public const int featGod_trickery1 = 1345; // [!code --]
	public const int featGod_oblivion1 = 1340; // [!code ++]
 // [!code ++]
	public const int featPianist = 1405; // [!code ++]

	public const int featTourist = 1406;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L179-L193)
```cs:line-numbers=179

	public const int featManaMeat = 1421;

	public const int featHealer = 1422; // [!code --]
 // [!code --]
	public const int featPianist = 1405; // [!code --]
	public const int featArcher = 1404; // [!code ++]

	public const int featPeaky = 1423; // [!code --]
	public const int featHealer = 1422; // [!code ++]

	public const int featArcher = 1404; // [!code --]
	public const int featFarmer = 1403; // [!code ++]

	public const int featWizard = 1402; // [!code --]
	public const int featThief = 1401; // [!code ++]

	public const int featBadKarma = 1271;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L195-L200)
```cs:line-numbers=195

	public const int featBloom = 1273;

	public const int featSlimeEvolution = 1274; // [!code ++]
 // [!code ++]
	public const int featGoddess = 1290;

	public const int featGod_element1 = 1300;
```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L213-L219)
```cs:line-numbers=213

	public const int featGod_harmony1 = 1335;

	public const int featGod_oblivion1 = 1340; // [!code --]
	public const int featGod_trickery1 = 1345; // [!code ++]

	public const int featGod_moonshadow1 = 1350;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L221-L233)
```cs:line-numbers=221

	public const int featWarrior = 1400;

	public const int featThief = 1401; // [!code --]
 // [!code --]
	public const int featFarmer = 1403; // [!code --]
	public const int featWizard = 1402; // [!code ++]

	public const int featGoodKarma = 1270;

	public const int featElite = 1424; // [!code --]
	public const int featPeaky = 1423; // [!code ++]

	public const int featAshborn = 1251;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L237-L243)
```cs:line-numbers=237

	public const int featNorland = 1236;

	public const int featNeckHunter = 1426; // [!code --]
	public const int featMimic = 1425; // [!code ++]

	public const int featLightEater = 1235;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L257-L263)
```cs:line-numbers=257

	public const int featServant = 1227;

	public const int featMimic = 1425; // [!code --]
	public const int featElite = 1424; // [!code ++]

	public const int featAquatic = 1252;

```

[`public class FEAT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FEAT.cs#L285-L307)
```cs:line-numbers=285

	public const int featMassSummoner = 1240;

	public static readonly int[] IDS = new int[141] // [!code --]
	public static readonly int[] IDS = new int[142] // [!code ++]
	{
		1226, 1652, 1651, 1650, 1649, 1648, 1647, 1646, 1645, 1644, // [!code --]
		1643, 1642, 1641, 1640, 1636, 1635, 1634, 1633, 1612, 1620, // [!code --]
		1621, 1622, 1623, 1624, 1653, 1625, 1627, 1628, 1629, 1630, // [!code --]
		1631, 1632, 1626, 1654, 1655, 1656, 1212, 1211, 1210, 1209, // [!code --]
		1208, 1207, 1213, 1206, 1204, 1203, 1202, 1201, 1200, 1225, // [!code --]
		1205, 1611, 1214, 1216, 1657, 1658, 1659, 1660, 1661, 1662, // [!code --]
		1215, 1750, 1222, 1221, 1220, 1219, 1218, 1217, 1223, 1610, // [!code --]
		1224, 1345, 1406, 1407, 1408, 1409, 1410, 1411, 1412, 1413, // [!code --]
		1414, 1415, 1416, 1417, 1418, 1419, 1420, 1421, 1422, 1405, // [!code --]
		1423, 1404, 1402, 1271, 1272, 1273, 1290, 1300, 1305, 1310, // [!code --]
		1315, 1320, 1325, 1330, 1335, 1340, 1350, 1355, 1400, 1401, // [!code --]
		1403, 1270, 1424, 1251, 1238, 1237, 1236, 1426, 1235, 1234, // [!code --]
		1233, 1232, 1231, 1230, 1229, 1228, 1227, 1425, 1252, 1239, // [!code --]
		1250, 1249, 1248, 1247, 1246, 1245, 1244, 1243, 1242, 1241, // [!code --]
		1240 // [!code --]
		1226, 1636, 1640, 1641, 1642, 1643, 1644, 1635, 1645, 1647, // [!code ++]
		1648, 1649, 1650, 1651, 1652, 1646, 1653, 1634, 1632, 1611, // [!code ++]
		1612, 1620, 1621, 1622, 1623, 1633, 1624, 1626, 1627, 1628, // [!code ++]
		1629, 1630, 1631, 1625, 1610, 1654, 1656, 1212, 1211, 1210, // [!code ++]
		1209, 1208, 1207, 1213, 1206, 1204, 1203, 1202, 1201, 1200, // [!code ++]
		1225, 1205, 1655, 1214, 1216, 1657, 1658, 1659, 1660, 1661, // [!code ++]
		1662, 1215, 1750, 1222, 1221, 1220, 1219, 1218, 1217, 1223, // [!code ++]
		1426, 1224, 1340, 1405, 1406, 1407, 1408, 1409, 1410, 1411, // [!code ++]
		1412, 1413, 1414, 1415, 1416, 1417, 1418, 1419, 1420, 1421, // [!code ++]
		1404, 1422, 1403, 1401, 1271, 1272, 1273, 1274, 1290, 1300, // [!code ++]
		1305, 1310, 1315, 1320, 1325, 1330, 1335, 1345, 1350, 1355, // [!code ++]
		1400, 1402, 1270, 1423, 1251, 1238, 1237, 1236, 1425, 1235, // [!code ++]
		1234, 1233, 1232, 1231, 1230, 1229, 1228, 1227, 1424, 1252, // [!code ++]
		1239, 1250, 1249, 1248, 1247, 1246, 1245, 1244, 1243, 1242, // [!code ++]
		1241, 1240 // [!code ++]
	};
}
public class Feat : Element
```

## FoodEffect

[`public static void Proc(Chara c, Thing food, bool consume = true)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/FoodEffect.cs#L398-L416)
```cs:line-numbers=398
				food.ModNum(-1);
			}
		}
		if (c2.IsCat || !(food.trait is TraitFoodChuryu)) // [!code --]
		if (!c2.IsCat && food.trait is TraitFoodChuryu) // [!code ++]
		{ // [!code ++]
			foreach (Chara item in c2.pos.ListCharasInRadius(c2, 5, (Chara c) => c.IsCat)) // [!code ++]
			{ // [!code ++]
				item.Say("angry", item); // [!code ++]
				item.ShowEmo(Emo.angry); // [!code ++]
				item.PlaySound("Animal/Cat/cat_angry"); // [!code ++]
				if (c2.IsPC) // [!code ++]
				{ // [!code ++]
					EClass.player.ModKarma(-3); // [!code ++]
				} // [!code ++]
			} // [!code ++]
		} // [!code ++]
		if (!(food.trait is TraitGene) || !c2.IsPC || !c2.HasElement(1274)) // [!code ++]
		{
			return;
		}
		foreach (Chara item in c2.pos.ListCharasInRadius(c2, 5, (Chara c) => c.IsCat)) // [!code --]
		DNA c_DNA = food.c_DNA; // [!code ++]
		int slot = c_DNA.slot; // [!code ++]
		CharaGenes genes = c2.c_genes; // [!code ++]
		int excess = c2.CurrentGeneSlot + slot - c2.MaxGeneSlot; // [!code ++]
		switch (c_DNA.type) // [!code ++]
		{
			item.Say("angry", item); // [!code --]
			item.ShowEmo(Emo.angry); // [!code --]
			item.PlaySound("Animal/Cat/cat_angry"); // [!code --]
			if (c2.IsPC) // [!code --]
		case DNA.Type.Inferior: // [!code ++]
			if (genes != null) // [!code ++]
			{
				EClass.player.ModKarma(-3); // [!code --]
				RemoveOldestDNA(); // [!code ++]
			}
			return; // [!code ++]
		case DNA.Type.Brain: // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		if (excess > 0) // [!code ++]
		{ // [!code ++]
			while (excess > 0 && genes != null && genes.items.Count != 0) // [!code ++]
			{ // [!code ++]
				RemoveOldestDNA(); // [!code ++]
			} // [!code ++]
		} // [!code ++]
		c_DNA.Apply(c2); // [!code ++]
		c2.Say("little_eat", c2); // [!code ++]
		c2.PlaySound("ding_potential"); // [!code ++]
		SE.Play("mutation"); // [!code ++]
		c2.PlayEffect("identify"); // [!code ++]
		void RemoveOldestDNA() // [!code ++]
		{ // [!code ++]
			DNA dNA = genes.items[0]; // [!code ++]
			CharaGenes.Remove(c2, dNA); // [!code ++]
			excess -= dNA.slot; // [!code ++]
		}
	}

```

## InvOwnerGene

[`public override void OnWriteNote(Thing t, UINote n)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/InvOwnerGene.cs#L85-L104)
```cs:line-numbers=85
	{
		if (ShouldShowGuide(t))
		{
			n.AddHeader("HeaderAdditionalTrait", "gene_hint"); // [!code --]
			_ = tg.c_genes; // [!code --]
			int num = t.c_DNA.slot; // [!code --]
			if (num > 1 && tg.HasElement(1237)) // [!code --]
			{ // [!code --]
				num--; // [!code --]
			} // [!code --]
			int num2 = tg.MaxGeneSlot - tg.CurrentGeneSlot; // [!code --]
			int num3 = num2 - num; // [!code --]
			int maxGeneSlot = tg.MaxGeneSlot; // [!code --]
			n.AddText("gene_hint_slot".lang(num2.ToString() ?? "", num3.ToString() ?? "", maxGeneSlot.ToString() ?? ""), (num3 >= 0) ? FontColor.Good : FontColor.Bad); // [!code --]
			int cost = t.c_DNA.cost; // [!code --]
			int num4 = tg.feat - cost; // [!code --]
			n.AddText("gene_hint_cost".lang(tg.feat.ToString() ?? "", cost + ((cost == t.c_DNA.cost) ? "" : ("(" + t.c_DNA.cost + ")")), num4.ToString() ?? ""), (num4 >= 0) ? FontColor.Good : FontColor.Bad); // [!code --]
			t.c_DNA.WriteNoteExtra(n, tg); // [!code ++]
		}
	}
}
```

## POLICY

[`public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/POLICY.cs#L47-L56)
```cs:line-numbers=47

	public const int food_for_people = 2502;

	public const int resident_tax = 2512; // [!code --]
 // [!code --]
	public const int prohibition = 2503;

	public const int resident_tax = 2512; // [!code ++]
 // [!code ++]
	public const int self_sufficient = 2511;

	public const int ban_radio = 2510;
```

[`public class POLICY`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/POLICY.cs#L109-L115)
```cs:line-numbers=109
{
	2818, 2819, 2820, 2821, 2822, 2826, 2824, 2825, 2827, 2828,
	2817, 2823, 2816, 2704, 2814, 2514, 2513, 2505, 2815, 2500,
	2501, 2502, 2512, 2503, 2511, 2510, 2509, 2508, 2507, 2506, // [!code --]
	2501, 2502, 2503, 2512, 2511, 2510, 2509, 2508, 2507, 2506, // [!code ++]
	2515, 2516, 2504, 2701, 2700, 2707, 2708, 2706, 2709, 2711,
	2712, 2715, 2710, 2810, 2811, 2812, 2813, 2705, 2703, 2702,
	2800
```

## SKILL

[`public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/SKILL.cs#L94-L100)
```cs:line-numbers=94

	public const int vigor = 62;

	public const int weaponDagger = 107; // [!code --]
	public const int weaponPolearm = 106; // [!code ++]

	public const int PER = 73;

```

[`public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/SKILL.cs#L132-L138)
```cs:line-numbers=132

	public const int fishing = 245;

	public const int weaponPolearm = 106; // [!code --]
	public const int weaponDagger = 107; // [!code ++]

	public const int carpentry = 255;

```

[`public class SKILL`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/SKILL.cs#L274-L282)
```cs:line-numbers=274
	241, 240, 237, 235, 230, 227, 226, 225, 123, 220,
	200, 152, 151, 150, 135, 134, 133, 132, 210, 207,
	100, 105, 71, 70, 68, 67, 66, 65, 72, 64,
	61, 60, 57, 56, 55, 51, 62, 107, 73, 75, // [!code --]
	61, 60, 57, 56, 55, 51, 62, 106, 73, 75, // [!code ++]
	104, 103, 102, 101, 94, 93, 74, 92, 90, 80,
	79, 78, 77, 76, 91, 245, 106, 255, 916, 917, // [!code --]
	79, 78, 77, 76, 91, 245, 107, 255, 916, 917, // [!code ++]
	918, 919, 921, 922, 923, 924, 925, 926, 950, 951,
	952, 953, 915, 954, 956, 957, 958, 959, 960, 961,
	962, 963, 964, 965, 250, 972, 971, 970, 955, 914,
```

## TraitBook

[`public override void SetName(ref string s)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/TraitBook.cs#L51-L56)
```cs:line-numbers=51

	public override void OnRead(Chara c)
	{
		if (owner.c_lockLv > 0) // [!code ++]
		{ // [!code ++]
			owner.c_lockLv = 0; // [!code ++]
			c.Say("unseal", c, owner); // [!code ++]
			c.PlaySound("open_bottle"); // [!code ++]
			if (owner.things.Count == 0) // [!code ++]
			{ // [!code ++]
				c.Say("empty"); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				EClass.pc.PickOrDrop(EClass.pc.pos, owner.things[0]); // [!code ++]
			} // [!code ++]
		} // [!code ++]
		BookList.Item item = Item;
		EClass.ui.AddLayer<LayerHelp>(IsParchment ? "LayerParchment" : "LayerBook").book.Show((IsParchment ? "Scroll/" : "Book/") + item.id, null, item.title, item);
	}
```

## +TraitCoreUser

::: details File Created
```cs
public class TraitCoreUser : Trait
{
}
```

:::
## TraitGene

[`public override void WriteNote(UINote n, bool identified)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/TraitGene.cs#L21-L35)
```cs:line-numbers=21
	{
		if (owner.c_DNA != null)
		{
			bool flag = EClass.pc.HasElement(1274) && !LayerDragGrid.Instance; // [!code ++]
			if (owner.c_DNA.cost > 0)
			{
				n.AddText("isCostFeatPoint".lang(owner.c_DNA.cost.ToString() ?? "")); // [!code --]
				n.AddText("isCostFeatPoint".lang((flag ? (owner.c_DNA.cost * EClass.pc.GeneCostMTP / 100 + " (" + owner.c_DNA.cost + ")") : ((object)owner.c_DNA.cost))?.ToString() ?? "")); // [!code ++]
			}
			if (EClass.debug.showExtra)
			{
				n.AddText("duration:" + owner.c_DNA.GetDurationHour());
			}
			owner.c_DNA.WriteNote(n);
			if (flag) // [!code ++]
			{ // [!code ++]
				owner.c_DNA.WriteNoteExtra(n, EClass.pc); // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public override void TrySetHeldAct(ActPlan p) // [!code ++]
	{ // [!code ++]
		if (!p.pos.Equals(EClass.pc.pos) || !EClass.pc.HasElement(1274)) // [!code ++]
		{ // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		Element invalidFeat = owner.c_DNA.GetInvalidFeat(EClass.pc); // [!code ++]
		Element invalidAction = owner.c_DNA.GetInvalidAction(EClass.pc); // [!code ++]
		if (owner.c_DNA.cost * EClass.pc.GeneCostMTP / 100 > EClass.pc.feat) // [!code ++]
		{ // [!code ++]
			p.TrySetAct("invFood", delegate // [!code ++]
			{ // [!code ++]
				SE.Beep(); // [!code ++]
				Msg.Say("notEnoughFeatPoint"); // [!code ++]
				return false; // [!code ++]
			}); // [!code ++]
		} // [!code ++]
		else if (invalidFeat != null) // [!code ++]
		{ // [!code ++]
			p.TrySetAct("invFood", delegate // [!code ++]
			{ // [!code ++]
				SE.Beep(); // [!code ++]
				Msg.Say("invalidGeneFeat", EClass.pc, invalidFeat.Name.ToTitleCase()); // [!code ++]
				return false; // [!code ++]
			}); // [!code ++]
		} // [!code ++]
		else if (invalidAction != null) // [!code ++]
		{ // [!code ++]
			p.TrySetAct("invFood", delegate // [!code ++]
			{ // [!code ++]
				SE.Beep(); // [!code ++]
				Msg.Say("invalidGeneAction", EClass.pc, invalidAction.Name.ToTitleCase()); // [!code ++]
				return false; // [!code ++]
			}); // [!code ++]
		} // [!code ++]
		else // [!code ++]
		{ // [!code ++]
			p.TrySetAct(new AI_Eat // [!code ++]
			{ // [!code ++]
				target = owner // [!code ++]
			}); // [!code ++]
		}
	}

```

## TraitParchmentBottle

[`public class TraitParchmentBottle : TraitParchment`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/TraitParchmentBottle.cs#L1-L9)
```cs:line-numbers=1
public class TraitParchmentBottle : TraitParchment
{
	public override bool CanBeSmashedToDeath => true; // [!code ++]
 // [!code ++]
	public override bool CanBeAttacked => !EClass._zone.IsPCFactionOrTent; // [!code ++]
 // [!code ++]
	public override ThrowType ThrowType => ThrowType.Vase; // [!code ++]
 // [!code ++]
	public override BookList.Item Item => BottleMessageList.GetItem(base.IdItem);

	public override void OnCreate(int lv)
	{
		owner.SetStr(53, BottleMessageList.GetRandomItem().id);
		owner.c_lockLv = 1; // [!code ++]
		string id; // [!code ++]
		int num; // [!code ++]
		if (!EClass._zone.IsUserZone && EClass.rnd(4) != 0) // [!code ++]
		{ // [!code ++]
			id = "money"; // [!code ++]
			num = EClass.rnd(EClass.rnd(EClass.rnd(EClass.rnd(500)))) + 1; // [!code ++]
			Rand.SetSeed(owner.uid); // [!code ++]
			if (EClass.rnd(5) == 0) // [!code ++]
			{ // [!code ++]
				SetId("scratchcard", 1); // [!code ++]
			} // [!code ++]
			if (EClass.rnd(10) == 0) // [!code ++]
			{ // [!code ++]
				SetId("234", 1); // [!code ++]
			} // [!code ++]
			if (EClass.rnd(20) == 0) // [!code ++]
			{ // [!code ++]
				SetId("medal", 1); // [!code ++]
			} // [!code ++]
			if (EClass.rnd(30) == 0) // [!code ++]
			{ // [!code ++]
				SetId("map_treasure", 1); // [!code ++]
			} // [!code ++]
			if (EClass.rnd(50) == 0) // [!code ++]
			{ // [!code ++]
				SetId("ticket_fortune", 1); // [!code ++]
			} // [!code ++]
			if (EClass.rnd(100) == 0) // [!code ++]
			{ // [!code ++]
				SetId("1084", 1); // [!code ++]
			} // [!code ++]
			if (EClass.rnd(500) == 9) // [!code ++]
			{ // [!code ++]
				SetId("book_exp", 1); // [!code ++]
			} // [!code ++]
			Rand.SetSeed(); // [!code ++]
			owner.AddCard(ThingGen.Create(id, -1, EClass.pc.FameLv).SetNum(num)); // [!code ++]
		} // [!code ++]
		void SetId(string _id, int _num) // [!code ++]
		{ // [!code ++]
			id = _id; // [!code ++]
			num = _num; // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public override void SetName(ref string s) // [!code ++]
	{ // [!code ++]
		base.SetName(ref s); // [!code ++]
		if (owner.c_lockLv != 0) // [!code ++]
		{ // [!code ++]
			s += "_sealed".lang(); // [!code ++]
		} // [!code ++]
	}
}
```

## WindowChara

[`public void RefreshSkill(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L526-L531)
```cs:line-numbers=526
			List("availableFeats_attribute", "attribute");
			return;
		}
		if (chara.IsPC && chara.HasElement(1274) && chara.c_genes != null && chara.c_genes.items.Count > 0) // [!code ++]
		{ // [!code ++]
			Header("genes", null); // [!code ++]
			ListFeat(); // [!code ++]
			list.callbacks = new UIList.Callback<DNA, ButtonElement> // [!code ++]
			{ // [!code ++]
				onClick = delegate // [!code ++]
				{ // [!code ++]
					SE.Beep(); // [!code ++]
				}, // [!code ++]
				onInstantiate = delegate(DNA a, ButtonElement b) // [!code ++]
				{ // [!code ++]
					b.mainText.SetText(a.GetText()); // [!code ++]
					b.SetTooltip(delegate(UITooltip t) // [!code ++]
					{ // [!code ++]
						UINote uINote = t.note; // [!code ++]
						uINote.Clear(); // [!code ++]
						uINote.AddHeader(a.GetText()); // [!code ++]
						a.WriteNote(uINote); // [!code ++]
						t.note.Build(); // [!code ++]
					}); // [!code ++]
					b.subText.text = "(+" + a.slot + ")"; // [!code ++]
					b.subText.SetActive(enable: true); // [!code ++]
					b.imagePotential.SetActive(enable: false); // [!code ++]
				}, // [!code ++]
				onList = delegate // [!code ++]
				{ // [!code ++]
					foreach (DNA item in chara.c_genes.items) // [!code ++]
					{ // [!code ++]
						list.Add(item); // [!code ++]
					} // [!code ++]
				} // [!code ++]
			}; // [!code ++]
			list.List(); // [!code ++]
		} // [!code ++]
		Header("mutation", null);
		ListFeat();
		list.callbacks = new UIList.Callback<Feat, ButtonElement>
```

[`public void RefreshSkill(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L541-L549)
```cs:line-numbers=541
			},
			onList = delegate
			{
				foreach (Element item in chara.elements.ListElements((Element a) => a.source.category == "mutation" && a.Value != 0)) // [!code --]
				foreach (Element item2 in chara.elements.ListElements((Element a) => a.source.category == "mutation" && a.Value != 0)) // [!code ++]
				{
					list.Add(item); // [!code --]
					list.Add(item2); // [!code ++]
				}
			}
		};
```

[`public void RefreshSkill(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L568-L576)
```cs:line-numbers=568
			},
			onList = delegate
			{
				foreach (Element item2 in chara.elements.ListElements((Element a) => a.source.category == "ether" && a.Value != 0)) // [!code --]
				foreach (Element item3 in chara.elements.ListElements((Element a) => a.source.category == "ether" && a.Value != 0)) // [!code ++]
				{
					list.Add(item2); // [!code --]
					list.Add(item3); // [!code ++]
				}
			}
		};
```

[`public void RefreshSkill(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L595-L603)
```cs:line-numbers=595
			},
			onList = delegate
			{
				foreach (Element item3 in chara.elements.ListElements((Element a) => a.source.category == "feat" && a.HasTag("innate") && a.Value != 0)) // [!code --]
				foreach (Element item4 in chara.elements.ListElements((Element a) => a.source.category == "feat" && a.HasTag("innate") && a.Value != 0)) // [!code ++]
				{
					list.Add(item3); // [!code --]
					list.Add(item4); // [!code ++]
				}
			}
		};
```

[`public void RefreshSkill(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L617-L625)
```cs:line-numbers=617
			},
			onList = delegate
			{
				foreach (Element item4 in chara.elements.ListElements((Element a) => a.source.category == "feat" && !a.HasTag("innate") && a.Value != 0)) // [!code --]
				foreach (Element item5 in chara.elements.ListElements((Element a) => a.source.category == "feat" && !a.HasTag("innate") && a.Value != 0)) // [!code ++]
				{
					list.Add(item4); // [!code --]
					list.Add(item5); // [!code ++]
				}
			},
			onSort = (Feat a, UIList.SortMode m) => a.GetSortVal(m)
```

[`public void RefreshSkill(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L640-L648)
```cs:line-numbers=640
			},
			onList = delegate
			{
				foreach (SourceElement.Row item5 in EClass.sources.elements.rows.Where((SourceElement.Row a) => a.category == "resist" && ((!a.tag.Contains("hidden") && !a.tag.Contains("high")) || chara.Evalue(a.id) != 0))) // [!code --]
				foreach (SourceElement.Row item6 in EClass.sources.elements.rows.Where((SourceElement.Row a) => a.category == "resist" && ((!a.tag.Contains("hidden") && !a.tag.Contains("high")) || chara.Evalue(a.id) != 0))) // [!code ++]
				{
					list.Add(chara.elements.GetOrCreateElement(item5.id)); // [!code --]
					list.Add(chara.elements.GetOrCreateElement(item6.id)); // [!code ++]
				}
			}
		};
```

[`public void RefreshSkill(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L702-L712)
```cs:line-numbers=702
			},
			onList = delegate
			{
				foreach (Element item6 in eles) // [!code --]
				foreach (Element item7 in eles) // [!code ++]
				{
					if (!skillCats.Contains(item6.source.categorySub)) // [!code --]
					if (!skillCats.Contains(item7.source.categorySub)) // [!code ++]
					{
						list.Add(item6); // [!code --]
						list.Add(item7); // [!code ++]
					}
				}
			}
```

[`public void RefreshSkill(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L722-L732)
```cs:line-numbers=722
			},
			onList = delegate
			{
				foreach (Element item7 in eles) // [!code --]
				foreach (Element item8 in eles) // [!code ++]
				{
					if (skillCats.Contains(item7.source.categorySub)) // [!code --]
					if (skillCats.Contains(item8.source.categorySub)) // [!code ++]
					{
						list.Add(item7); // [!code --]
						list.Add(item8); // [!code ++]
					}
				}
			}
```

[`void List(string lang, string idSubCat)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L773-L781)
```cs:line-numbers=773
			},
			onList = delegate
			{
				foreach (Element item8 in chara.elements.ListElements((Element a) => (a.Value != 0 || a.ValueWithoutLink != 0 || a.vSource > 0) && a.source.category == "skill" && cats.Contains(a.source.categorySub))) // [!code --]
				foreach (Element item9 in chara.elements.ListElements((Element a) => (a.Value != 0 || a.ValueWithoutLink != 0 || a.vSource > 0) && a.source.category == "skill" && cats.Contains(a.source.categorySub))) // [!code ++]
				{
					list.Add(item8); // [!code --]
					list.Add(item9); // [!code ++]
				}
			},
			onSort = (Element c, UIList.SortMode m) => EClass.sources.elements.alias[c.source.aliasParent].id * -10000 - c.id
```

[`void List(string lang, string idSubCat)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowChara.cs#L819-L829)
```cs:line-numbers=819
			},
			onList = delegate
			{
				foreach (Element item9 in chara.ListAvailabeFeats(pet: false, EClass.game.config.showAllFeat)) // [!code --]
				foreach (Element item10 in chara.ListAvailabeFeats(pet: false, EClass.game.config.showAllFeat)) // [!code ++]
				{
					if (item9.source.categorySub == idSubCat) // [!code --]
					if (item10.source.categorySub == idSubCat) // [!code ++]
					{
						_list.Add(item9); // [!code --]
						_list.Add(item10); // [!code ++]
					}
				}
			}
```

## WindowCharaMini

[`public void Refresh(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/2ce0d8280aed7f0326fe8dff9cad7721ea577aa5/Elin/WindowCharaMini.cs#L236-L244)
```cs:line-numbers=236
						{
							genes.inferior--;
							SE.Trash();
							genes.Remove(chara, g); // [!code --]
							CharaGenes.Remove(chara, g); // [!code ++]
							Refresh(idTab);
							chara.RemoveAllStances(); // [!code --]
						});
					}
				});
```

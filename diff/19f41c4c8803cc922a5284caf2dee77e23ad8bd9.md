---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 9 files modified.
version: EA 23.243 Nightly Patch 1
changes: AI_PlayMusic/Card/Chara/ConVampire/DramaOutcome/InvOwner/Trait/TraitBookExp/UIRecipeInfo
---

# EA 23.243 Nightly Patch 1

December 4, 2025

9 files modified.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [Card (1)](#card)
```cs:no-line-numbers
public void AddExp(int a) // [!code --]
public void AddExp(int a, bool applyMod = true) // [!code ++]
```
## AI_PlayMusic

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/AI_PlayMusic.cs#L87-L92)
```cs:line-numbers=87
	{
		switch (tool.id)
		{
		case "sax": // [!code ++]
		case "trumpet":
			idSong = "trumpet_practice";
			break;
```

## Card

[`public void ClampInitialSkill()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/Card.cs#L2948-L2956)
```cs:line-numbers=2948
		}
	}

	public void AddExp(int a) // [!code --]
	public void AddExp(int a, bool applyMod = true) // [!code ++]
	{
		a = a * GetExpMtp() / 100; // [!code --]
		if (applyMod) // [!code ++]
		{ // [!code ++]
			a = a * GetExpMtp() / 100; // [!code ++]
		} // [!code ++]
		exp += a;
		while (exp >= ExpToNext && exp > 0 && ExpToNext > 0)
		{
```

[`public int GetExpMtp()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/Card.cs#L2974-L2980)
```cs:line-numbers=2974
				}
			}
		}
		return num * (100 + Evalue(1237) * 30) / 100; // [!code --]
		return num * (100 + Evalue(1237) * 30 + Evalue(1273) * 50) / 100; // [!code ++]
	}

	public int GetAffinityExpBonus()
```

## Chara

[`public override MoveResult _Move(Point newPoint, MoveType type = MoveType.Walk)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/Chara.cs#L2777-L2783)
```cs:line-numbers=2777
				num2 += 20;
				num *= 1.8f;
			}
			num2 = num2 * 100 / (100 + EvalueMax(240, -20) + EvalueMax(407, -5) * 5); // [!code --]
			num2 = num2 * 100 / (100 + (int)Mathf.Sqrt(EvalueMax(240, -20) * 10) + EvalueMax(407, -5) * 5); // [!code ++]
			EClass.world.date.AdvanceMin(num2 * 6);
			EClass.player.lastZonePos = null;
			EClass.player.distanceTravel++;
```

## ConVampire

[`using Newtonsoft.Json;`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/ConVampire.cs#L1-L4)
```cs:line-numbers=1
using Newtonsoft.Json;
using UnityEngine; // [!code ++]

public class ConVampire : Condition
{
```

[`public override ElementContainer GetElementContainer()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/ConVampire.cs#L23-L37)
```cs:line-numbers=23

	public override void Tick()
	{
		if (EClass._zone.IsRegion || EClass.rnd(10) != 0) // [!code --]
		if (EClass.rnd(2) != 0) // [!code ++]
		{
			return;
		}
		int num = List_Vampire.RandomItem();
		int num2 = ec.Value(num);
		int num3 = owner.elements.Base(num) / 7 + 5; // [!code ++]
		if (EClass.world.date.IsNight)
		{
			int num3 = owner.elements.Base(num) / 5 + 5; // [!code --]
			switch (num)
			{
			case 60:
```

[`public override void Tick()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/ConVampire.cs#L44-L55)
```cs:line-numbers=44
			}
			if (num2 < num3 && (float)EClass.rnd(100) >= 99f * (float)num2 / (float)num3)
			{
				ec.ModBase(num, 1); // [!code --]
				ec.ModBase(num, Mathf.Clamp(num3 / 10, 1, num3 - num2)); // [!code ++]
			}
		}
		else if (num2 > 0)
		{
			ec.ModBase(num, -1); // [!code --]
			ec.ModBase(num, -Mathf.Clamp(num3 / 4, 1, num2)); // [!code ++]
		}
	}

```

## DramaOutcome

[`public int GetFelmeraRewardIndex()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/DramaOutcome.cs#L492-L500)
```cs:line-numbers=492
{
	int count = EMono.player.sketches.Count;
	int num = count / 10;
	if (num >= 29) // [!code --]
	if (num >= 31) // [!code ++]
	{
		num = 29; // [!code --]
		num = 31; // [!code ++]
	}
	Debug.Log(count + "/" + num + "/" + EMono.player.lastFelmeraReward);
	return num;
```

## InvOwner

[`public bool Process(bool startTransaction = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/InvOwner.cs#L231-L237)
```cs:line-numbers=231
				{
					EClass.pc.ModCurrency(-price, IDCurrency);
				}
				if (sell && !thing2.IsIdentified) // [!code --]
				if (sell && !thing2.IsIdentified && !ShopTransaction.current.HasBought(thing2)) // [!code ++]
				{
					thing2.Identify(show: true, IDTSource.SuperiorIdentify);
				}
```

## Trait

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/Trait.cs#L1896-L1902)
```cs:line-numbers=1896
				break;
			case ShopType.Moyer:
			{
				for (int num12 = 1; num12 <= 15; num12++) // [!code --]
				for (int num12 = 1; num12 <= 16; num12++) // [!code ++]
				{
					AddAdvWeek(num12);
				}
```

## TraitBookExp

[`public override void OnRead(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/TraitBookExp.cs#L14-L20)
```cs:line-numbers=14
{
	EClass.player.forceTalk = true;
	c.Talk((EClass.rnd(2) == 0) ? "nice_statue" : "disgust");
	c.AddExp(c.ExpToNext / ((!c.IsPC) ? 1 : 4)); // [!code --]
	c.AddExp(c.ExpToNext / ((!c.IsPC) ? 1 : 4) * ((!c.HasElement(1273)) ? 1 : 4), applyMod: false); // [!code ++]
	c.PlaySound("ding_potential");
	c.Say("spellbookCrumble", owner.Duplicate(1));
	owner.ModNum(-1);
```

## UIRecipeInfo

[`public void Refresh()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/19f41c4c8803cc922a5284caf2dee77e23ad8bd9/Elin/UIRecipeInfo.cs#L268-L274)
```cs:line-numbers=268
	int[] tiles = recipe.renderRow.tiles;
	if (EMono.debug.showExtra)
	{
		text = text + "(" + recipe.id + "  " + recipe.renderRow.idRenderData + "/" + ((tiles.Length != 0) ? tiles[0] : (-1)) + ")" + Environment.NewLine; // [!code --]
		text = text + "(" + recipe.id + "  " + recipe.renderRow.idRenderData + "/" + ((tiles.Length != 0) ? tiles[0] : (-1)) + ") skin:" + recipe.idSkin + Environment.NewLine; // [!code ++]
	}
	textDetail.SetActive(enable: true);
	if (CraftMode)
```

---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 7 files modified.
version: EA 23.279 Nightly Patch 1
changes: AI_Fish/ActEffect/ActZap/DNA/Religion/TraitAltar/TraitWell
---

# EA 23.279 Nightly Patch 1

February 28, 2026

7 files modified.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [Religion (1)](#religion)
```cs:no-line-numbers
public bool TryGetGift() // [!code --]
public int GetGiftRank() // [!code ++]
```
## AI_Fish

[`public override void OnProgressComplete()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/AI_Fish.cs#L113-L130)
```cs:line-numbers=113
		{
			thing.isHidden = false;
		}
		if (EClass.rnd(EClass.debug.enable ? 2 : 100) == 0 && thing.category.IsChildOf("fish")) // [!code --]
		if (EClass.rnd(EClass.debug.enable ? 2 : 1000) == 0 && thing.category.IsChildOf("fish")) // [!code ++]
		{
			owner.Say("fish_ehe"); // [!code --]
			owner.Say("fish_ehe2"); // [!code --]
			owner.PlaySound("escape");
			owner.PlayEffect("fizzle");
			thing.Destroy(); // [!code --]
			if (owner.IsPC)
			{
				owner.Say("fish_ehe"); // [!code ++]
				owner.Say("fish_ehe2"); // [!code ++]
				owner.Say("fish_ehe3"); // [!code ++]
				EClass.player.flags.fishStolen++;
				Steam.GetAchievement(ID_Achievement.EHE_FISH);
				if (EClass.rnd(777) == 0) // [!code ++]
				{ // [!code ++]
					EClass.pc.AddCondition<ConInvulnerable>(); // [!code ++]
					ActEffect.Proc(EffectId.Wish, EClass.pc, null, 50 + EClass.player.CountKeyItem("well_enhance") * 50 + EClass.player.flags.fishStolen * 50); // [!code ++]
				} // [!code ++]
			}
			thing.Destroy(); // [!code ++]
		}
		else if (owner.IsPC)
		{
```

## ActEffect

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/ActEffect.cs#L832-L838)
```cs:line-numbers=832
		Chara chara3 = CharaGen.Create((id == EffectId.Bit) ? "bit2" : "bit");
		chara3.SetMainElement(element.source.alias, element.Value, elemental: true);
		chara3.SetSummon(20 + power / 20 + EClass.rnd(10));
		chara3.SetLv(power / 15); // [!code --]
		chara3.SetLv(Mathf.Abs(power) / 15); // [!code ++]
		chara3.interest = 0;
		EClass._zone.AddCard(chara3, tp.GetNearestPoint(allowBlock: false, allowChara: false));
		chara3.PlayEffect("teleport");
```

## ActZap

[`public override bool Perform()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/ActZap.cs#L20-L26)
```cs:line-numbers=20
		trait.owner.ModCharge(-1);
		Act.CC.PlayEffect("rod");
		Act.CC.PlaySound("rod");
		Act.CC.RemoveCondition<ConInvisibility>(); // [!code --]
		if (EClass.rnd(2) == 0) // [!code ++]
		{ // [!code ++]
			Act.CC.RemoveCondition<ConInvisibility>(); // [!code ++]
		} // [!code ++]
		Act.TC = Act.CC;
		EffectId idEffect = trait.IdEffect;
		long a = trait.Power * (100 + (long)Act.CC.Evalue(305) * 10L + Act.CC.MAG / 2 + Act.CC.PER / 2) / 100;
```

## DNA

[`void AddSpecial()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/DNA.cs#L455-L491)
```cs:line-numbers=455
	}
	void AddVal(int id, int v, bool allowStack, Func<int, int> funcCost)
	{
		bool flag = false; // [!code --]
		int num = EClass.curve(v, 20, 10, 90); // [!code --]
		if (v < -100) // [!code --]
		{ // [!code --]
			num = EClass.curve(Mathf.Abs(v + 100), 20, 10, 90); // [!code --]
		} // [!code --]
		v = EClass.curve(v, 20, 10, 80); // [!code --]
		for (int k = 0; k < vals.Count; k += 2) // [!code --]
		if (v >= 0) // [!code ++]
		{
			if (vals[k] == id) // [!code --]
			bool flag = false; // [!code ++]
			int num = EClass.curve(v, 20, 10, 90); // [!code ++]
			if (v < -100) // [!code ++]
			{ // [!code ++]
				num = EClass.curve(Mathf.Abs(v + 100), 20, 10, 90); // [!code ++]
			} // [!code ++]
			v = EClass.curve(v, 20, 10, 80); // [!code ++]
			for (int k = 0; k < vals.Count; k += 2) // [!code ++]
			{
				if (allowStack) // [!code --]
				if (vals[k] == id) // [!code ++]
				{
					v /= 2; // [!code --]
					num /= 2; // [!code --]
					vals[k + 1] += v; // [!code --]
					Debug.Log(vals[k + 1] + ": " + v + "/" + num); // [!code --]
					flag = true; // [!code --]
					break; // [!code --]
					if (allowStack) // [!code ++]
					{ // [!code ++]
						v /= 2; // [!code ++]
						num /= 2; // [!code ++]
						vals[k + 1] += v; // [!code ++]
						Debug.Log(vals[k + 1] + ": " + v + "/" + num); // [!code ++]
						flag = true; // [!code ++]
						break; // [!code ++]
					} // [!code ++]
					return; // [!code ++]
				}
				return; // [!code --]
			}
		} // [!code --]
		if (v != 0) // [!code --]
		{ // [!code --]
			if (!flag) // [!code --]
			if (v != 0) // [!code ++]
			{
				vals.Add(id); // [!code --]
				vals.Add(v); // [!code --]
				if (!flag) // [!code ++]
				{ // [!code ++]
					vals.Add(id); // [!code ++]
					vals.Add(v); // [!code ++]
				} // [!code ++]
				cost += Mathf.Max(0, funcCost(num)); // [!code ++]
			}
			cost += Mathf.Max(0, funcCost(num)); // [!code --]
		}
	}
}
```

## Religion

[`void SetValue(SourceCategory.Row cat, int mtp)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/Religion.cs#L217-L231)
```cs:line-numbers=217
		}
	}

	public bool TryGetGift() // [!code --]
	public int GetGiftRank() // [!code ++]
	{
		if (IsEyth || source.rewards.Length == 0)
		{
			return false; // [!code --]
			return -1; // [!code ++]
		}
		Point point = EClass.pc.pos.GetNearestPoint(allowBlock: false, allowChara: false, allowInstalled: false) ?? EClass.pc.pos; // [!code --]
		int num = EClass.pc.Evalue(85);
		if (giftRank == 0 && (num >= 15 || EClass.debug.enable))
		{ // [!code ++]
			return 1; // [!code ++]
		} // [!code ++]
		if (source.rewards.Length >= 2 && giftRank == 1 && (num >= 30 || EClass.debug.enable)) // [!code ++]
		{ // [!code ++]
			return 2; // [!code ++]
		} // [!code ++]
		return -1; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public bool TryGetGift() // [!code ++]
	{ // [!code ++]
		int num = GetGiftRank(); // [!code ++]
		if (num == -1) // [!code ++]
		{ // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
		Point point = EClass.pc.pos.GetNearestPoint(allowBlock: false, allowChara: false, allowInstalled: false) ?? EClass.pc.pos; // [!code ++]
		switch (num) // [!code ++]
		{ // [!code ++]
		case 1: // [!code ++]
		{
			Talk("pet");
			Chara chara = CharaGen.Create(source.rewards[0]);
```

[`public bool TryGetGift()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/Religion.cs#L235-L241)
```cs:line-numbers=235
		giftRank = 1;
		return true;
	}
	if (source.rewards.Length >= 2 && giftRank == 1 && (num >= 30 || EClass.debug.enable)) // [!code --]
	case 2: // [!code ++]
	{
		Talk("gift");
		string[] array = source.rewards[1].Split('|');
```

[`public bool TryGetGift()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/Religion.cs#L247-L253)
```cs:line-numbers=247
			giftRank = 2;
			return true;
		}
		return false; // [!code --]
		default: // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
	}

	public static Religion GetArtifactDeity(string id)
```

## TraitAltar

[`public override void TrySetAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/TraitAltar.cs#L75-L83)
```cs:line-numbers=75

	public override bool CanOffer(Card c)
	{
		Debug.Log(Deity); // [!code --]
		Debug.Log(Deity.id); // [!code --]
		Debug.Log(IsEyth); // [!code --]
		if (c != null && c.HasTag(CTAG.godArtifact))
		{
			if (EClass.pc.IsEyth && EClass.pc.HasElement(1228))
```

[`public void _OnOffer(Chara c, Thing t, int takeoverMod = 0)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/TraitAltar.cs#L220-L226)
```cs:line-numbers=220
{
	bool @bool = t.GetBool(115);
	int offeringValue = Deity.GetOfferingValue(t, t.Num);
	offeringValue = offeringValue * (c.HasElement(1228) ? 130 : 100) / 100; // [!code --]
	offeringValue = offeringValue * (EClass.debug.enable ? 1000 : (c.HasElement(1228) ? 130 : 100)) / 100; // [!code ++]
	if (takeoverMod == 0)
	{
		if (offeringValue >= 200)
```

[`public void _OnOffer(Chara c, Thing t, int takeoverMod = 0)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/TraitAltar.cs#L249-L255)
```cs:line-numbers=249
	int num = Mathf.Max(c.Evalue(306), 1);
	Element orCreateElement = c.elements.GetOrCreateElement(85);
	int value = orCreateElement.Value;
	c.elements.ModExp(orCreateElement.id, offeringValue * 2 / 3); // [!code --]
	if (orCreateElement.vBase < num) // [!code ++]
	{ // [!code ++]
		c.elements.ModExp(orCreateElement.id, offeringValue * 2 / 3); // [!code ++]
		if (orCreateElement.vBase >= num) // [!code ++]
		{ // [!code ++]
			c.elements.SetBase(orCreateElement.id, num); // [!code ++]
		} // [!code ++]
	} // [!code ++]
	int num2 = 4;
	if (orCreateElement.vBase < num)
	{
```

[`public void _OnOffer(Chara c, Thing t, int takeoverMod = 0)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/TraitAltar.cs#L265-L270)
```cs:line-numbers=265
		c.elements.ModExp(306, offeringValue / 5);
	}
	c.RefreshFaithElement();
	if (c.faith.GetGiftRank() != -1) // [!code ++]
	{ // [!code ++]
		c.faith.Talk("like"); // [!code ++]
	} // [!code ++]
	if (@bool)
	{
		EClass.player.ModKarma(-1);
```

## TraitWell

[`public override void TrySetAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/aa5c3cc94873eee14df2eba71506eb18c08b6c6c/Elin/TraitWell.cs#L109-L115)
```cs:line-numbers=109
			if (EClass.player.CountKeyItem("well_wish") > 0)
			{
				EClass.player.ModKeyItem("well_wish", -1);
				ActEffect.Proc(EffectId.Wish, EClass.pc, null, 50 + EClass.player.CountKeyItem("well_enhance") * 50 + EClass.player.flags.fishStolen * 20); // [!code --]
				ActEffect.Proc(EffectId.Wish, EClass.pc, null, 50 + EClass.player.CountKeyItem("well_enhance") * 50 + EClass.player.flags.fishStolen * 50); // [!code ++]
				EClass.player.wellWished = true;
			}
			else
```

---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 21 files modified. 2 new files created. 1 file removed.
version: EA 23.178 Nightly Patch 1
changes: AI_Eat/ActEffect/Affinity/CINT/COBJ/Card/Chara/CharaAbility/CoreDebug/CraftUtil/DramaCustomSequence/ELEMENT/Emo2/FactionBranch/FoodEffect/LayerSleep/+MixedFoodData/SourceFood/StatsMana/TCOrbitChara/Thing/Trait/+TraitLunchLove/~TraitFoodLunchLove
---

# EA 23.178 Nightly Patch 1

August 13, 2025

21 files modified. 2 new files created. 1 file removed.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [Chara (1)](#chara)
```cs:no-line-numbers
public Thing MakeLunch() // [!code --]

```
### [ELEMENT (1)](#element)
```cs:no-line-numbers
public static SourceElement.Row GetRandomElement(int lv = 1) // [!code --]
public static SourceElement.Row GetRandomElement(int lv = 1, bool useWeight = true) // [!code ++]
```
### [FoodEffect (1)](#foodeffect)
```cs:no-line-numbers
public static void Proc(Chara c, Thing food) // [!code --]
public static void Proc(Chara c, Thing food, bool consume = true) // [!code ++]
```
## AI_Eat

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/AI_Eat.cs#L127-L133)
```cs:line-numbers=127
				owner.Say("eat_end", owner, target.GetName(NameStyle.Full, 1));
				owner.ShowEmo(Emo.happy);
				FoodEffect.Proc(owner, target.Thing);
				target.ModNum(-1); // [!code --]
			}
		}
	}.SetDuration(max, 5);
```

## ActEffect

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/ActEffect.cs#L533-L538)
```cs:line-numbers=533
		bool flag3 = false;
		bool flag4 = actRef.n1 == "special";
		int num5 = -1;
		string text = ""; // [!code ++]
		switch (actRef.n1)
		{
		case "shadow":
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/ActEffect.cs#L572-L597)
```cs:line-numbers=572
				continue;
			}
			Chara chara = null;
			CardBlueprint.Set(new CardBlueprint()); // [!code ++]
			if (num5 != -1)
			{
				CardBlueprint.Set(new CardBlueprint // [!code --]
				CardBlueprint.current.lv = num5; // [!code ++]
			} // [!code ++]
			if (!text.IsEmpty()) // [!code ++]
			{ // [!code ++]
				CardBlueprint.current.idEle = text; // [!code ++]
			} // [!code ++]
			switch (actRef.n1) // [!code ++]
			{ // [!code ++]
			case "special": // [!code ++]
				if (j == 0 && !CC.HasMinion("imolonac") && !CC.HasMinion("ygolonac")) // [!code ++]
				{
					lv = num5 // [!code --]
				}); // [!code --]
					chara = CharaGen.Create((EClass.rnd(20) == 0) ? "imolonac" : "ygolonac"); // [!code ++]
					break; // [!code ++]
				} // [!code ++]
				Debug.Log(CardBlueprint.current.idEle); // [!code ++]
				chara = CharaGen.Create("hound", CC.LV); // [!code ++]
				if (text.IsEmpty()) // [!code ++]
				{ // [!code ++]
					text = chara.MainElement.source.alias; // [!code ++]
				} // [!code ++]
				break; // [!code ++]
			case "yeek": // [!code ++]
				chara = CharaGen.CreateFromFilter(SpawnListChara.Get("summon_yeek", (SourceChara.Row r) => r.race == "yeek"), power / 10); // [!code ++]
				break; // [!code ++]
			case "orc": // [!code ++]
				chara = CharaGen.CreateFromFilter(SpawnListChara.Get("summon_orc", (SourceChara.Row r) => r.race == "orc"), power / 10); // [!code ++]
				break; // [!code ++]
			case "pawn": // [!code ++]
				chara = CharaGen.CreateFromFilter("c_pawn", power / 10); // [!code ++]
				break; // [!code ++]
			case "monster": // [!code ++]
				chara = CharaGen.CreateFromFilter("c_dungeon", power / 10); // [!code ++]
				break; // [!code ++]
			case "animal": // [!code ++]
				chara = CharaGen.CreateFromFilter("c_animal", power / 15); // [!code ++]
				break; // [!code ++]
			case "fire": // [!code ++]
				chara = CharaGen.CreateFromElement("Fire", power / 10); // [!code ++]
				break; // [!code ++]
			case "fish": // [!code ++]
				chara = CharaGen.CreateFromFilter(SpawnListChara.Get("summon_fish", (SourceChara.Row r) => r.ContainsTag("water") || r.model.Chara.race.tag.Contains("water")), power / 10); // [!code ++]
				break; // [!code ++]
			case "octopus": // [!code ++]
				chara = CharaGen.CreateFromFilter(SpawnListChara.Get("summon_octopus", (SourceChara.Row r) => r.race == "octopus"), power / 10); // [!code ++]
				break; // [!code ++]
			default: // [!code ++]
				chara = CharaGen.Create(id3, power / 10); // [!code ++]
				break; // [!code ++]
			}
			chara = actRef.n1 switch // [!code --]
			{ // [!code --]
				"special" => (j != 0 || CC.HasMinion("imolonac") || CC.HasMinion("ygolonac")) ? CharaGen.Create("hound", 50) : CharaGen.Create((EClass.rnd(20) == 0) ? "imolonac" : "ygolonac"),  // [!code --]
				"yeek" => CharaGen.CreateFromFilter(SpawnListChara.Get("summon_yeek", (SourceChara.Row r) => r.race == "yeek"), power / 10),  // [!code --]
				"orc" => CharaGen.CreateFromFilter(SpawnListChara.Get("summon_orc", (SourceChara.Row r) => r.race == "orc"), power / 10),  // [!code --]
				"pawn" => CharaGen.CreateFromFilter("c_pawn", power / 10),  // [!code --]
				"monster" => CharaGen.CreateFromFilter("c_dungeon", power / 10),  // [!code --]
				"animal" => CharaGen.CreateFromFilter("c_animal", power / 15),  // [!code --]
				"fire" => CharaGen.CreateFromElement("Fire", power / 10),  // [!code --]
				"fish" => CharaGen.CreateFromFilter(SpawnListChara.Get("summon_fish", (SourceChara.Row r) => r.ContainsTag("water") || r.model.Chara.race.tag.Contains("water")), power / 10),  // [!code --]
				"octopus" => CharaGen.CreateFromFilter(SpawnListChara.Get("summon_octopus", (SourceChara.Row r) => r.race == "octopus"), power / 10),  // [!code --]
				_ => CharaGen.Create(id3, power / 10),  // [!code --]
			}; // [!code --]
			if (chara == null)
			{
				continue;
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/ActEffect.cs#L602-L608)
```cs:line-numbers=602
				continue;
			}
			int num6 = -1;
			num6 = ((!(actRef.n1 == "shadow")) ? (chara.LV * (100 + power / 10) / 100 + power / 30) : (power / 10 + 1)); // [!code --]
			string n = actRef.n1; // [!code ++]
			if (!(n == "shadow")) // [!code ++]
			{ // [!code ++]
				if (!(n == "special")) // [!code ++]
				{ // [!code ++]
					num6 = chara.LV * (100 + power / 10) / 100 + power / 30; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				num6 = power / 10 + 1; // [!code ++]
			} // [!code ++]
			if (chara.LV < num6)
			{
				chara.SetLv(num6);
```

[`public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/ActEffect.cs#L612-L618)
```cs:line-numbers=612
			{
				chara.c_fur = -1;
			}
			string n = actRef.n1; // [!code --]
			n = actRef.n1; // [!code ++]
			if (!(n == "shadow"))
			{
				if (n == "special_force")
```

## Affinity

[`public bool CanInvite()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Affinity.cs#L62-L72)
```cs:line-numbers=62

	public bool CanGiveCard()
	{
		if (!EClass.debug.marryAnytime) // [!code --]
		{ // [!code --]
			return CurrentStage >= Stage.Love; // [!code --]
		} // [!code --]
		return true; // [!code --]
		return CurrentStage >= Stage.Love; // [!code ++]
	}

	public bool CanMarry()
```

[`public bool CanSleepBeside()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Affinity.cs#L87-L92)
```cs:line-numbers=87
		return true;
	}

	public int GetLunchChance() // [!code ++]
	{ // [!code ++]
		if (!EClass.debug.enable) // [!code ++]
		{ // [!code ++]
			if (CurrentStage < Stage.LoveLoveLove) // [!code ++]
			{ // [!code ++]
				if (CurrentStage < Stage.LoveLove) // [!code ++]
				{ // [!code ++]
					if (CurrentStage < Stage.Love) // [!code ++]
					{ // [!code ++]
						return 0; // [!code ++]
					} // [!code ++]
					return 10; // [!code ++]
				} // [!code ++]
				return 25; // [!code ++]
			} // [!code ++]
			return 50; // [!code ++]
		} // [!code ++]
		return 100; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public Sprite GetIcon()
	{
		int affinity = CC._affinity;
```

## CINT

[`public class CINT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CINT.cs#L108-L113)
```cs:line-numbers=108

	public const int dateSpecialSummon = 70;

	public const int dateLunchGift = 71; // [!code ++]
 // [!code ++]
	public const int fiamaPet = 100;

	public const int noRestock = 101;
```

[`public class CINT`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CINT.cs#L152-L157)
```cs:line-numbers=152

	public const int price_copy = 124;

	public const int isHalfEaten = 125; // [!code ++]
 // [!code ++]
	public const int dateDeathLock = 130;

	public const int fixedValue = 131;
```

## COBJ

[`public class COBJ`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/COBJ.cs#L33-L36)
```cs:line-numbers=33
	public const int corruptionHistory = 16;

	public const int socketList = 17;
 // [!code ++]
	public const int mixedFoodData = 18; // [!code ++]
}
```

## Card

[`public CharaList c_charaList`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Card.cs#L1863-L1868)
```cs:line-numbers=1863
		}
	}

	public MixedFoodData c_mixedFoodData // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			return GetObj<MixedFoodData>(18); // [!code ++]
		} // [!code ++]
		set // [!code ++]
		{ // [!code ++]
			SetObj(18, value); // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public byte[] c_textureData
	{
		get
```

[`public bool IsPowerful`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Card.cs#L2034-L2040)
```cs:line-numbers=2034
	{
		if (rarity >= Rarity.Legendary || trait is TraitAdventurer)
		{
			return !IsPCFaction; // [!code --]
			return !IsPCFactionOrMinion; // [!code ++]
		}
		return false;
	}
```

[`public Thing TryMakeRandomItem(int lv = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Card.cs#L5195-L5200)
```cs:line-numbers=5195
	case "egg_fertilized":
	case "_meat":
	case "meat_marble":
	case "dattamono": // [!code ++]
	case "deadbody": // [!code ++]
	{
		string text = "c_wilds";
		if (id == "_meat" || id == "meat_marble")
```

## Chara

[`public override bool isSynced`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L703-L709)
```cs:line-numbers=703

	public override bool IsMultisize => sourceCard.multisize;

	public override int MaxHP => (int)Mathf.Clamp(((long)(base.END * 2 + base.STR + base.WIL / 2) * (long)Mathf.Min(base.LV, 25) / 25 + base.END + 10) * Evalue(60) / 100 * ((IsPCFaction ? 100 : (100 + (int)base.rarity * 300)) + (IsPC ? (EClass.player.lastEmptyAlly * Evalue(1646)) : 0)) / 100, 1f, 100000000f); // [!code --]
	public override int MaxHP => (int)Mathf.Clamp(((long)(base.END * 2 + base.STR + base.WIL / 2) * (long)Mathf.Min(base.LV, 25) / 25 + base.END + 10) * Evalue(60) / 100 * ((base.IsPCFactionOrMinion ? 100 : (100 + (int)base.rarity * 300)) + (IsPC ? (EClass.player.lastEmptyAlly * Evalue(1646)) : 0)) / 100, 1f, 100000000f); // [!code ++]

	public override int WeightLimit => Mathf.Max((base.STR * 500 + base.END * 250 + Evalue(207) * 2000) * ((!HasElement(1411)) ? 1 : 5) + 45000, 1000);

```

[`public override void OnCreate(int genLv)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L1550-L1556)
```cs:line-numbers=1550
		Tuple<string, int, int> tuple = list.RandomItemWeighted((Tuple<string, int, int> a) => 10000 / (100 + (_genLv - a.Item3) * 25));
		if (!bp.idEle.IsEmpty())
		{
			tuple = list.Where((Tuple<string, int, int> a) => a.Item1 == bp.idEle).FirstOrDefault() ?? tuple; // [!code --]
			tuple = list.Where((Tuple<string, int, int> a) => a.Item1 == bp.idEle || "ele" + a.Item1 == bp.idEle).FirstOrDefault() ?? tuple; // [!code ++]
		}
		SetMainElement(tuple.Item1, (tuple.Item2 == 0) ? 10 : tuple.Item2, elemental: true);
		if (list.Count >= 2)
```

[`public void RefreshSpeed(Element.BonusInfo info = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L1807-L1812)
```cs:line-numbers=1807
	{
		ride.RefreshSpeed();
		_Speed = ride._Speed;
		info?.AddText("rideSpeed".lang(_Speed.ToString() ?? "")); // [!code ++]
	}
	else if (host != null)
	{
```

[`public void RefreshSpeed(Element.BonusInfo info = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L1831-L1837)
```cs:line-numbers=1831
	}
	if (parasite != null)
	{
		int speed = _Speed; // [!code ++]
		_Speed = _Speed * 100 / Mathf.Clamp(120 + parasite.LV * 2 - base.STR - Evalue(227) * 2, 100, 1000);
		info?.AddText(_Speed - speed, "parasiteSpeed".lang()); // [!code ++]
	}
	if (_Speed < elements.ValueWithoutLink(79) / 3)
	{
```

[`public void ShowDialog()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L6692-L6731)
```cs:line-numbers=6692
	{
		RemoveCondition<ConSuspend>();
	}
	if (IsDeadOrSleeping) // [!code --]
	if (LayerDrama.forceJump == null) // [!code ++]
	{
		ShowDialog("_chara", "sleep"); // [!code --]
	} // [!code --]
	else if (EClass.pc.isHidden && !CanSee(EClass.pc)) // [!code --]
	{ // [!code --]
		ShowDialog("_chara", "invisible"); // [!code --]
	} // [!code --]
	else if (base.isRestrained) // [!code --]
	{ // [!code --]
		ShowDialog("_chara", "strain"); // [!code --]
	} // [!code --]
	else if (base.IsUnique && !EClass.player.codex.DroppedCard(id) && affinity.CanGiveCard()) // [!code --]
	{ // [!code --]
		EClass.player.codex.MarkCardDrop(id); // [!code --]
		ShowDialog("_chara", "give_card"); // [!code --]
		Thing thing = ThingGen.Create("figure"); // [!code --]
		thing.MakeFigureFrom(id); // [!code --]
		EClass.player.DropReward(thing); // [!code --]
		thing = ThingGen.Create("figure3"); // [!code --]
		thing.MakeFigureFrom(id); // [!code --]
		EClass.player.DropReward(thing); // [!code --]
	} // [!code --]
	else if (IsEscorted()) // [!code --]
	{ // [!code --]
		ShowDialog("_chara", "escort"); // [!code --]
	} // [!code --]
	else if (EClass._zone is Zone_Music) // [!code --]
	{ // [!code --]
		ShowDialog("_chara", "party"); // [!code --]
	} // [!code --]
	else // [!code --]
	{ // [!code --]
		if (LayerDrama.forceJump == null && EClass.game.quests.OnShowDialog(this)) // [!code --]
		if (IsDeadOrSleeping) // [!code ++]
		{ // [!code ++]
			ShowDialog("_chara", "sleep"); // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		if (EClass.pc.isHidden && !CanSee(EClass.pc)) // [!code ++]
		{ // [!code ++]
			ShowDialog("_chara", "invisible"); // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		if (!IsPC && !EClass.player.codex.DroppedCard(id) && affinity.CanGiveCard()) // [!code ++]
		{ // [!code ++]
			EClass.player.codex.MarkCardDrop(id); // [!code ++]
			ShowDialog("_chara", "give_card"); // [!code ++]
			Thing thing = ThingGen.Create("figure"); // [!code ++]
			thing.MakeFigureFrom(id); // [!code ++]
			EClass.player.DropReward(thing); // [!code ++]
			thing = ThingGen.Create("figure3"); // [!code ++]
			thing.MakeFigureFrom(id); // [!code ++]
			EClass.player.DropReward(thing); // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		if (GetInt(71) == -2) // [!code ++]
		{ // [!code ++]
			ShowDialog("_chara", "give_lunch"); // [!code ++]
			Thing t = CraftUtil.MakeLoveLunch(this); // [!code ++]
			EClass.player.DropReward(t); // [!code ++]
			SetInt(71, EClass.world.date.GetRaw() + 43200); // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		if (base.isRestrained) // [!code ++]
		{ // [!code ++]
			ShowDialog("_chara", "strain"); // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		if (IsEscorted()) // [!code ++]
		{ // [!code ++]
			ShowDialog("_chara", "escort"); // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		if (EClass._zone is Zone_Music) // [!code ++]
		{ // [!code ++]
			ShowDialog("_chara", "party"); // [!code ++]
			return; // [!code ++]
		} // [!code ++]
		if (EClass.game.quests.OnShowDialog(this)) // [!code ++]
		{
			return;
		}
```

[`public void ShowDialog()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L6837-L6855)
```cs:line-numbers=6837
				ShowDialog("guild_clerk", "main", tag2);
				return;
			}
			bool flag = true; // [!code --]
			if (id == "parttimer_jure" && (!EClass._zone.IsFestival || !(EClass._zone is Zone_Noyel) || EClass.pc.faith == EClass.game.religions.Healing)) // [!code --]
			{ // [!code --]
				flag = false; // [!code --]
			} // [!code --]
			if (flag && File.Exists(CorePath.DramaData + id + ".xlsx")) // [!code --]
			{ // [!code --]
				ShowDialog(id); // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				ShowDialog("_chara"); // [!code --]
			} // [!code --]
		} // [!code ++]
		bool flag = true; // [!code ++]
		if (id == "parttimer_jure" && (!EClass._zone.IsFestival || !(EClass._zone is Zone_Noyel) || EClass.pc.faith == EClass.game.religions.Healing)) // [!code ++]
		{ // [!code ++]
			flag = false; // [!code ++]
		} // [!code ++]
		if (flag && File.Exists(CorePath.DramaData + id + ".xlsx")) // [!code ++]
		{ // [!code ++]
			ShowDialog(id); // [!code ++]
		} // [!code ++]
		else // [!code ++]
		{ // [!code ++]
			ShowDialog("_chara"); // [!code ++]
		}
	}

```

[`public void InstantEat(Thing t = null, bool sound = true)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L7203-L7209)
```cs:line-numbers=7203
				PlaySound("eat");
			}
			FoodEffect.Proc(this, t);
			t.ModNum(-1); // [!code --]
		}
	}

```

[`public void ModAffinity(Chara c, int a, bool show = true, bool showOnlyEmo = fal`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L7536-L7541)
```cs:line-numbers=7536
	if (flag)
	{
		a = a * num / 100;
		if (affinity.GetLunchChance() > EClass.rnd(100) && GetInt(71) >= 0 && GetInt(71) < EClass.world.date.GetRaw()) // [!code ++]
		{ // [!code ++]
			SetInt(71, -1); // [!code ++]
		} // [!code ++]
	}
	if (show)
	{
```

[`public SourceThing.Row GetFavFood()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L7611-L7617)
```cs:line-numbers=7611
	{
		foreach (SourceThing.Row row in EClass.sources.things.rows)
		{
			if (row._origin == "dish" && row.value != 0) // [!code --]
			if (row._origin == "dish" && row.value != 0 && row.chance != 0) // [!code ++]
			{
				_listFavFood.Add(row);
			}
```

[`public Thing MakeGene(DNA.Type? type = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Chara.cs#L7729-L7741)
```cs:line-numbers=7729
		return DNA.GenerateGene(this, type);
	}

	public Thing MakeLunch() // [!code --]
	{ // [!code --]
		Thing thing = ThingGen.Create("lunch_love"); // [!code --]
		thing.MakeRefFrom(this); // [!code --]
		return thing; // [!code --]
	} // [!code --]
 // [!code --]
	public Thing MakeBraineCell()
	{
		return DNA.GenerateGene(this, DNA.Type.Brain);
```

## CharaAbility

[`public class CharaAbility : EClass`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CharaAbility.cs#L29-L34)
```cs:line-numbers=29
		case 5048:
		case 6400:
		case 6410:
		case 6800: // [!code ++]
		case 8200:
			continue;
		}
```

## CoreDebug

[`public void UpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CoreDebug.cs#L929-L942)
```cs:line-numbers=929
		EClass.game.world.date.year = 3000;
		EClass._zone.development += 10;
		EClass._zone.development *= EClass._zone.development;
		EClass.pc.Pick(ThingGen.CreateSpellbook(8550)); // [!code --]
		EClass.pc.Pick(ThingGen.CreatePotion(8550)); // [!code --]
		EClass.pc.Pick(ThingGen.CreateSpellbook(9004)); // [!code --]
		EClass.pc.Pick(ThingGen.CreateRedBook("advweek_1")); // [!code --]
		Chara targetChara = EClass.scene.mouseTarget.TargetChara;
		if (targetChara != null)
		{
			EClass.pc.Pick(targetChara.MakeLunch()); // [!code --]
			EClass.pc.Pick(CraftUtil.MakeLoveLunch(targetChara)); // [!code ++]
			EClass.pc.Pick(CraftUtil.MakeDarkSoup()); // [!code ++]
			EClass.pc.Pick(targetChara.MakeMilk());
			EClass.pc.Pick(targetChara.MakeGene());
			EClass.pc.Pick(targetChara.MakeBraineCell());
```

[`public void UpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CoreDebug.cs#L979-L987)
```cs:line-numbers=979
		{
			EClass.Branch.ModExp(EClass.Branch.GetNextExp());
		}
		foreach (Chara chara2 in EClass._map.charas) // [!code --]
		foreach (Chara item in EClass._map.charas.ToList()) // [!code ++]
		{
			chara2.AddExp(chara2.ExpToNext); // [!code --]
			item.AddExp(item.ExpToNext); // [!code ++]
			item.Vomit(); // [!code ++]
		}
		EClass.pc.PlayEffect("boost");
		EClass.pc.PlaySound("boost");
```

[`public void UpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CoreDebug.cs#L1160-L1168)
```cs:line-numbers=1160
	{
		if (Input.GetMouseButtonDown(0))
		{
			foreach (Card item in list) // [!code --]
			foreach (Card item2 in list) // [!code ++]
			{
				Debug.Log(item.Name + "/" + item.dir + "/" + item.flipX + "/" + item.angle); // [!code --]
				Debug.Log(item2.Name + "/" + item2.dir + "/" + item2.flipX + "/" + item2.angle); // [!code ++]
			}
		}
		if (Input.GetMouseButtonDown(1))
```

[`public void UpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CoreDebug.cs#L1195-L1203)
```cs:line-numbers=1195
		}
		if (key)
		{
			foreach (Card item2 in EClass._map.Roaming.all) // [!code --]
			foreach (Card item3 in EClass._map.Roaming.all) // [!code ++]
			{
				EClass._zone.RemoveCard(item2); // [!code --]
				EClass._zone.RemoveCard(item3); // [!code ++]
			}
		}
		else if (hitPoint.detail != null)
```

[`public void UpdateInput()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CoreDebug.cs#L1276-L1284)
```cs:line-numbers=1276
		{
			break;
		}
		foreach (Card item3 in hitPoint.ListCards()) // [!code --]
		foreach (Card item4 in hitPoint.ListCards()) // [!code ++]
		{
			item3.renderer.PlayAnime(num5.ToEnum<AnimeID>()); // [!code --]
			item4.renderer.PlayAnime(num5.ToEnum<AnimeID>()); // [!code ++]
		}
		Debug.Log(num5.ToEnum<AnimeID>());
		break;
```

## CraftUtil

[`public static void MakeDish(Thing food, int lv, Chara crafter = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CraftUtil.cs#L65-L71)
```cs:line-numbers=65
	int num = Mathf.Min(EClass.rnd(lv), 50);
	foreach (Recipe.Ingredient ingredient in recipeSource.GetIngredients())
	{
		Thing thing = ThingGen.Create(ingredient.id); // [!code --]
		Thing thing = ThingGen.Create(ingredient.id).TryMakeRandomItem(lv); // [!code ++]
		TraitSeed.LevelSeed(thing, null, EClass.rnd(lv / 4) + 1);
		thing.SetEncLv(thing.encLV / 2);
		if (num > 0 && EClass.rnd(3) == 0)
```

[`public static void MakeDish(Thing food, int lv, Chara crafter = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/CraftUtil.cs#L88-L93)
```cs:line-numbers=88
		}
	}

	public static Thing MakeDarkSoup() // [!code ++]
	{ // [!code ++]
		Thing thing = ThingGen.Create("soup_dark"); // [!code ++]
		for (int i = 0; i < 4 + EClass.rnd(4); i++) // [!code ++]
		{ // [!code ++]
			Chara c = EClass._map.charas.RandomItem(); // [!code ++]
			AddIngredient(thing, c, GetRandomDarkSoupIngredient(c)); // [!code ++]
		} // [!code ++]
		if (!EClass.debug.autoIdentify) // [!code ++]
		{ // [!code ++]
			thing.c_IDTState = 1; // [!code ++]
		} // [!code ++]
		return thing; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public static Thing GetRandomDarkSoupIngredient(Chara c) // [!code ++]
	{ // [!code ++]
		return ThingGen.CreateFromFilter("darksoup", c.LV); // [!code ++]
	} // [!code ++]
 // [!code ++]
	public static Thing MakeLoveLunch(Chara c) // [!code ++]
	{ // [!code ++]
		Thing thing = ThingGen.Create("lunch_love"); // [!code ++]
		thing.MakeRefFrom(c); // [!code ++]
		int num = c.uid + EClass.world.date.year * 10000 + EClass.world.date.month * 100; // [!code ++]
		Rand.SetSeed(num); // [!code ++]
		int num2 = 3 + EClass.rnd(3); // [!code ++]
		if (!EClass.debug.autoIdentify) // [!code ++]
		{ // [!code ++]
			thing.c_IDTState = 5; // [!code ++]
		} // [!code ++]
		for (int i = 0; i < num2; i++) // [!code ++]
		{ // [!code ++]
			Rand.SetSeed(num + i); // [!code ++]
			AddIngredient(thing, c, GetRandomLoveLunchIngredient(c), writeCrafter: false); // [!code ++]
		} // [!code ++]
		Rand.SetSeed(); // [!code ++]
		return thing; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public static Thing GetRandomLoveLunchIngredient(Chara c) // [!code ++]
	{ // [!code ++]
		Thing thing = null; // [!code ++]
		int lV = c.LV; // [!code ++]
		for (int i = 0; i < 3; i++) // [!code ++]
		{ // [!code ++]
			thing = ThingGen.Create("dish", -1, lV + i * 3); // [!code ++]
			if (!thing.HasTag(CTAG.dish_fail)) // [!code ++]
			{ // [!code ++]
				break; // [!code ++]
			} // [!code ++]
		} // [!code ++]
		MakeDish(thing, lV, c); // [!code ++]
		return thing; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public static void AddIngredient(Card product, Chara c, Card ing, bool writeCrafter = true) // [!code ++]
	{ // [!code ++]
		if (product.c_mixedFoodData == null) // [!code ++]
		{ // [!code ++]
			product.c_mixedFoodData = new MixedFoodData(); // [!code ++]
		} // [!code ++]
		product.c_mixedFoodData.texts.Add(ing.Name + (writeCrafter ? "isMixedBy".lang(c.NameSimple) : "")); // [!code ++]
		foreach (Element value in ing.elements.dict.Values) // [!code ++]
		{ // [!code ++]
			if (!IsValidTrait(value)) // [!code ++]
			{ // [!code ++]
				continue; // [!code ++]
			} // [!code ++]
			if (value.IsFoodTraitMain) // [!code ++]
			{ // [!code ++]
				int num = value.Value; // [!code ++]
				if (product.id == "lunch_dystopia") // [!code ++]
				{ // [!code ++]
					num *= -1; // [!code ++]
				} // [!code ++]
				product.elements.ModBase(value.id, num); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				int num2 = product.elements.Base(value.id); // [!code ++]
				if ((num2 <= 0 && value.Value < 0 && value.Value < num2) || (value.Value > 0 && value.Value > num2)) // [!code ++]
				{ // [!code ++]
					product.elements.SetTo(value.id, value.Value); // [!code ++]
				} // [!code ++]
			} // [!code ++]
		} // [!code ++]
		product.elements.ModBase(10, ing.Evalue(10)); // [!code ++]
		static bool IsValidTrait(Element e) // [!code ++]
		{ // [!code ++]
			if (e.HasTag("noInherit")) // [!code ++]
			{ // [!code ++]
				return false; // [!code ++]
			} // [!code ++]
			if (e.IsFoodTrait || e.IsTrait || e.id == 2) // [!code ++]
			{ // [!code ++]
				return true; // [!code ++]
			} // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public static void MakeDish(Card food, List<Thing> ings, int qualityBonus, Chara crafter = null)
	{
		List<Thing> list = new List<Thing>();
```

## DramaCustomSequence

[`void Invest(bool quick)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/DramaCustomSequence.cs#L1336-L1342)
```cs:line-numbers=1336
				SE.Pay();
				EClass.pc.ModCurrency(-cost);
				TempTalkTopic("food2", StepDefault);
				FoodEffect.Proc(EClass.pc, ThingGen.Create("dish_lunch")); // [!code --]
				FoodEffect.Proc(EClass.pc, ThingGen.Create("dish_lunch"), consume: false); // [!code ++]
				EClass.pc.hunger.value = 0;
			}
		});
```

## ELEMENT

[`public static Dictionary<int, int> GetElementMap(int[] list, Dictionary<int, int`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/ELEMENT.cs#L551-L557)
```cs:line-numbers=551
		return map;
	}

	public static SourceElement.Row GetRandomElement(int lv = 1) // [!code --]
	public static SourceElement.Row GetRandomElement(int lv = 1, bool useWeight = true) // [!code ++]
	{
		if (lv > 100)
		{
```

[`public static SourceElement.Row GetRandomElement(int lv = 1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/ELEMENT.cs#L576-L582)
```cs:line-numbers=576
				list.Add(new Tuple<SourceElement.Row, int>(listElement, num));
			}
		}
		return list.RandomItemWeighted((Tuple<SourceElement.Row, int> a) => 10000 / (100 + (lv - a.Item2) * 25)).Item1; // [!code --]
		return (useWeight ? list.RandomItemWeighted((Tuple<SourceElement.Row, int> a) => 10000 / (100 + (lv - a.Item2) * 25)) : list.RandomItem()).Item1; // [!code ++]
	}

	public void WriteNote(UINote n, ElementContainer owner = null, Action<UINote> onWriteNote = null)
```

## Emo2

[`public enum Emo2`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Emo2.cs#L20-L24)
```cs:line-numbers=20
	brush_hate,
	brush_like,
	brush_like2,
	brush_like3 // [!code --]
	brush_like3, // [!code ++]
	hintEvent // [!code ++]
}
```

## FactionBranch

[`public void OnSimulateHour(VirtualDate date)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/FactionBranch.cs#L340-L346)
```cs:line-numbers=340
					if (meal != null)
					{
						FoodEffect.Proc(c, meal);
						meal.Destroy(); // [!code --]
					}
					else
					{
```

## FoodEffect

[``](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/FoodEffect.cs#L3-L9)
```cs:line-numbers=3

public class FoodEffect : EClass
{
	public static void Proc(Chara c, Thing food) // [!code --]
	public static void Proc(Chara c, Thing food, bool consume = true) // [!code ++]
	{
		food.CheckJustCooked();
		bool flag = EClass._zone.IsPCFaction && c.IsInSpot<TraitSpotDining>();
```

[`public static void Proc(Chara c, Thing food)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/FoodEffect.cs#L21-L34)
```cs:line-numbers=21
	bool flag3 = food.HasElement(709);
	bool flag4 = c.HasElement(1205);
	bool flag5 = food.IsDecayed || flag3;
	bool flag6 = food.trait is TraitLunchLove; // [!code ++]
	c.AddFoodHistory(food);
	if (c.IsPCFaction && !c.IsPC)
	{
		int num6 = c.CountNumEaten(food);
		bool flag6 = c.GetFavFood().id == food.id; // [!code --]
		if (num6 < 2 || flag6) // [!code --]
		bool flag7 = c.GetFavFood().id == food.id; // [!code ++]
		if (num6 < 2 || flag7) // [!code ++]
		{
			if (num6 == 1 || flag6 || EClass.rnd(4) == 0) // [!code --]
			if (num6 == 1 || flag7 || EClass.rnd(4) == 0) // [!code ++]
			{
				c.Talk("foodNice");
			}
```

[`public static void Proc(Chara c, Thing food)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/FoodEffect.cs#L154-L164)
```cs:line-numbers=154
			float num8 = num2 * (float)value.Value;
			if (value.source.category == "food" && c.IsPC)
			{
				bool flag7 = num8 >= 0f; // [!code --]
				string text = value.source.GetText(flag7 ? "textInc" : "textDec", returnNull: true); // [!code --]
				bool flag8 = num8 >= 0f; // [!code ++]
				string text = value.source.GetText(flag8 ? "textInc" : "textDec", returnNull: true); // [!code ++]
				if (text != null)
				{
					Msg.SetColor(flag7 ? "positive" : "negative"); // [!code --]
					Msg.SetColor(flag8 ? "positive" : "negative"); // [!code ++]
					c.Say(text);
				}
			}
```

[`public static void Proc(Chara c, Thing food)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/FoodEffect.cs#L181-L186)
```cs:line-numbers=181
				c.PlaySound("ding_potential");
				c.elements.ModExp(306, -1000f);
				c.SetInt(117, int2 + 1);
				flag6 = false; // [!code ++]
				break;
			}
			case "exp":
```

[`public static void Proc(Chara c, Thing food)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/FoodEffect.cs#L244-L249)
```cs:line-numbers=244
					c.SetFeat(1230, c.elements.Base(1230) + 1);
				}
				c.SetInt(112, @int + 1);
				flag6 = false; // [!code ++]
				break;
			}
			}
```

[`public static void Proc(Chara c, Thing food)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/FoodEffect.cs#L355-L360)
```cs:line-numbers=355
		{
			food.trait.OnDrink(c);
		}
		if (consume) // [!code ++]
		{ // [!code ++]
			num7 += 5f; // [!code ++]
			if (flag6 && (float)food.Evalue(10) > num7 + 10f) // [!code ++]
			{ // [!code ++]
				food.elements.SetTo(10, (int)Mathf.Max((float)food.Evalue(10) - num7, 1f)); // [!code ++]
				food.SetBool(125, enable: true); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				food.ModNum(-1); // [!code ++]
			} // [!code ++]
		} // [!code ++]
	}

	public static void ProcTrait(Chara c, Card t)
```

## LayerSleep

[`public void Advance()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/LayerSleep.cs#L58-L63)
```cs:line-numbers=58
		{
			ELayer.player.SimulateFaction();
		}
		foreach (Chara chara in ELayer._map.charas) // [!code ++]
		{ // [!code ++]
			if (chara.affinity.GetLunchChance() > ELayer.rnd(100) && chara.GetInt(71) == -1) // [!code ++]
			{ // [!code ++]
				chara.SetInt(71, -2); // [!code ++]
			} // [!code ++]
		} // [!code ++]
		foreach (Chara member in ELayer.pc.party.members)
		{
			member.OnSleep(bed);
```

## +MixedFoodData

::: details File Created
```cs
using System.Collections.Generic;
using Newtonsoft.Json;

public class MixedFoodData : EClass
{
	[JsonProperty]
	public List<string> texts = new List<string>();
}
```

:::
## SourceFood

[`public override Row CreateRow()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/SourceFood.cs#L61-L102)
```cs:line-numbers=61
			unit = SourceData.GetString(5),
			name2_JP = SourceData.GetStringArray(6),
			name2 = SourceData.GetStringArray(7),
			tiles = SourceData.GetIntArray(8), // [!code --]
			parse = SourceData.GetStringArray(9), // [!code --]
			vals = SourceData.GetStringArray(10), // [!code --]
			trait = SourceData.GetStringArray(11), // [!code --]
			elements = Core.ParseElements(SourceData.GetStr(12)), // [!code --]
			idTaste = SourceData.GetString(14), // [!code --]
			TST = SourceData.GetInt(15), // [!code --]
			NUT = SourceData.GetInt(16), // [!code --]
			STR = SourceData.GetInt(17), // [!code --]
			STR2 = SourceData.GetInt(18), // [!code --]
			END = SourceData.GetInt(19), // [!code --]
			END2 = SourceData.GetInt(20), // [!code --]
			DEX = SourceData.GetInt(21), // [!code --]
			DEX2 = SourceData.GetInt(22), // [!code --]
			PER = SourceData.GetInt(23), // [!code --]
			PER2 = SourceData.GetInt(24), // [!code --]
			LER = SourceData.GetInt(25), // [!code --]
			LER2 = SourceData.GetInt(26), // [!code --]
			WIL = SourceData.GetInt(27), // [!code --]
			WIL2 = SourceData.GetInt(28), // [!code --]
			MAG = SourceData.GetInt(29), // [!code --]
			MAG2 = SourceData.GetInt(30), // [!code --]
			CHA = SourceData.GetInt(31), // [!code --]
			CHA2 = SourceData.GetInt(32), // [!code --]
			LV = SourceData.GetInt(34), // [!code --]
			chance = SourceData.GetInt(35), // [!code --]
			value = SourceData.GetInt(36), // [!code --]
			weight = SourceData.GetInt(37), // [!code --]
			recipeKey = SourceData.GetStringArray(38), // [!code --]
			factory = SourceData.GetStringArray(39), // [!code --]
			components = SourceData.GetStringArray(40), // [!code --]
			defMat = SourceData.GetString(41), // [!code --]
			category = SourceData.GetString(42), // [!code --]
			tag = SourceData.GetStringArray(43), // [!code --]
			detail_JP = SourceData.GetString(44), // [!code --]
			detail = SourceData.GetString(45) // [!code --]
			unknown_JP = SourceData.GetString(8), // [!code ++]
			unknown = SourceData.GetString(9), // [!code ++]
			tiles = SourceData.GetIntArray(10), // [!code ++]
			parse = SourceData.GetStringArray(11), // [!code ++]
			vals = SourceData.GetStringArray(12), // [!code ++]
			trait = SourceData.GetStringArray(13), // [!code ++]
			elements = Core.ParseElements(SourceData.GetStr(14)), // [!code ++]
			idTaste = SourceData.GetString(16), // [!code ++]
			TST = SourceData.GetInt(17), // [!code ++]
			NUT = SourceData.GetInt(18), // [!code ++]
			STR = SourceData.GetInt(19), // [!code ++]
			STR2 = SourceData.GetInt(20), // [!code ++]
			END = SourceData.GetInt(21), // [!code ++]
			END2 = SourceData.GetInt(22), // [!code ++]
			DEX = SourceData.GetInt(23), // [!code ++]
			DEX2 = SourceData.GetInt(24), // [!code ++]
			PER = SourceData.GetInt(25), // [!code ++]
			PER2 = SourceData.GetInt(26), // [!code ++]
			LER = SourceData.GetInt(27), // [!code ++]
			LER2 = SourceData.GetInt(28), // [!code ++]
			WIL = SourceData.GetInt(29), // [!code ++]
			WIL2 = SourceData.GetInt(30), // [!code ++]
			MAG = SourceData.GetInt(31), // [!code ++]
			MAG2 = SourceData.GetInt(32), // [!code ++]
			CHA = SourceData.GetInt(33), // [!code ++]
			CHA2 = SourceData.GetInt(34), // [!code ++]
			LV = SourceData.GetInt(36), // [!code ++]
			chance = SourceData.GetInt(37), // [!code ++]
			value = SourceData.GetInt(38), // [!code ++]
			weight = SourceData.GetInt(39), // [!code ++]
			recipeKey = SourceData.GetStringArray(40), // [!code ++]
			factory = SourceData.GetStringArray(41), // [!code ++]
			components = SourceData.GetStringArray(42), // [!code ++]
			defMat = SourceData.GetString(43), // [!code ++]
			category = SourceData.GetString(44), // [!code ++]
			tag = SourceData.GetStringArray(45), // [!code ++]
			detail_JP = SourceData.GetString(46), // [!code ++]
			detail = SourceData.GetString(47) // [!code ++]
		};
	}

```

[`public override void OnImportRow(Row _r, SourceThing.Row c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/SourceFood.cs#L131-L136)
```cs:line-numbers=131
	c.elements = list.ToArray();
	c.name2 = row.name2;
	c.name2_JP = row.name2_JP;
	c.unknown = row.unknown; // [!code ++]
	c.unknown_JP = row.unknown_JP; // [!code ++]
	if (!row.unit_JP.IsEmpty())
	{
		c.unit_JP = row.unit_JP;
```

## StatsMana

[``](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/StatsMana.cs#L2-L8)
```cs:line-numbers=2

public class StatsMana : Stats
{
	public override int max => (int)Mathf.Clamp(((long)(BaseStats.CC.MAG * 2 + BaseStats.CC.WIL + BaseStats.CC.LER / 2) * (long)Mathf.Min(BaseStats.CC.LV, 25) / 25 + BaseStats.CC.MAG + 10) * (BaseStats.CC.Evalue(61) - BaseStats.CC.Evalue(93)) / 100 * ((BaseStats.CC.IsPCFaction ? 100 : (100 + (int)BaseStats.CC.rarity * 250)) + (BaseStats.CC.IsPC ? (EClass.player.lastEmptyAlly * BaseStats.CC.Evalue(1646)) : 0)) / 100, 1f, 100000000f); // [!code --]
	public override int max => (int)Mathf.Clamp(((long)(BaseStats.CC.MAG * 2 + BaseStats.CC.WIL + BaseStats.CC.LER / 2) * (long)Mathf.Min(BaseStats.CC.LV, 25) / 25 + BaseStats.CC.MAG + 10) * (BaseStats.CC.Evalue(61) - BaseStats.CC.Evalue(93)) / 100 * ((BaseStats.CC.IsPCFactionOrMinion ? 100 : (100 + (int)BaseStats.CC.rarity * 250)) + (BaseStats.CC.IsPC ? (EClass.player.lastEmptyAlly * BaseStats.CC.Evalue(1646)) : 0)) / 100, 1f, 100000000f); // [!code ++]

	public override int min => -999999;

```

## TCOrbitChara

[`public void RefreshAll()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/TCOrbitChara.cs#L72-L77)
```cs:line-numbers=72
		{
			emo = owner.trait.GetRestockedIcon();
		}
		else if (!owner.IsPC && ((owner.affinity.CanGiveCard() && !EMono.player.codex.DroppedCard(owner.id)) || owner.GetInt(71) == -2)) // [!code ++]
		{ // [!code ++]
			emo = Emo2.hintEvent; // [!code ++]
		} // [!code ++]
		else
		{
			bool flag = false;
```

## Thing

[`public override string GetName(NameStyle style, int _num = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Thing.cs#L544-L605)
```cs:line-numbers=544
		{
			text = id;
		}
		if (!isEquipmentOrRangedOrAmmo || !base.IsIdentified || base.rarity < Rarity.Legendary) // [!code --]
		if (isEquipmentOrRangedOrAmmo && base.IsIdentified && base.rarity >= Rarity.Legendary) // [!code ++]
		{
			if (source.naming == "m" || (source.naming == "ms" && base.material != source.DefaultMaterial)) // [!code --]
			if (base.rarity != Rarity.Artifact && !base.material.GetTextArray("altName").IsEmpty()) // [!code ++]
			{
				if (isEquipmentOrRangedOrAmmo) // [!code --]
				{ // [!code --]
					string[] textArray = base.material.GetTextArray("altName"); // [!code --]
					if (textArray != null && textArray.Length >= 2) // [!code --]
					{ // [!code --]
						text = base.material.GetTextArray("altName")[1] + Lang.space + text; // [!code --]
						goto IL_01f2; // [!code --]
					} // [!code --]
				} // [!code --]
				text = "_of2".lang(base.material.GetName(), text); // [!code --]
				text = base.material.GetTextArray("altName")[0] + Lang.space + text; // [!code ++]
			}
			goto IL_01f2; // [!code --]
			goto IL_0215; // [!code ++]
		}
		if (base.rarity != Rarity.Artifact && !base.material.GetTextArray("altName").IsEmpty()) // [!code --]
		if (source.naming == "m" || (source.naming == "ms" && base.material != source.DefaultMaterial)) // [!code ++]
		{
			text = base.material.GetTextArray("altName")[0] + Lang.space + text; // [!code --]
			if (isEquipmentOrRangedOrAmmo) // [!code ++]
			{ // [!code ++]
				string[] textArray = base.material.GetTextArray("altName"); // [!code ++]
				if (textArray != null && textArray.Length >= 2) // [!code ++]
				{ // [!code ++]
					text = base.material.GetTextArray("altName")[1] + Lang.space + text; // [!code ++]
					goto IL_01f2; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			text = "_of2".lang(base.material.GetName(), text); // [!code ++]
		}
		goto IL_01f2; // [!code ++]
	}
	else // [!code --]
	text = "unknown"; // [!code ++]
	string idUnknown = source.GetText("unknown"); // [!code ++]
	if (idUnknown.StartsWith("#")) // [!code ++]
	{
		text = "unknown"; // [!code --]
		string idUnknown = source.GetText("unknown"); // [!code --]
		if (idUnknown.StartsWith("#")) // [!code --]
		Rand.UseSeed(EClass.game.seed + (trait.CanStack ? sourceCard._index : base.uid) + base.refVal, delegate // [!code ++]
		{
			Rand.UseSeed(EClass.game.seed + (trait.CanStack ? sourceCard._index : base.uid) + base.refVal, delegate // [!code --]
			{ // [!code --]
				idUnknown = Lang.GetList(idUnknown.Remove(0, 1)).RandomItem(); // [!code --]
			}); // [!code --]
		} // [!code --]
		text = idUnknown; // [!code --]
			idUnknown = Lang.GetList(idUnknown.Remove(0, 1)).RandomItem(); // [!code ++]
		}); // [!code ++]
	}
	goto IL_02a1; // [!code --]
	IL_02a1: // [!code --]
	if (!base.c_idRefCard.IsEmpty() && trait.RefCardName != RefCardName.None) // [!code --]
	text = idUnknown; // [!code ++]
	goto IL_047d; // [!code ++]
	IL_047d: // [!code ++]
	if (GetBool(125)) // [!code ++]
	{
		string text7 = base.c_altName.IsEmpty(base.refCard.GetName()); // [!code --]
		if (!base.c_idRefCard2.IsEmpty()) // [!code --]
		{ // [!code --]
			text7 = "_and".lang(text7, base.c_altName2.IsEmpty(base.refCard2.GetName())); // [!code --]
		} // [!code --]
		if (!(text7 == "*r")) // [!code --]
		{ // [!code --]
			text = ((!source.name2.IsEmpty()) ? source.GetTextArray("name2")[0].Replace("#1b", base.c_extraNameRef.IsEmpty((base.refCard == null) ? text7 : (base.refCard.isChara ? base.refCard.GetName() : base.refCard.GetText()))).Replace("#1", base.c_extraNameRef.IsEmpty(text7)) : (source.naming.Contains("last") ? (text + Lang.space + text7) : (source.naming.Contains("first") ? (text7 + Lang.space + text) : ((!source.naming.Contains("of")) ? (text6.IsEmpty() ? "_of3" : "_of2").lang(text7, text) : "_of".lang(text7, text))))); // [!code --]
		} // [!code --]
		else // [!code --]
		{ // [!code --]
			string text8 = base.refCard.GetText("aka"); // [!code --]
			if (!text8.IsEmpty()) // [!code --]
			{ // [!code --]
				text = "_of".lang(text8, text); // [!code --]
			} // [!code --]
		} // [!code --]
		text = "_halfeaten".lang(text); // [!code ++]
	}
	if (base.c_bill != 0)
	{
```

[`public override string GetName(NameStyle style, int _num = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Thing.cs#L628-L647)
```cs:line-numbers=628
			int dMG = base.DMG;
			if ((base.IsMeleeWeapon || base.IsRangedWeapon || base.IsAmmo || hIT != 0 || dMG != 0) && source.offense.Length != 0)
			{
				string text9 = ""; // [!code --]
				string text7 = ""; // [!code ++]
				if (source.offense[0] != 0)
				{
					text9 = text9 + source.offense[0] + "d" + base.c_diceDim; // [!code --]
					text7 = text7 + source.offense[0] + "d" + base.c_diceDim; // [!code ++]
				}
				if (dMG != 0)
				{
					text9 += ((base.IsMeleeWeapon || base.IsRangedWeapon || base.IsAmmo) ? dMG.ToText() : (dMG.ToString() ?? "")); // [!code --]
					text7 += ((base.IsMeleeWeapon || base.IsRangedWeapon || base.IsAmmo) ? dMG.ToText() : (dMG.ToString() ?? "")); // [!code ++]
				}
				if (hIT != 0)
				{
					text9 = text9 + ((dMG != 0 || source.offense[0] != 0) ? ", " : "") + hIT; // [!code --]
					text7 = text7 + ((dMG != 0 || source.offense[0] != 0) ? ", " : "") + hIT; // [!code ++]
				}
				text2 = text2 + " (" + text9.IsEmpty(" - ") + ") "; // [!code --]
				text2 = text2 + " (" + text7.IsEmpty(" - ") + ") "; // [!code ++]
			}
			int dV = DV;
			int pV = PV;
```

[`public override string GetName(NameStyle style, int _num = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Thing.cs#L658-L664)
```cs:line-numbers=658
		}
		else if (base.c_IDTState == 3 || base.c_IDTState == 1)
		{
			text2 = "(" + base.TextRarity.ToTitleCase() + ")"; // [!code --]
			text2 = Lang.space + "(" + base.TextRarity.ToTitleCase() + ")"; // [!code ++]
		}
		if (base.IsDecayed)
		{
```

[`public override string GetName(NameStyle style, int _num = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Thing.cs#L725-L757)
```cs:line-numbers=725
		}
		if (!base.c_note.IsEmpty() && (!base.isBackerContent || EClass.core.config.backer.Show(base.c_note)))
		{
			string text10 = base.c_note; // [!code --]
			if (text10.StartsWith('@')) // [!code --]
			string text8 = base.c_note; // [!code ++]
			if (text8.StartsWith('@')) // [!code ++]
			{
				text10 = Lang.Note.map.TryGetValue(text10.TrimStart('@'))?.GetText("text") ?? base.c_note; // [!code --]
				text8 = Lang.Note.map.TryGetValue(text8.TrimStart('@'))?.GetText("text") ?? base.c_note; // [!code ++]
			}
			string text11 = (base.category.IsChildOf("book") ? "_written" : "_engraved"); // [!code --]
			string text9 = (base.category.IsChildOf("book") ? "_written" : "_engraved"); // [!code ++]
			if (id == "grave_dagger1" || id == "grave_dagger2")
			{
				text11 = "_daggerGrave"; // [!code --]
				text9 = "_daggerGrave"; // [!code ++]
			}
			text = ((!text10.Contains("_bracketLeft".lang())) ? text11.lang(text10, text) : (text11 + "Alt").lang(text10, text)); // [!code --]
			text = ((!text8.Contains("_bracketLeft".lang())) ? text9.lang(text8, text) : (text9 + "Alt").lang(text8, text)); // [!code ++]
		}
		text = (flag ? ((num <= 1) ? (text4 + text) : "_unit".lang(num.ToFormat() ?? "", text4 + text, text6)) : ((trait is TraitAbility) ? text.ToTitleCase(wholeText: true) : ((!text6.IsEmpty() && (base.IsIdentified || source.unknown.IsEmpty())) ? "_unit".lang((num == 1) ? "" : (num.ToFormat() ?? ""), text, (text4 + text6).AddArticle(num, style2, source.unit)) : (text4 + text).AddArticle(num, style2, source.name))));
		if (base.rarity >= Rarity.Legendary)
		{
			text = text.ToTitleCase(wholeText: true);
		}
		string text12 = ((base.isSale && things.Count > 0) ? "forSale2".lang() : ((base.isSale || (base.parentThing != null && base.parentThing.isSale && TraitSalesTag.CanTagSale(this, insideContainer: true))) ? "forSale".lang(Lang._currency(GetPrice(CurrencyType.Money, sell: true, PriceType.PlayerShop), "money")) : "")); // [!code --]
		string text10 = ((base.isSale && things.Count > 0) ? "forSale2".lang() : ((base.isSale || (base.parentThing != null && base.parentThing.isSale && TraitSalesTag.CanTagSale(this, insideContainer: true))) ? "forSale".lang(Lang._currency(GetPrice(CurrencyType.Money, sell: true, PriceType.PlayerShop), "money")) : "")); // [!code ++]
		if (trait is TraitSalesTag && base.isOn && !GetStr(11).IsEmpty())
		{
			text12 += "soldOut".lang(EClass.sources.categories.map[GetStr(11)].GetName()); // [!code --]
			text10 += "soldOut".lang(EClass.sources.categories.map[GetStr(11)].GetName()); // [!code ++]
		}
		if (GetInt(101) != 0)
		{
			text5 = "_limitedStock".lang(text5);
		}
		return text5 + text3 + text + sig + text2 + text12; // [!code --]
		return text5 + text3 + text + sig + text2 + text10; // [!code ++]
	}
	}
	IL_01f2:
```

[`public override string GetName(NameStyle style, int _num = -1)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Thing.cs#L759-L765)
```cs:line-numbers=759
		{
			text = base.material.GetName();
		}
		goto IL_02a1; // [!code --]
		goto IL_0215; // [!code ++]
		IL_0215: // [!code ++]
		if (!base.c_idRefCard.IsEmpty() && trait.RefCardName != RefCardName.None) // [!code ++]
		{ // [!code ++]
			string text11 = base.c_altName.IsEmpty(base.refCard.GetName()); // [!code ++]
			if (!base.c_idRefCard2.IsEmpty()) // [!code ++]
			{ // [!code ++]
				text11 = "_and".lang(text11, base.c_altName2.IsEmpty(base.refCard2.GetName())); // [!code ++]
			} // [!code ++]
			if (!(text11 == "*r")) // [!code ++]
			{ // [!code ++]
				text = ((!source.name2.IsEmpty()) ? source.GetTextArray("name2")[0].Replace("#1b", base.c_extraNameRef.IsEmpty((base.refCard == null) ? text11 : (base.refCard.isChara ? base.refCard.GetName() : base.refCard.GetText()))).Replace("#1", base.c_extraNameRef.IsEmpty(text11)) : (source.naming.Contains("last") ? (text + Lang.space + text11) : (source.naming.Contains("first") ? (text11 + Lang.space + text) : ((!source.naming.Contains("of")) ? (text6.IsEmpty() ? "_of3" : "_of2").lang(text11, text) : "_of".lang(text11, text))))); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				string text12 = base.refCard.GetText("aka"); // [!code ++]
				if (!text12.IsEmpty()) // [!code ++]
				{ // [!code ++]
					text = "_of".lang(text12, text); // [!code ++]
				} // [!code ++]
			} // [!code ++]
		} // [!code ++]
		goto IL_047d; // [!code ++]
	}

	public override string GetHoverText()
```

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Thing.cs#L1263-L1305)
```cs:line-numbers=1263
		}
	}
	trait.WriteNote(n, flag2);
	if (flag2 && showTraits) // [!code --]
	if (flag2) // [!code ++]
	{
		elements.AddNote(n, (Element e) => listTrait.Contains(e), null, ElementContainer.NoteMode.BonusTrait, addRaceFeat: false, delegate(Element e, string s) // [!code --]
		if (showTraits) // [!code ++]
		{
			string text12 = s; // [!code --]
			string text13 = e.source.GetText("textExtra"); // [!code --]
			if (!text13.IsEmpty()) // [!code --]
			elements.AddNote(n, (Element e) => listTrait.Contains(e), null, ElementContainer.NoteMode.BonusTrait, addRaceFeat: false, delegate(Element e, string s) // [!code ++]
			{
				string text14 = ""; // [!code --]
				if (e.id == 2 && mode == IInspect.NoteMode.Product) // [!code --]
				string text12 = s; // [!code ++]
				string text13 = e.source.GetText("textExtra"); // [!code ++]
				if (!text13.IsEmpty()) // [!code ++]
				{
					int num2 = recipe.GetQualityBonus() / 10; // [!code --]
					if (num2 >= 0) // [!code --]
					string text14 = ""; // [!code ++]
					if (e.id == 2 && mode == IInspect.NoteMode.Product) // [!code ++]
					{
						num2++; // [!code --]
						int num2 = recipe.GetQualityBonus() / 10; // [!code ++]
						if (num2 >= 0) // [!code ++]
						{ // [!code ++]
							num2++; // [!code ++]
						} // [!code ++]
						text14 = "qualityLimit".lang(num2.ToString() ?? ""); // [!code ++]
					}
					text14 = "qualityLimit".lang(num2.ToString() ?? ""); // [!code --]
				} // [!code --]
				int num3 = e.Value / 10; // [!code --]
				num3 = ((e.Value < 0) ? (num3 - 1) : (num3 + 1)); // [!code --]
				text13 = "Lv." + num3 + text14 + " " + text13; // [!code --]
				if (infoMode && e.IsFoodTraitMain) // [!code --]
				{ // [!code --]
					text13 += "traitAdditive".lang(); // [!code --]
					int num3 = e.Value / 10; // [!code ++]
					num3 = ((e.Value < 0) ? (num3 - 1) : (num3 + 1)); // [!code ++]
					text13 = "Lv." + num3 + text14 + " " + text13; // [!code ++]
					if (infoMode && e.IsFoodTraitMain) // [!code ++]
					{ // [!code ++]
						text13 += "traitAdditive".lang(); // [!code ++]
					} // [!code ++]
					text12 += (" <size=12>" + text13 + "</size>").TagColor(FontColor.Passive); // [!code ++]
				}
				text12 += (" <size=12>" + text13 + "</size>").TagColor(FontColor.Passive); // [!code --]
				return text12; // [!code ++]
			}, delegate // [!code ++]
			{ // [!code ++]
			}); // [!code ++]
			if (listTrait.Count != list.Count) // [!code ++]
			{ // [!code ++]
				AddText("traitOther".lang((list.Count - listTrait.Count).ToString() ?? ""), FontColor.Default); // [!code ++]
			}
			return text12; // [!code --]
		}, delegate // [!code --]
		{ // [!code --]
		}); // [!code --]
		if (listTrait.Count != list.Count) // [!code --]
		} // [!code ++]
		if (base.c_mixedFoodData != null) // [!code ++]
		{
			AddText("traitOther".lang((list.Count - listTrait.Count).ToString() ?? ""), FontColor.Default); // [!code --]
			n.AddHeader("isMixedFood"); // [!code ++]
			foreach (string text15 in base.c_mixedFoodData.texts) // [!code ++]
			{ // [!code ++]
				AddText("_bullet".lang() + text15, FontColor.Default); // [!code ++]
			} // [!code ++]
		}
	}
	if (!flag2) // [!code --]
	else // [!code ++]
	{
		AddText("isUnidentified".lang(), FontColor.Flavor);
		if (base.c_IDTState == 1)
```

## Trait

[`public void OnBarter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/4e2b4539741a92da27fbbf2026c7eca094fefd81/Elin/Trait.cs#L1833-L1839)
```cs:line-numbers=1833
			{
			case ShopType.Moyer:
			{
				for (int num10 = 1; num10 <= 3; num10++) // [!code --]
				for (int num10 = 1; num10 <= 6; num10++) // [!code ++]
				{
					AddAdvWeek(num10);
				}
```

## +TraitLunchLove

::: details File Created
```cs
public class TraitLunchLove : TraitMixedFood
{
}
```

:::
## ~TraitFoodLunchLove

::: details File Renamed
```cs
public class TraitFoodLunchLove : TraitFood
public class TraitMixedFood : TraitFood
{
	public override bool CanSearchContent => false;

```

:::
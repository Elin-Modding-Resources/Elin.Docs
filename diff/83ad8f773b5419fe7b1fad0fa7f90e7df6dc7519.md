---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 12 files modified. 2 new files created.
version: EA 23.241 Nightly
changes: AI_Eat/ActMelee/ActThrow/Card/Chara/+ConDark/DNA/FEAT/Player/Thing/Trait/+TraitBookExp/TraitBookSecret/TraitMagicChest
---

# EA 23.241 Nightly

December 2, 2025

12 files modified. 2 new files created.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [TraitBookSecret (2)](#traitbooksecret)
```cs:no-line-numbers
public override bool CanRead(Chara c) // [!code --]

```
```cs:no-line-numbers
public override int GetActDuration(Chara c) // [!code --]

```
## AI_Eat

[`public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/AI_Eat.cs#L70-L76)
```cs:line-numbers=70
	{
		yield return Cancel();
	}
	if (EClass._zone.IsPCFaction && !owner.IsPCParty && owner.memberType != FactionMemberType.Livestock && !owner.noMove) // [!code --]
	if ((EClass._zone.IsPCFaction || EClass.rnd(4) != 0) && !owner.IsPCParty && owner.memberType != FactionMemberType.Livestock && !owner.noMove) // [!code ++]
	{
		yield return DoGotoSpot<TraitSpotDining>(base.KeepRunning);
	}
```

## ActMelee

[`public bool Attack(float dmgMulti = 1f)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/ActMelee.cs#L160-L165)
```cs:line-numbers=160
	if (EClass.rnd(2) == 0)
	{
		Act.CC.RemoveCondition<ConInvisibility>();
		Act.CC.RemoveCondition<ConDark>(); // [!code ++]
	}
	if (orgTC.isChara && orgTC.ExistsOnMap && orgTC != cC && !orgTC.IsRestrainedResident && !orgTC.IsDisabled && ACT.Melee.CanPerform(orgTC.Chara, cC) && (!orgTC.IsPCFactionOrMinion || !EClass._zone.isPeace))
	{
```

## ActThrow

[`public static EffectIRenderer Throw(Card c, Point p, Card target, Thing t, Throw`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/ActThrow.cs#L404-L409)
```cs:line-numbers=404
	if (EClass.rnd(2) == 0)
	{
		c.Chara.RemoveCondition<ConInvisibility>();
		c.Chara.RemoveCondition<ConDark>(); // [!code ++]
	}
	if (Act.TC != null)
	{
```

## Card

[`private void _OnDeserialized(StreamingContext context)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Card.cs#L2716-L2728)
```cs:line-numbers=2716
		{
			isDestroyed = true;
		}
		if (version < 3) // [!code --]
		if (version < 4) // [!code ++]
		{
			if (version < 3 && isChara && HasElement(1210))
			{
				elements.ModBase(960, -5 * Evalue(1210));
			}
			version = 3; // [!code --]
			if (version < 4 && isChara && HasElement(1210)) // [!code ++]
			{ // [!code ++]
				elements.ModBase(423, Evalue(1210)); // [!code ++]
			} // [!code ++]
			version = 4; // [!code ++]
		}
	}

```

[`public void LevelUp()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Card.cs#L3008-L3029)
```cs:line-numbers=3008
		{
			Chara.SetFeat(1415, Evalue(1415) + 1, msg: true);
		}
		if (IsPC) // [!code --]
		if (IsPC || !(Chara.race.id == "mutant")) // [!code ++]
		{
			return;
		}
		if (Chara.race.id == "mutant") // [!code --]
		int num = Mathf.Min(1 + LV / 5, 20); // [!code ++]
		for (int i = 0; i < num; i++) // [!code ++]
		{
			int num = Mathf.Min(1 + LV / 5, 20); // [!code --]
			for (int i = 0; i < num; i++) // [!code --]
			if (Evalue(1644) < i + 1) // [!code ++]
			{
				if (Evalue(1644) < i + 1) // [!code --]
				{ // [!code --]
					Chara.SetFeat(1644, i + 1, msg: true); // [!code --]
				} // [!code --]
				Chara.SetFeat(1644, i + 1, msg: true); // [!code ++]
			}
		}
		Chara.TryUpgrade(); // [!code --]
	}

	public virtual void ApplyMaterialElements(bool remove)
```

[`public void SpawnLoot(Card origin)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Card.cs#L5210-L5216)
```cs:line-numbers=5210
				{
					CardBlueprint.SetRarity((EClass.rnd(20) == 0) ? Rarity.Mythical : Rarity.Legendary);
				}
				list.Add(ThingGen.Create(array[0], -1, LV).SetNum((num4 < 1000) ? 1 : (num4 / 1000 + ((EClass.rnd(1000) > num4 % 1000) ? 1 : 0)))); // [!code --]
				list.Add(ThingGen.Create(array[0], -1, LV).SetNum((num4 < 1000) ? 1 : (num4 / 1000 + ((EClass.rnd(1000) < num4 % 1000) ? 1 : 0)))); // [!code ++]
			}
		}
		if (Chara.IsMachine)
```

[`public virtual int GetPrice(CurrencyType currency = CurrencyType.Money, bool sel`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Card.cs#L7279-L7296)
```cs:line-numbers=7279
			}
			break;
		case CurrencyType.Plat:
		{ // [!code --]
			string text = id; // [!code --]
			if (!(text == "lucky_coin")) // [!code --]
			switch (id) // [!code ++]
			{
				if (!(text == "book_skill")) // [!code --]
				{ // [!code --]
					break; // [!code --]
				} // [!code --]
			case "lucky_coin": // [!code ++]
				return 100; // [!code ++]
			case "book_exp": // [!code ++]
				return 200; // [!code ++]
			case "book_skill": // [!code ++]
				return 50;
			}
			return 100; // [!code --]
		} // [!code --]
			break; // [!code ++]
		case CurrencyType.Medal:
			switch (id)
			{
```

## Chara

[`public override void Tick()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L4182-L4187)
```cs:line-numbers=4182
			{
				Say("abMistOfDarkness_step", this);
			}
			AddCondition<ConDark>(e.power); // [!code ++]
			break;
		}
	}
```

[`public bool UseAbility(Act a, Card tc = null, Point pos = null, bool pt = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L6030-L6035)
```cs:line-numbers=6030
	if (flag2 && !a.source.tag.Contains("keepInvisi") && EClass.rnd(2) == 0)
	{
		RemoveCondition<ConInvisibility>();
		RemoveCondition<ConDark>(); // [!code ++]
	}
	return flag2;
	void ForeachEnemy(Action<Chara> action)
```

[`public void TryTakeSharedItems(IEnumerable<Thing> containers, bool msg = true, b`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L7314-L7350)
```cs:line-numbers=7314
		return;
	}
	int num = 2;
	int num2 = 2; // [!code --]
	bool flag = GetInt(113) == 0; // [!code --]
	int num2 = 1; // [!code ++]
	int num3 = 2;
	bool flag = GetInt(113) == 0; // [!code ++]
	int num4 = 2;
	int num5 = 2;
	int num6 = 2; // [!code ++]
	if (homeBranch != null && homeBranch.HasItemProtection && !IsPCParty)
	{
		num4 = 0; // [!code --]
		num5 = 0;
		num6 = 0; // [!code ++]
	}
	foreach (Thing thing3 in things)
	{
		if (CanEat(thing3, shouldEat))
		{
			num -= thing3.Num; // [!code --]
			if (thing3.HasElement(757)) // [!code ++]
			{ // [!code ++]
				num2 -= thing3.Num; // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				num -= thing3.Num; // [!code ++]
			} // [!code ++]
		}
		if (thing3.trait.GetHealAction(this) != null)
		{
			num2 -= thing3.Num; // [!code --]
			num3 -= thing3.Num; // [!code ++]
		}
		if (thing3.id == "polish_powder")
		{
			num3 -= thing3.Num; // [!code --]
			num4 -= thing3.Num; // [!code ++]
		}
		if (thing3.trait is TraitBlanketColdproof)
		{
			num4 -= thing3.Num; // [!code --]
			num5 -= thing3.Num; // [!code ++]
		}
		if (thing3.trait is TraitBlanketFireproof)
		{
			num5 -= thing3.Num; // [!code --]
			num6 -= thing3.Num; // [!code ++]
		}
	}
	_ListItems.Clear();
```

[`public void TryTakeSharedItems(IEnumerable<Thing> containers, bool msg = true, b`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L7358-L7387)
```cs:line-numbers=7358
		{
			if (!thing4.c_isImportant && thing4.IsIdentified)
			{
				if (num3 > 0 && thing4.id == "polish_powder") // [!code --]
				if (num4 > 0 && thing4.id == "polish_powder") // [!code ++]
				{
					_ListItems.Add(thing4);
					num3 -= thing4.Num; // [!code --]
					num4 -= thing4.Num; // [!code ++]
				}
				else if (num4 > 0 && !HasElement(1236) && thing4.trait is TraitBlanketColdproof) // [!code --]
				else if (num5 > 0 && !HasElement(1236) && thing4.trait is TraitBlanketColdproof) // [!code ++]
				{
					_ListItems.Add(thing4);
					num4 -= thing4.Num; // [!code --]
					num5 -= thing4.Num; // [!code ++]
				}
				else if (num5 > 0 && thing4.trait is TraitBlanketFireproof) // [!code --]
				else if (num6 > 0 && thing4.trait is TraitBlanketFireproof) // [!code ++]
				{
					_ListItems.Add(thing4);
					num5 -= thing4.Num; // [!code --]
					num6 -= thing4.Num; // [!code ++]
				} // [!code ++]
				else if (num2 > 0 && CanEat(thing4, shouldEat) && !thing4.c_isImportant && thing4.HasElement(757)) // [!code ++]
				{ // [!code ++]
					_ListItems.Add(thing4); // [!code ++]
					num2 -= thing4.Num; // [!code ++]
				}
				else if (num > 0 && CanEat(thing4, shouldEat) && !thing4.c_isImportant)
				{
					_ListItems.Add(thing4);
					num -= thing4.Num;
				}
				else if (num2 > 0 && thing4.trait.GetHealAction(this) != null) // [!code --]
				else if (num3 > 0 && thing4.trait.GetHealAction(this) != null) // [!code ++]
				{
					_ListItems.Add(thing4);
					num2 -= thing4.Num; // [!code --]
					num3 -= thing4.Num; // [!code ++]
				}
				else if (flag && thing4.IsEquipmentOrRanged && !thing4.HasTag(CTAG.gift) && ShouldEquip(thing4, useFav: true))
				{
```

[`public void TryTakeSharedItems(IEnumerable<Thing> containers, bool msg = true, b`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L7424-L7430)
```cs:line-numbers=7424
			break;
		}
		Thing thing2 = listItem2.parent as Thing;
		if (thing.Num > 2) // [!code --]
		if (thing.HasElement(757)) // [!code ++]
		{ // [!code ++]
			if (thing.Num > 1) // [!code ++]
			{ // [!code ++]
				thing = thing.Split(1); // [!code ++]
			} // [!code ++]
		} // [!code ++]
		else if (thing.Num > 2) // [!code ++]
		{
			thing = thing.Split(2);
		}
```

[`public Thing FindBestFoodToEat()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L7456-L7462)
```cs:line-numbers=7456
	foreach (Thing item in things.List((Thing t) => CanEat(t, shouldEat: true) && !t.c_isImportant, onlyAccessible: true))
	{
		int num2 = CountNumEaten(item);
		int num3 = 100 - num2; // [!code --]
		int num3 = 100 - num2 + (item.HasElement(757) ? 10 : 0); // [!code ++]
		if (num3 > num)
		{
			result = item;
```

[`public bool CanAcceptGift(Chara c, Card t)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L8119-L8125)
```cs:line-numbers=8119
	{
		return true;
	}
	if (t.trait is TraitBookSecret) // [!code --]
	if (t.trait is TraitBookExp) // [!code ++]
	{
		return true;
	}
```

[`public Condition AddCondition(Condition c, bool force = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L9210-L9215)
```cs:line-numbers=9210
			return null;
		}
	}
	int num2 = c.EvaluateTurn(c.power); // [!code ++]
	if (num2 == 0) // [!code ++]
	{ // [!code ++]
		return null; // [!code ++]
	} // [!code ++]
	for (int j = 0; j < conditions.Count; j++)
	{
		if (conditions[j].id != c.id)
```

[`public Condition AddCondition(Condition c, bool force = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L9225-L9232)
```cs:line-numbers=9225
		{
			if (conditions[j].WillOverride)
			{
				conditions[j].Kill(silent: true); // [!code --]
				continue; // [!code --]
				if (num2 > conditions[j].value) // [!code ++]
				{ // [!code ++]
					conditions[j].Kill(silent: true); // [!code ++]
					continue; // [!code ++]
				} // [!code ++]
				return null; // [!code ++]
			}
			if (CanGainConResist)
			{
```

[`public Condition AddCondition(Condition c, bool force = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L9248-L9258)
```cs:line-numbers=9248
			return null;
		}
	}
	int num2 = c.EvaluateTurn(c.power); // [!code --]
	if (num2 == 0) // [!code --]
	{ // [!code --]
		return null; // [!code --]
	} // [!code --]
	c.value = num2;
	conditions.Add(c);
	if (CanGainConResist)
```

[`public void SetFeat(int id, int value = 1, bool msg = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Chara.cs#L9781-L9795)
```cs:line-numbers=9781
		num = feat.Value;
		feat.Apply(-feat.Value, elements);
	}
	if (value > 0) // [!code --]
	feat = elements.SetBase(id, value - (feat?.vSource ?? 0)) as Feat; // [!code ++]
	if (feat.Value != 0) // [!code ++]
	{
		feat = elements.SetBase(id, value - (feat?.vSource ?? 0)) as Feat; // [!code --]
		feat.Apply(feat.Value, elements);
	}
	else // [!code --]
	{ // [!code --]
		elements.Remove(id); // [!code --]
	} // [!code --]
	if (EClass.core.IsGameStarted)
	{
		Refresh();
```

## +ConDark

::: details File Created
```cs
public class ConDark : Condition
{
	public override bool ShouldRefresh => true;

	public override int GetPhase()
	{
		return 0;
	}
}
```

:::
## DNA

[`public void Generate(Type _type, Chara model = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/DNA.cs#L270-L276)
```cs:line-numbers=270
	cost = 0;
	slot = 0;
	vals.Clear();
	Debug.Log(seed); // [!code --]
	Rand.SetSeed(seed);
	if (model == null)
	{
```

## FEAT

[`public List<string> Apply(int a, ElementContainer owner, bool hint = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/FEAT.cs#L523-L528)
```cs:line-numbers=523
		ModBase(956, a * 10, hide: false);
		ModBase(950, a * -5, hide: false);
		ModBase(960, a * -5, hide: false);
		ModBase(423, a, hide: false); // [!code ++]
		break;
	case 1290:
		ModBase(418, a * 100, hide: false);
```

## Player

[`public void CreateEquip()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Player.cs#L1731-L1736)
```cs:line-numbers=1731
	if (c.race.id == "vampire")
	{
		c.AddCard(ThingGen.CreateRecipe("bloodpack"));
		c.AddCard(SetSpellbook(ThingGen.CreateSpellbook(8800), 4)); // [!code ++]
		if (EClass.debug.enable)
		{
			c.AddCard(ThingGen.Create("mixer"));
```

## Thing

[`public override void WriteNote(UINote n, Action<UINote> onWriteNote = null, IIns`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Thing.cs#L1093-L1105)
```cs:line-numbers=1093
	{
		AddText("isAcidproof", FontColor.Default);
	}
	if (trait.Electricity > 0) // [!code --]
	if (trait.OriginalElectricity > 0) // [!code ++]
	{
		AddText("isGenerateElectricity".lang(trait.Electricity.ToString() ?? ""), FontColor.Default); // [!code --]
		AddText("isGenerateElectricity".lang(trait.OriginalElectricity.ToString() ?? ""), FontColor.Default); // [!code ++]
	}
	if (trait.Electricity < 0) // [!code --]
	if (trait.OriginalElectricity < 0) // [!code ++]
	{
		AddText("isConsumeElectricity".lang(Mathf.Abs(trait.Electricity).ToString() ?? ""), FontColor.Default); // [!code --]
		AddText("isConsumeElectricity".lang(Mathf.Abs(trait.OriginalElectricity).ToString() ?? ""), FontColor.Default); // [!code ++]
	}
	if (base.IsUnique)
	{
```

[`public override void SetRenderParam(RenderParam p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Thing.cs#L1601-L1620)
```cs:line-numbers=1601
		}
		if (source.anime.Length > 2)
		{
			float num = time * 1000f / (float)source.anime[1] % (float)source.anime[2]; // [!code --]
			if ((int)num == source.anime[0] - 1 && source.anime.Length > 3) // [!code --]
			int num = (int)(time * 1000f / (float)source.anime[1] % (float)source.anime[2]); // [!code ++]
			if (num == source.anime[0] - 1 && source.anime.Length > 3) // [!code ++]
			{
				PlaySound("anime_sound" + source.anime[3]);
			}
			if (!(num >= (float)source.anime[0])) // [!code --]
			if (num < source.anime[0]) // [!code ++]
			{
				p.tile += num * (float)((!(p.tile < 0f)) ? 1 : (-1)); // [!code --]
				p.tile += num * ((!(p.tile < 0f)) ? 1 : (-1)); // [!code ++]
			}
		}
		else
		{
			float num2 = time * 1000f / (float)source.anime[1] % (float)source.anime[0]; // [!code --]
			p.tile += num2 * (float)((!(p.tile < 0f)) ? 1 : (-1)); // [!code --]
			int num2 = (int)(time * 1000f / (float)source.anime[1] % (float)source.anime[0]); // [!code ++]
			p.tile += num2 * ((!(p.tile < 0f)) ? 1 : (-1)); // [!code ++]
		}
		break;
	}
```

[`public void ShowSplitMenu(ButtonGrid button, InvOwner.Transaction trans = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Thing.cs#L1823-L1829)
```cs:line-numbers=1823
	}
	i.onDestroy = delegate
	{
		if (!buy && !i.wasCanceled) // [!code --]
		if ((!buy || Input.GetKeyDown(KeyCode.Return) || Input.GetKeyDown(KeyCode.KeypadEnter)) && !i.wasCanceled) // [!code ++]
		{
			Process();
		}
```

[`void UpdateButton()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Thing.cs#L1888-L1909)
```cs:line-numbers=1888
public void ShowSplitMenu2(ButtonGrid button, string lang, Action<int> onSplit = null)
{
	int count = 1;
	UIContextMenu uIContextMenu = EClass.ui.CreateContextMenuInteraction(); // [!code --]
	UIContextMenu i = EClass.ui.CreateContextMenuInteraction(); // [!code ++]
	UIButton buttonBuy = null;
	UIItem itemSlider = null;
	itemSlider = uIContextMenu.AddSlider("sliderSplitMenu", "adjustmentNum", (float a) => (!EClass.core.IsGameStarted) ? "" : ("/" + base.Num), count, delegate(float b) // [!code --]
	itemSlider = i.AddSlider("sliderSplitMenu", "adjustmentNum", (float a) => (!EClass.core.IsGameStarted) ? "" : ("/" + base.Num), count, delegate(float b) // [!code ++]
	{
		count = (int)b;
		UpdateButton();
	}, 1f, base.Num, isInt: true, hideOther: false, useInput: true).GetComponent<UIItem>();
	buttonBuy = uIContextMenu.AddButton("invBuy", delegate // [!code --]
	buttonBuy = i.AddButton("invBuy", delegate // [!code ++]
	{
		Process();
	});
	uIContextMenu.onDestroy = delegate // [!code --]
	i.onDestroy = delegate // [!code ++]
	{
		if ((Input.GetKeyDown(KeyCode.Return) || Input.GetKeyDown(KeyCode.KeypadEnter)) && !i.wasCanceled) // [!code ++]
		{ // [!code ++]
			Process(); // [!code ++]
		} // [!code ++]
	};
	uIContextMenu.Show(); // [!code --]
	i.Show(); // [!code ++]
	if ((bool)buttonBuy)
	{
		buttonBuy.gameObject.AddComponent<CanvasGroup>();
```

## Trait

[`public virtual bool ShouldRefreshTile`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Trait.cs#L98-L104)
```cs:line-numbers=98

	public virtual int GuidePriotiy => 0;

	public virtual int Electricity // [!code --]
	public virtual int OriginalElectricity // [!code ++]
	{
		get
		{
```

[`public virtual int Electricity`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Trait.cs#L115-L120)
```cs:line-numbers=115
		}
	}

	public virtual int Electricity => OriginalElectricity; // [!code ++]
 // [!code ++]
	public virtual bool IgnoreLastStackHeight => false;

	public virtual int Decay => owner.material.decay;
```

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Trait.cs#L1527-L1532)
```cs:line-numbers=1527
		NoRestock(ThingGen.Create("lucky_coin").SetNum(10));
		NoRestock(ThingGen.CreateSkillbook(6662));
		NoRestock(ThingGen.CreateSkillbook(6664));
		Add("book_exp", 10, 0); // [!code ++]
		break;
	case ShopType.Copy:
	{
```

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/Trait.cs#L1893-L1899)
```cs:line-numbers=1893
				break;
			case ShopType.Moyer:
			{
				for (int num12 = 1; num12 <= 13; num12++) // [!code --]
				for (int num12 = 1; num12 <= 14; num12++) // [!code ++]
				{
					AddAdvWeek(num12);
				}
```

## +TraitBookExp

::: details File Created
```cs
public class TraitBookExp : TraitScroll
{
	public override bool CanRead(Chara c)
	{
		return !c.isBlind;
	}

	public override int GetActDuration(Chara c)
	{
		return 5;
	}

	public override void OnRead(Chara c)
	{
		EClass.player.forceTalk = true;
		c.Talk((EClass.rnd(2) == 0) ? "nice_statue" : "disgust");
		c.AddExp(c.ExpToNext / ((!c.IsPC) ? 1 : 4));
		c.PlaySound("ding_potential");
		c.Say("spellbookCrumble", owner.Duplicate(1));
		owner.ModNum(-1);
	}
}
```

:::
## TraitBookSecret

[`public class TraitBookSecret : TraitScroll`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/TraitBookSecret.cs#L1-L15)
```cs:line-numbers=1
public class TraitBookSecret : TraitScroll // [!code --]
public class TraitBookSecret : TraitBookExp // [!code ++]
{
	public override bool CanRead(Chara c) // [!code --]
	{ // [!code --]
		return !c.isBlind; // [!code --]
	} // [!code --]
 // [!code --]
	public override int GetActDuration(Chara c) // [!code --]
	{ // [!code --]
		return 5; // [!code --]
	} // [!code --]
 // [!code --]
	public override void OnRead(Chara c)
	{
		if (c.IsPC && EClass.player.stats.kumi >= 5)
```

[`public override void OnRead(Chara c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/TraitBookSecret.cs#L19-L25)
```cs:line-numbers=19
	}
	c.Say("book_secret", c);
	c.Say("dingExp", c);
	c.feat += (c.IsPC ? 1 : 3); // [!code --]
	c.feat += (c.IsPC ? 1 : 4); // [!code ++]
	if (c.IsPC)
	{
		EClass.player.stats.kumi++;
```

## TraitMagicChest

[`public class TraitMagicChest : TraitContainer`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/83ad8f773b5419fe7b1fad0fa7f90e7df6dc7519/Elin/TraitMagicChest.cs#L1-L6)
```cs:line-numbers=1
public class TraitMagicChest : TraitContainer
{
	public override int Electricity => base.Electricity + ((IsFridge ? 50 : 0) + owner.c_containerUpgrade.cap / 5) * -1; // [!code --]
	public override int OriginalElectricity => base.OriginalElectricity + ((IsFridge ? 50 : 0) + owner.c_containerUpgrade.cap / 5) * -1; // [!code ++]

	public override bool IsHomeItem => true;

```

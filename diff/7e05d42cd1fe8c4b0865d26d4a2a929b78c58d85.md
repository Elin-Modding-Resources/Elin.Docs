---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 1 file modified. 1 new file created.
version: +EA 23.253 Nightly - Plugin.UI
changes: UIList/+UIListDragItem
---

# +EA 23.253 Nightly - Plugin.UI

December 26, 2025

1 file modified. 1 new file created.

## Important Changes

**None.**
## UIList

[`public class Callback<T1, T2> : ICallback where T2 : Component`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/7e05d42cd1fe8c4b0865d26d4a2a929b78c58d85/Elin/Plugins.UI/UIList.cs#L67-L72)
```cs:line-numbers=67

		public UIList list;

		public Action<T1, int> onDragReorder; // [!code ++]
 // [!code ++]
		public Func<T1, bool> canDragReorder; // [!code ++]
 // [!code ++]
		public bool useSort => onSort != null;

		public bool useOnClick => onClick != null;
```

[`public Component Instantiate(object obj, Transform parent)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/7e05d42cd1fe8c4b0865d26d4a2a929b78c58d85/Elin/Plugins.UI/UIList.cs#L106-L111)
```cs:line-numbers=106
			{
				onInstantiate((T1)obj, val);
			}
			if (onDragReorder != null) // [!code ++]
			{ // [!code ++]
				UIListDragItem orCreate = val.GetOrCreate<UIListDragItem>(); // [!code ++]
				orCreate.list = list; // [!code ++]
				orCreate.item = obj; // [!code ++]
			} // [!code ++]
			return val;
		}

```

[`public void OnRefresh()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/7e05d42cd1fe8c4b0865d26d4a2a929b78c58d85/Elin/Plugins.UI/UIList.cs#L146-L151)
```cs:line-numbers=146
			}
		}

		public void OnDragReorder(object obj, int a) // [!code ++]
		{ // [!code ++]
			if (onDragReorder != null) // [!code ++]
			{ // [!code ++]
				onDragReorder((T1)obj, a); // [!code ++]
			} // [!code ++]
		} // [!code ++]
 // [!code ++]
		public bool CanDragReorder(object obj) // [!code ++]
		{ // [!code ++]
			if (canDragReorder != null) // [!code ++]
			{ // [!code ++]
				return canDragReorder((T1)obj); // [!code ++]
			} // [!code ++]
			return false; // [!code ++]
		} // [!code ++]
 // [!code ++]
		public Component GetComponent(Transform t)
		{
			return t.GetComponent<T2>();
```

[`public interface ICallback`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/7e05d42cd1fe8c4b0865d26d4a2a929b78c58d85/Elin/Plugins.UI/UIList.cs#L177-L182)
```cs:line-numbers=177
		int OnSort(object obj, SortMode mode);

		void OnRefresh();
 // [!code ++]
		void OnDragReorder(object obj, int a); // [!code ++]
 // [!code ++]
		bool CanDragReorder(object obj); // [!code ++]
	}

	public struct ButtonPair
```

[`public struct ButtonPair`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/7e05d42cd1fe8c4b0865d26d4a2a929b78c58d85/Elin/Plugins.UI/UIList.cs#L271-L276)
```cs:line-numbers=271

	private int highlightIndex;

	private object dragTarget; // [!code ++]
 // [!code ++]
	private int dragBeginIndex; // [!code ++]
 // [!code ++]
	private int dragHoverIndex; // [!code ++]
 // [!code ++]
	[NonSerialized] // [!code ++]
	public UIScrollView dragScrollView; // [!code ++]
 // [!code ++]
	[NonSerialized] // [!code ++]
	public RectTransform dragViewport; // [!code ++]
 // [!code ++]
	[NonSerialized] // [!code ++]
	public float dragEdgeSize; // [!code ++]
 // [!code ++]
	[NonSerialized] // [!code ++]
	public float dragScrollSpeed = 2.5f; // [!code ++]
 // [!code ++]
	public LayoutGroup layoutItems => _layoutItems ?? (_layoutItems = GetComponent<LayoutGroup>());

	public GridLayoutGroup gridLayout => layoutItems as GridLayoutGroup;
```

[`public UIList Root`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/7e05d42cd1fe8c4b0865d26d4a2a929b78c58d85/Elin/Plugins.UI/UIList.cs#L291-L296)
```cs:line-numbers=291
		}
	}

	public bool IsDragging => dragTarget != null; // [!code ++]
 // [!code ++]
	public void AddCollection(ICollection collection)
	{
		foreach (object item in collection)
```

[`public void ClearChildren()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/7e05d42cd1fe8c4b0865d26d4a2a929b78c58d85/Elin/Plugins.UI/UIList.cs#L803-L806)
```cs:line-numbers=803
		}
		layoutItems.DestroyChildren();
	}
 // [!code ++]
	public void BeginItemDrag(UIListDragItem drag) // [!code ++]
	{ // [!code ++]
		if (callbacks.CanDragReorder(drag.item)) // [!code ++]
		{ // [!code ++]
			dragTarget = drag.item; // [!code ++]
			dragBeginIndex = drag.transform.GetSiblingIndex(); // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public void EndItemDrag(UIListDragItem drag) // [!code ++]
	{ // [!code ++]
		if (dragTarget != null) // [!code ++]
		{ // [!code ++]
			int num = dragHoverIndex - dragBeginIndex; // [!code ++]
			dragTarget = null; // [!code ++]
			if (num != 0) // [!code ++]
			{ // [!code ++]
				callbacks.OnDragReorder(drag.item, num); // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	public void UpdateItemDragHover(UIListDragItem drag) // [!code ++]
	{ // [!code ++]
		if (callbacks.CanDragReorder(drag.item) && dragTarget != null && dragTarget != drag.item) // [!code ++]
		{ // [!code ++]
			dragHoverIndex = drag.transform.GetSiblingIndex(); // [!code ++]
			GetPair(dragTarget).component?.transform.SetSiblingIndex(dragHoverIndex); // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	private void Update() // [!code ++]
	{ // [!code ++]
		if (IsDragging) // [!code ++]
		{ // [!code ++]
			AutoScrollWhileDragging(); // [!code ++]
		} // [!code ++]
	} // [!code ++]
 // [!code ++]
	private void AutoScrollWhileDragging() // [!code ++]
	{ // [!code ++]
		if ((bool)dragViewport && (bool)dragScrollView) // [!code ++]
		{ // [!code ++]
			RectTransformUtility.ScreenPointToLocalPointInRectangle(dragViewport, Input.mousePosition, null, out var localPoint); // [!code ++]
			float y = localPoint.y; // [!code ++]
			float num = dragViewport.rect.height * 0.5f; // [!code ++]
			float num2 = 0f; // [!code ++]
			if (y < 0f - num + dragEdgeSize) // [!code ++]
			{ // [!code ++]
				float num3 = Mathf.InverseLerp(0f - num + dragEdgeSize, 0f - num, y); // [!code ++]
				num2 = (0f - dragScrollSpeed) * num3; // [!code ++]
			} // [!code ++]
			else if (y > num - dragEdgeSize) // [!code ++]
			{ // [!code ++]
				float num4 = Mathf.InverseLerp(num - dragEdgeSize, num, y); // [!code ++]
				num2 = dragScrollSpeed * num4; // [!code ++]
			} // [!code ++]
			if (num2 != 0f) // [!code ++]
			{ // [!code ++]
				float verticalNormalizedPosition = dragScrollView.verticalNormalizedPosition; // [!code ++]
				dragScrollView.verticalNormalizedPosition = Mathf.Clamp01(verticalNormalizedPosition + num2 * Time.unscaledDeltaTime); // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
}
```

## +UIListDragItem

::: details File Created
```cs
using UnityEngine;
using UnityEngine.EventSystems;

public class UIListDragItem : MonoBehaviour, IBeginDragHandler, IEventSystemHandler, IDragHandler, IEndDragHandler, IPointerEnterHandler
{
	public UIList list;

	public object item;

	public void OnBeginDrag(PointerEventData eventData)
	{
		list.BeginItemDrag(this);
	}

	public void OnDrag(PointerEventData eventData)
	{
	}

	public void OnEndDrag(PointerEventData eventData)
	{
		list.EndItemDrag(this);
	}

	public void OnPointerEnter(PointerEventData eventData)
	{
		list.UpdateItemDragHover(this);
	}
}
```

:::
---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 18 files modified. 2 new files created.
version: EA 23.73 Nightly
changes: AI_Fuck/ActEffect/BaseTileMap/Chara/GameIO/GameSerializationBinder/LayerLoadGame/Quest/QuestCraft/QuestDialog/+QuestDummy/QuestProgression/QuestSequence/QuestSubdue/Steam/TaskBuild/TileType/+TileTypeTent/TraitBoat/TraitTent
---

# EA 23.73 Nightly

January 3, 2025

18 files modified. 2 new files created.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [GameIO (1)](#gameio)
```cs:no-line-numbers
public static bool TryLoadSteamCloud() // [!code --]
public static bool TryLoadSteamCloud(string pathSave) // [!code ++]
```
## AI_Fuck

[`@@ -135,7 +135,7 @@ public override IEnumerable<Status> Run()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/AI_Fuck.cs#L135-L141)
```cs:line-numbers=135
			{
				tc.PlaySound("brushing");
				int num2 = cc.CHA / 2 + cc.Evalue(237) - tc.CHA * 2;
				int num3 = ((EClass.rnd(cc.CHA / 2 + cc.Evalue(237)) <= EClass.rnd(tc.CHA * num / 100)) ? (-5 + Mathf.Clamp(num2 / 10, -30, 0)) : (5 + Mathf.Clamp(num2 / 20, 0, 20))); // [!code --]
				int num3 = ((EClass.rnd(cc.CHA / 2 + cc.Evalue(237)) <= EClass.rnd(tc.CHA * num / 100)) ? (-5 + ((!tc.IsPCFaction) ? Mathf.Clamp(num2 / 10, -30, 0) : 0)) : (5 + Mathf.Clamp(num2 / 20, 0, 20))); // [!code ++]
				int a = 20;
				if (tc.IsPCFactionOrMinion && tc.affinity.CurrentStage >= Affinity.Stage.Love)
				{
```

## ActEffect

[`@@ -586,6 +586,7 @@ public static bool DamageEle(Card CC, EffectId id, int power, Element e, List<Po`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/ActEffect.cs#L586-L591)
```cs:line-numbers=586
		chara.SetMainElement(element.source.alias, element.Value, elemental: true);
		chara.SetSummon(20 + power / 20 + EClass.rnd(10));
		chara.SetLv(power / 15);
		chara.interest = 0; // [!code ++]
		EClass._zone.AddCard(chara, tp.GetNearestPoint(allowBlock: false, allowChara: false));
		chara.PlayEffect("teleport");
		chara.MakeMinion(CC);
```

## BaseTileMap

[`@@ -1254,7 +1254,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L1254-L1260)
```cs:line-numbers=1254
			fogged = true;
		}
	}
	goto IL_7a73; // [!code --]
	goto IL_7aa2; // [!code ++]
	IL_1668:
	if (this.cell.isSlopeEdge)
	{
```

[`@@ -1869,19 +1869,9 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L1869-L1887)
```cs:line-numbers=1869
		}
	}
	param.color = blockLight;
	if (isSnowCovered && (sourceBlock.id != 0 || this.cell.hasDoor)) // [!code --]
	if (isSnowCovered && (sourceBlock.id != 0 || this.cell.hasDoor) && (snowed || this.cell.isClearSnow) && (this.cell.Front.HasRoof || this.cell.Right.HasRoof)) // [!code ++]
	{
		if (snowed || this.cell.isClearSnow) // [!code --]
		{ // [!code --]
			if (this.cell.Front.HasRoof || this.cell.Right.HasRoof) // [!code --]
			{ // [!code --]
				snowed = false; // [!code --]
			} // [!code --]
		} // [!code --]
		else if ((!this.cell.Front.HasRoof && !this.cell.Front.HasBlock) || (!this.cell.Right.HasRoof && !this.cell.Right.HasBlock)) // [!code --]
		{ // [!code --]
			snowed = true; // [!code --]
		} // [!code --]
		snowed = false; // [!code ++]
	}
	int num12 = 0;
	if (sourceBlock.id != 0)
```

[`@@ -2449,31 +2439,250 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2449-L2479)
```cs:line-numbers=2449
	{
		if (this.cell.room != null || !this.cell.IsRoomEdge || !showRoof)
		{
			goto IL_6f69; // [!code --]
			goto IL_6f12; // [!code ++]
		}
		if (this.cell._block == 0 || !this.cell.sourceBlock.tileType.RepeatBlock)
		{
			Room obj = this.cell.FrontRight.room;
			if (obj == null || !obj.HasRoof)
			{
				goto IL_6f69; // [!code --]
				goto IL_6f12; // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
	goto IL_6f72; // [!code ++]
	IL_6f72: // [!code ++]
	if (isSnowCovered && (sourceBlock.id != 0 || this.cell.hasDoor) && !snowed && !this.cell.isClearSnow && ((!this.cell.Front.HasRoof && !this.cell.Front.HasBlock) || (!this.cell.Right.HasRoof && !this.cell.Right.HasBlock))) // [!code ++]
	{ // [!code ++]
		snowed = true; // [!code ++]
	} // [!code ++]
	if (this.cell.effect != null) // [!code ++]
	{ // [!code ++]
		if (this.cell.effect.IsLiquid) // [!code ++]
		{ // [!code ++]
			SourceCellEffect.Row sourceEffect = this.cell.sourceEffect; // [!code ++]
			SourceMaterial.Row defaultMaterial = sourceEffect.DefaultMaterial; // [!code ++]
			tile = 4 + Rand.bytes[index % Rand.MaxBytes] % 4; // [!code ++]
			param.tile = tile + this.cell.sourceEffect._tiles[0]; // [!code ++]
			param.mat = defaultMaterial; // [!code ++]
			param.matColor = ((this.cell.effect.color == 0) ? GetColorInt(ref defaultMaterial.matColor, sourceEffect.colorMod) : this.cell.effect.color); // [!code ++]
			sourceEffect.renderData.Draw(param); // [!code ++]
		} // [!code ++]
		else // [!code ++]
		{ // [!code ++]
			param.tile = this.cell.effect.source._tiles[0]; // [!code ++]
			SourceCellEffect.Row sourceEffect2 = this.cell.sourceEffect; // [!code ++]
			if (sourceEffect2.anime.Length != 0) // [!code ++]
			{ // [!code ++]
				if (sourceEffect2.anime.Length > 2) // [!code ++]
				{ // [!code ++]
					float num19 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code ++]
					if (!(num19 >= (float)sourceEffect2.anime[0])) // [!code ++]
					{ // [!code ++]
						param.tile += num19; // [!code ++]
					} // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					float num20 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code ++]
					param.tile += num20; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (this.cell.effect.IsFire) // [!code ++]
			{ // [!code ++]
				rendererEffect.Draw(param); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				this.cell.effect.source.renderData.Draw(param); // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
	param.color = floorLight; // [!code ++]
	if (this.cell.critter != null) // [!code ++]
	{ // [!code ++]
		Critter critter = this.cell.critter; // [!code ++]
		int snowTile = critter.tile; // [!code ++]
		if (snowed && critter.SnowTile != 0) // [!code ++]
		{ // [!code ++]
			critter.x = 0.06f; // [!code ++]
			critter.y = -0.06f; // [!code ++]
			snowTile = critter.SnowTile; // [!code ++]
		} // [!code ++]
		else // [!code ++]
		{ // [!code ++]
			critter.Update(); // [!code ++]
		} // [!code ++]
		pass = passObjSS; // [!code ++]
		batch = pass.batches[pass.batchIdx]; // [!code ++]
		batch.matrices[pass.idx].m03 = param.x + (float)(int)(critter.x * 100f) * 0.01f; // [!code ++]
		batch.matrices[pass.idx].m13 = param.y + (float)(int)(critter.y * 100f) * 0.01f; // [!code ++]
		batch.matrices[pass.idx].m23 = param.z; // [!code ++]
		batch.tiles[pass.idx] = snowTile * ((!critter.reverse) ? 1 : (-1)); // [!code ++]
		batch.colors[pass.idx] = floorLight; // [!code ++]
		pass.idx++; // [!code ++]
		if (pass.idx == pass.batchSize) // [!code ++]
		{ // [!code ++]
			pass.NextBatch(); // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (detail != null) // [!code ++]
	{ // [!code ++]
		TransAnime anime3 = detail.anime; // [!code ++]
		if (anime3 != null && !anime3.animeBlock) // [!code ++]
		{ // [!code ++]
			TransAnime anime4 = detail.anime; // [!code ++]
			param.x += anime4.v.x; // [!code ++]
			param.y += anime4.v.y; // [!code ++]
			param.z += anime4.v.z; // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (this.cell.obj != 0 && !this.cell.sourceObj.renderData.SkipOnMap) // [!code ++]
	{ // [!code ++]
		SourceObj.Row sourceObj = this.cell.sourceObj; // [!code ++]
		if (!snowed || sourceObj.snowTile <= 0) // [!code ++]
		{ // [!code ++]
			param.snow = snowed; // [!code ++]
			param.mat = this.cell.matObj; // [!code ++]
			orgY = param.y; // [!code ++]
			if (param.liquidLv > 0) // [!code ++]
			{ // [!code ++]
				if (sourceObj.pref.Float) // [!code ++]
				{ // [!code ++]
					param.y += 0.01f * floatY; // [!code ++]
					if (liquidLv > 10) // [!code ++]
					{ // [!code ++]
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code ++]
					} // [!code ++]
					liquidLv -= (int)(floatY * 0.5f); // [!code ++]
					param.liquidLv = liquidLv; // [!code ++]
				} // [!code ++]
				if (sourceObj.tileType.IsWaterTop) // [!code ++]
				{ // [!code ++]
					param.liquidLv = 0; // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					param.liquidLv += sourceObj.pref.liquidMod; // [!code ++]
					if (param.liquidLv < 1) // [!code ++]
					{ // [!code ++]
						param.liquid = 1f; // [!code ++]
					} // [!code ++]
					else if (param.liquidLv > 99 + sourceObj.pref.liquidModMax) // [!code ++]
					{ // [!code ++]
						param.liquidLv = 99 + sourceObj.pref.liquidModMax; // [!code ++]
					} // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (sourceObj.useAltColor) // [!code ++]
			{ // [!code ++]
				param.matColor = ((sourceObj.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, sourceObj.colorMod)); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				param.matColor = ((sourceObj.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, sourceObj.colorMod)); // [!code ++]
			} // [!code ++]
			if (sourceObj.HasGrowth) // [!code ++]
			{ // [!code ++]
				this.cell.growth.OnRenderTileMap(param); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				if (this.cell.autotileObj != 0) // [!code ++]
				{ // [!code ++]
					param.tile = sourceObj._tiles[0] + this.cell.autotileObj; // [!code ++]
				} // [!code ++]
				else if (sourceObj.tileType.IsUseBlockDir) // [!code ++]
				{ // [!code ++]
					param.tile = sourceObj._tiles[this.cell.blockDir % sourceObj._tiles.Length]; // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					param.tile = sourceObj._tiles[this.cell.objDir % sourceObj._tiles.Length]; // [!code ++]
				} // [!code ++]
				if (_lowblock && sourceObj.tileType.IsSkipLowBlock) // [!code ++]
				{ // [!code ++]
					param.tile += ((param.tile > 0f) ? 1 : (-1)) * 3000000; // [!code ++]
				} // [!code ++]
				orgY = param.y; // [!code ++]
				orgZ = param.z; // [!code ++]
				param.y += sourceObj.pref.y; // [!code ++]
				param.z += sourceObj.pref.z; // [!code ++]
				sourceObj.renderData.Draw(param); // [!code ++]
				param.y = orgY; // [!code ++]
				param.z = orgZ; // [!code ++]
				int shadow4 = sourceObj.pref.shadow; // [!code ++]
				if (shadow4 > 1 && !this.cell.ignoreObjShadow) // [!code ++]
				{ // [!code ++]
					passShadow.AddShadow(param.x + sourceObj.renderData.offsetShadow.x, param.y + sourceObj.renderData.offsetShadow.y, param.z + sourceObj.renderData.offsetShadow.z, ShadowData.Instance.items[shadow4], sourceObj.pref, 0, param.snow); // [!code ++]
				} // [!code ++]
				param.y = orgY; // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (this.cell.decal != 0 && sourceFloor.tileType.AllowBlood) // [!code ++]
	{ // [!code ++]
		passDecal.Add(param, (int)this.cell.decal, floorLight); // [!code ++]
	} // [!code ++]
	if (highlightCells) // [!code ++]
	{ // [!code ++]
		switch (ActionMode.FlagCell.mode) // [!code ++]
		{ // [!code ++]
		case AM_FlagCell.Mode.flagWallPillar: // [!code ++]
			if (this.cell.isToggleWallPillar) // [!code ++]
			{ // [!code ++]
				passArea.Add(param, 34f, 0f); // [!code ++]
			} // [!code ++]
			break; // [!code ++]
		case AM_FlagCell.Mode.flagSnow: // [!code ++]
			if (this.cell.isClearSnow) // [!code ++]
			{ // [!code ++]
				passArea.Add(param, 34f, 0f); // [!code ++]
			} // [!code ++]
			break; // [!code ++]
		case AM_FlagCell.Mode.flagFloat: // [!code ++]
			if (this.cell.isForceFloat) // [!code ++]
			{ // [!code ++]
				passArea.Add(param, 34f, 0f); // [!code ++]
			} // [!code ++]
			break; // [!code ++]
		case AM_FlagCell.Mode.flagClear: // [!code ++]
			if (this.cell.isClearArea) // [!code ++]
			{ // [!code ++]
				passArea.Add(param, 34f, 0f); // [!code ++]
			}
			break; // [!code ++]
		}
	}
	goto IL_6fc9; // [!code --]
	IL_6f69: // [!code --]
	if (detail == null) // [!code ++]
	{ // [!code ++]
		return; // [!code ++]
	} // [!code ++]
	if (highlightArea && detail.area != null) // [!code ++]
	{ // [!code ++]
		passArea.Add(param, (int)detail.area.GetTile(index) - ((!subtleHighlightArea) ? 1 : 0), 0f); // [!code ++]
	} // [!code ++]
	if (detail.footmark != null && sourceFloor.id != 0) // [!code ++]
	{ // [!code ++]
		param.tile = detail.footmark.tile; // [!code ++]
		param.mat = matFloor; // [!code ++]
		param.matColor = 104025f; // [!code ++]
		renderFootmark.Draw(param); // [!code ++]
	} // [!code ++]
	goto IL_7aa2; // [!code ++]
	IL_6f12: // [!code ++]
	if (!showRoof || !roof || this.cell.room == null || this.cell.Front.room == null || this.cell.Right.room == null)
	{
		param.tile = num12;
		rendererFov.Draw(param);
	}
	goto IL_6fc9; // [!code --]
	IL_7a73: // [!code --]
	goto IL_6f72; // [!code ++]
	IL_7aa2: // [!code ++]
	if (detail.things.Count == 0 && detail.charas.Count == 0)
	{
		return;
	}
	int num19 = 0; // [!code --]
	int num21 = 0; // [!code ++]
	thingPos.x = 0f;
	thingPos.y = 0f;
	thingPos.z = 0f;
```

[`@@ -2504,16 +2713,16 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2504-L2519)
```cs:line-numbers=2504
	}
	Thing thing = null;
	bool shadow = liquidLv == 0;
	float num20 = 0f; // [!code --]
	float num21 = 0f; // [!code --]
	bool flag10 = false; // [!code --]
	float num22 = 0f;
	bool flag11 = false; // [!code --]
	float num23 = 0f;
	bool flag10 = false; // [!code ++]
	float num24 = 0f; // [!code ++]
	bool flag11 = false; // [!code ++]
	float num25 = 0f; // [!code ++]
	if (detail.things.Count > 0 && isSeen)
	{
		_ = zSetting.max1;
		float num24 = 0f; // [!code --]
		float num26 = 0f; // [!code ++]
		for (int m = 0; m < detail.things.Count; m++)
		{
			Thing t = detail.things[m];
```

[`@@ -2528,12 +2737,12 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2528-L2539)
```cs:line-numbers=2528
			{
				pref = rendererObjDummy.shadowPref;
			}
			float num25 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code --]
			float num27 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code ++]
			if (t.ignoreStackHeight)
			{
				thingPos.y -= num20; // [!code --]
				thingPos.y -= num22; // [!code ++]
			}
			shadow = thingPos.y < 0.16f && num23 < 0.16f; // [!code --]
			shadow = thingPos.y < 0.16f && num25 < 0.16f; // [!code ++]
			_ = pref.bypassShadow;
			param.shadowFix = 0f - thingPos.y;
			param.liquidLv = ((thingPos.y + (float)t.altitude < 0.1f) ? liquidLv : 0);
```

[`@@ -2543,7 +2752,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2543-L2549)
```cs:line-numbers=2543
				SetRoofHeight(param, this.cell, cx, cz);
				_actorPos.x = param.x;
				_actorPos.y = param.y;
				_actorPos.z = param.z + num24; // [!code --]
				_actorPos.z = param.z + num26; // [!code ++]
				if (this.room != null)
				{
					param.color = GetRoofLight(this.room.lot);
```

[`@@ -2554,9 +2763,9 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2554-L2562)
```cs:line-numbers=2554
			else
			{
				param.snow = snowed;
				_actorPos.x = orgX + num21; // [!code --]
				_actorPos.x = orgX + num23; // [!code ++]
				_actorPos.y = orgY;
				_actorPos.z = orgZ + num24 + thingPos.z; // [!code --]
				_actorPos.z = orgZ + num26 + thingPos.z; // [!code ++]
				if (tileType.CanStack || !isInstalled)
				{
					if (thing?.id != t.id)
```

[`@@ -2566,13 +2775,13 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2566-L2578)
```cs:line-numbers=2566
					_actorPos.y += thingPos.y;
					if (t.trait.IgnoreLastStackHeight && (thing == null || !thing.trait.IgnoreLastStackHeight))
					{
						thingPos.y -= num20; // [!code --]
						thingPos.y -= num22; // [!code ++]
						if (thing != null)
						{
							_actorPos.z -= 0.2f;
							thingPos.z -= 0.2f;
						}
						_actorPos.y -= num20; // [!code --]
						_actorPos.y -= num22; // [!code ++]
					}
					_actorPos.z += renderSetting.thingZ + (float)m * -0.01f + zSetting.mod1 * thingPos.y;
				}
```

[`@@ -2589,7 +2798,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2589-L2595)
```cs:line-numbers=2589
						freePos.z += rampFix2.z;
						if (!this.cell.IsTopWater || t.altitude > 0)
						{
							num23 += rampFix2.y; // [!code --]
							num25 += rampFix2.y; // [!code ++]
						}
						liquidLv -= (int)(rampFix2.y * 150f);
						if (liquidLv < 0)
```

[`@@ -2599,17 +2808,17 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2599-L2615)
```cs:line-numbers=2599
					}
					else if (!flag11 && t.trait.IsChangeFloorHeight && !t.ignoreStackHeight)
					{
						orgY += num25 + (float)t.altitude * altitudeFix.y; // [!code --]
						orgY += num27 + (float)t.altitude * altitudeFix.y; // [!code ++]
						orgZ += (float)t.altitude * altitudeFix.z;
						freePos.y += num25 + (float)t.altitude * altitudeFix.y; // [!code --]
						freePos.y += num27 + (float)t.altitude * altitudeFix.y; // [!code ++]
						if (!this.cell.IsTopWater || t.altitude > 0)
						{
							num23 += num25 + (float)t.altitude * altitudeFix.y; // [!code --]
							num25 += num27 + (float)t.altitude * altitudeFix.y; // [!code ++]
						}
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1));
						_actorPos.z += pref.z;
						thingPos.z += pref.z;
						liquidLv -= (int)(num25 * 150f); // [!code --]
						liquidLv -= (int)(num27 * 150f); // [!code ++]
						if (liquidLv < 0)
						{
							liquidLv = 0;
```

[`@@ -2617,7 +2826,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2617-L2623)
```cs:line-numbers=2617
					}
					else
					{
						thingPos.y += num25; // [!code --]
						thingPos.y += num27; // [!code ++]
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1));
						_actorPos.z += pref.z;
						if (pref.height >= 0f)
```

[`@@ -2632,7 +2841,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2632-L2638)
```cs:line-numbers=2632
				}
				else
				{
					thingPos.y += num25; // [!code --]
					thingPos.y += num27; // [!code ++]
					_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1));
					_actorPos.z += pref.z;
					thingPos.z += pref.z;
```

[`@@ -2640,10 +2849,10 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2640-L2649)
```cs:line-numbers=2640
				if (t.isFloating && isWater && !hasBridge && !flag)
				{
					flag = true;
					float num26 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code --]
					orgY += 0.01f * floatY - num26; // [!code --]
					num22 = num25; // [!code --]
					_actorPos.y += 0.01f * floatY - num26; // [!code --]
					float num28 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code ++]
					orgY += 0.01f * floatY - num28; // [!code ++]
					num24 = num27; // [!code ++]
					_actorPos.y += 0.01f * floatY - num28; // [!code ++]
					if (liquidLv > 10)
					{
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10;
```

[`@@ -2655,10 +2864,10 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2655-L2664)
```cs:line-numbers=2655
					}
					param.liquidLv = liquidLv;
				}
				num20 = num25; // [!code --]
				num22 = num27; // [!code ++]
				if (t.sourceCard.multisize && !t.trait.IsGround)
				{
					num24 += zSetting.multiZ; // [!code --]
					num26 += zSetting.multiZ; // [!code ++]
				}
				orgZ += t.renderer.data.stackZ;
				if (param.liquidLv > 0)
```

[`@@ -2735,35 +2944,35 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2735-L2769)
```cs:line-numbers=2735
			{
				if (iconMode != 0)
				{
					int num27 = 0; // [!code --]
					int num29 = 0; // [!code ++]
					switch (iconMode)
					{
					case CardIconMode.Visibility:
						if (t.isMasked)
						{
							num27 = 17; // [!code --]
							num29 = 17; // [!code ++]
						}
						break;
					case CardIconMode.State:
						if (t.placeState == PlaceState.installed)
						{
							num27 = 18; // [!code --]
							num29 = 18; // [!code ++]
						}
						break;
					case CardIconMode.Deconstruct:
						if (t.isDeconstructing)
						{
							num27 = 14; // [!code --]
							num29 = 14; // [!code ++]
						}
						break;
					}
					if (t.isNPCProperty && !EMono.debug.godBuild)
					{
						num27 = 13; // [!code --]
						num29 = 13; // [!code ++]
					}
					if (num27 != 0) // [!code --]
					if (num29 != 0) // [!code ++]
					{
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num27); // [!code --]
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num29); // [!code ++]
					}
				}
				t.SetRenderParam(param);
```

[`@@ -2790,7 +2999,7 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2790-L2796)
```cs:line-numbers=2790
			}
			if (isInstalled)
			{
				num21 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
				num23 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
			}
			param.x = orgX;
			param.y = orgY;
```

[`@@ -2803,12 +3012,12 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2803-L2814)
```cs:line-numbers=2803
			}
		}
	}
	orgY += num22; // [!code --]
	orgY += num24; // [!code ++]
	if (detail.charas.Count <= 0)
	{
		return;
	}
	param.shadowFix = 0f - num23; // [!code --]
	param.shadowFix = 0f - num25; // [!code ++]
	param.color += 1310720f;
	float max = zSetting.max2;
	for (int n = 0; n < detail.charas.Count; n++)
```

[`@@ -2833,9 +3042,9 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2833-L2841)
```cs:line-numbers=2833
				{
					Vector3 position = restrainer.owner.renderer.position;
					float defCharaHeight = EMono.setting.render.defCharaHeight;
					float num28 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code --]
					float num30 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code ++]
					_actorPos.x = position.x + getRestrainPos.x * (float)((restrainer.owner.dir % 2 == 0) ? 1 : (-1));
					_actorPos.y = position.y + num28; // [!code --]
					_actorPos.y = position.y + num30; // [!code ++]
					_actorPos.z = position.z + getRestrainPos.z;
					param.liquidLv = 0;
					param.shadowFix = orgY - _actorPos.y;
```

[`@@ -2850,22 +3059,22 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2850-L2871)
```cs:line-numbers=2850
		{
			if (chara.IsDeadOrSleeping && chara.IsPCC)
			{
				float num29 = chara.renderer.data.size.y * 0.3f; // [!code --]
				float num31 = chara.renderer.data.size.y * 0.3f; // [!code ++]
				if (thingPos.y > max)
				{
					thingPos.y = max;
				}
				float num30 = thingPos.y + num29; // [!code --]
				float num31 = (float)n * -0.01f; // [!code --]
				if (num30 > zSetting.thresh1) // [!code --]
				float num32 = thingPos.y + num31; // [!code ++]
				float num33 = (float)n * -0.01f; // [!code ++]
				if (num32 > zSetting.thresh1) // [!code ++]
				{
					num31 = zSetting.mod1; // [!code --]
					num33 = zSetting.mod1; // [!code ++]
				}
				_actorPos.x += thingPos.x;
				_actorPos.y += thingPos.y;
				_actorPos.z += renderSetting.laydownZ + num31; // [!code --]
				_actorPos.z += renderSetting.laydownZ + num33; // [!code ++]
				param.liquidLv = ((thingPos.y == 0f && liquidLv > 0) ? 90 : 0);
				thingPos.y += num29 * 0.8f; // [!code --]
				thingPos.y += num31 * 0.8f; // [!code ++]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0);
			}
			else
```

[`@@ -2885,10 +3094,10 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2885-L2894)
```cs:line-numbers=2885
				}
				if (!chara.IsPC && !chara.renderer.IsMoving && detail.charas.Count > 1 && (detail.charas.Count != 2 || !detail.charas[0].IsDeadOrSleeping || !detail.charas[0].IsPCC))
				{
					_actorPos += renderSetting.charaPos[1 + ((num19 < 4) ? num19 : 3)]; // [!code --]
					_actorPos += renderSetting.charaPos[1 + ((num21 < 4) ? num21 : 3)]; // [!code ++]
				}
				_actorPos.z += 0.01f * (float)n + renderSetting.charaZ;
				num19++; // [!code --]
				num21++; // [!code ++]
				if (flag10)
				{
					_actorPos.z += chara.renderer.data.hangedFixZ;
```

[`@@ -2900,222 +3109,6 @@ public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L2900-L3121)
```cs:line-numbers=2900
		param.y = orgY;
		param.z = orgZ;
	}
	return; // [!code --]
	IL_6fc9: // [!code --]
	if (this.cell.effect != null) // [!code --]
	{ // [!code --]
		if (this.cell.effect.IsLiquid) // [!code --]
		{ // [!code --]
			SourceCellEffect.Row sourceEffect = this.cell.sourceEffect; // [!code --]
			SourceMaterial.Row defaultMaterial = sourceEffect.DefaultMaterial; // [!code --]
			tile = 4 + Rand.bytes[index % Rand.MaxBytes] % 4; // [!code --]
			param.tile = tile + this.cell.sourceEffect._tiles[0]; // [!code --]
			param.mat = defaultMaterial; // [!code --]
			param.matColor = ((this.cell.effect.color == 0) ? GetColorInt(ref defaultMaterial.matColor, sourceEffect.colorMod) : this.cell.effect.color); // [!code --]
			sourceEffect.renderData.Draw(param); // [!code --]
		} // [!code --]
		else // [!code --]
		{ // [!code --]
			param.tile = this.cell.effect.source._tiles[0]; // [!code --]
			SourceCellEffect.Row sourceEffect2 = this.cell.sourceEffect; // [!code --]
			if (sourceEffect2.anime.Length != 0) // [!code --]
			{ // [!code --]
				if (sourceEffect2.anime.Length > 2) // [!code --]
				{ // [!code --]
					float num32 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code --]
					if (!(num32 >= (float)sourceEffect2.anime[0])) // [!code --]
					{ // [!code --]
						param.tile += num32; // [!code --]
					} // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					float num33 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code --]
					param.tile += num33; // [!code --]
				} // [!code --]
			} // [!code --]
			if (this.cell.effect.IsFire) // [!code --]
			{ // [!code --]
				rendererEffect.Draw(param); // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				this.cell.effect.source.renderData.Draw(param); // [!code --]
			} // [!code --]
		} // [!code --]
	} // [!code --]
	param.color = floorLight; // [!code --]
	if (this.cell.critter != null) // [!code --]
	{ // [!code --]
		Critter critter = this.cell.critter; // [!code --]
		int snowTile = critter.tile; // [!code --]
		if (snowed && critter.SnowTile != 0) // [!code --]
		{ // [!code --]
			critter.x = 0.06f; // [!code --]
			critter.y = -0.06f; // [!code --]
			snowTile = critter.SnowTile; // [!code --]
		} // [!code --]
		else // [!code --]
		{ // [!code --]
			critter.Update(); // [!code --]
		} // [!code --]
		pass = passObjSS; // [!code --]
		batch = pass.batches[pass.batchIdx]; // [!code --]
		batch.matrices[pass.idx].m03 = param.x + (float)(int)(critter.x * 100f) * 0.01f; // [!code --]
		batch.matrices[pass.idx].m13 = param.y + (float)(int)(critter.y * 100f) * 0.01f; // [!code --]
		batch.matrices[pass.idx].m23 = param.z; // [!code --]
		batch.tiles[pass.idx] = snowTile * ((!critter.reverse) ? 1 : (-1)); // [!code --]
		batch.colors[pass.idx] = floorLight; // [!code --]
		pass.idx++; // [!code --]
		if (pass.idx == pass.batchSize) // [!code --]
		{ // [!code --]
			pass.NextBatch(); // [!code --]
		} // [!code --]
	} // [!code --]
	if (detail != null) // [!code --]
	{ // [!code --]
		TransAnime anime3 = detail.anime; // [!code --]
		if (anime3 != null && !anime3.animeBlock) // [!code --]
		{ // [!code --]
			TransAnime anime4 = detail.anime; // [!code --]
			param.x += anime4.v.x; // [!code --]
			param.y += anime4.v.y; // [!code --]
			param.z += anime4.v.z; // [!code --]
		} // [!code --]
	} // [!code --]
	if (this.cell.obj != 0 && !this.cell.sourceObj.renderData.SkipOnMap) // [!code --]
	{ // [!code --]
		SourceObj.Row sourceObj = this.cell.sourceObj; // [!code --]
		if (!snowed || sourceObj.snowTile <= 0) // [!code --]
		{ // [!code --]
			param.snow = snowed; // [!code --]
			param.mat = this.cell.matObj; // [!code --]
			orgY = param.y; // [!code --]
			if (param.liquidLv > 0) // [!code --]
			{ // [!code --]
				if (sourceObj.pref.Float) // [!code --]
				{ // [!code --]
					param.y += 0.01f * floatY; // [!code --]
					if (liquidLv > 10) // [!code --]
					{ // [!code --]
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code --]
					} // [!code --]
					liquidLv -= (int)(floatY * 0.5f); // [!code --]
					param.liquidLv = liquidLv; // [!code --]
				} // [!code --]
				if (sourceObj.tileType.IsWaterTop) // [!code --]
				{ // [!code --]
					param.liquidLv = 0; // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					param.liquidLv += sourceObj.pref.liquidMod; // [!code --]
					if (param.liquidLv < 1) // [!code --]
					{ // [!code --]
						param.liquid = 1f; // [!code --]
					} // [!code --]
					else if (param.liquidLv > 99 + sourceObj.pref.liquidModMax) // [!code --]
					{ // [!code --]
						param.liquidLv = 99 + sourceObj.pref.liquidModMax; // [!code --]
					} // [!code --]
				} // [!code --]
			} // [!code --]
			if (sourceObj.useAltColor) // [!code --]
			{ // [!code --]
				param.matColor = ((sourceObj.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, sourceObj.colorMod)); // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				param.matColor = ((sourceObj.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, sourceObj.colorMod)); // [!code --]
			} // [!code --]
			if (sourceObj.HasGrowth) // [!code --]
			{ // [!code --]
				this.cell.growth.OnRenderTileMap(param); // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				if (this.cell.autotileObj != 0) // [!code --]
				{ // [!code --]
					param.tile = sourceObj._tiles[0] + this.cell.autotileObj; // [!code --]
				} // [!code --]
				else if (sourceObj.tileType.IsUseBlockDir) // [!code --]
				{ // [!code --]
					param.tile = sourceObj._tiles[this.cell.blockDir % sourceObj._tiles.Length]; // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					param.tile = sourceObj._tiles[this.cell.objDir % sourceObj._tiles.Length]; // [!code --]
				} // [!code --]
				if (_lowblock && sourceObj.tileType.IsSkipLowBlock) // [!code --]
				{ // [!code --]
					param.tile += ((param.tile > 0f) ? 1 : (-1)) * 3000000; // [!code --]
				} // [!code --]
				orgY = param.y; // [!code --]
				orgZ = param.z; // [!code --]
				param.y += sourceObj.pref.y; // [!code --]
				param.z += sourceObj.pref.z; // [!code --]
				sourceObj.renderData.Draw(param); // [!code --]
				param.y = orgY; // [!code --]
				param.z = orgZ; // [!code --]
				int shadow4 = sourceObj.pref.shadow; // [!code --]
				if (shadow4 > 1 && !this.cell.ignoreObjShadow) // [!code --]
				{ // [!code --]
					passShadow.AddShadow(param.x + sourceObj.renderData.offsetShadow.x, param.y + sourceObj.renderData.offsetShadow.y, param.z + sourceObj.renderData.offsetShadow.z, ShadowData.Instance.items[shadow4], sourceObj.pref, 0, param.snow); // [!code --]
				} // [!code --]
				param.y = orgY; // [!code --]
			} // [!code --]
		} // [!code --]
	} // [!code --]
	if (this.cell.decal != 0 && sourceFloor.tileType.AllowBlood) // [!code --]
	{ // [!code --]
		passDecal.Add(param, (int)this.cell.decal, floorLight); // [!code --]
	} // [!code --]
	if (highlightCells) // [!code --]
	{ // [!code --]
		switch (ActionMode.FlagCell.mode) // [!code --]
		{ // [!code --]
		case AM_FlagCell.Mode.flagWallPillar: // [!code --]
			if (this.cell.isToggleWallPillar) // [!code --]
			{ // [!code --]
				passArea.Add(param, 34f, 0f); // [!code --]
			} // [!code --]
			break; // [!code --]
		case AM_FlagCell.Mode.flagSnow: // [!code --]
			if (this.cell.isClearSnow) // [!code --]
			{ // [!code --]
				passArea.Add(param, 34f, 0f); // [!code --]
			} // [!code --]
			break; // [!code --]
		case AM_FlagCell.Mode.flagFloat: // [!code --]
			if (this.cell.isForceFloat) // [!code --]
			{ // [!code --]
				passArea.Add(param, 34f, 0f); // [!code --]
			} // [!code --]
			break; // [!code --]
		case AM_FlagCell.Mode.flagClear: // [!code --]
			if (this.cell.isClearArea) // [!code --]
			{ // [!code --]
				passArea.Add(param, 34f, 0f); // [!code --]
			} // [!code --]
			break; // [!code --]
		} // [!code --]
	} // [!code --]
	if (detail == null) // [!code --]
	{ // [!code --]
		return; // [!code --]
	} // [!code --]
	if (highlightArea && detail.area != null) // [!code --]
	{ // [!code --]
		passArea.Add(param, (int)detail.area.GetTile(index) - ((!subtleHighlightArea) ? 1 : 0), 0f); // [!code --]
	} // [!code --]
	if (detail.footmark != null && sourceFloor.id != 0) // [!code --]
	{ // [!code --]
		param.tile = detail.footmark.tile; // [!code --]
		param.mat = matFloor; // [!code --]
		param.matColor = 104025f; // [!code --]
		renderFootmark.Draw(param); // [!code --]
	} // [!code --]
	goto IL_7a73; // [!code --]
	void Draw(int tile)
	{
		pass = passEdge;
```

[`@@ -3462,13 +3455,13 @@ public void DrawRoof(Lot lot)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L3462-L3474)
```cs:line-numbers=3462
				}
				num13 = 0;
			}
			if (room == null && !roofStyle.coverLot && !flag2) // [!code --]
			bool flag3 = isSnowCovered && !cell.isClearSnow; // [!code ++]
			if (room == null && !roofStyle.coverLot && !flag2 && !(cell.HasFullBlock && cell.IsRoomEdge && flag3)) // [!code ++]
			{
				continue;
			}
			index = cx + cz * Size;
			height = cell.TopHeight;
			bool flag3 = isSnowCovered && !cell.isClearSnow; // [!code --]
			float num18 = (float)num17 * screen.tileAlign.y + (float)lot.mh * _heightMod.y + lot.realHeight + roofFix.y + vector.y;
			float num19 = 1000f + param.x * screen.tileWeight.x + (float)lot.mh * _heightMod.z + lot.realHeight * roofFix3.z + roofFix.z + vector.z;
			if (lot.height == 1 && lot.heightFix < 20)
```

[`@@ -3488,7 +3481,7 @@ public void DrawRoof(Lot lot)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/BaseTileMap.cs#L3488-L3494)
```cs:line-numbers=3488
				RenderRow renderRow;
				if (roofStyle.type == RoofStyle.Type.FlatFloor)
				{
					if (cell.HasFullBlock && cell.IsRoomEdge) // [!code --]
					if (cell.HasFullBlock && cell.IsRoomEdge && !flag3) // [!code ++]
					{
						continue;
					}
```

## Chara

[`@@ -7122,9 +7122,9 @@ public Thing MakeMilk(bool effect = true, int num = 1, bool addToZone = true)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/Chara.cs#L7122-L7130)
```cs:line-numbers=7122
	Thing thing = ThingGen.Create("milk").SetNum(num);
	thing.MakeRefFrom(this);
	int num2 = base.LV - source.LV;
	if (EClass._zone.IsUserZone && !base.IsPCFactionOrMinion) // [!code --]
	if (!IsPCFaction) // [!code ++]
	{
		num2 = 0; // [!code --]
		num2 = ((!EClass._zone.IsUserZone) ? (num2 / 10) : 0); // [!code ++]
	}
	if (num2 >= 10)
	{
```

## GameIO

[`@@ -151,12 +151,16 @@ public static Game LoadGame(string id, string root, bool cloud)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/GameIO.cs#L151-L162)
```cs:line-numbers=151
	{
		Game.id = id;
		GameIndex gameIndex = IO.LoadFile<GameIndex>(root + "/index.txt");
		string path = root + "/game.txt"; // [!code ++]
		if (cloud)
		{
			gameIndex.cloud = true;
			Debug.Log(TryLoadSteamCloud()); // [!code --]
			Debug.Log(TryLoadSteamCloud(root)); // [!code ++]
		} // [!code ++]
		else if (!File.Exists(path)) // [!code ++]
		{ // [!code ++]
			Debug.Log(TryLoadSteamCloud(root)); // [!code ++]
		}
		string path = root + "/game.txt"; // [!code --]
		return JsonConvert.DeserializeObject<Game>(IO.IsCompressed(path) ? IO.Decompress(path) : File.ReadAllText(path), jsReadGame);
	}

```

[`@@ -192,34 +196,33 @@ public static void PrepareSteamCloud(string id, string path = "")`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/GameIO.cs#L192-L225)
```cs:line-numbers=192
		}
	}

	public static bool TryLoadSteamCloud() // [!code --]
	public static bool TryLoadSteamCloud(string pathSave) // [!code ++]
	{
		Debug.Log("LoadGame using cloud save");
		string text = CorePath.RootSaveCloud + Game.id; // [!code --]
		string text2 = text + "/cloud.zip"; // [!code --]
		string text3 = CorePath.RootSaveCloud + "/cloud.zip"; // [!code --]
		string text = pathSave + "/cloud.zip"; // [!code ++]
		string text2 = CorePath.RootSaveCloud + "/cloud.zip"; // [!code ++]
		bool flag = false;
		try
		{
			if (!File.Exists(text2)) // [!code --]
			if (!File.Exists(text)) // [!code ++]
			{
				EClass.ui.Say("Steam Cloud save not found:" + text2); // [!code --]
				EClass.ui.Say("Steam Cloud save not found:" + text); // [!code ++]
				return true;
			}
			if (File.Exists(text3)) // [!code --]
			if (File.Exists(text2)) // [!code ++]
			{
				File.Delete(text3); // [!code --]
				File.Delete(text2); // [!code ++]
			}
			File.Move(text2, text3); // [!code --]
			IO.DeleteDirectory(text); // [!code --]
			File.Move(text, text2); // [!code ++]
			IO.DeleteDirectory(pathSave); // [!code ++]
			flag = true;
			Directory.CreateDirectory(text); // [!code --]
			ZipFile.ExtractToDirectory(text3, text); // [!code --]
			if (File.Exists(text2)) // [!code --]
			Directory.CreateDirectory(pathSave); // [!code ++]
			ZipFile.ExtractToDirectory(text2, pathSave); // [!code ++]
			if (File.Exists(text)) // [!code ++]
			{
				File.Delete(text2); // [!code --]
				File.Delete(text); // [!code ++]
			}
			File.Move(text3, text2); // [!code --]
			File.Move(text2, text); // [!code ++]
		}
		catch (Exception ex)
		{
```

[`@@ -227,11 +230,11 @@ public static bool TryLoadSteamCloud()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/GameIO.cs#L227-L237)
```cs:line-numbers=227
		if (flag)
		{
			Debug.Log("Try restore backup:");
			if (Directory.Exists(text)) // [!code --]
			if (Directory.Exists(pathSave)) // [!code ++]
			{
				Directory.Delete(text); // [!code --]
				Directory.Delete(pathSave); // [!code ++]
			}
			File.Move(text3, text2); // [!code --]
			File.Move(text2, text); // [!code ++]
			return true;
		}
		return false;
```

## GameSerializationBinder

[`@@ -15,6 +15,11 @@ public override Type BindToType(string assemblyName, string typeName)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/GameSerializationBinder.cs#L15-L20)
```cs:line-numbers=15
	catch (Exception ex)
	{
		Debug.LogError(ex.Message);
		Debug.LogError(assemblyName + "/" + typeName); // [!code ++]
		if (typeName.Contains("Quest")) // [!code ++]
		{ // [!code ++]
			return typeof(QuestDummy); // [!code ++]
		} // [!code ++]
		return typeof(object);
	}
}
```

## LayerLoadGame

[`@@ -208,11 +208,7 @@ public void RefreshInfo(GameIndex i)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/LayerLoadGame.cs#L208-L218)
```cs:line-numbers=208
						foreach (GameIndex game in GameIO.GetGameList(((!cloud) ? CorePath.PathBackupCloud : CorePath.PathBackup) + i.id + "/"))
						{
							Debug.Log("Processing:" + game.id + ": " + game.path);
							if (cloud) // [!code --]
							{ // [!code --]
								IO.DeleteFile(game.path + "/cloud.zip"); // [!code --]
							} // [!code --]
							else // [!code --]
							if (!cloud) // [!code ++]
							{
								GameIO.PrepareSteamCloud(game.id, game.path);
							}
```

[`@@ -227,10 +223,6 @@ public void RefreshInfo(GameIndex i)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/LayerLoadGame.cs#L227-L236)
```cs:line-numbers=227
					{
						GameIO.PrepareSteamCloud(i.id);
					}
					else // [!code --]
					{ // [!code --]
						IO.DeleteFile(i.path + "/cloud.zip"); // [!code --]
					} // [!code --]
				}
				catch (Exception ex)
				{
```

## Quest

[`@@ -104,7 +104,7 @@ public Zone ClientZone`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/Quest.cs#L104-L110)
```cs:line-numbers=104

	public Chara chara => person.chara;

	public SourceQuest.Row source => EClass.sources.quests.map[idSource]; // [!code --]
	public virtual SourceQuest.Row source => EClass.sources.quests.map[idSource]; // [!code ++]

	public bool Confetti => false;

```

## QuestCraft

[`@@ -154,7 +154,7 @@ public override string GetTextProgress()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/QuestCraft.cs#L154-L160)
```cs:line-numbers=154

	public override string GetDetailText(bool onJournal = false)
	{
		return base.source.GetDetail().Split('|')[progress]; // [!code --]
		return source.GetDetail().Split('|')[progress]; // [!code ++]
	}

	public override string GetTalkProgress()
```

[`@@ -166,7 +166,7 @@ public override string GetTalkComplete()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/QuestCraft.cs#L166-L172)
```cs:line-numbers=166
{
	if (progress != 1 || !hasSecondReq)
	{
		return Parse(base.source.GetText("talkComplete")); // [!code --]
		return Parse(source.GetText("talkComplete")); // [!code ++]
	}
	return GetDetailText();
}
```

## QuestDialog

[`@@ -17,7 +17,7 @@ public override void ShowCompleteText()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/QuestDialog.cs#L17-L23)
```cs:line-numbers=17

	public override bool CanStartQuest()
	{
		if (base.source.id == "farris_tulip") // [!code --]
		if (source.id == "farris_tulip") // [!code ++]
		{
			return EClass.pc.faction.HasMember("farris");
		}
```

[`@@ -26,7 +26,7 @@ public override bool CanStartQuest()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/QuestDialog.cs#L26-L32)
```cs:line-numbers=26

	public override void OnDropReward()
	{
		switch (base.source.id) // [!code --]
		switch (source.id) // [!code ++]
		{
		case "pre_debt":
		{
```

## +QuestDummy

::: details File Created
```cs
public class QuestDummy : Quest
{
	public override SourceQuest.Row source => EClass.sources.quests.map["dummy"];

	public override bool CanAbandon => true;
}
```

:::
## QuestProgression

[`@@ -4,7 +4,7 @@ public class QuestProgression : QuestSequence`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/QuestProgression.cs#L4-L10)
```cs:line-numbers=4

	public override string GetDetail(bool onJournal = false)
	{
		string text = base.source.GetDetail().Split('|').TryGet(onJournal ? 1 : 0); // [!code --]
		string text = source.GetDetail().Split('|').TryGet(onJournal ? 1 : 0); // [!code ++]
		string text2 = GetTextProgress();
		if (!text2.IsEmpty())
		{
```

## QuestSequence

[`@@ -6,7 +6,7 @@ public class QuestSequence : Quest`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/QuestSequence.cs#L6-L12)
```cs:line-numbers=6

	public override string GetTitle()
	{
		string text = base.source.GetText("name", returnNull: true); // [!code --]
		string text = source.GetText("name", returnNull: true); // [!code ++]
		if (!text.IsEmpty())
		{
			return text;
```

## QuestSubdue

[`@@ -4,7 +4,7 @@ public class QuestSubdue : QuestInstance`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/QuestSubdue.cs#L4-L10)
```cs:line-numbers=4

	public override bool FameContent => true;

	public override int BaseMoney => base.source.money + EClass.curve(DangerLv, 20, 15) * 10; // [!code --]
	public override int BaseMoney => source.money + EClass.curve(DangerLv, 20, 15) * 10; // [!code ++]

	public override ZoneEventQuest CreateEvent()
	{
```

## Steam

[`@@ -38,11 +38,12 @@ public void CheckDLC()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/Steam.cs#L38-L48)
```cs:line-numbers=38

	public static bool HasDLC(ID_DLC id)
	{
		if (id != ID_DLC.BackerReward) // [!code --]
		return id switch // [!code ++]
		{
			_ = 2504360; // [!code --]
		} // [!code --]
		return EClass.core.config.HasBackerRewardCode(); // [!code --]
			ID_DLC.CursedManor => true,  // [!code ++]
			ID_DLC.BackerReward => EClass.core.config.HasBackerRewardCode(),  // [!code ++]
			_ => EClass.core.config.HasBackerRewardCode(),  // [!code ++]
		}; // [!code ++]
	}

	public static void GetAchievement(ID_Achievement id)
```

## TaskBuild

[`@@ -148,7 +148,7 @@ public override HitResult GetHitResult()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/TaskBuild.cs#L148-L154)
```cs:line-numbers=148
		{
			return HitResult.Invalid;
		}
		if (EClass.pc.held.TileType.IsBlockPass && pos.HasChara) // [!code --]
		if (EClass.pc.held.TileType.IsBlockPass && pos.HasChara && pos.FirstChara.IsHostile(EClass.pc)) // [!code ++]
		{
			return HitResult.Invalid;
		}
```

## TileType

[`@@ -79,6 +79,8 @@ public enum RampType`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/TileType.cs#L79-L84)
```cs:line-numbers=79

	public static TileTypeIllumination Illumination = new TileTypeIllumination();

	public static TileTypeTent Tent = new TileTypeTent(); // [!code ++]
 // [!code ++]
	public static TileTypeSeed Seed = new TileTypeSeed();

	public static TileTypeTree Tree = new TileTypeTree();
```

## +TileTypeTent

::: details File Created
```cs
public class TileTypeTent : TileTypeObjBig
{
}
```

:::
## TraitBoat

[`@@ -6,6 +6,8 @@ public class TraitBoat : Trait`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/TraitBoat.cs#L6-L11)
```cs:line-numbers=6

	public override bool IsGround => true;

	public override bool CanExtendBuild => true; // [!code ++]
 // [!code ++]
	public override void OnChangePlaceState(PlaceState state)
	{
		if (state == PlaceState.installed)
```

## TraitTent

[`@@ -6,6 +6,8 @@ public class TraitTent : TraitNewZone`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/424dbab1c12832c2e79eb2d9f3c9fd4d8cf56696/Elin/TraitTent.cs#L6-L11)
```cs:line-numbers=6

	public override bool CreateExternalZone => true;

	public override bool CanExtendBuild => true; // [!code ++]
 // [!code ++]
	public override bool CanBeHeld => true;

	public override int UseDist => 1;
```

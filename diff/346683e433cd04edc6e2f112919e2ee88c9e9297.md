---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 21 files modified. 4 new files created.
version: EA 23.255 Nightly Patch 3
changes: AM_MoveInstalled/BaseTileMap/Card/CardRenderer/Chara/CureType/Game/GrowSystem/RankedZoneManager/RecipeCard/SerializedCards/TaskHarvest/Thing/Trait/TraitFakeBlock/+TraitFakeObj/+TraitFakeTile/TraitHouseBoard/TraitRoomPlate/+TraitSyringe/TraitSyringeBlood/TraitSyringeGene/TraitSyringeHeaven/+TraitSyringeUnicorn/TraitTicketChampagne
---

# EA 23.255 Nightly Patch 3

January 5, 2026

21 files modified. 4 new files created.

## Important Changes

Possible breaking changes. Click the filename to view the chunk.
### [GrowSystem (1)](#growsystem)
```cs:no-line-numbers
public virtual void OnRenderTileMap(RenderParam p) // [!code --]
public virtual void OnRenderTileMap(RenderParam p, bool drawShadow = true) // [!code ++]
```
### [TraitFakeBlock (3)](#traitfakeblock)
```cs:no-line-numbers
public override void OnCreate(int lv) // [!code --]

```
```cs:no-line-numbers
public override void OnCrafted(Recipe recipe, List<Thing> ings) // [!code --]

```
```cs:no-line-numbers
public override void TrySetHeldAct(ActPlan p) // [!code --]

```
## AM_MoveInstalled

[`public void SetTarget(Card _target)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/AM_MoveInstalled.cs#L160-L165)
```cs:line-numbers=160
	{
		moldCard = target.Duplicate(1);
		moldCard.placeState = PlaceState.installed;
		moldCard._CreateRenderer(); // [!code ++]
	}
	else
	{
```

## BaseTileMap

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1281-L1525)
```cs:line-numbers=1281
			fogged = true;
		}
	}
	goto IL_7ba5; // [!code --]
	IL_6fea: // [!code --]
	if (isSnowCovered && (sourceBlock.id != 0 || this.cell.hasDoor) && !snowed && !this.cell.isClearSnow && ((!this.cell.Front.HasRoof && !this.cell.Front.HasBlock) || (!this.cell.Right.HasRoof && !this.cell.Right.HasBlock))) // [!code --]
	{ // [!code --]
		snowed = true; // [!code --]
	} // [!code --]
	if (this.cell.effect != null) // [!code --]
	{ // [!code --]
		if (this.cell.effect.IsLiquid) // [!code --]
		{ // [!code --]
			SourceCellEffect.Row sourceEffect = this.cell.sourceEffect; // [!code --]
			SourceMaterial.Row defaultMaterial = sourceEffect.DefaultMaterial; // [!code --]
			tile = 4 + Rand.bytes[index % Rand.MaxBytes] % 4; // [!code --]
			param.tile = tile + this.cell.sourceEffect._tiles[0]; // [!code --]
			param.mat = defaultMaterial; // [!code --]
			param.matColor = ((this.cell.effect.color == 0) ? GetColorInt(ref defaultMaterial.matColor, sourceEffect.colorMod) : this.cell.effect.color); // [!code --]
			sourceEffect.renderData.Draw(param); // [!code --]
		} // [!code --]
		else // [!code --]
		{ // [!code --]
			param.tile = this.cell.effect.source._tiles[0]; // [!code --]
			SourceCellEffect.Row sourceEffect2 = this.cell.sourceEffect; // [!code --]
			if (sourceEffect2.anime.Length != 0) // [!code --]
			{ // [!code --]
				if (sourceEffect2.anime.Length > 2) // [!code --]
				{ // [!code --]
					float num3 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code --]
					if (!(num3 >= (float)sourceEffect2.anime[0])) // [!code --]
					{ // [!code --]
						param.tile += num3; // [!code --]
					} // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					float num4 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code --]
					param.tile += num4; // [!code --]
				} // [!code --]
			} // [!code --]
			if (this.cell.effect.IsFire) // [!code --]
			{ // [!code --]
				rendererEffect.Draw(param); // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				this.cell.effect.source.renderData.Draw(param); // [!code --]
			} // [!code --]
		} // [!code --]
	} // [!code --]
	param.color = floorLight; // [!code --]
	if (this.cell.critter != null) // [!code --]
	{ // [!code --]
		Critter critter = this.cell.critter; // [!code --]
		int snowTile = critter.tile; // [!code --]
		if (snowed && critter.SnowTile != 0) // [!code --]
		{ // [!code --]
			critter.x = 0.06f; // [!code --]
			critter.y = -0.06f; // [!code --]
			snowTile = critter.SnowTile; // [!code --]
		} // [!code --]
		else // [!code --]
		{ // [!code --]
			critter.Update(); // [!code --]
		} // [!code --]
		pass = passObjSS; // [!code --]
		batch = pass.batches[pass.batchIdx]; // [!code --]
		batch.matrices[pass.idx].m03 = param.x + (float)(int)(critter.x * 100f) * 0.01f; // [!code --]
		batch.matrices[pass.idx].m13 = param.y + (float)(int)(critter.y * 100f) * 0.01f; // [!code --]
		batch.matrices[pass.idx].m23 = param.z; // [!code --]
		batch.tiles[pass.idx] = snowTile * ((!critter.reverse) ? 1 : (-1)); // [!code --]
		batch.colors[pass.idx] = floorLight; // [!code --]
		pass.idx++; // [!code --]
		if (pass.idx == pass.batchSize) // [!code --]
		{ // [!code --]
			pass.NextBatch(); // [!code --]
		} // [!code --]
	} // [!code --]
	if (detail != null) // [!code --]
	{ // [!code --]
		TransAnime anime3 = detail.anime; // [!code --]
		if (anime3 != null && !anime3.animeBlock) // [!code --]
		{ // [!code --]
			TransAnime anime4 = detail.anime; // [!code --]
			param.x += anime4.v.x; // [!code --]
			param.y += anime4.v.y; // [!code --]
			param.z += anime4.v.z; // [!code --]
		} // [!code --]
	} // [!code --]
	if (this.cell.obj != 0 && !this.cell.sourceObj.renderData.SkipOnMap) // [!code --]
	{ // [!code --]
		SourceObj.Row sourceObj = this.cell.sourceObj; // [!code --]
		if (!snowed || sourceObj.snowTile <= 0) // [!code --]
		{ // [!code --]
			param.snow = snowed; // [!code --]
			param.mat = this.cell.matObj; // [!code --]
			orgY = param.y; // [!code --]
			if (param.liquidLv > 0) // [!code --]
			{ // [!code --]
				if (sourceObj.pref.Float) // [!code --]
				{ // [!code --]
					param.y += 0.01f * floatY; // [!code --]
					if (liquidLv > 10) // [!code --]
					{ // [!code --]
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code --]
					} // [!code --]
					liquidLv -= (int)(floatY * 0.5f); // [!code --]
					param.liquidLv = liquidLv; // [!code --]
				} // [!code --]
				if (sourceObj.tileType.IsWaterTop) // [!code --]
				{ // [!code --]
					param.liquidLv = 0; // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					param.liquidLv += sourceObj.pref.liquidMod; // [!code --]
					if (param.liquidLv < 1) // [!code --]
					{ // [!code --]
						param.liquid = 1f; // [!code --]
					} // [!code --]
					else if (param.liquidLv > 99 + sourceObj.pref.liquidModMax) // [!code --]
					{ // [!code --]
						param.liquidLv = 99 + sourceObj.pref.liquidModMax; // [!code --]
					} // [!code --]
				} // [!code --]
			} // [!code --]
			if (sourceObj.useAltColor) // [!code --]
			{ // [!code --]
				param.matColor = ((sourceObj.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, sourceObj.colorMod)); // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				param.matColor = ((sourceObj.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, sourceObj.colorMod)); // [!code --]
			} // [!code --]
			if (sourceObj.HasGrowth) // [!code --]
			{ // [!code --]
				this.cell.growth.OnRenderTileMap(param); // [!code --]
				if (this.cell.obj == 118 && Core.fixedFrame % 10f == 0f && sourceObj.growth.IsMature) // [!code --]
				{ // [!code --]
					EMono.scene.psFey.transform.position = new Vector3(param.x, param.y, param.z - 2f); // [!code --]
					EMono.scene.psFey.Emit(1); // [!code --]
				} // [!code --]
			} // [!code --]
			else // [!code --]
			{ // [!code --]
				if (this.cell.autotileObj != 0) // [!code --]
				{ // [!code --]
					param.tile = sourceObj._tiles[0] + this.cell.autotileObj; // [!code --]
				} // [!code --]
				else if (sourceObj.tileType.IsUseBlockDir) // [!code --]
				{ // [!code --]
					param.tile = sourceObj._tiles[this.cell.blockDir % sourceObj._tiles.Length]; // [!code --]
				} // [!code --]
				else // [!code --]
				{ // [!code --]
					param.tile = sourceObj._tiles[this.cell.objDir % sourceObj._tiles.Length]; // [!code --]
				} // [!code --]
				if (_lowblock && sourceObj.tileType.IsSkipLowBlock) // [!code --]
				{ // [!code --]
					param.tile += ((param.tile > 0f) ? 1 : (-1)) * 3000000; // [!code --]
				} // [!code --]
				orgY = param.y; // [!code --]
				orgZ = param.z; // [!code --]
				param.y += sourceObj.pref.y; // [!code --]
				param.z += sourceObj.pref.z; // [!code --]
				sourceObj.renderData.Draw(param); // [!code --]
				param.y = orgY; // [!code --]
				param.z = orgZ; // [!code --]
				int shadow3 = sourceObj.pref.shadow; // [!code --]
				if (shadow3 > 1 && !this.cell.ignoreObjShadow) // [!code --]
				{ // [!code --]
					passShadow.AddShadow(param.x + sourceObj.renderData.offsetShadow.x, param.y + sourceObj.renderData.offsetShadow.y, param.z + sourceObj.renderData.offsetShadow.z, ShadowData.Instance.items[shadow3], sourceObj.pref, 0, param.snow); // [!code --]
				} // [!code --]
				param.y = orgY; // [!code --]
			} // [!code --]
		} // [!code --]
	} // [!code --]
	if (this.cell.decal != 0 && sourceFloor.tileType.AllowBlood) // [!code --]
	{ // [!code --]
		passDecal.Add(param, (int)this.cell.decal, floorLight); // [!code --]
	} // [!code --]
	if (highlightCells) // [!code --]
	{ // [!code --]
		switch (ActionMode.FlagCell.mode) // [!code --]
		{ // [!code --]
		case AM_FlagCell.Mode.flagWallPillar: // [!code --]
			if (this.cell.isToggleWallPillar) // [!code --]
			{ // [!code --]
				passArea.Add(param, 34f, 0f); // [!code --]
			} // [!code --]
			break; // [!code --]
		case AM_FlagCell.Mode.flagSnow: // [!code --]
			if (this.cell.isClearSnow) // [!code --]
			{ // [!code --]
				passArea.Add(param, 34f, 0f); // [!code --]
			} // [!code --]
			break; // [!code --]
		case AM_FlagCell.Mode.flagFloat: // [!code --]
			if (this.cell.isForceFloat) // [!code --]
			{ // [!code --]
				passArea.Add(param, 34f, 0f); // [!code --]
			} // [!code --]
			break; // [!code --]
		case AM_FlagCell.Mode.flagClear: // [!code --]
			if (this.cell.isClearArea) // [!code --]
			{ // [!code --]
				passArea.Add(param, 34f, 0f); // [!code --]
			} // [!code --]
			break; // [!code --]
		} // [!code --]
	} // [!code --]
	if (detail == null) // [!code --]
	{ // [!code --]
		return; // [!code --]
	} // [!code --]
	if (highlightArea && detail.area != null) // [!code --]
	{ // [!code --]
		passArea.Add(param, (int)detail.area.GetTile(index) - ((!subtleHighlightArea) ? 1 : 0), 0f); // [!code --]
	} // [!code --]
	if (detail.footmark != null && sourceFloor.id != 0) // [!code --]
	{ // [!code --]
		param.tile = detail.footmark.tile; // [!code --]
		param.mat = matFloor; // [!code --]
		param.matColor = 104025f; // [!code --]
		renderFootmark.Draw(param); // [!code --]
	} // [!code --]
	goto IL_7ba5; // [!code --]
	goto IL_7b1b; // [!code ++]
	IL_6f8a:
	int num5; // [!code --]
	int num3; // [!code ++]
	if (!showRoof || !roof || this.cell.room == null || this.cell.Front.room == null || this.cell.Right.room == null)
	{
		param.tile = num5; // [!code --]
		param.tile = num3; // [!code ++]
		rendererFov.Draw(param);
	}
	goto IL_6fea;
	IL_7ba5: // [!code --]
	IL_7b1b: // [!code ++]
	if (detail.things.Count == 0 && detail.charas.Count == 0)
	{
		return;
	}
	int num6 = 0; // [!code --]
	int num4 = 0; // [!code ++]
	thingPos.x = 0f;
	thingPos.y = 0f;
	thingPos.z = 0f;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1550-L1567)
```cs:line-numbers=1550
	}
	Thing thing = null;
	bool shadow = liquidLv == 0;
	float num5 = 0f; // [!code ++]
	float num6 = 0f; // [!code ++]
	float num7 = 0f;
	float num8 = 0f;
	float num9 = 0f; // [!code --]
	float num10 = 0f; // [!code --]
	bool flag6 = false;
	float num11 = 0f; // [!code --]
	float num9 = 0f; // [!code ++]
	bool flag7 = false;
	float num12 = 0f; // [!code --]
	float num10 = 0f; // [!code ++]
	if (detail.things.Count > 0 && isSeen)
	{
		_ = zSetting.max1;
		float num13 = 0f; // [!code --]
		float num11 = 0f; // [!code ++]
		for (int j = 0; j < detail.things.Count; j++)
		{
			Thing t = detail.things[j];
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1576-L1588)
```cs:line-numbers=1576
			{
				pref = rendererObjDummy.shadowPref;
			}
			float num14 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code --]
			float num12 = ((tileType.UseMountHeight && isInstalled) ? 0f : ((pref.height < 0f) ? 0f : ((pref.height == 0f) ? 0.1f : pref.height))); // [!code ++]
			if (t.ignoreStackHeight)
			{
				thingPos.y -= num7; // [!code --]
				thingPos -= altitudeFix * num8; // [!code --]
				thingPos.y -= num5; // [!code ++]
				thingPos -= altitudeFix * num6; // [!code ++]
			}
			shadow = thingPos.y < 0.16f && num12 < 0.16f; // [!code --]
			shadow = thingPos.y < 0.16f && num10 < 0.16f; // [!code ++]
			_ = pref.bypassShadow;
			param.shadowFix = 0f - thingPos.y;
			param.liquidLv = ((thingPos.y + (float)t.altitude < 0.1f) ? liquidLv : 0);
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1592-L1598)
```cs:line-numbers=1592
				SetRoofHeight(param, this.cell, cx, cz);
				_actorPos.x = param.x;
				_actorPos.y = param.y;
				_actorPos.z = param.z + num13; // [!code --]
				_actorPos.z = param.z + num11; // [!code ++]
				if (this.room != null)
				{
					param.color = GetRoofLight(this.room.lot);
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1603-L1611)
```cs:line-numbers=1603
			else
			{
				param.snow = snowed;
				_actorPos.x = orgX + num10; // [!code --]
				_actorPos.x = orgX + num8; // [!code ++]
				_actorPos.y = orgY;
				_actorPos.z = orgZ + num13 + thingPos.z; // [!code --]
				_actorPos.z = orgZ + num11 + thingPos.z; // [!code ++]
				if (tileType.CanStack || !isInstalled)
				{
					if (thing?.id != t.id)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1615-L1627)
```cs:line-numbers=1615
					_actorPos.y += thingPos.y;
					if (t.trait.IgnoreLastStackHeight && (thing == null || !thing.trait.IgnoreLastStackHeight))
					{
						thingPos.y -= num7; // [!code --]
						thingPos.y -= num5; // [!code ++]
						if (thing != null)
						{
							_actorPos.z -= 0.2f;
							thingPos.z -= 0.2f;
						}
						_actorPos.y -= num7; // [!code --]
						_actorPos.y -= num5; // [!code ++]
					}
					_actorPos.z += renderSetting.thingZ + (float)j * -0.01f + zSetting.mod1 * thingPos.y;
				}
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1638-L1644)
```cs:line-numbers=1638
						freePos.z += rampFix2.z;
						if (!this.cell.IsTopWater || t.altitude > 0)
						{
							num12 += rampFix2.y; // [!code --]
							num10 += rampFix2.y; // [!code ++]
						}
						liquidLv -= (int)(rampFix2.y * 150f);
						if (liquidLv < 0)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1648-L1659)
```cs:line-numbers=1648
					}
					else if (!flag7 && t.trait.IsChangeFloorHeight && !t.ignoreStackHeight)
					{
						orgY += num14 + (float)t.altitude * altitudeFix.y; // [!code --]
						orgY += num12 + (float)t.altitude * altitudeFix.y; // [!code ++]
						orgZ += (float)t.altitude * altitudeFix.z;
						freePos.y += num14 + (float)t.altitude * altitudeFix.y; // [!code --]
						freePos.y += num12 + (float)t.altitude * altitudeFix.y; // [!code ++]
						if (!this.cell.IsTopWater || t.altitude > 0)
						{
							num12 += num14 + (float)t.altitude * altitudeFix.y; // [!code --]
							num10 += num12 + (float)t.altitude * altitudeFix.y; // [!code ++]
						}
						_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1));
						_actorPos.z += pref.z;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1665-L1671)
```cs:line-numbers=1665
					}
					else
					{
						thingPos.y += num14; // [!code --]
						thingPos.y += num12; // [!code ++]
						if (tileType.UseMountHeight)
						{
							if (tileType != TileType.Illumination || !this.cell.HasObj)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1722-L1728)
```cs:line-numbers=1722
				}
				else
				{
					thingPos.y += num14; // [!code --]
					thingPos.y += num12; // [!code ++]
					_actorPos.x += pref.x * (float)((!t.flipX) ? 1 : (-1));
					_actorPos.z += pref.z;
					thingPos.z += pref.z;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1730-L1742)
```cs:line-numbers=1730
				if (t.isFloating && isWater && !hasBridge && !flag)
				{
					flag = true;
					float num15 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code --]
					orgY += 0.01f * floatY - num15; // [!code --]
					float num13 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code ++]
					orgY += 0.01f * floatY - num13; // [!code ++]
					if (!t.trait.IsChangeFloorHeight)
					{
						num11 = num14; // [!code --]
						num9 = num12; // [!code ++]
					}
					_actorPos.y += 0.01f * floatY - num15; // [!code --]
					_actorPos.y += 0.01f * floatY - num13; // [!code ++]
					if (liquidLv > 10)
					{
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1748-L1757)
```cs:line-numbers=1748
					}
					param.liquidLv = liquidLv;
				}
				num7 = num14; // [!code --]
				num5 = num12; // [!code ++]
				if (t.sourceCard.multisize && !t.trait.IsGround)
				{
					num13 += zSetting.multiZ; // [!code --]
					num11 += zSetting.multiZ; // [!code ++]
				}
				orgZ += t.renderer.data.stackZ;
				if (param.liquidLv > 0)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1774-L1784)
```cs:line-numbers=1774
					_actorPos += altitudeFix * t.altitude;
					if (!t.isRoofItem)
					{
						num9 += (float)t.altitude; // [!code --]
						num8 = t.altitude; // [!code --]
						num7 += (float)t.altitude; // [!code ++]
						num6 = t.altitude; // [!code ++]
					}
				}
				if (num9 >= 2f && ((this.cell.Back.room != null && this.cell.Back.IsRoomEdge) || (this.cell.Left.room != null && this.cell.Left.IsRoomEdge)) && hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code --]
				if (num7 >= 2f && ((this.cell.Back.room != null && this.cell.Back.IsRoomEdge) || (this.cell.Left.room != null && this.cell.Left.IsRoomEdge)) && hideHang && (this.cell.room?.lot != currentLot || (!this.cell.lotWall && this.cell.room != currentRoom))) // [!code ++]
				{
					continue;
				}
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1804-L1838)
```cs:line-numbers=1804
			{
				if (iconMode != 0)
				{
					int num16 = 0; // [!code --]
					int num14 = 0; // [!code ++]
					switch (iconMode)
					{
					case CardIconMode.Visibility:
						if (t.isMasked)
						{
							num16 = 17; // [!code --]
							num14 = 17; // [!code ++]
						}
						break;
					case CardIconMode.State:
						if (t.placeState == PlaceState.installed)
						{
							num16 = 18; // [!code --]
							num14 = 18; // [!code ++]
						}
						break;
					case CardIconMode.Deconstruct:
						if (t.isDeconstructing)
						{
							num16 = 14; // [!code --]
							num14 = 14; // [!code ++]
						}
						break;
					}
					if (t.isNPCProperty && !EMono.debug.godBuild)
					{
						num16 = 13; // [!code --]
						num14 = 13; // [!code ++]
					}
					if (num16 != 0) // [!code --]
					if (num14 != 0) // [!code ++]
					{
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num16); // [!code --]
						passGuideBlock.Add(_actorPos.x, _actorPos.y, _actorPos.z - 10f, num14); // [!code ++]
					}
				}
				t.SetRenderParam(param);
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1859-L1865)
```cs:line-numbers=1859
			}
			if (isInstalled)
			{
				num10 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code --]
				num8 += pref.stackX * (float)((!t.flipX) ? 1 : (-1)); // [!code ++]
			}
			param.x = orgX;
			param.y = orgY;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1872-L1883)
```cs:line-numbers=1872
			}
		}
	}
	orgY += num11; // [!code --]
	orgY += num9; // [!code ++]
	if (detail.charas.Count <= 0)
	{
		return;
	}
	param.shadowFix = 0f - num12; // [!code --]
	param.shadowFix = 0f - num10; // [!code ++]
	param.color += 1310720f;
	float max = zSetting.max2;
	for (int k = 0; k < detail.charas.Count; k++)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1902-L1910)
```cs:line-numbers=1902
				{
					Vector3 position = restrainer.owner.renderer.position;
					float defCharaHeight = EMono.setting.render.defCharaHeight;
					float num17 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code --]
					float num15 = getRestrainPos.y + defCharaHeight - ((chara.Pref.height == 0f) ? defCharaHeight : chara.source.pref.height); // [!code ++]
					_actorPos.x = position.x + getRestrainPos.x * (float)((restrainer.owner.dir % 2 == 0) ? 1 : (-1));
					_actorPos.y = position.y + num17; // [!code --]
					_actorPos.y = position.y + num15; // [!code ++]
					_actorPos.z = position.z + getRestrainPos.z;
					param.liquidLv = 0;
					param.shadowFix = orgY - _actorPos.y;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1919-L1940)
```cs:line-numbers=1919
		{
			if (chara.IsDeadOrSleeping && chara.IsPCC)
			{
				float num18 = chara.renderer.data.size.y * 0.3f; // [!code --]
				float num16 = chara.renderer.data.size.y * 0.3f; // [!code ++]
				if (thingPos.y > max)
				{
					thingPos.y = max;
				}
				float num19 = thingPos.y + num18; // [!code --]
				float num20 = (float)k * -0.01f; // [!code --]
				if (num19 > zSetting.thresh1) // [!code --]
				float num17 = thingPos.y + num16; // [!code ++]
				float num18 = (float)k * -0.01f; // [!code ++]
				if (num17 > zSetting.thresh1) // [!code ++]
				{
					num20 = zSetting.mod1; // [!code --]
					num18 = zSetting.mod1; // [!code ++]
				}
				_actorPos.x += thingPos.x;
				_actorPos.y += thingPos.y;
				_actorPos.z += renderSetting.laydownZ + num20; // [!code --]
				_actorPos.z += renderSetting.laydownZ + num18; // [!code ++]
				param.liquidLv = ((thingPos.y == 0f && liquidLv > 0) ? 90 : 0);
				thingPos.y += num18 * 0.8f; // [!code --]
				thingPos.y += num16 * 0.8f; // [!code ++]
				chara.renderer.Draw(param, ref _actorPos, liquidLv == 0);
			}
			else
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1944-L1954)
```cs:line-numbers=1944
				{
					if (chara.Pref.FloatUnderwater)
					{
						float num21 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code --]
						float num22 = floatYs[chara.uid % 10] + 10f + (float)(chara.uid % 30); // [!code --]
						orgY += 0.01f * num22 - num21; // [!code --]
						_actorPos.y += 0.01f * num22 - num21; // [!code --]
						param.shadowFix -= 0.01f * num22 - num21; // [!code --]
						float num19 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code ++]
						float num20 = floatYs[chara.uid % 10] + 10f + (float)(chara.uid % 30); // [!code ++]
						orgY += 0.01f * num20 - num19; // [!code ++]
						_actorPos.y += 0.01f * num20 - num19; // [!code ++]
						param.shadowFix -= 0.01f * num20 - num19; // [!code ++]
					}
				}
				else if (liquidLv > 0)
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1957-L1968)
```cs:line-numbers=1957
					{
						if (liquidLv > 20)
						{
							float num23 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code --]
							orgY += 0.01f * floatY - num23; // [!code --]
							_actorPos.y += 0.01f * floatY - num23; // [!code --]
							int num24 = TileType.FloorWaterShallow.LiquidLV * 10; // [!code --]
							num24 -= (int)(floatY * 0.5f); // [!code --]
							param.liquidLv = num24; // [!code --]
							float num21 = ((this.cell._bridge != 0) ? sourceBridge.tileType.FloorHeight : sourceFloor.tileType.FloorHeight); // [!code ++]
							orgY += 0.01f * floatY - num21; // [!code ++]
							_actorPos.y += 0.01f * floatY - num21; // [!code ++]
							int num22 = TileType.FloorWaterShallow.LiquidLV * 10; // [!code ++]
							num22 -= (int)(floatY * 0.5f); // [!code ++]
							param.liquidLv = num22; // [!code ++]
						}
						else
						{
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1981-L1990)
```cs:line-numbers=1981
				}
				if (!chara.IsPC && !chara.renderer.IsMoving && detail.charas.Count > 1 && (detail.charas.Count != 2 || !detail.charas[0].IsDeadOrSleeping || !detail.charas[0].IsPCC))
				{
					_actorPos += renderSetting.charaPos[1 + ((num6 < 4) ? num6 : 3)]; // [!code --]
					_actorPos += renderSetting.charaPos[1 + ((num4 < 4) ? num4 : 3)]; // [!code ++]
				}
				_actorPos.z += 0.01f * (float)k + renderSetting.charaZ;
				num6++; // [!code --]
				num4++; // [!code ++]
				if (flag6)
				{
					_actorPos.z += chara.renderer.data.hangedFixZ;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L1997-L2002)
```cs:line-numbers=1997
		param.z = orgZ;
	}
	return;
	IL_6fea: // [!code ++]
	if (isSnowCovered && (sourceBlock.id != 0 || this.cell.hasDoor) && !snowed && !this.cell.isClearSnow && ((!this.cell.Front.HasRoof && !this.cell.Front.HasBlock) || (!this.cell.Right.HasRoof && !this.cell.Right.HasBlock))) // [!code ++]
	{ // [!code ++]
		snowed = true; // [!code ++]
	} // [!code ++]
	if (this.cell.effect != null) // [!code ++]
	{ // [!code ++]
		if (this.cell.effect.IsLiquid) // [!code ++]
		{ // [!code ++]
			SourceCellEffect.Row sourceEffect = this.cell.sourceEffect; // [!code ++]
			SourceMaterial.Row defaultMaterial = sourceEffect.DefaultMaterial; // [!code ++]
			tile = 4 + Rand.bytes[index % Rand.MaxBytes] % 4; // [!code ++]
			param.tile = tile + this.cell.sourceEffect._tiles[0]; // [!code ++]
			param.mat = defaultMaterial; // [!code ++]
			param.matColor = ((this.cell.effect.color == 0) ? GetColorInt(ref defaultMaterial.matColor, sourceEffect.colorMod) : this.cell.effect.color); // [!code ++]
			sourceEffect.renderData.Draw(param); // [!code ++]
		} // [!code ++]
		else // [!code ++]
		{ // [!code ++]
			param.tile = this.cell.effect.source._tiles[0]; // [!code ++]
			SourceCellEffect.Row sourceEffect2 = this.cell.sourceEffect; // [!code ++]
			if (sourceEffect2.anime.Length != 0) // [!code ++]
			{ // [!code ++]
				if (sourceEffect2.anime.Length > 2) // [!code ++]
				{ // [!code ++]
					float num23 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[2]; // [!code ++]
					if (!(num23 >= (float)sourceEffect2.anime[0])) // [!code ++]
					{ // [!code ++]
						param.tile += num23; // [!code ++]
					} // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					float num24 = Time.realtimeSinceStartup * 1000f / (float)sourceEffect2.anime[1] % (float)sourceEffect2.anime[0]; // [!code ++]
					param.tile += num24; // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (this.cell.effect.IsFire) // [!code ++]
			{ // [!code ++]
				rendererEffect.Draw(param); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				this.cell.effect.source.renderData.Draw(param); // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
	param.color = floorLight; // [!code ++]
	if (this.cell.critter != null) // [!code ++]
	{ // [!code ++]
		Critter critter = this.cell.critter; // [!code ++]
		int snowTile = critter.tile; // [!code ++]
		if (snowed && critter.SnowTile != 0) // [!code ++]
		{ // [!code ++]
			critter.x = 0.06f; // [!code ++]
			critter.y = -0.06f; // [!code ++]
			snowTile = critter.SnowTile; // [!code ++]
		} // [!code ++]
		else // [!code ++]
		{ // [!code ++]
			critter.Update(); // [!code ++]
		} // [!code ++]
		pass = passObjSS; // [!code ++]
		batch = pass.batches[pass.batchIdx]; // [!code ++]
		batch.matrices[pass.idx].m03 = param.x + (float)(int)(critter.x * 100f) * 0.01f; // [!code ++]
		batch.matrices[pass.idx].m13 = param.y + (float)(int)(critter.y * 100f) * 0.01f; // [!code ++]
		batch.matrices[pass.idx].m23 = param.z; // [!code ++]
		batch.tiles[pass.idx] = snowTile * ((!critter.reverse) ? 1 : (-1)); // [!code ++]
		batch.colors[pass.idx] = floorLight; // [!code ++]
		pass.idx++; // [!code ++]
		if (pass.idx == pass.batchSize) // [!code ++]
		{ // [!code ++]
			pass.NextBatch(); // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (detail != null) // [!code ++]
	{ // [!code ++]
		TransAnime anime3 = detail.anime; // [!code ++]
		if (anime3 != null && !anime3.animeBlock) // [!code ++]
		{ // [!code ++]
			TransAnime anime4 = detail.anime; // [!code ++]
			param.x += anime4.v.x; // [!code ++]
			param.y += anime4.v.y; // [!code ++]
			param.z += anime4.v.z; // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (this.cell.obj != 0 && !this.cell.sourceObj.renderData.SkipOnMap) // [!code ++]
	{ // [!code ++]
		SourceObj.Row sourceObj = this.cell.sourceObj; // [!code ++]
		if (!snowed || sourceObj.snowTile <= 0) // [!code ++]
		{ // [!code ++]
			param.snow = snowed; // [!code ++]
			param.mat = this.cell.matObj; // [!code ++]
			orgY = param.y; // [!code ++]
			if (param.liquidLv > 0) // [!code ++]
			{ // [!code ++]
				if (sourceObj.pref.Float) // [!code ++]
				{ // [!code ++]
					param.y += 0.01f * floatY; // [!code ++]
					if (liquidLv > 10) // [!code ++]
					{ // [!code ++]
						liquidLv = TileType.FloorWaterShallow.LiquidLV * 10; // [!code ++]
					} // [!code ++]
					liquidLv -= (int)(floatY * 0.5f); // [!code ++]
					param.liquidLv = liquidLv; // [!code ++]
				} // [!code ++]
				if (sourceObj.tileType.IsWaterTop) // [!code ++]
				{ // [!code ++]
					param.liquidLv = 0; // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					param.liquidLv += sourceObj.pref.liquidMod; // [!code ++]
					if (param.liquidLv < 1) // [!code ++]
					{ // [!code ++]
						param.liquid = 1f; // [!code ++]
					} // [!code ++]
					else if (param.liquidLv > 99 + sourceObj.pref.liquidModMax) // [!code ++]
					{ // [!code ++]
						param.liquidLv = 99 + sourceObj.pref.liquidModMax; // [!code ++]
					} // [!code ++]
				} // [!code ++]
			} // [!code ++]
			if (sourceObj.useAltColor) // [!code ++]
			{ // [!code ++]
				param.matColor = ((sourceObj.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.altColor, sourceObj.colorMod)); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				param.matColor = ((sourceObj.colorMod == 0) ? 104025 : GetColorInt(ref param.mat.matColor, sourceObj.colorMod)); // [!code ++]
			} // [!code ++]
			if (sourceObj.HasGrowth) // [!code ++]
			{ // [!code ++]
				this.cell.growth.OnRenderTileMap(param); // [!code ++]
			} // [!code ++]
			else // [!code ++]
			{ // [!code ++]
				if (this.cell.autotileObj != 0) // [!code ++]
				{ // [!code ++]
					param.tile = sourceObj._tiles[0] + this.cell.autotileObj; // [!code ++]
				} // [!code ++]
				else if (sourceObj.tileType.IsUseBlockDir) // [!code ++]
				{ // [!code ++]
					param.tile = sourceObj._tiles[this.cell.blockDir % sourceObj._tiles.Length]; // [!code ++]
				} // [!code ++]
				else // [!code ++]
				{ // [!code ++]
					param.tile = sourceObj._tiles[this.cell.objDir % sourceObj._tiles.Length]; // [!code ++]
				} // [!code ++]
				if (_lowblock && sourceObj.tileType.IsSkipLowBlock) // [!code ++]
				{ // [!code ++]
					param.tile += ((param.tile > 0f) ? 1 : (-1)) * 3000000; // [!code ++]
				} // [!code ++]
				orgY = param.y; // [!code ++]
				orgZ = param.z; // [!code ++]
				param.y += sourceObj.pref.y; // [!code ++]
				param.z += sourceObj.pref.z; // [!code ++]
				sourceObj.renderData.Draw(param); // [!code ++]
				param.y = orgY; // [!code ++]
				param.z = orgZ; // [!code ++]
				int shadow3 = sourceObj.pref.shadow; // [!code ++]
				if (shadow3 > 1 && !this.cell.ignoreObjShadow) // [!code ++]
				{ // [!code ++]
					passShadow.AddShadow(param.x + sourceObj.renderData.offsetShadow.x, param.y + sourceObj.renderData.offsetShadow.y, param.z + sourceObj.renderData.offsetShadow.z, ShadowData.Instance.items[shadow3], sourceObj.pref, 0, param.snow); // [!code ++]
				} // [!code ++]
				param.y = orgY; // [!code ++]
			} // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (this.cell.decal != 0 && sourceFloor.tileType.AllowBlood) // [!code ++]
	{ // [!code ++]
		passDecal.Add(param, (int)this.cell.decal, floorLight); // [!code ++]
	} // [!code ++]
	if (highlightCells) // [!code ++]
	{ // [!code ++]
		switch (ActionMode.FlagCell.mode) // [!code ++]
		{ // [!code ++]
		case AM_FlagCell.Mode.flagWallPillar: // [!code ++]
			if (this.cell.isToggleWallPillar) // [!code ++]
			{ // [!code ++]
				passArea.Add(param, 34f, 0f); // [!code ++]
			} // [!code ++]
			break; // [!code ++]
		case AM_FlagCell.Mode.flagSnow: // [!code ++]
			if (this.cell.isClearSnow) // [!code ++]
			{ // [!code ++]
				passArea.Add(param, 34f, 0f); // [!code ++]
			} // [!code ++]
			break; // [!code ++]
		case AM_FlagCell.Mode.flagFloat: // [!code ++]
			if (this.cell.isForceFloat) // [!code ++]
			{ // [!code ++]
				passArea.Add(param, 34f, 0f); // [!code ++]
			} // [!code ++]
			break; // [!code ++]
		case AM_FlagCell.Mode.flagClear: // [!code ++]
			if (this.cell.isClearArea) // [!code ++]
			{ // [!code ++]
				passArea.Add(param, 34f, 0f); // [!code ++]
			} // [!code ++]
			break; // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (detail == null) // [!code ++]
	{ // [!code ++]
		return; // [!code ++]
	} // [!code ++]
	if (highlightArea && detail.area != null) // [!code ++]
	{ // [!code ++]
		passArea.Add(param, (int)detail.area.GetTile(index) - ((!subtleHighlightArea) ? 1 : 0), 0f); // [!code ++]
	} // [!code ++]
	if (detail.footmark != null && sourceFloor.id != 0) // [!code ++]
	{ // [!code ++]
		param.tile = detail.footmark.tile; // [!code ++]
		param.mat = matFloor; // [!code ++]
		param.matColor = 104025f; // [!code ++]
		renderFootmark.Draw(param); // [!code ++]
	} // [!code ++]
	goto IL_7b1b; // [!code ++]
	IL_169b:
	if (this.cell.isSlopeEdge)
	{
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L2627-L2633)
```cs:line-numbers=2627
	{
		snowed = false;
	}
	num5 = 0; // [!code --]
	num3 = 0; // [!code ++]
	if (sourceBlock.id != 0)
	{
		this.tileType = sourceBlock.tileType;
```

[`public virtual void DrawTile()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/BaseTileMap.cs#L2747-L2757)
```cs:line-numbers=2747
		}
		if (!_lowblock && (double)roomHeight > 1.2 && this.tileType.RepeatBlock)
		{
			num5 = 1; // [!code --]
			num3 = 1; // [!code ++]
		}
		else if (lowBlock)
		{
			num5 = 2; // [!code --]
			num3 = 2; // [!code ++]
		}
		param.mat = matBlock;
		param.dir = this.cell.blockDir;
```

## Card

[`public virtual bool flipX`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Card.cs#L2132-L2137)
```cs:line-numbers=2132

	public virtual CardRow sourceRenderCard => sourceCard;

	public virtual RenderRow TileRow => sourceCard; // [!code ++]
 // [!code ++]
	public TileType TileType => sourceCard.tileType;

	public string Name => GetName(NameStyle.Full);
```

[`public void SetPlaceState(PlaceState newState, bool byPlayer = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Card.cs#L3785-L3791)
```cs:line-numbers=3785
	{
		this.placeState = newState;
	}
	if (trait is TraitFakeBlock) // [!code --]
	if (trait is TraitFakeTile) // [!code ++]
	{
		_CreateRenderer();
	}
```

[`public void RefreshColor()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Card.cs#L6039-L6049)
```cs:line-numbers=6039
	{
		if (isDyed)
		{
			_colorInt = BaseTileMap.GetColorInt(ref DyeMat.matColor, sourceRenderCard.colorMod); // [!code --]
			_colorInt = BaseTileMap.GetColorInt(ref DyeMat.matColor, TileRow.colorMod); // [!code ++]
		}
		else if (isElemental)
		{
			_colorInt = BaseTileMap.GetColorInt(ref EClass.setting.elements[Chara.MainElement.source.alias].colorSprite, sourceRenderCard.colorMod); // [!code --]
			_colorInt = BaseTileMap.GetColorInt(ref EClass.setting.elements[Chara.MainElement.source.alias].colorSprite, TileRow.colorMod); // [!code ++]
		}
		else
		{
```

[`public void RefreshColor()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Card.cs#L6052-L6077)
```cs:line-numbers=6052
		}
		else if (isDyed)
		{
			if (sourceRenderCard.useAltColor) // [!code --]
			if (TileRow.useAltColor) // [!code ++]
			{
				_colorInt = BaseTileMap.GetColorInt(ref DyeMat.altColor, sourceRenderCard.colorMod); // [!code --]
				_colorInt = BaseTileMap.GetColorInt(ref DyeMat.altColor, TileRow.colorMod); // [!code ++]
			}
			else
			{
				_colorInt = BaseTileMap.GetColorInt(ref DyeMat.matColor, sourceRenderCard.colorMod); // [!code --]
				_colorInt = BaseTileMap.GetColorInt(ref DyeMat.matColor, TileRow.colorMod); // [!code ++]
			}
		}
		else if (sourceRenderCard.useRandomColor)
		{
			_colorInt = BaseTileMap.GetColorInt(ref GetRandomColor(), sourceRenderCard.colorMod); // [!code --]
			_colorInt = BaseTileMap.GetColorInt(ref GetRandomColor(), TileRow.colorMod); // [!code ++]
		}
		else if (sourceRenderCard.useAltColor)
		{
			_colorInt = BaseTileMap.GetColorInt(ref material.altColor, sourceRenderCard.colorMod); // [!code --]
			_colorInt = BaseTileMap.GetColorInt(ref material.altColor, TileRow.colorMod); // [!code ++]
		}
		else
		{
			_colorInt = BaseTileMap.GetColorInt(ref material.matColor, sourceRenderCard.colorMod); // [!code --]
			_colorInt = BaseTileMap.GetColorInt(ref material.matColor, TileRow.colorMod); // [!code ++]
		}
	}

```

[`public ref Color GetRandomColor()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Card.cs#L6104-L6109)
```cs:line-numbers=6104

	public virtual Sprite GetSprite(int dir = 0)
	{
		if (trait is TraitFakeTile) // [!code ++]
		{ // [!code ++]
			if (trait is TraitFakeBlock) // [!code ++]
			{ // [!code ++]
				return EClass.sources.blocks.map[refVal].GetSprite(dir, trait.IdSkin, (IsInstalled && pos != null && pos.IsValid && pos.cell.IsSnowTile) ? true : false); // [!code ++]
			} // [!code ++]
			return EClass.sources.objs.map[refVal].GetSprite(dir, trait.IdSkin, (IsInstalled && pos != null && pos.IsValid && pos.cell.IsSnowTile) ? true : false); // [!code ++]
		} // [!code ++]
		if (trait is TraitAbility)
		{
			return (trait as TraitAbility).CreateAct()?.GetSprite() ?? EClass.core.refs.icons.defaultAbility;
```

[`public virtual void Rotate(bool reverse = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Card.cs#L6261-L6266)
```cs:line-numbers=6261
	{
		num = 2;
	}
	if (trait is TraitFakeObj) // [!code ++]
	{ // [!code ++]
		num = (trait as TraitFakeObj).GetMaxDir(); // [!code ++]
	} // [!code ++]
	if (reverse)
	{
		dir--;
```

## CardRenderer

[`public Vector3 PositionCenter()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/CardRenderer.cs#L38-L50)
```cs:line-numbers=38
public virtual void SetOwner(Card c)
{
	owner = c;
	if (owner.trait is TraitFakeBlock) // [!code --]
	if (data == null) // [!code ++]
	{
		data = EClass.sources.blocks.map[owner.refVal].renderData; // [!code --]
	} // [!code --]
	else if (data == null) // [!code --]
	{ // [!code --]
		data = owner.sourceCard.renderData; // [!code --]
		data = owner.trait.GetRenderData() ?? owner.sourceCard.renderData; // [!code ++]
	}
	isChara = c.isChara;
	usePass = data.pass != null;
```

[`public override void Draw(RenderParam p, ref Vector3 v, bool drawShadow)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/CardRenderer.cs#L172-L177)
```cs:line-numbers=172
	{
		anime.Update();
	}
	if (owner.trait is TraitFakeObj) // [!code ++]
	{ // [!code ++]
		TraitFakeObj traitFakeObj = owner.trait as TraitFakeObj; // [!code ++]
		if (traitFakeObj.growth != null) // [!code ++]
		{ // [!code ++]
			traitFakeObj.growth?.OnRenderTileMap(p, owner.IsInstalled && owner.altitude == 0 && owner.pos.FirstThing == owner); // [!code ++]
			return; // [!code ++]
		} // [!code ++]
	} // [!code ++]
	if (!isChara && !owner.IsInstalled && owner.category.tileDummy != 0 && !owner.isRoofItem && owner.ExistsOnMap && owner.trait.UseDummyTile)
	{
		SubPassData.Current = SubPassData.Default;
```

## Chara

[`public void Cure(CureType type, int p = 100, BlessedState state = BlessedState.N`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Chara.cs#L9548-L9559)
```cs:line-numbers=9548
		}
		CureCondition<ConWait>();
		CureCondition<ConDisease>((EClass.rnd(20) + 10) * p / 100);
		bool flag3 = HasCondition<ConAnorexia>(); // [!code --]
		base.c_vomit -= (flag3 ? 3 : 2) * p / 100; // [!code --]
		bool flag2 = HasCondition<ConAnorexia>(); // [!code ++]
		base.c_vomit -= (flag2 ? 3 : 2) * p / 100; // [!code ++]
		if (base.c_vomit < 0)
		{
			base.c_vomit = 0;
			if (flag3) // [!code --]
			if (flag2) // [!code ++]
			{
				RemoveCondition<ConAnorexia>();
			}
```

[`public void Cure(CureType type, int p = 100, BlessedState state = BlessedState.N`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Chara.cs#L9564-L9576)
```cs:line-numbers=9564
	case CureType.Death:
	case CureType.Jure:
	case CureType.Boss:
	case CureType.Unicorn: // [!code ++]
	{
		bool flag2 = type == CureType.Death; // [!code --]
		CureTempElements(p * 100, body: true, mind: true);
		for (int num = conditions.Count - 1; num >= 0; num--)
		{
			Condition condition = conditions[num];
			if (condition is ConAnorexia && !flag2) // [!code --]
			if (condition is ConAnorexia && type != CureType.Death && type != CureType.Unicorn && type != CureType.Jure) // [!code ++]
			{
				continue;
			}
```

[`public void Cure(CureType type, int p = 100, BlessedState state = BlessedState.N`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Chara.cs#L9582-L9613)
```cs:line-numbers=9582
				condition.Kill();
				continue;
			case ConditionType.Stance:
				if (flag2) // [!code --]
				if (type == CureType.Death) // [!code ++]
				{
					condition.Kill();
					continue;
				}
				break;
			}
			if (flag2 && condition.isPerfume) // [!code --]
			if (type == CureType.Death && condition.isPerfume) // [!code ++]
			{
				condition.Kill();
			}
		}
		CureCondition<ConWait>();
		CureCondition<ConSleep>();
		if (flag2 || type == CureType.Boss) // [!code --]
		switch (type) // [!code ++]
		{
		case CureType.Death: // [!code ++]
		case CureType.Boss: // [!code ++]
		case CureType.Unicorn: // [!code ++]
			SAN.Mod(-20);
			RemoveCondition<ConBrightnessOfLife>();
		} // [!code --]
		if (type == CureType.Jure) // [!code --]
		{ // [!code --]
			break; // [!code ++]
		case CureType.Jure: // [!code ++]
			SAN.Mod(-999);
			if (HasElement(1206))
			{
				SetFeat(1206, 0, msg: true);
			}
			break; // [!code ++]
		case CureType.CureBody: // [!code ++]
		case CureType.CureMind: // [!code ++]
		case CureType.Prayer: // [!code ++]
			break; // [!code ++]
		}
		break;
	}
```

[`public bool MutateRandom(int vec = 0, int tries = 100, bool ether = false, Bless`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Chara.cs#L9990-L9996)
```cs:line-numbers=9990
		SourceElement.Row row = ie.RandomItem();
		if (i == 0 && vec < 0 && ether && base.c_corruptionHistory != null && base.c_corruptionHistory.Count > 0)
		{
			row = EClass.sources.elements.map[base.c_corruptionHistory.LastItem()]; // [!code --]
			if (EClass.sources.elements.map.ContainsKey(base.c_corruptionHistory.LastItem())) // [!code ++]
			{ // [!code ++]
				row = EClass.sources.elements.map[base.c_corruptionHistory.LastItem()]; // [!code ++]
			} // [!code ++]
			base.c_corruptionHistory.RemoveAt(base.c_corruptionHistory.Count - 1);
			if (base.c_corruptionHistory.Count == 0)
			{
```

## CureType

[`public enum CureType`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/CureType.cs#L8-L12)
```cs:line-numbers=8
	CureMind,
	Jure,
	Prayer,
	Boss // [!code --]
	Boss, // [!code ++]
	Unicorn // [!code ++]
}
```

## Game

[`using System;`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Game.cs#L1-L5)
```cs:line-numbers=1
using System;
using System.Collections.Generic;
using System.Linq; // [!code ++]
using System.Runtime.Serialization;
using Newtonsoft.Json;
using UnityEngine;
```

[`public void OnLoad()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Game.cs#L658-L663)
```cs:line-numbers=658
			global2.phase = 0;
		}
	}
	foreach (KeyValuePair<int, Spatial> item7 in EClass.game.spatials.map.ToList()) // [!code ++]
	{ // [!code ++]
		if (item7.Value == null) // [!code ++]
		{ // [!code ++]
			EClass.game.spatials.map.Remove(item7.Key); // [!code ++]
		} // [!code ++]
	} // [!code ++]
	void TryAddQuest(string idQuest, string idReqQuest)
	{
		if (quests.completedIDs.Contains(idReqQuest) && !quests.completedIDs.Contains(idQuest) && quests.GetGlobal(idQuest) == null && quests.Get(idQuest) == null)
```

## GrowSystem

[`public virtual int GetShadow(int index)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/GrowSystem.cs#L190-L196)
```cs:line-numbers=190
		return -1;
	}

	public virtual void OnRenderTileMap(RenderParam p) // [!code --]
	public virtual void OnRenderTileMap(RenderParam p, bool drawShadow = true) // [!code ++]
	{
		int num = cell.objVal / 30;
		currentStage = stages[num];
```

[`public virtual void OnRenderTileMap(RenderParam p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/GrowSystem.cs#L228-L234)
```cs:line-numbers=228
	}
	p.y = y;
	p.z = z;
	if (num >= ShadowStage) // [!code --]
	if (cell.obj == 118 && Core.fixedFrame % 10f == 0f && IsMature) // [!code ++]
	{ // [!code ++]
		EClass.scene.psFey.transform.position = new Vector3(p.x, p.y, p.z - 2f); // [!code ++]
		EClass.scene.psFey.Emit(1); // [!code ++]
	} // [!code ++]
	if (drawShadow && num >= ShadowStage) // [!code ++]
	{
		int shadow = GetShadow(num);
		if (shadow == -1)
```

## RankedZoneManager

[`public List<RankedZone> GetList()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/RankedZoneManager.cs#L49-L55)
```cs:line-numbers=49
	List<RankedZone> list = new List<RankedZone>();
	foreach (Spatial z in EClass.game.spatials.map.Values)
	{
		if ((z.source.value <= 0 || z.lv != 0) && !z.IsPlayerFaction) // [!code --]
		if ((z == null || z.source.value <= 0 || z.lv != 0) && !z.IsPlayerFaction) // [!code ++]
		{
			continue;
		}
```

## RecipeCard

[`public Card CreateMold()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/RecipeCard.cs#L147-L152)
```cs:line-numbers=147
		_mold.dir = _dir;
		_mold.altitude = ActionMode.Build.altitude;
		_mold.idSkin = idSkin;
		_mold._CreateRenderer(); // [!code ++]
		return _mold;
	}

```

## SerializedCards

[`public void Restore(Map map, Map orgMap, bool addToZone, PartialMap partial = nu`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/SerializedCards.cs#L873-L879)
```cs:line-numbers=873
				card2.Chara.ScaleByPrincipal();
			}
		}
		if (card2.trait is TraitFakeBlock) // [!code --]
		if (card2.trait is TraitFakeTile) // [!code ++]
		{
			card2._CreateRenderer();
		}
```

## TaskHarvest

[`public string GetIdDismantled()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TaskHarvest.cs#L529-L535)
```cs:line-numbers=529

	public bool ShouldGenerateDismantled(string dest)
	{
		if (target.trait is TraitFakeBlock) // [!code --]
		if (target.trait is TraitFakeTile) // [!code ++]
		{
			return false;
		}
```

## Thing

[`public override SourcePref Pref`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Thing.cs#L50-L84)
```cs:line-numbers=50
	{
		get
		{
			if (trait is TraitFakeBlock) // [!code --]
			SourcePref pref = trait.GetPref(); // [!code ++]
			if (pref == null) // [!code ++]
			{
				TileType tileType = EClass.sources.blocks.map[base.refVal].tileType; // [!code --]
				if (tileType is TileTypePillar) // [!code --]
				if (source.origin == null || source.pref.UsePref) // [!code ++]
				{
					return EClass.core.refs.prefs.blockPillar; // [!code --]
					return source.pref; // [!code ++]
				}
				if (tileType is TileTypeFence) // [!code --]
				{ // [!code --]
					return EClass.core.refs.prefs.blockFence; // [!code --]
				} // [!code --]
				if (tileType is TileTypeStairs) // [!code --]
				{ // [!code --]
					return EClass.core.refs.prefs.blockStairs; // [!code --]
				} // [!code --]
				if (tileType is TileTypeWall) // [!code --]
				{ // [!code --]
					return EClass.core.refs.prefs.blockWall; // [!code --]
				} // [!code --]
				if (tileType is TileTypeSlope) // [!code --]
				{ // [!code --]
					return EClass.core.refs.prefs.blockStairs; // [!code --]
				} // [!code --]
			} // [!code --]
			if (source.origin == null || source.pref.UsePref) // [!code --]
			{ // [!code --]
				return source.pref; // [!code --]
				pref = source.origin.pref; // [!code ++]
			}
			return source.origin.pref; // [!code --]
			return pref; // [!code ++]
		}
	}

```

[`public override int SelfWeight`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Thing.cs#L98-L104)
```cs:line-numbers=98
		}
	}

	public override int[] Tiles => sourceCard._tiles; // [!code --]
	public override int[] Tiles => TileRow._tiles; // [!code ++]
 // [!code ++]
	public override RenderRow TileRow // [!code ++]
	{ // [!code ++]
		get // [!code ++]
		{ // [!code ++]
			if (trait is TraitFakeTile) // [!code ++]
			{ // [!code ++]
				if (trait is TraitFakeBlock) // [!code ++]
				{ // [!code ++]
					return EClass.sources.blocks.map[base.refVal]; // [!code ++]
				} // [!code ++]
				return EClass.sources.objs.map[base.refVal]; // [!code ++]
			} // [!code ++]
			return base.TileRow; // [!code ++]
		} // [!code ++]
	} // [!code ++]

	public bool CanSearchContents
	{
```

[`public override void SetRenderParam(RenderParam p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Thing.cs#L1515-L1522)
```cs:line-numbers=1515
		break;
	case Trait.TileMode.FakeBlock:
	{
		p.color += 1572864f; // [!code --]
		SourceBlock.Row row = EClass.sources.blocks.map[base.refVal]; // [!code --]
		SourceBlock.Row row2 = EClass.sources.blocks.map[base.refVal]; // [!code ++]
		p.tile = row2._tiles[base.dir % row2._tiles.Length]; // [!code ++]
		if (row2.tileType.IsFullBlock) // [!code ++]
		{ // [!code ++]
			p.color += 1572864f; // [!code ++]
		} // [!code ++]
		break; // [!code ++]
	} // [!code ++]
	case Trait.TileMode.FakeObj: // [!code ++]
	{ // [!code ++]
		SourceObj.Row row = EClass.sources.objs.map[base.refVal]; // [!code ++]
		p.tile = row._tiles[base.dir % row._tiles.Length];
		break;
	}
```

## Trait

[`public enum TileMode`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Trait.cs#L12-L18)
```cs:line-numbers=12
		Illumination,
		DefaultNoAnime,
		SignalAnime,
		FakeBlock // [!code --]
		FakeBlock, // [!code ++]
		FakeObj // [!code ++]
	}

	public enum CopyShopType
```

[`public int GetParamInt(int i, int def)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/Trait.cs#L581-L586)
```cs:line-numbers=581
		return def;
	}

	public virtual SourcePref GetPref() // [!code ++]
	{ // [!code ++]
		return null; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public virtual RenderData GetRenderData() // [!code ++]
	{ // [!code ++]
		return null; // [!code ++]
	} // [!code ++]
 // [!code ++]
	public virtual bool Contains(RecipeSource r)
	{
		return r.idFactory == ((owner.sourceCard.origin != null) ? owner.sourceCard.origin.id : owner.id);
```

## TraitFakeBlock

[`using System.Collections.Generic;`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitFakeBlock.cs#L1-L41)
```cs:line-numbers=1
using System.Collections.Generic; // [!code --]
 // [!code --]
public class TraitFakeBlock : Trait // [!code --]
public class TraitFakeBlock : TraitFakeTile // [!code ++]
{
	public override TileMode tileMode => TileMode.FakeBlock; // [!code --]
 // [!code --]
	public override void OnCreate(int lv) // [!code --]
	{ // [!code --]
		if (owner.refVal == 0) // [!code --]
		{ // [!code --]
			owner.refVal = 1; // [!code --]
		} // [!code --]
	} // [!code --]
 // [!code --]
	public override void OnCrafted(Recipe recipe, List<Thing> ings) // [!code --]
	{ // [!code --]
		if (ings == null || ings.Count == 0) // [!code --]
		{ // [!code --]
			owner.refVal = 1; // [!code --]
			return; // [!code --]
		} // [!code --]
		TraitBlock traitBlock = ings[0].trait as TraitBlock; // [!code --]
		owner.refVal = traitBlock.source.id; // [!code --]
	} // [!code --]
 // [!code --]
	public override void TrySetHeldAct(ActPlan p) // [!code --]
	{ // [!code --]
		if (p.pos.cell._block != 0 && !p.pos.sourceBlock.ContainsTag("noFake")) // [!code --]
		{ // [!code --]
			p.TrySetAct("actCopyBlock", delegate // [!code --]
			{ // [!code --]
				owner.Dye(p.pos.matBlock); // [!code --]
				owner.refVal = p.pos.sourceBlock.id; // [!code --]
				SE.Play("offering"); // [!code --]
				owner._CreateRenderer(); // [!code --]
				HotItemHeld.recipe = GetRecipe(); // [!code --]
				return false; // [!code --]
			}); // [!code --]
		} // [!code --]
	} // [!code --]
}
```

## +TraitFakeObj

::: details File Created
```cs
public class TraitFakeObj : TraitFakeTile
{
	public Cell cell = new Cell();

	public GrowSystem growth
	{
		get
		{
			if (!obj.HasGrowth)
			{
				return null;
			}
			GrowSystem.cell = cell;
			cell.objVal = (byte)(owner.dir % obj.growth.StageLength * 30);
			cell.objDir = owner.dir;
			cell.obj = (byte)owner.refVal;
			return obj.growth;
		}
	}

	public SourceObj.Row obj => EClass.sources.objs.map[owner.refVal];

	public override TileMode tileMode => TileMode.FakeObj;

	public override RenderData GetRenderData()
	{
		return obj.renderData;
	}

	public override SourcePref GetPref()
	{
		return obj.pref;
	}

	public int GetMaxDir()
	{
		if (growth != null && !(growth is GrowSystemTreeCoralwood))
		{
			return growth.StageLength;
		}
		return obj._tiles.Length;
	}
}
```

:::
## +TraitFakeTile

::: details File Created
```cs
using System.Collections.Generic;

public class TraitFakeTile : Trait
{
	public override TileMode tileMode => TileMode.FakeBlock;

	public override RenderData GetRenderData()
	{
		return EClass.sources.blocks.map[owner.refVal].renderData;
	}

	public override SourcePref GetPref()
	{
		TileType tileType = EClass.sources.blocks.map[owner.refVal].tileType;
		if (!(tileType is TileTypePillar))
		{
			if (!(tileType is TileTypeFence))
			{
				if (!(tileType is TileTypeStairs))
				{
					if (!(tileType is TileTypeWall))
					{
						if (tileType is TileTypeSlope)
						{
							return EClass.core.refs.prefs.blockStairs;
						}
						return null;
					}
					return EClass.core.refs.prefs.blockWall;
				}
				return EClass.core.refs.prefs.blockStairs;
			}
			return EClass.core.refs.prefs.blockFence;
		}
		return EClass.core.refs.prefs.blockPillar;
	}

	public override void OnCrafted(Recipe recipe, List<Thing> ings)
	{
		owner.refVal = 0;
		if (this is TraitFakeBlock && ings != null && ings.Count > 0)
		{
			TraitBlock traitBlock = ings[0].trait as TraitBlock;
			owner.refVal = traitBlock.source.id;
		}
	}

	public override void TrySetHeldAct(ActPlan p)
	{
		if (this is TraitFakeBlock)
		{
			if (p.pos.cell._block == 0)
			{
				return;
			}
		}
		else if (p.pos.cell.obj == 0)
		{
			return;
		}
		TileRow source = ((this is TraitFakeBlock) ? ((TileRow)p.pos.sourceBlock) : ((TileRow)p.pos.sourceObj));
		SourceMaterial.Row mat = ((this is TraitFakeBlock) ? p.pos.matBlock : p.pos.cell.matObj);
		if (!source.ContainsTag("noFake"))
		{
			p.TrySetAct("actCopyBlock", delegate
			{
				owner.Dye(mat);
				owner.refVal = source.id;
				SE.Play("offering");
				owner._CreateRenderer();
				HotItemHeld.recipe = GetRecipe();
				LayerInventory.SetDirty(owner.Thing);
				return false;
			});
		}
	}
}
```

:::
## TraitHouseBoard

[`public void ApplyData()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitHouseBoard.cs#L104-L110)
```cs:line-numbers=104

	public override void TrySetAct(ActPlan p)
	{
		if (!EClass.debug.enable && !EClass._zone.IsPCFaction) // [!code --]
		if (!EClass.debug.enable && !EClass._zone.IsPCFactionOrTent) // [!code ++]
		{
			return;
		}
```

## TraitRoomPlate

[`public AreaData areaData`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitRoomPlate.cs#L24-L30)
```cs:line-numbers=24

	public override void TrySetAct(ActPlan p)
	{
		if ((!EClass.debug.enable && !EClass._zone.IsPCFaction) || !owner.IsInstalled || owner.pos.cell.room == null) // [!code --]
		if ((!EClass.debug.enable && !EClass._zone.IsPCFactionOrTent) || !owner.IsInstalled || owner.pos.cell.room == null) // [!code ++]
		{
			return;
		}
```

## +TraitSyringe

::: details File Created
```cs
public class TraitSyringe : Trait
{
	public override bool CanChangeHeight => false;

	public void EffectInject(Chara cc, Chara tc)
	{
		cc.PlaySound("syringe");
		cc.Say("syringe", cc, tc, owner.NameOne);
		tc.PlayEffect("blood").SetParticleColor(EClass.Colors.matColors[tc.material.alias].main).Emit(20);
		tc.AddBlood(2 + EClass.rnd(2));
	}
}
```

:::
## TraitSyringeBlood

[`public class TraitSyringeBlood : TraitTicketChampagne.TraitSyringe`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitSyringeBlood.cs#L1-L4)
```cs:line-numbers=1
public class TraitSyringeBlood : TraitTicketChampagne.TraitSyringe // [!code --]
public class TraitSyringeBlood : TraitSyringe // [!code ++]
{
	public override void TrySetHeldAct(ActPlan p)
	{
```

[`public override void TrySetHeldAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitSyringeBlood.cs#L6-L18)
```cs:line-numbers=6
	{
		p.TrySetAct("actInject".lang("", c.Name), delegate
		{
			EClass.pc.PlaySound("syringe"); // [!code --]
			EClass.pc.Say("syringe", EClass.pc, c, owner.NameOne); // [!code --]
			c.PlayEffect("blood").SetParticleColor(EClass.Colors.matColors[c.material.alias].main).Emit(20); // [!code --]
			c.AddBlood(2 + EClass.rnd(2)); // [!code --]
			EffectInject(EClass.pc, c); // [!code ++]
			EClass.pc.PickOrDrop(EClass.pc.pos, CraftUtil.MakeBloodSample(EClass.pc, c));
			owner.ModNum(-1);
			return false; // [!code --]
			return true; // [!code ++]
		}, c);
	});
}
```

## TraitSyringeGene

[`public class TraitSyringeGene : TraitTicketChampagne.TraitSyringe`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitSyringeGene.cs#L1-L4)
```cs:line-numbers=1
public class TraitSyringeGene : TraitTicketChampagne.TraitSyringe // [!code --]
public class TraitSyringeGene : TraitSyringe // [!code ++]
{
	public override void TrySetHeldAct(ActPlan p)
	{
```

[`public override void TrySetHeldAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitSyringeGene.cs#L6-L15)
```cs:line-numbers=6
	{
		p.TrySetAct("actInject".lang("", c.Name), delegate
		{
			EClass.pc.PlaySound("syringe"); // [!code --]
			EClass.pc.Say("syringe", EClass.pc, c, owner.NameOne); // [!code --]
			c.PlayEffect("blood").SetParticleColor(EClass.Colors.matColors[c.material.alias].main).Emit(20); // [!code --]
			c.AddBlood(2 + EClass.rnd(2)); // [!code --]
			EffectInject(EClass.pc, c); // [!code ++]
			c.AddCondition<ConHallucination>(50);
			TraitGeneMachine traitGeneMachine = c.pos.FindThing<TraitGeneMachine>();
			if (traitGeneMachine != null && traitGeneMachine.GetTarget() == c)
```

[`public override void TrySetHeldAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitSyringeGene.cs#L29-L35)
```cs:line-numbers=29
				c.ModCorruption(-50);
			}
			owner.ModNum(-1);
			return false; // [!code --]
			return true; // [!code ++]
		}, c);
	});
}
```

## TraitSyringeHeaven

[`public class TraitSyringeHeaven : TraitTicketChampagne.TraitSyringe`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitSyringeHeaven.cs#L1-L4)
```cs:line-numbers=1
public class TraitSyringeHeaven : TraitTicketChampagne.TraitSyringe // [!code --]
public class TraitSyringeHeaven : TraitSyringe // [!code ++]
{
	public override void TrySetHeldAct(ActPlan p)
	{
```

[`public override void TrySetHeldAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitSyringeHeaven.cs#L6-L15)
```cs:line-numbers=6
	{
		p.TrySetAct("actInject".lang("", c.Name), delegate
		{
			EClass.pc.PlaySound("syringe"); // [!code --]
			EClass.pc.Say("syringe", EClass.pc, c, owner.NameOne); // [!code --]
			c.PlayEffect("blood").SetParticleColor(EClass.Colors.matColors[c.material.alias].main).Emit(20); // [!code --]
			c.AddBlood(2 + EClass.rnd(2)); // [!code --]
			EffectInject(EClass.pc, c); // [!code ++]
			c.AddCondition<ConHallucination>(50);
			if ((c.trait is TraitLittleOne) & !c.HasCondition<ConDeathSentense>())
			{
```

[`public override void TrySetHeldAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitSyringeHeaven.cs#L17-L23)
```cs:line-numbers=17
				c.AddCondition<ConDeathSentense>(100, force: true);
			}
			owner.ModNum(-1);
			return false; // [!code --]
			return true; // [!code ++]
		}, c);
	});
}
```

## +TraitSyringeUnicorn

::: details File Created
```cs
public class TraitSyringeUnicorn : TraitSyringe
{
	public override void TrySetHeldAct(ActPlan p)
	{
		p.pos.Charas.ForEach(delegate(Chara c)
		{
			p.TrySetAct("actInject".lang("", c.Name), delegate
			{
				EffectInject(EClass.pc, c);
				c.PlayEffect("heal");
				c.PlaySound("heal_tick");
				c.CureHost(CureType.Unicorn, 100, owner.blessedState);
				owner.ModNum(-1);
				return true;
			}, c);
		});
	}
}
```

:::
## TraitTicketChampagne

[`public class TraitTicketChampagne : TraitTicketMassage`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/346683e433cd04edc6e2f112919e2ee88c9e9297/Elin/TraitTicketChampagne.cs#L1-L7)
```cs:line-numbers=1
public class TraitTicketChampagne : TraitTicketMassage
{
	public class TraitSyringe : Trait // [!code --]
	{ // [!code --]
		public override bool CanChangeHeight => false; // [!code --]
	} // [!code --]
}
```

---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 2 files modified. 1 new file created.
version: +EA 23.268 Nightly - Plugin.UI
changes: BookList/+BottleMessageList/UIBook
---

# +EA 23.268 Nightly - Plugin.UI

February 9, 2026

2 files modified. 1 new file created.

## Important Changes

**None.**
## BookList

[`public class BookList`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/45d3a79402118938b2b4c8a685160ab4afb5615a/Elin/Plugins.UI/BookList.cs#L6-L17)
```cs:line-numbers=6
{
	public class Item
	{
		public string[] lines; // [!code ++]
 // [!code ++]
		public string title;

		public string author;

		public string id;

		public string cat; // [!code ++]
 // [!code ++]
		public int chance = 100;

		public int skin;
```

[`public class Item`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/45d3a79402118938b2b4c8a685160ab4afb5615a/Elin/Plugins.UI/BookList.cs#L21-L29)
```cs:line-numbers=21

	public static void Init()
	{
		dict = new Dictionary<string, Dictionary<string, Item>>(); // [!code --]
		AddDir("Book", CorePath.CorePackage.Book); // [!code --]
		AddDir("Scroll", CorePath.CorePackage.Scroll); // [!code --]
		if (dict == null) // [!code ++]
		{ // [!code ++]
			dict = new Dictionary<string, Dictionary<string, Item>>(); // [!code ++]
			AddDir("Book", CorePath.CorePackage.Book); // [!code ++]
			AddDir("Scroll", CorePath.CorePackage.Scroll); // [!code ++]
		} // [!code ++]
		static void AddDir(string id, string path)
		{
			DirectoryInfo directoryInfo = new DirectoryInfo(path);
```

[`static void AddDir(string id, string path)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/45d3a79402118938b2b4c8a685160ab4afb5615a/Elin/Plugins.UI/BookList.cs#L38-L43)
```cs:line-numbers=38
				string[] array = streamReader.ReadLine().Split(',');
				Item item = new Item
				{
					cat = id, // [!code ++]
					title = array[0],
					author = ((array.Length >= 2 && !array[1].IsEmpty()) ? "nameAuthor".lang(array[1]) : "unknownAuthor".lang()),
					chance = ((array.Length >= 3) ? array[2].ToInt() : 100),
```

[`static void AddDir(string id, string path)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/45d3a79402118938b2b4c8a685160ab4afb5615a/Elin/Plugins.UI/BookList.cs#L53-L64)
```cs:line-numbers=53

	public static Item GetRandomItem(string idCat = "Book")
	{
		return dict[idCat].Where((KeyValuePair<string, Item> p) => p.Value.chance != 0).ToList().RandomItem() // [!code --]
		Init(); // [!code ++]
		return dict[idCat].Where((KeyValuePair<string, Item> p) => p.Value.chance != 0).ToList().RandomItemWeighted((KeyValuePair<string, Item> p) => p.Value.chance) // [!code ++]
			.Value;
	}

	public static Item GetItem(string id, string idCat = "Book")
	{
		Init(); // [!code ++]
		return dict[idCat].TryGetValue(id) ?? dict["Book"]["_default"];
	}
}
```

## +BottleMessageList

::: details File Created
```cs
using System.Collections.Generic;
using System.Linq;

public class BottleMessageList
{
	public static List<BookList.Item> list;

	public static void Init()
	{
		if (list == null)
		{
			list = new List<BookList.Item>();
			string[] dialog = Lang.GetDialog("rumor", "bottle");
			int num = 0;
			string[] array = dialog;
			for (int i = 0; i < array.Length; i++)
			{
				string[] array2 = array[i].Split('|');
				list.Add(new BookList.Item
				{
					id = (num.ToString() ?? ""),
					author = array2[0],
					title = array2[1],
					lines = new string[4]
					{
						"",
						"",
						"{center}",
						array2[2]
					}
				});
				num++;
			}
		}
	}

	public static BookList.Item GetRandomItem()
	{
		Init();
		return list.RandomItemWeighted((BookList.Item p) => p.chance);
	}

	public static BookList.Item GetItem(string id)
	{
		Init();
		return list.First((BookList.Item p) => p.id == id) ?? list[0];
	}
}
```

:::
## UIBook

[`public void Show()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/45d3a79402118938b2b4c8a685160ab4afb5615a/Elin/Plugins.UI/UIBook.cs#L493-L499)
```cs:line-numbers=493
public void BuildPages()
{
	pages.Clear();
	string[] array = IO.LoadTextArray(CorePath.CorePackage.Help + idFile); // [!code --]
	string[] array = bookItem?.lines ?? IO.LoadTextArray(CorePath.CorePackage.Help + idFile); // [!code ++]
	if (idFile == "version" && Lang.langCode == "CN")
	{
		array = IO.LoadTextArray(CorePath.CorePackage.TextEN + idFile);
```

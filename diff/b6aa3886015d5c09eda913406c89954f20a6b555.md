---
exclude: true
aside: false
pageClass: diff-single-page
footer: false
editLink: false
lastUpdated: false
description: 18 files modified. 1 new file created.
version: EA 23.262 Nightly Patch 1
changes: ACT/ActEffect/ActMelee/ActPlan/ActThrow/AttackProcess/AttackSource/Chara/ConDeathSentense/ConditionType/ContentGallery/CoreRef/DramaOutcome/+GalleryFlattenAndRename/HotItemHeld/HotItemNoItem/InvOwner/Trait/WidgetSideScreen
---

# EA 23.262 Nightly Patch 1

January 19, 2026

18 files modified. 1 new file created.

## Important Changes

**None.**
## ACT

[`public virtual bool ShowMouseHint(Card c)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ACT.cs#L202-L208)
```cs:line-numbers=202

	public virtual bool IsValidTC(Card c)
	{
		if (!c.isChara || c.Chara.mimicry != null) // [!code --]
		if (!c.isChara || (c.Chara.mimicry != null && !c.IsPCParty)) // [!code ++]
		{
			return c.trait.CanBeAttacked;
		}
```

[`public bool CanPerform(Chara _cc, Card _tc = null, Point _tp = null)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ACT.cs#L351-L357)
```cs:line-numbers=351
			}
		}
	}
	if (!(this is ActMelee) && tt.Range == TargetRange.Chara && (TC == null || !CC.CanSee(TC) || (TC.Chara?.mimicry != null && CC.IsPC && TC != EClass.pc))) // [!code --]
	if (!(this is ActMelee) && tt.Range == TargetRange.Chara && (TC == null || !CC.CanSee(TC) || (TC.Chara?.mimicry != null && CC.IsPC && !TC.IsPCParty))) // [!code ++]
	{
		return false;
	}
```

## ActEffect

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ActEffect.cs#L735-L741)
```cs:line-numbers=735
				j--;
				continue;
			}
			int num6 = -1; // [!code --]
			long num6 = -1L; // [!code ++]
			n = actRef.n1;
			if (!(n == "shadow"))
			{
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ActEffect.cs#L750-L760)
```cs:line-numbers=750
					{
						num7 = (CC.IsPCFactionOrMinion ? (CC.LV / 2) : (CC.LV / 3 * 2));
					}
					num6 = chara.LV * (100 + power / 10) / 100 + power / 30; // [!code --]
					if (num5 == -1) // [!code ++]
					{ // [!code ++]
						num6 = chara.LV * (100 + power / 10) / 100 + power / 30; // [!code ++]
					} // [!code ++]
					if (num6 < num7)
					{
						num6 = num7;
					}
					if (num6 > 99999999) // [!code ++]
					{ // [!code ++]
						num6 = 99999999L; // [!code ++]
					} // [!code ++]
				}
			}
			else
```

[`void AddCon<T>(int rate, int power) where T : Condition`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ActEffect.cs#L763-L769)
```cs:line-numbers=763
			}
			if (chara.LV < num6)
			{
				chara.SetLv(num6); // [!code --]
				chara.SetLv((int)num6); // [!code ++]
			}
			chara.interest = 0;
			if (chara.HaveFur())
```

## ActMelee

[`void AttackWithFlurry(Card _tc, Point _tp, float mtp, bool subAttack)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ActMelee.cs#L511-L516)
```cs:line-numbers=511
				{
					break;
				}
				if ((bool)LayerDrama.Instance) // [!code ++]
				{ // [!code ++]
					break; // [!code ++]
				} // [!code ++]
				if (m > 0)
				{
					Act.CC.Say(Act.CC.IsHostile() ? "attack_flurry_enemy" : "attack_flurry");
```

## ActPlan

[`public void _Update(PointTarget target)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ActPlan.cs#L528-L534)
```cs:line-numbers=528
				int num = c2.Dist(EClass.pc);
				if (num <= 1 || !EClass.pc.isBlind)
				{
					if (c2.mimicry != null) // [!code --]
					if (c2.mimicry != null && !c2.IsPCParty) // [!code ++]
					{
						if (num <= 1)
						{
```

[`public void _Update(PointTarget target)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ActPlan.cs#L623-L629)
```cs:line-numbers=623
			items.ForeachReverse(delegate(Card _c)
			{
				Chara c = _c.Chara;
				if (c != null && c.mimicry == null) // [!code --]
				if (c != null && (c.mimicry == null || c.IsPCParty)) // [!code ++]
				{
					bool flag3 = EClass.pc.CanSee(c);
					if (flag3)
```

## ActThrow

[`public static EffectIRenderer Throw(Card c, Point p, Card target, Thing t, Throw`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ActThrow.cs#L148-L154)
```cs:line-numbers=148
	{
		Msg.Say("shatter");
	}
	if (Act.TC != null && Act.TC.isChara && Act.TC.Chara.mimicry != null) // [!code --]
	if (Act.TC?.Chara?.mimicry != null) // [!code ++]
	{
		Act.TC.Chara.mimicry.RevealMimicry(c, surprise: false);
	}
```

## AttackProcess

[`public bool Perform(int count, bool hasHit, float dmgMulti = 1f, bool maxRoll =`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/AttackProcess.cs#L622-L628)
```cs:line-numbers=622
		num2 += weapon.Evalue(91, ignoreGlobalElement: true);
		num3 += weapon.Evalue(603, ignoreGlobalElement: true);
	}
	if (CC.HasElement(1426)) // [!code --]
	if (!IsRanged && !isThrow && CC.HasElement(1426)) // [!code ++]
	{
		list.Add(Element.Create(6650, 100));
	}
```

## AttackSource

[`public enum AttackSource`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/AttackSource.cs#L17-L23)
```cs:line-numbers=17
Hang,
Wrath,
ManaBackfire,
DeathSentense, // [!code --]
DeathSentence, // [!code ++]
Euthanasia,
Shockwave,
MagicSword,
```

## Chara

[`public override void Die(Element e = null, Card origin = null, AttackSource atta`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/Chara.cs#L5447-L5453)
```cs:line-numbers=5447
	}
	if (isInActiveZone)
	{
		if (attackSource == AttackSource.DeathSentense || attackSource == AttackSource.Euthanasia) // [!code --]
		if (attackSource == AttackSource.DeathSentence || attackSource == AttackSource.Euthanasia) // [!code ++]
		{
			Msg.Say("goto_heaven", this);
		}
```

[`public void TryPutSharedItems(IEnumerable<Thing> containers, bool msg = true)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/Chara.cs#L7429-L7435)
```cs:line-numbers=7429
	Thing bestRangedWeapon = GetBestRangedWeapon();
	foreach (Thing thing in things)
	{
		if (!thing.IsAmmo) // [!code --]
		if (!thing.IsAmmo && !thing.c_isImportant) // [!code ++]
		{
			if (thing.category.slot != 0 && !thing.isEquipped && !thing.HasTag(CTAG.gift))
			{
```

[`public bool ShouldThrowAway(Thing t, ClearInventoryType type)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/Chara.cs#L8546-L8552)
```cs:line-numbers=8546
			return false;
		}
	}
	if (t.isEquipped || t.rarity >= Rarity.Legendary || !t.trait.CanBeDestroyed) // [!code --]
	if (t.isEquipped || t.rarity >= Rarity.Legendary || !t.trait.CanBeDestroyed || t.c_isImportant) // [!code ++]
	{
		return false;
	}
```

[`public bool TryNeckHunt(Chara TC, int power, bool harvest = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/Chara.cs#L9718-L9724)
```cs:line-numbers=9718
	{
		return false;
	}
	if (TC.hp > (long)TC.MaxHP * (long)(Mathf.Min(5 + (int)Mathf.Sqrt(power), harvest ? 35 : 25) + Evalue(1426) * 5) / 100) // [!code --]
	if (TC.hp > (long)TC.MaxHP * (long)(Mathf.Min(5 + (int)Mathf.Sqrt(power), harvest ? 30 : 20) + Evalue(1426) * 5) / (TC.IsPowerful ? 250 : 100)) // [!code ++]
	{
		return false;
	}
```

## ConDeathSentense

[`public override void Tick()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ConDeathSentense.cs#L22-L32)
```cs:line-numbers=22
		owner.Say("death_sentense", owner);
		if (!euthanasia && owner.IsPowerful)
		{
			owner.DamageHP(owner.MaxHP / (EClass.debug.enable ? 1 : 13) + 1, AttackSource.DeathSentense); // [!code --]
			owner.DamageHP(owner.MaxHP / (EClass.debug.enable ? 1 : 13) + 1, AttackSource.DeathSentence); // [!code ++]
		}
		else
		{
			owner.Die(null, null, euthanasia ? AttackSource.Euthanasia : AttackSource.DeathSentense); // [!code --]
			owner.Die(null, null, euthanasia ? AttackSource.Euthanasia : AttackSource.DeathSentence); // [!code ++]
		}
	}
}
```

## ConditionType

[`public enum ConditionType`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ConditionType.cs#L8-L12)
```cs:line-numbers=8
	Wrath,
	Buff,
	Stance,
	Sentense // [!code --]
	Sentence // [!code ++]
}
```

## ContentGallery

[`public class Page : UIBook.Page`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ContentGallery.cs#L10-L17)
```cs:line-numbers=10
		public class Item
		{
			public int id;
 // [!code --]
			public Sprite sprite; // [!code --]
		}

		public List<string> ids = new List<string>();
```

[`public override void BuildNote(UINote n, string idTopic)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ContentGallery.cs#L21-L34)
```cs:line-numbers=21
		foreach (string id in ids)
		{
			UIItem uIItem = n.AddItem("ItemGallery");
			int num = id.ToInt(); // [!code --]
			Sprite sprite = Resources.Load<Sprite>("Media/Gallery/" + CoreRef.GetArtDir(num) + "/" + EClass.core.refs.dictSketches[num]); // [!code --]
			int idx = id.ToInt(); // [!code ++]
			string path = EClass.core.refs.dictSketches2[idx]; // [!code ++]
			Sprite sprite = sprites.TryGetValue(idx); // [!code ++]
			if (!sprite) // [!code ++]
			{ // [!code ++]
				Texture2D texture2D = IO.LoadPNG(path + "_t"); // [!code ++]
				sprite = Sprite.Create(texture2D, new Rect(0f, 0f, texture2D.width, texture2D.height), new Vector2(0.5f, 0.5f)); // [!code ++]
				sprites[idx] = sprite; // [!code ++]
			} // [!code ++]
			uIItem.image1.sprite = sprite;
			uIItem.text1.text = "#" + id;
			uIItem.button1.SetOnClick(delegate
			{
				SE.Play("click_recipe");
				EClass.ui.AddLayer<LayerImage>().SetImage(sprite); // [!code --]
				Sprite sprite2 = spritesFull.TryGetValue(idx); // [!code ++]
				if (!sprite2) // [!code ++]
				{ // [!code ++]
					Texture2D texture2D2 = IO.LoadPNG(path); // [!code ++]
					sprite2 = Sprite.Create(texture2D2, new Rect(0f, 0f, texture2D2.width, texture2D2.height), new Vector2(0.5f, 0.5f)); // [!code ++]
					spritesFull[idx] = sprite2; // [!code ++]
				} // [!code ++]
				EClass.ui.AddLayer<LayerImage>().SetImage(sprite2); // [!code ++]
			});
		}
	}
```

[`public override void BuildNote(UINote n, string idTopic)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ContentGallery.cs#L38-L43)
```cs:line-numbers=38

	public static bool listMode;

	public static Dictionary<int, Sprite> sprites = new Dictionary<int, Sprite>(); // [!code ++]
 // [!code ++]
	public static Dictionary<int, Sprite> spritesFull = new Dictionary<int, Sprite>(); // [!code ++]
 // [!code ++]
	public Transform transBig;

	public Image imageBig;
```

[`public override void OnSwitchContent(int idTab)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ContentGallery.cs#L61-L67)
```cs:line-numbers=61
	if (EClass.debug.allArt)
	{
		EClass.player.sketches.Clear();
		foreach (int key in EClass.core.refs.dictSketches.Keys) // [!code --]
		foreach (int key in EClass.core.refs.dictSketches2.Keys) // [!code ++]
		{
			EClass.player.sketches.Add(key);
		}
```

[`public void Refresh()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ContentGallery.cs#L96-L102)
```cs:line-numbers=96
		}
		book.currentPage = lastPage;
		book.Show();
		textCollected.SetText("sketch_collected".lang((list.Count * 100 / EClass.core.refs.dictSketches.Count()).ToString() ?? "")); // [!code --]
		textCollected.SetText("sketch_collected".lang((list.Count * 100 / EClass.core.refs.dictSketches2.Count()).ToString() ?? "")); // [!code ++]
	}

	public void OnClickHelp()
```

[`public void ToggleMode()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/ContentGallery.cs#L115-L119)
```cs:line-numbers=115
	private void OnDestroy()
	{
		lastPage = book.currentPage;
		foreach (Sprite item in sprites.Values.Concat(spritesFull.Values)) // [!code ++]
		{ // [!code ++]
			Object.Destroy(item.texture); // [!code ++]
			Object.Destroy(item); // [!code ++]
		} // [!code ++]
		sprites.Clear(); // [!code ++]
		spritesFull.Clear(); // [!code ++]
	}
}
```

## CoreRef

[`public class PrefData`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/CoreRef.cs#L412-L417)
```cs:line-numbers=412

	public UD_Int_String dictSketches;

	public UD_Int_String dictSketches2; // [!code ++]
 // [!code ++]
	public PrefData prefs;

	public float testColor;
```

[`public void RebuildBGMList()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/CoreRef.cs#L472-L489)
```cs:line-numbers=472

	public void RebuildSketchList()
	{
		dictSketches.Clear(); // [!code --]
		for (int i = 0; i < 10; i++) // [!code --]
		{ // [!code --]
			Sprite[] array = Resources.LoadAll<Sprite>("Media/Gallery/" + GetArtDir(i * 100)); // [!code --]
			foreach (Sprite sprite in array) // [!code --]
			{ // [!code --]
				int key = sprite.name.Split('_')[0].ToInt(); // [!code --]
				dictSketches[key] = sprite.name; // [!code --]
				Debug.Log(key + " " + sprite.name); // [!code --]
			} // [!code --]
		} // [!code --]
		Debug.Log("Sketches rebuilt:" + dictSketches.Count()); // [!code --]
		dictSketches2 = GalleryFlattenAndRename.Run(); // [!code ++]
	}

	public static string GetArtDir(int a)
```

## DramaOutcome

[`public bool check_sketch()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/DramaOutcome.cs#L504-L510)
```cs:line-numbers=504
	{
		for (int j = 0; j < 5; j++)
		{
			int item = EMono.core.refs.dictSketches.Keys.RandomItem(); // [!code --]
			int item = EMono.core.refs.dictSketches2.Keys.RandomItem(); // [!code ++]
			if (!EMono.player.sketches.Contains(item))
			{
				EMono.player.sketches.Add(item);
```

[`public void give_sketch_reward()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/DramaOutcome.cs#L566-L572)
```cs:line-numbers=566

	public void give_sketch_special()
	{
		foreach (int key in EMono.core.refs.dictSketches.Keys) // [!code --]
		foreach (int key in EMono.core.refs.dictSketches2.Keys) // [!code ++]
		{
			if (key >= 500 && key < 700)
			{
```

## +GalleryFlattenAndRename

::: details File Created
```cs
using System.IO;
using System.Linq;
using UnityEngine;

public static class GalleryFlattenAndRename
{
	public static string root = CorePath.CorePackage.ETC + "/Gallery";

	public static UD_Int_String dict;

	public const int ThumbMaxW = 360;

	public const int ThumbMaxH = 240;

	public static UD_Int_String Run()
	{
		dict = new UD_Int_String();
		int num = MoveAllFilesUnderSubfoldersToRoot(root);
		string[] array = Directory.GetDirectories(root, "*", SearchOption.AllDirectories).ToArray();
		for (int i = 0; i < array.Length; i++)
		{
			Directory.Delete(array[i], recursive: true);
		}
		array = Directory.GetFiles(root, "*", SearchOption.TopDirectoryOnly);
		foreach (string text in array)
		{
			if (text.EndsWith("meta"))
			{
				File.Delete(text);
			}
		}
		RenameAllFilesToLeadingNumber(root);
		array = Directory.GetFiles(root, "*", SearchOption.TopDirectoryOnly);
		foreach (string text2 in array)
		{
			if (text2.EndsWith("meta"))
			{
				File.Delete(text2);
			}
		}
		CreateThumbnailsSameFolder(root, 360, 240);
		Debug.Log("[Gallery] Done. Total:" + num + "/" + dict.Count);
		return dict;
	}

	private static int MoveAllFilesUnderSubfoldersToRoot(string root)
	{
		string[] directories = Directory.GetDirectories(root, "*", SearchOption.AllDirectories);
		int num = 0;
		string[] array = directories;
		for (int i = 0; i < array.Length; i++)
		{
			string[] files = Directory.GetFiles(array[i], "*", SearchOption.TopDirectoryOnly);
			foreach (string text in files)
			{
				string text2 = Path.Combine(root, Path.GetFileName(text));
				File.Move(text, text2);
				if (!text2.EndsWith("meta"))
				{
					num++;
				}
			}
		}
		return num;
	}

	private static void RenameAllFilesToLeadingNumber(string root)
	{
		string[] files = Directory.GetFiles(root, "*", SearchOption.TopDirectoryOnly);
		foreach (string obj in files)
		{
			string extension = Path.GetExtension(obj);
			string text = Path.GetFileNameWithoutExtension(obj).Split('_')[0];
			string text2 = Path.Combine(root, text + extension);
			File.Move(obj, text2);
			dict[text.ToInt()] = text2;
		}
	}

	private static void CreateThumbnailsSameFolder(string root, int maxW, int maxH)
	{
		string[] files = Directory.GetFiles(root, "*", SearchOption.TopDirectoryOnly);
		foreach (string text in files)
		{
			if (text.EndsWith(".meta"))
			{
				continue;
			}
			string text2 = Path.GetExtension(text).ToLowerInvariant();
			if (!IsImageExt(text2) || Path.GetFileName(text).Contains(text2 + "_t"))
			{
				continue;
			}
			byte[] data = File.ReadAllBytes(text);
			Texture2D texture2D = new Texture2D(2, 2, TextureFormat.RGBA32, mipChain: false, linear: false);
			if (!texture2D.LoadImage(data))
			{
				Object.DestroyImmediate(texture2D);
				continue;
			}
			int width = texture2D.width;
			int height = texture2D.height;
			float num = Mathf.Min((float)maxW / (float)width, (float)maxH / (float)height);
			if (num > 1f)
			{
				num = 1f;
			}
			int w = Mathf.Max(1, Mathf.RoundToInt((float)width * num));
			int h = Mathf.Max(1, Mathf.RoundToInt((float)height * num));
			Texture2D texture2D2 = ResizeTo(texture2D, w, h);
			string path = text + "_t";
			byte[] bytes = ((!(text2 == ".png")) ? texture2D2.EncodeToJPG(90) : texture2D2.EncodeToPNG());
			File.WriteAllBytes(path, bytes);
			Object.DestroyImmediate(texture2D);
			Object.DestroyImmediate(texture2D2);
		}
	}

	private static bool IsImageExt(string ext)
	{
		if (!(ext == ".png") && !(ext == ".jpg"))
		{
			return ext == ".jpeg";
		}
		return true;
	}

	private static Texture2D ResizeTo(Texture2D src, int w, int h)
	{
		RenderTexture temporary = RenderTexture.GetTemporary(w, h, 0, RenderTextureFormat.ARGB32, RenderTextureReadWrite.sRGB);
		RenderTexture active = RenderTexture.active;
		Graphics.Blit(src, temporary);
		RenderTexture.active = temporary;
		Texture2D texture2D = new Texture2D(w, h, TextureFormat.RGBA32, mipChain: false, linear: false);
		texture2D.ReadPixels(new Rect(0f, 0f, w, h), 0, 0);
		texture2D.Apply(updateMipmaps: false, makeNoLongerReadable: false);
		RenderTexture.active = active;
		RenderTexture.ReleaseTemporary(temporary);
		return texture2D;
	}
}
```

:::
## HotItemHeld

[`public bool TrySetToolAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/HotItemHeld.cs#L330-L336)
```cs:line-numbers=330
		Card tc = null;
		foreach (Chara item in pos.ListVisibleCharas())
		{
			if (item.isSynced && item.IsAliveInCurrentZone && item.mimicry == null) // [!code --]
			if (item.isSynced && item.IsAliveInCurrentZone && (item.mimicry == null || item.IsPCParty)) // [!code ++]
			{
				tc = item;
				break;
```

## HotItemNoItem

[`public static bool _TrySetAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/HotItemNoItem.cs#L16-L22)
```cs:line-numbers=16
	Card tg = null;
	p.pos.ListVisibleCards().ForeachReverse(delegate(Card a)
	{
		if (a.isChara && a.Chara.mimicry != null && !a.IsPC) // [!code --]
		if (a.isChara && a.Chara.mimicry != null && !a.IsPCParty) // [!code ++]
		{
			tg = a;
			return true;
```

[`public static bool _TrySetAct(ActPlan p)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/HotItemNoItem.cs#L34-L40)
```cs:line-numbers=34
		{
			if (tg.ExistsOnMap)
			{
				if (tg.isChara && tg.Chara.mimicry != null) // [!code --]
				if (tg.isChara && tg.Chara.mimicry != null && !tg.IsPCParty) // [!code ++]
				{
					tg.Chara.mimicry.RevealMimicry(EClass.pc, surprise: true);
					return true;
```

## InvOwner

[`public bool Process(bool startTransaction = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/InvOwner.cs#L251-L257)
```cs:line-numbers=251
			destInv.owner.Chara.Talk("tooHeavy");
			return false;
		}
		if (thing2.c_isImportant && !destInv.owner.IsPC && destInv.DenyImportant) // [!code --]
		if (thing2.c_isImportant && destInv != inv && !destInv.owner.IsPC && destInv.DenyImportant) // [!code ++]
		{
			Msg.Say("markedImportant");
			return false;
```

[`public ListInteraction ListInteractions(ButtonGrid b, bool context)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/InvOwner.cs#L1427-L1433)
```cs:line-numbers=1427
	}
	if (context)
	{
		bool flag4 = false; // [!code --]
		if (AllowHold(t) && !Container.isNPCProperty)
		{
			if (t.Num > 1)
```

[`public ListInteraction ListInteractions(ButtonGrid b, bool context)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/InvOwner.cs#L1437-L1460)
```cs:line-numbers=1437
					t.ShowSplitMenu(b, (HasTrader && currency != 0 && !owner.IsPC) ? new Transaction(b) : null);
				});
			}
			if (owner.IsPC) // [!code --]
			if ((owner.IsPC || Container.IsPCFactionOrMinion) && AllowDrop(t)) // [!code ++]
			{
				flag4 = true; // [!code --]
				listInteraction.Add(t.c_isImportant ? "important_off" : "important_on", 299, delegate // [!code --]
				listInteraction.Add(flag ? "dragForget" : "actDrop", 300, delegate // [!code ++]
				{
					t.c_isImportant = !t.c_isImportant; // [!code --]
					LayerInventory.SetDirty(t); // [!code --]
					SE.ClickOk(); // [!code --]
					EClass.pc.DropThing(t); // [!code ++]
				});
				if (AllowDrop(t)) // [!code --]
				{ // [!code --]
					listInteraction.Add(flag ? "dragForget" : "actDrop", 300, delegate // [!code --]
					{ // [!code --]
						EClass.pc.DropThing(t); // [!code --]
					}); // [!code --]
				} // [!code --]
			}
		}
		bool flag4 = false; // [!code ++]
		if (owner.IsPC || Container.IsPCFactionOrMinion) // [!code ++]
		{ // [!code ++]
			flag4 = true; // [!code ++]
			listInteraction.Add(t.c_isImportant ? "important_off" : "important_on", 299, delegate // [!code ++]
			{ // [!code ++]
				t.c_isImportant = !t.c_isImportant; // [!code ++]
				LayerInventory.SetDirty(t); // [!code ++]
				SE.ClickOk(); // [!code ++]
			}); // [!code ++]
		} // [!code ++]
		if (!flag4 && t.c_isImportant)
		{
			listInteraction.Add(t.c_isImportant ? "important_off" : "important_on", 299, delegate
```

## Trait

[`public void OnBarter(bool reroll = false)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/Trait.cs#L1796-L1801)
```cs:line-numbers=1796
				Add("433", 1, 0);
				Add("714", 1, 0);
				Add("1017", 1, 0);
				Add("1313", 1, 0); // [!code ++]
				Add("1155", 1, 0);
				Add("1287", 1, 0);
				Add("1288", 1, 0);
```

## WidgetSideScreen

[`public override void OnSetContextMenu(UIContextMenu m)`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/WidgetSideScreen.cs#L72-L82)
```cs:line-numbers=72
		extra.width = (int)a;
		OnChangeResolution();
	}, 10f, 50f, isInt: true);
	uIContextMenu.AddSlider("image", (float a) => a.ToString() ?? "", extra.idImage, delegate(float a) // [!code --]
	{ // [!code --]
		extra.idImage = (int)a; // [!code --]
		OnChangeResolution(); // [!code --]
	}, 0f, sprites.Length - 1, isInt: true); // [!code --]
	uIContextMenu.AddButton("colorBG", delegate
	{
		EMono.ui.AddLayer<LayerColorPicker>().SetColor(bgColor, Color.white, delegate(PickerState state, Color _c)
```

[`public override void OnChangeResolution()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/WidgetSideScreen.cs#L98-L105)
```cs:line-numbers=98
	base.OnChangeResolution();
	RectTransform rectTransform = this.Rect();
	float x = 0.01f * (float)Screen.width * (float)extra.width / EMono.core.uiScale + 50f;
	float num = (float)Screen.height / EMono.core.uiScale + 50f; // [!code --]
	rectTransform.sizeDelta = new Vector2(x, num); // [!code --]
	float y = (float)Screen.height / EMono.core.uiScale + 50f; // [!code ++]
	rectTransform.sizeDelta = new Vector2(x, y); // [!code ++]
	if (extra.reverse)
	{
		rectTransform.SetAnchor(0f, 0.5f, 0f, 0.5f);
```

[`public override void OnChangeResolution()`](https://github.com/Elin-Modding-Resources/Elin-Decompiled/blob/b6aa3886015d5c09eda913406c89954f20a6b555/Elin/WidgetSideScreen.cs#L111-L124)
```cs:line-numbers=111
		rectTransform.anchoredPosition = new Vector2(rectTransform.sizeDelta.x * -0.5f, 0f);
	}
	Refresh();
	imagePic.SetActive(extra.idImage > 0); // [!code --]
	Sprite sprite = sprites[extra.idImage]; // [!code --]
	if ((bool)sprite) // [!code --]
	{ // [!code --]
		imagePic.sprite = sprite; // [!code --]
		imagePic.rectTransform.sizeDelta = new Vector2(num * (float)sprite.texture.width / (float)sprite.texture.height, num); // [!code --]
		imagePic.color = bgColor; // [!code --]
	} // [!code --]
	imagePic.SetActive(enable: false); // [!code ++]
	if (extra.alignUI)
	{
		if (extra.reverse)
```
